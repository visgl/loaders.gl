"use strict";(self.webpackChunkproject_website=self.webpackChunkproject_website||[]).push([[724],{17298:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>u,frontMatter:()=>d,metadata:()=>s,toc:()=>c});var r=t(62540),i=t(43023);const d={},a="GLTFScenegraph",s={id:"modules/gltf/api-reference/gltf-scenegraph",title:"GLTFScenegraph",description:"The GLTFScenegraph class provides an API for accessing and modifying glTF data.",source:"@site/../docs/modules/gltf/api-reference/gltf-scenegraph.md",sourceDirName:"modules/gltf/api-reference",slug:"/modules/gltf/api-reference/gltf-scenegraph",permalink:"/docs/modules/gltf/api-reference/gltf-scenegraph",draft:!1,unlisted:!1,editUrl:"https://github.com/visgl/loaders.gl/tree/master/website/../docs/modules/gltf/api-reference/gltf-scenegraph.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Overview",permalink:"/docs/modules/gltf/"},next:{title:"postProcessGLTF",permalink:"/docs/modules/gltf/api-reference/post-process-gltf"}},o={},c=[{value:"Usage",id:"usage",level:2},{value:"Accessing",id:"accessing",level:3},{value:"Modifying",id:"modifying",level:3},{value:"Fields",id:"fields",level:2},{value:"gltf: object",id:"gltf-object",level:3},{value:"<code>sourceBuffers: Array&amp;lt;ArrayBuffer | { arrayBuffer?: ArrayBuffer; buffer?: ArrayBuffer; byteOffset: number; byteLength: number}&amp;gt;</code>",id:"sourcebuffers-arrayltarraybuffer---arraybuffer-arraybuffer-buffer-arraybuffer-byteoffset-number-bytelength-numbergt",level:3},{value:"byteLength: number",id:"bytelength-number",level:3},{value:"Accessor Methods",id:"accessor-methods",level:2},{value:"constructor(gltf: object)",id:"constructorgltf-object",level:3},{value:"json()",id:"json",level:3},{value:"getApplicationData(key: string): unknown",id:"getapplicationdatakey-string-unknown",level:3},{value:"getExtraData(key: string): object?",id:"getextradatakey-string-object",level:3},{value:"getExtension(name: string): object?",id:"getextensionname-string-object",level:3},{value:"getUsedExtensions(): string[]",id:"getusedextensions-string",level:3},{value:"getRequiredExtensions(): string[]",id:"getrequiredextensions-string",level:3},{value:"getRemovedExtensions(): string[]",id:"getremovedextensions-string",level:3},{value:"getObjectExtension(object, extensionName)",id:"getobjectextensionobject-extensionname",level:3},{value:"getScene([index: Number]): object?",id:"getsceneindex-number-object",level:3},{value:"getScene(index: Number): object",id:"getsceneindex-number-object-1",level:3},{value:"getNode(index: Number): object",id:"getnodeindex-number-object",level:3},{value:"getSkin(index: Number): object",id:"getskinindex-number-object",level:3},{value:"getMesh(index: Number): object",id:"getmeshindex-number-object",level:3},{value:"getMaterial(index: Number): object",id:"getmaterialindex-number-object",level:3},{value:"getAccessor(index: Number): object",id:"getaccessorindex-number-object",level:3},{value:"getCamera(index: Number): object",id:"getcameraindex-number-object",level:3},{value:"getTexture(index: Number): object",id:"gettextureindex-number-object",level:3},{value:"getSampler(index: Number): object",id:"getsamplerindex-number-object",level:3},{value:"getImage(index: Number): object",id:"getimageindex-number-object",level:3},{value:"getBufferView(index: Number): object",id:"getbufferviewindex-number-object",level:3},{value:"getBuffer(index: Number): object",id:"getbufferindex-number-object",level:3},{value:"getTypedArrayForBufferView(bufferView: Number | object): Uint8Array",id:"gettypedarrayforbufferviewbufferview-number--object-uint8array",level:3},{value:"getTypedArrayForAccessor(accessor: Number | object): Uint8Array | Float32Array | ...",id:"gettypedarrayforaccessoraccessor-number--object-uint8array--float32array--",level:3},{value:"getTypedArrayForImageData(image: Number | object): Uint8Array",id:"gettypedarrayforimagedataimage-number--object-uint8array",level:3},{value:"Modifiers",id:"modifiers",level:2},{value:"addApplicationData(key, data)",id:"addapplicationdatakey-data",level:3},{value:"addExtraData(key, data)",id:"addextradatakey-data",level:3},{value:"addRequiredExtension(extensionName, data)",id:"addrequiredextensionextensionname-data",level:3},{value:"registerUsedExtension(extensionName)",id:"registerusedextensionextensionname",level:3},{value:"registerRequiredExtension(extensionName)",id:"registerrequiredextensionextensionname",level:3},{value:"removeExtension(extensionName)",id:"removeextensionextensionname",level:3},{value:"setObjectExtension(object, extensionName, data)",id:"setobjectextensionobject-extensionname-data",level:3},{value:"setDefaultScene(sceneIndex: number);",id:"setdefaultscenesceneindex-number",level:3},{value:"<code>addScene(arguments: {nodeIndices: number[]}): number</code>",id:"addscenearguments-nodeindices-number-number",level:3},{value:"<code>addNode(arguments: {meshIndex: number}): number;</code>",id:"addnodearguments-meshindex-number-number",level:3},{value:"<code>addMesh(arguments: {attributes: object, indices: object, material: number, mode = 4})</code>",id:"addmesharguments-attributes-object-indices-object-material-number-mode--4",level:3},{value:"<code>addPointCloud(attributes)</code>",id:"addpointcloudattributes",level:3},{value:"<code>addBufferView(buffer)</code>",id:"addbufferviewbuffer",level:3},{value:"<code>addTexture(arguments: {imageIndex: number}): number;</code>",id:"addtexturearguments-imageindex-number-number",level:3},{value:"<code>addMaterial(pbrMaterialInfo: object): number;</code>",id:"addmaterialpbrmaterialinfo-object-number",level:3},{value:"<code>addAccessor(bufferViewIndex, accessor)</code>",id:"addaccessorbufferviewindex-accessor",level:3},{value:"<code>addImage(imageData, mimeType)</code>",id:"addimageimagedata-mimetype",level:3},{value:"<code>createBinChunk()</code>",id:"createbinchunk",level:3}];function l(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"gltfscenegraph",children:"GLTFScenegraph"})}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"GLTFScenegraph"})," class provides an API for accessing and modifying glTF data."]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"Caveat: Modification of binary data chunks has limitations, and this class is currently not intended to be a generic utility for modifying glTF data."}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,r.jsx)(n.h3,{id:"accessing",children:"Accessing"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"import {GLTFLoader, GLTFScenegraph} from '@loaders.gl/gltf';\nimport {load} from '@loaders.gl/core';\n\n// Load and parse a file\nconst gltfWithBuffers = await parse(fetch(GLTF_URL), GLTFLoader);\n\n// Create a parser\nconst gltf = new GLTFScenegraph(gltfWithBuffers);\n\n// Get the complete glTF JSON structure\nconst gltfJson = gltf.getJSON();\n\n// Get specific top-level fields from the glTF JSON chunk\nconst appData = gltf.getApplicationData('customData');\n\n// Get a top level extension from the glTF JSON chunk\nconst topLevelExtension = gltf.getExtension('ORGNAME_extensionName');\nif (topLevelExtension) {\n  ...\n}\n\n// Get images from the binary chunk (together with metadata)\nconst imageIndex = 0;\nconst image = gltf.getImage(imageIndex);\n\n// Get default glTF scenegraph\nconst scenegraph = gltf.getScene();\n// Get specific glTF scenegraph\nconst scenegraph = gltf.getScene(2);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"modifying",children:"Modifying"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:"import {load, encode} from '@loaders.gl/core';\nimport {ImageWriter} from '@loaders.gl/images';\nimport {GLTFLoader, GLTFWriter, GLTFScenegraph} from '@loaders.gl/gltf';\n\n// Load and parse a file\nconst gltfData = await load(GLTF_URL, GLTFLoader);\n\nconst meshIndex = gltfBuilder.addMesh(gltfData.meshes[0].primitives[0].attributes);\nconst nodeIndex = gltfBuilder.addNode(meshIndex);\nconst sceneIndex = gltfBuilder.addScene([nodeIndex]);\ngltfBuilder.setDefaultScene(sceneIndex);\nconst imageBuffer = await encode(gltfData.images[0].image, ImageWriter);\nconst imageIndex = gltfBuilder.addImage(imageBuffer, 'image/jpeg');\nconst textureIndex = gltfBuilder.addTexture(imageIndex);\nconst pbrMaterialInfo = {\n  pbrMetallicRoughness: {\n    baseColorTexture: textureIndex\n  }\n};\ngltfBuilder.addMaterial(pbrMaterialInfo);\ngltfBuilder.createBinaryChunk();\n\nconst gltfBuffer = encodeSync(gltfBuilder.gltf, GLTFWriter);\n"})}),"\n",(0,r.jsx)(n.h2,{id:"fields",children:"Fields"}),"\n",(0,r.jsx)(n.h3,{id:"gltf-object",children:"gltf: object"}),"\n",(0,r.jsxs)(n.p,{children:["Contains all data of gltf including the json part and the binary chunk. The binary chunk is generated by ",(0,r.jsx)(n.code,{children:"createBinChunk()"})," method"]}),"\n",(0,r.jsx)(n.h3,{id:"sourcebuffers-arrayltarraybuffer---arraybuffer-arraybuffer-buffer-arraybuffer-byteoffset-number-bytelength-numbergt",children:(0,r.jsx)(n.code,{children:"sourceBuffers: Array&lt;ArrayBuffer | { arrayBuffer?: ArrayBuffer; buffer?: ArrayBuffer; byteOffset: number; byteLength: number}&gt;"})}),"\n",(0,r.jsxs)(n.p,{children:["Accumulates buffers of resources added by ",(0,r.jsx)(n.code,{children:"addMesh()"}),", ",(0,r.jsx)(n.code,{children:"addImage()"})," etc. These buffers should be compiled before encoding using ",(0,r.jsx)(n.code,{children:"createBinaryChunk()"})]}),"\n",(0,r.jsx)(n.h3,{id:"bytelength-number",children:"byteLength: number"}),"\n",(0,r.jsx)(n.p,{children:"Total byteLength of the binary part of gltf"}),"\n",(0,r.jsx)(n.h2,{id:"accessor-methods",children:"Accessor Methods"}),"\n",(0,r.jsx)(n.h3,{id:"constructorgltf-object",children:"constructor(gltf: object)"}),"\n",(0,r.jsxs)(n.p,{children:["Creates a new ",(0,r.jsx)(n.code,{children:"GLTFScenegraph"})," instance from a pure JavaScript object."]}),"\n",(0,r.jsx)(n.h3,{id:"json",children:"json()"}),"\n",(0,r.jsx)(n.h3,{id:"getapplicationdatakey-string-unknown",children:"getApplicationData(key: string): unknown"}),"\n",(0,r.jsx)(n.p,{children:"Returns the given data field in the top-level glTF JSON object."}),"\n",(0,r.jsx)(n.h3,{id:"getextradatakey-string-object",children:"getExtraData(key: string): object?"}),"\n",(0,r.jsxs)(n.p,{children:["Returns a key in the top-level glTF ",(0,r.jsx)(n.code,{children:"extras"})," JSON object."]}),"\n",(0,r.jsx)(n.h3,{id:"getextensionname-string-object",children:"getExtension(name: string): object?"}),"\n",(0,r.jsxs)(n.p,{children:["Returns the top-level extension by ",(0,r.jsx)(n.code,{children:"name"}),", if present."]}),"\n",(0,r.jsx)(n.h3,{id:"getusedextensions-string",children:"getUsedExtensions(): string[]"}),"\n",(0,r.jsx)(n.p,{children:"Returns an array of extension names (covering all extensions used at any level of the glTF hierarchy)."}),"\n",(0,r.jsx)(n.h3,{id:"getrequiredextensions-string",children:"getRequiredExtensions(): string[]"}),"\n",(0,r.jsx)(n.p,{children:"Returns an array of extensions at any level of the glTF hierarchy that are required to properly display this file (covering all extensions used at any level of the glTF hierarchy)."}),"\n",(0,r.jsx)(n.h3,{id:"getremovedextensions-string",children:"getRemovedExtensions(): string[]"}),"\n",(0,r.jsx)(n.p,{children:"When loaders.gl parses a glTF file, by default it pre-processes and removes certain extensions (e.g. various mesh and image compression formats), see documentation on glTF extensions for more information."}),"\n",(0,r.jsx)(n.p,{children:"The resulting glTF is intended to be identical to a glTF created without those extensions. However in some cases it is useful to know what extensions were removed during preprocessing."}),"\n",(0,r.jsx)(n.h3,{id:"getobjectextensionobject-extensionname",children:"getObjectExtension(object, extensionName)"}),"\n",(0,r.jsx)(n.h3,{id:"getsceneindex-number-object",children:"getScene([index: Number]): object?"}),"\n",(0,r.jsx)(n.p,{children:"Returns the scene (scenegraph) with the given index, or the default scene if no index is specified."}),"\n",(0,r.jsx)(n.h3,{id:"getsceneindex-number-object-1",children:"getScene(index: Number): object"}),"\n",(0,r.jsx)(n.h3,{id:"getnodeindex-number-object",children:"getNode(index: Number): object"}),"\n",(0,r.jsx)(n.h3,{id:"getskinindex-number-object",children:"getSkin(index: Number): object"}),"\n",(0,r.jsx)(n.h3,{id:"getmeshindex-number-object",children:"getMesh(index: Number): object"}),"\n",(0,r.jsx)(n.h3,{id:"getmaterialindex-number-object",children:"getMaterial(index: Number): object"}),"\n",(0,r.jsx)(n.h3,{id:"getaccessorindex-number-object",children:"getAccessor(index: Number): object"}),"\n",(0,r.jsx)(n.h3,{id:"getcameraindex-number-object",children:"getCamera(index: Number): object"}),"\n",(0,r.jsx)(n.h3,{id:"gettextureindex-number-object",children:"getTexture(index: Number): object"}),"\n",(0,r.jsx)(n.h3,{id:"getsamplerindex-number-object",children:"getSampler(index: Number): object"}),"\n",(0,r.jsx)(n.h3,{id:"getimageindex-number-object",children:"getImage(index: Number): object"}),"\n",(0,r.jsx)(n.p,{children:"Returns the image with specified index"}),"\n",(0,r.jsx)(n.h3,{id:"getbufferviewindex-number-object",children:"getBufferView(index: Number): object"}),"\n",(0,r.jsx)(n.h3,{id:"getbufferindex-number-object",children:"getBuffer(index: Number): object"}),"\n",(0,r.jsx)(n.h3,{id:"gettypedarrayforbufferviewbufferview-number--object-uint8array",children:"getTypedArrayForBufferView(bufferView: Number | object): Uint8Array"}),"\n",(0,r.jsx)(n.p,{children:"Accepts buffer view index or buffer view object"}),"\n",(0,r.jsx)(n.h3,{id:"gettypedarrayforaccessoraccessor-number--object-uint8array--float32array--",children:"getTypedArrayForAccessor(accessor: Number | object): Uint8Array | Float32Array | ..."}),"\n",(0,r.jsx)(n.p,{children:"Accepts accessor index or accessor object."}),"\n",(0,r.jsx)(n.p,{children:"Returns a typed array with type that matches the types"}),"\n",(0,r.jsx)(n.h3,{id:"gettypedarrayforimagedataimage-number--object-uint8array",children:"getTypedArrayForImageData(image: Number | object): Uint8Array"}),"\n",(0,r.jsx)(n.p,{children:"accepts accessor index or accessor object"}),"\n",(0,r.jsx)(n.h2,{id:"modifiers",children:"Modifiers"}),"\n",(0,r.jsx)(n.h3,{id:"addapplicationdatakey-data",children:"addApplicationData(key, data)"}),"\n",(0,r.jsx)(n.p,{children:"Add an extra application-defined key to the top-level data structure"}),"\n",(0,r.jsx)(n.h3,{id:"addextradatakey-data",children:"addExtraData(key, data)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"extras"})," - Standard GLTF field for storing application specific data"]}),"\n",(0,r.jsx)(n.p,{children:"Add to GLTF top level extension object, mark as used"}),"\n",(0,r.jsx)(n.h3,{id:"addrequiredextensionextensionname-data",children:"addRequiredExtension(extensionName, data)"}),"\n",(0,r.jsx)(n.p,{children:"Add GLTF top level extension object, mark as used and required"}),"\n",(0,r.jsx)(n.h3,{id:"registerusedextensionextensionname",children:"registerUsedExtension(extensionName)"}),"\n",(0,r.jsx)(n.p,{children:"Add extensionName to list of used extensions"}),"\n",(0,r.jsx)(n.h3,{id:"registerrequiredextensionextensionname",children:"registerRequiredExtension(extensionName)"}),"\n",(0,r.jsx)(n.p,{children:"Add extensionName to list of required extensions"}),"\n",(0,r.jsx)(n.h3,{id:"removeextensionextensionname",children:"removeExtension(extensionName)"}),"\n",(0,r.jsxs)(n.p,{children:["Removes an extension name string from the top-level glTF extension fields (",(0,r.jsx)(n.code,{children:"extensionsUsed"})," and ",(0,r.jsx)(n.code,{children:"extensionsRequired"}),") if present.\nAlso adds the same extensionName to the ",(0,r.jsx)(n.code,{children:"extensionsRemoved"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"setobjectextensionobject-extensionname-data",children:"setObjectExtension(object, extensionName, data)"}),"\n",(0,r.jsx)(n.h3,{id:"setdefaultscenesceneindex-number",children:"setDefaultScene(sceneIndex: number);"}),"\n",(0,r.jsx)(n.p,{children:"Set the default scene which is to be displayed at load time"}),"\n",(0,r.jsx)(n.h3,{id:"addscenearguments-nodeindices-number-number",children:(0,r.jsx)(n.code,{children:"addScene(arguments: {nodeIndices: number[]}): number"})}),"\n",(0,r.jsx)(n.p,{children:"Add a scene to the json part"}),"\n",(0,r.jsx)(n.h3,{id:"addnodearguments-meshindex-number-number",children:(0,r.jsx)(n.code,{children:"addNode(arguments: {meshIndex: number}): number;"})}),"\n",(0,r.jsx)(n.p,{children:"Add a node to the json part"}),"\n",(0,r.jsx)(n.h3,{id:"addmesharguments-attributes-object-indices-object-material-number-mode--4",children:(0,r.jsx)(n.code,{children:"addMesh(arguments: {attributes: object, indices: object, material: number, mode = 4})"})}),"\n",(0,r.jsx)(n.h3,{id:"addpointcloudattributes",children:(0,r.jsx)(n.code,{children:"addPointCloud(attributes)"})}),"\n",(0,r.jsx)(n.h3,{id:"addbufferviewbuffer",children:(0,r.jsx)(n.code,{children:"addBufferView(buffer)"})}),"\n",(0,r.jsxs)(n.p,{children:["Add one untyped source buffer, create a matching glTF ",(0,r.jsx)(n.code,{children:"bufferView"}),", and return its index"]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["The binary data will not be added to the gltf buffer until ",(0,r.jsx)(n.code,{children:"createBinChunk()"})," is called."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"addtexturearguments-imageindex-number-number",children:(0,r.jsx)(n.code,{children:"addTexture(arguments: {imageIndex: number}): number;"})}),"\n",(0,r.jsx)(n.p,{children:"Add a texture to the json part"}),"\n",(0,r.jsx)(n.h3,{id:"addmaterialpbrmaterialinfo-object-number",children:(0,r.jsx)(n.code,{children:"addMaterial(pbrMaterialInfo: object): number;"})}),"\n",(0,r.jsx)(n.p,{children:"Add a material to the json part"}),"\n",(0,r.jsx)(n.h3,{id:"addaccessorbufferviewindex-accessor",children:(0,r.jsx)(n.code,{children:"addAccessor(bufferViewIndex, accessor)"})}),"\n",(0,r.jsx)(n.p,{children:"Adds an accessor to a bufferView"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["The binary data will not be added to the gltf buffer until ",(0,r.jsx)(n.code,{children:"createBinChunk()"})," is called."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"addimageimagedata-mimetype",children:(0,r.jsx)(n.code,{children:"addImage(imageData, mimeType)"})}),"\n",(0,r.jsx)(n.p,{children:'Adds a binary image. Builds glTF "JSON metadata" and saves buffer reference\nBuffer will be copied into BIN chunk during "pack"'}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["The binary data will not be added to the gltf buffer until ",(0,r.jsx)(n.code,{children:"createBinChunk()"})," is called."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"createbinchunk",children:(0,r.jsx)(n.code,{children:"createBinChunk()"})}),"\n",(0,r.jsx)(n.p,{children:"Packs any pending binary data into the first binary glTF buffer."}),"\n",(0,r.jsx)(n.p,{children:"Note: Overwrites the existing first buffer if present."})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},43023:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>s});var r=t(63696);const i={},d=r.createContext(i);function a(e){const n=r.useContext(d);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),r.createElement(d.Provider,{value:n},e.children)}}}]);