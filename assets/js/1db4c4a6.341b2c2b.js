"use strict";(self.webpackChunkproject_website=self.webpackChunkproject_website||[]).push([[3970],{62175:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>i,default:()=>h,frontMatter:()=>o,metadata:()=>a,toc:()=>c});var r=n(85893),s=n(11151);const o={},i="Creating New Loaders and Writers",a={id:"developer-guide/creating-loaders-and-writers",title:"Creating New Loaders and Writers",description:"See the a detailed specification of the loader object format API reference.",source:"@site/../docs/developer-guide/creating-loaders-and-writers.md",sourceDirName:"developer-guide",slug:"/developer-guide/creating-loaders-and-writers",permalink:"/docs/developer-guide/creating-loaders-and-writers",draft:!1,unlisted:!1,editUrl:"https://github.com/visgl/loaders.gl/tree/master/website/../docs/developer-guide/creating-loaders-and-writers.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Managing Dependencies",permalink:"/docs/developer-guide/dependencies"},next:{title:"Composite Loaders",permalink:"/docs/developer-guide/composite-loaders"}},d={},c=[{value:"Overview",id:"overview",level:2},{value:"Creating a Loader Object",id:"creating-a-loader-object",level:2},{value:"Dependency Management",id:"dependency-management",level:2},{value:"Creating Composite Loaders",id:"creating-composite-loaders",level:2},{value:"Accessing the Response object",id:"accessing-the-response-object",level:2}];function l(e){const t={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,s.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.h1,{id:"creating-new-loaders-and-writers",children:"Creating New Loaders and Writers"}),"\n",(0,r.jsxs)(t.blockquote,{children:["\n",(0,r.jsxs)(t.p,{children:["See the a detailed specification of the ",(0,r.jsx)(t.a,{href:"/docs/specifications/loader-object-format",children:"loader object format API reference"}),"."]}),"\n"]}),"\n",(0,r.jsx)(t.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsx)(t.p,{children:"Applications can also create new loader objects. E.g. if you have existing JavaScript parsing functionality that you would like to use with the loaders.gl core utility functions."}),"\n",(0,r.jsx)(t.h2,{id:"creating-a-loader-object",children:"Creating a Loader Object"}),"\n",(0,r.jsx)(t.p,{children:"You would give a name to the loader object, define what file extension(s) it uses, and define a parser function."}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-typescript",children:"export default {\n  name: 'JSON',\n  extensions: ['json'],\n  testText: null,\n  parse: async (arrayBuffer) => await JSON.parse(new TextDecoder().decode(arrayBuffer),\n  parseTextSync: JSON.parse\n};\n"})}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Field"}),(0,r.jsx)(t.th,{children:"Type"}),(0,r.jsx)(t.th,{children:"Default"}),(0,r.jsx)(t.th,{children:"Description"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"name"})}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"String"})}),(0,r.jsx)(t.td,{children:"Required"}),(0,r.jsx)(t.td,{children:"Short name of the loader ('OBJ', 'PLY' etc)"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"extension"})}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"String"})}),(0,r.jsx)(t.td,{children:"Required"}),(0,r.jsx)(t.td,{children:"Three letter (typically) extension used by files of this format"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"testText"})}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"Function"})}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"null"})}),(0,r.jsx)(t.td,{children:"Guesses if a file is of this format by examining the first characters in the file"})]})]})]}),"\n",(0,r.jsx)(t.p,{children:"A loader must define a parser function for the format, a function that takes the loaded data and converts it into a parsed object."}),"\n",(0,r.jsx)(t.p,{children:"Depending on how the underlying loader works (whether it is synchronous or asynchronous and whether it expects text or binary data), the loader object can expose the parser in a couple of different ways, specified by provided one of the parser function fields."}),"\n",(0,r.jsx)(t.h2,{id:"dependency-management",children:"Dependency Management"}),"\n",(0,r.jsxs)(t.p,{children:['In general, it is recommended that loaders are "standalone" and avoid importing ',(0,r.jsx)(t.code,{children:"@loaders.gl/core"}),". ",(0,r.jsx)(t.code,{children:"@loaders.gl/loader-utils"})," provides a small set of shared loader utilities."]}),"\n",(0,r.jsx)(t.h2,{id:"creating-composite-loaders",children:"Creating Composite Loaders"}),"\n",(0,r.jsxs)(t.p,{children:['loaders.gl enables loaders to call other loaders (referred to as "sub-loaders" in this section).\nThis enables loaders for "composite formats" to be "composed" out of loaders for the primitive parts.\nFor more information see ',(0,r.jsx)(t.a,{href:"./composite-loaders",children:"Composite Loaders"}),"."]}),"\n",(0,r.jsx)(t.h2,{id:"accessing-the-response-object",children:"Accessing the Response object"}),"\n",(0,r.jsxs)(t.p,{children:["Loaders will often use the ",(0,r.jsx)(t.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API",children:"fetch API"})," to retrieve data. In most cases, a loader will only be concerned with the data payload, but in some cases it may be desirable to access the underlying ",(0,r.jsx)(t.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/Response",children:"Response"})," object, available on the ",(0,r.jsx)(t.code,{children:"context"})," parameter."]}),"\n",(0,r.jsx)(t.p,{children:"An example of accessing a HTTP header."}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-typescript",children:"export async function parseWithHeader(arrayBuffer, options, context) {\n  const {parse, response} = context;\n  const contentLength = response.headers.get('content-length');\n  const data = await parse(arrayBuffer, JSONLoader);\n}\n"})})]})}function h(e={}){const{wrapper:t}={...(0,s.a)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},11151:(e,t,n)=>{n.d(t,{Z:()=>a,a:()=>i});var r=n(67294);const s={},o=r.createContext(s);function i(e){const t=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),r.createElement(o.Provider,{value:t},e.children)}}}]);