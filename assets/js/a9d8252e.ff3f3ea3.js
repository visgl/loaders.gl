"use strict";(self.webpackChunkproject_website=self.webpackChunkproject_website||[]).push([[4565],{99789:(e,r,s)=>{s.r(r),s.d(r,{assets:()=>c,contentTitle:()=>i,default:()=>p,frontMatter:()=>a,metadata:()=>o,toc:()=>d});var n=s(62540),t=s(43023);const a={},i="WMSSource",o={id:"modules/wms/api-reference/wms-source",title:"WMSSource",description:"ogc-logo",source:"@site/../docs/modules/wms/api-reference/wms-source.md",sourceDirName:"modules/wms/api-reference",slug:"/modules/wms/api-reference/wms-source",permalink:"/docs/modules/wms/api-reference/wms-source",draft:!1,unlisted:!1,editUrl:"https://github.com/visgl/loaders.gl/tree/master/website/../docs/modules/wms/api-reference/wms-source.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"CSWService \ud83d\udea7",permalink:"/docs/modules/wms/api-reference/csw-source"},next:{title:"File Formats",permalink:"/docs/formats/"}},c={},d=[{value:"Usage",id:"usage",level:2},{value:"Methods",id:"methods",level:2},{value:"constructor()",id:"constructor",level:3},{value:"getCapabilities()",id:"getcapabilities",level:3},{value:"getMap()",id:"getmap",level:3},{value:"getFeatureInfo()",id:"getfeatureinfo",level:3},{value:"describeLayer()",id:"describelayer",level:3},{value:"getLegendGraphic()",id:"getlegendgraphic",level:3},{value:"Limitations",id:"limitations",level:2}];function l(e){const r={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",p:"p",pre:"pre",...(0,t.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.header,{children:(0,n.jsx)(r.h1,{id:"wmssource",children:"WMSSource"})}),"\n",(0,n.jsx)("p",{class:"badges",children:(0,n.jsx)("img",{src:"https://img.shields.io/badge/From-v3.3-blue.svg?style=flat-square",alt:"From-3.3"})}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)(r.img,{alt:"ogc-logo",src:s(9215).A+"",width:"119",height:"60"})}),"\n",(0,n.jsxs)(r.p,{children:["The ",(0,n.jsx)(r.code,{children:"WMSSource"})," class helps applications interact with a WMS service (discover its capabilities, request map images and information about geospatial features, etc)."]}),"\n",(0,n.jsxs)(r.p,{children:["The ",(0,n.jsx)(r.code,{children:"WMSSource"})," provides a type safe API that forms valid WMS URLs and issues requests, handles WMS version differences and edge cases under the hood and parses results and errors into strongly typed JavaScript objects."]}),"\n",(0,n.jsxs)(r.p,{children:["The ",(0,n.jsx)(r.code,{children:"WMSSource"})," implements the ",(0,n.jsx)(r.code,{children:"ImageService"})," interface, allowing WMS services to be used as one interchangeable source of asynchronously generated map image data."]}),"\n",(0,n.jsx)(r.h2,{id:"usage",children:"Usage"}),"\n",(0,n.jsxs)(r.p,{children:["A ",(0,n.jsx)(r.code,{children:"WMSSource"})," instance provides type safe methods to send requests to a WMS service and parse the responses:"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-typescript",children:"const wmsService = createDataSource(WMS_SERVICE_URL, [WMSSource], {\n  wmsParameters: {layers: ['oms']}\n});\nconst mapImage = await wmsService.getMap({\n  width: 800,\n  height: 600,\n  bbox: [30, 70, 35, 75]\n});\n// Render mapImage...\n"})}),"\n",(0,n.jsx)(r.p,{children:"Capabilities metadata can be queried:"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-typescript",children:"const wmsService = createDataSource(WMS_SERVICE_URL, [WMSSource]);\nconst capabilities = await wmsService.getCapabilities({});\n// Check capabilities\n"})}),"\n",(0,n.jsx)(r.p,{children:"The WMS version as well as other default WMS parameters can be specified in the constructor"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-typescript",children:"// Specify the older 1.1.1 version (1.3.0 is the default)\nconst wmsService = createDataSource(WMS_SERVICE_URL, [WMSSource], {\n  version: '1.1.1',\n  layers: ['oms']\n});\nconst getMap = await wmsService.getMap({\n  width: 800,\n  height: 600,\n  bbox: [30, 70, 35, 75]\n});\n"})}),"\n",(0,n.jsxs)(r.p,{children:["Custom fetch options, such as HTTP headers, and loader-specific options can be specified via the\nstandard loaders.gl ",(0,n.jsx)(r.code,{children:"loadOptions"})," argument, which is forwarded to all load and parse operations:"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-typescript",children:"const wmsService = createDataSource(WMS_SERVICE_URL, [WMSSource], {\n  core: {\n    loadOptions: {\n      fetch: {\n        headers: {\n          Authentication: 'Bearer abc...'\n        }\n      }\n    }\n  }\n});\n\nconst getMap = await wmsService.getMap({\n  width: 800,\n  height: 600,\n  bbox: [30, 70, 35, 75],\n  layers: ['oms']\n});\n"})}),"\n",(0,n.jsxs)(r.p,{children:["For special use cases, is possible to use the ",(0,n.jsx)(r.code,{children:"WMSSource"})," to just generate URLs, so that the application issue its own requests and parse responses."]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-typescript",children:"const wmsService = createDataSource(WMS_SERVICE_URL, [WMSSource]);\nconst getMapUrl = await wmsService.getMapURL({\n  width: 800,\n  height: 600,\n  bbox: [30, 70, 35, 75],\n  layers: ['oms']\n});\nconst response = await myCustomFetch(getMapURL);\n// parse...\n"})}),"\n",(0,n.jsx)(r.h2,{id:"methods",children:"Methods"}),"\n",(0,n.jsx)(r.h3,{id:"constructor",children:"constructor()"}),"\n",(0,n.jsxs)(r.p,{children:["Creates a ",(0,n.jsx)(r.code,{children:"WMSSource"})," instance. Not normally called by the application, use"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-typescript",children:"export type WMSServiceProps = {\n  url: string; // Base URL to the service\n  loadOptions?: LoaderOptions; // Any load options to the loaders.gl Loaders used by the WMSSource methods\n  substituteCRS84?: boolean; // In WMS 1.3.0, replaces EPSG:4326 with CRS:84 to ensure lng,lat axis order. Default true.\n\n  wmsParameters: {\n    // Default WMS parameters can be provided here\n    version?: '1.3.0' | '1.1.1'; /** WMS version */\n    layers?: string[]; /** Layers to render */\n    query_layers?: string[]; /** Layers to query */\n    crs?: string; /** CRS for the image (not the bounding box) */\n    format?: 'image/png'; /** Requested format for the return image */\n    info_format?: 'text/plain' | 'application/vnd.ogc.gml'; /** Requested MIME type of returned feature info */\n    styles?: unknown; /** Styling */\n    transparent?: boolean; /** Render transparent pixels if no data */\n  },\n  vendorParameters\n};\n\nconstructor(props: WMSServiceProps)\n"})}),"\n",(0,n.jsx)(r.h3,{id:"getcapabilities",children:"getCapabilities()"}),"\n",(0,n.jsx)(r.p,{children:"Get Capabilities"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-typescript",children:"  async getCapabilities(\n    wmsParameters?: WMSGetCapabilitiesParameters,\n    vendorParameters?: Record<string, unknown>\n  ): Promise<WMSCapabilities>\n"})}),"\n",(0,n.jsxs)(r.p,{children:["Returns a capabilities objects. See [",(0,n.jsx)(r.code,{children:"WMSCapabilitiesLoader"}),"][/docs/modules/wms/api-reference/wms-capabilities-loader] for detailed information about the ",(0,n.jsx)(r.code,{children:"WMSCapabilities"})," type."]}),"\n",(0,n.jsx)(r.h3,{id:"getmap",children:"getMap()"}),"\n",(0,n.jsx)(r.p,{children:"Get a map image"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-typescript",children:"  async getMap(wmsParameters: WMSGetMapParameters, vendorParameters?: Record<string, unknown>): Promise<ImageType>\n"})}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-typescript",children:"export type WMSGetMapParameters = {\n  bbox: [number, number, number, number]; // bounding box of the requested map image\n  width: number; // pixel width of returned image\n  height: number; // pixels\n\n  // constructor parameters can be overridden in the actual calls\n  layers?: string | string[]; // Layers to render\n  styles?: unknown; // Styling\n  crs?: string; // crs for the image (not the bounding box)\n  format?: 'image/png'; // requested format for the return image\n};\n"})}),"\n",(0,n.jsx)(r.h3,{id:"getfeatureinfo",children:"getFeatureInfo()"}),"\n",(0,n.jsxs)(r.blockquote,{children:["\n",(0,n.jsxs)(r.p,{children:["This request is not supported by all WNS servers. Use ",(0,n.jsx)(r.code,{children:"getCapabilities()"})," to determine if it is."]}),"\n"]}),"\n",(0,n.jsx)(r.p,{children:"Get Feature Info for a coordinate"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-typescript",children:"  async getFeatureInfo(\n    wmsParameters: WMSGetFeatureInfoParameters,\n    vendorParameters?: Record<string, unknown>\n  ): Promise<WMSFeatureInfo>\n"})}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-typescript",children:"// https://imagery.pasda.psu.edu/arcgis/services/pasda/UrbanTreeCanopy_Landcover/MapServer/WmsServer?SERVICE=WMS&\nexport type WMSGetFeatureInfoParameters = {\n  x: number; // x coordinate for the feature info request\n  y: number; // y coordinate for the feature info request\n  query_layers: string[]; // list of layers to query (could be different from rendered layers)\n  info_format?: 'text/plain' | 'application/geojson' | 'application/vnd.ogc.gml'; // MIME type of returned feature info\n  layers: string[]; // Layers to render\n  styles?: unknown; // Styling\n  bbox: [number, number, number, number]; // bounding box of the requested map image\n  width: number; // pixel width of returned image\n  height: number; // pixels\n  crs?: string; // crs for the image (not the bounding box)\n  format?: 'image/png'; // requested format for the return image\n};\n"})}),"\n",(0,n.jsx)(r.h3,{id:"describelayer",children:"describeLayer()"}),"\n",(0,n.jsxs)(r.blockquote,{children:["\n",(0,n.jsxs)(r.p,{children:["This request is not supported by all WNS servers. Use ",(0,n.jsx)(r.code,{children:"getCapabilities()"})," to determine if it is."]}),"\n"]}),"\n",(0,n.jsx)(r.p,{children:"Get more information about a layer."}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-typescript",children:"  async describeLayer(\n    wmsParameters: WMSDescribeLayerParameters,\n    vendorParameters?: Record<string, unknown>\n  ): Promise<WMSLayerDescription>\n"})}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-typescript",children:"export type WMSDescribeLayerParameters = {\n  layer: string; // Layer to describe\n};\n"})}),"\n",(0,n.jsx)(r.h3,{id:"getlegendgraphic",children:"getLegendGraphic()"}),"\n",(0,n.jsxs)(r.blockquote,{children:["\n",(0,n.jsxs)(r.p,{children:["This request is not supported by all WMS servers. Use ",(0,n.jsx)(r.code,{children:"getCapabilities()"})," to determine if it is."]}),"\n"]}),"\n",(0,n.jsx)(r.p,{children:"Get an image with a semantic legend"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-typescript",children:"  async getLegendGraphic(\n    wmsParameters: WMSGetLegendGraphicParameters,\n    vendorParameters?: Record<string, unknown>\n  ): Promise<ImageType>\n"})}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-typescript",children:"export type WMSGetLegendGraphicParameters = {};\n"})}),"\n",(0,n.jsx)(r.h2,{id:"limitations",children:"Limitations"}),"\n",(0,n.jsxs)(r.p,{children:["The ",(0,n.jsx)(r.code,{children:"WMSSource"})," only supports WMS URL parameters generation and HTTP GET requests against a WMS server. The OGC WMS standard also allows WMS services to accept XML payloads with HTTP POST messages, however generation of such XML payloads is not supported."]})]})}function p(e={}){const{wrapper:r}={...(0,t.R)(),...e.components};return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(l,{...e})}):l(e)}},9215:(e,r,s)=>{s.d(r,{A:()=>n});const n=s.p+"assets/images/ogc-logo-60-8ee2c25a50ccc14293453512c707a0c4.png"},43023:(e,r,s)=>{s.d(r,{R:()=>i,x:()=>o});var n=s(63696);const t={},a=n.createContext(t);function i(e){const r=n.useContext(a);return n.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function o(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),n.createElement(a.Provider,{value:r},e.children)}}}]);