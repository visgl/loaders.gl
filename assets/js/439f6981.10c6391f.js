"use strict";(self.webpackChunkproject_website=self.webpackChunkproject_website||[]).push([[8827],{83331:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>a,contentTitle:()=>d,default:()=>h,frontMatter:()=>i,metadata:()=>o,toc:()=>c});var r=t(62540),n=t(43023);const i={},d="JSONWriter",o={id:"modules/json/api-reference/json-writer",title:"JSONWriter",description:"Streaming writer for GeoJSON encoded files.",source:"@site/../docs/modules/json/api-reference/json-writer.md",sourceDirName:"modules/json/api-reference",slug:"/modules/json/api-reference/json-writer",permalink:"/docs/modules/json/api-reference/json-writer",draft:!1,unlisted:!1,editUrl:"https://github.com/visgl/loaders.gl/tree/master/website/../docs/modules/json/api-reference/json-writer.md",tags:[],version:"current",frontMatter:{}},a={},c=[{value:"Usage",id:"usage",level:2},{value:"Streaming and JSON paths",id:"streaming-and-json-paths",level:3},{value:"Data Format",id:"data-format",level:2},{value:"Options",id:"options",level:2},{value:"JSONPaths",id:"jsonpaths",level:2},{value:"Attribution",id:"attribution",level:2}];function l(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,n.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"jsonwriter",children:"JSONWriter"})}),"\n",(0,r.jsx)("p",{class:"badges",children:(0,r.jsx)("img",{src:"https://img.shields.io/badge/From-v4.0-blue.svg?style=flat-square",alt:"From-v4.0"})}),"\n",(0,r.jsx)(s.p,{children:"Streaming writer for GeoJSON encoded files."}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Loader"}),(0,r.jsx)(s.th,{children:"Characteristic"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"File Extension"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:".geojson"})})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Media Type"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"application/geo+json"})})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"File Type"}),(0,r.jsx)(s.td,{children:"Text"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"File Format"}),(0,r.jsx)(s.td,{children:"JSON"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Data Format"}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.a,{href:"/docs/specifications/category-table",children:"Classic Table"})})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:"Supported APIs"}),(0,r.jsxs)(s.td,{children:[(0,r.jsx)(s.code,{children:"encode"}),", ",(0,r.jsx)(s.code,{children:"encodeSync"}),", ",(0,r.jsx)(s.code,{children:"encode\xd3InBatches"})]})]})]})]}),"\n",(0,r.jsx)(s.h2,{id:"usage",children:"Usage"}),"\n",(0,r.jsx)(s.p,{children:'For simple usage, you can encode a table into a JSON "file" atomically:'}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-typescript",children:"import {JSONWriter} from '@loaders.gl/json';\nimport {encode} from '@loaders.gl/core';\n\nconst data = await encode(url, JSONWriter, {json: options});\n"})}),"\n",(0,r.jsx)(s.h3,{id:"streaming-and-json-paths",children:"Streaming and JSON paths"}),"\n",(0,r.jsx)(s.p,{children:'For larger files, JSONWriter supports streaming JSON parsing, in which case it will yield "batches" of rows from one array.'}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-typescript",children:"import {JSONWriter} from '@loaders.gl/json';\nimport {encodeInBatches} from '@loaders.gl/core';\n\nconst batches = await encodeInBatches('geojson.json', JSONWriter, {json: {jsonpaths: ['$.features']}});\n\nfor await (const batch of batches) {\n  // batch.data will contain a number of rows\n  for (const feature of batch.data) {\n    switch (feature.geometry.type) {\n      case 'Polygon':\n      ...\n    }\n  }\n}\n"})}),"\n",(0,r.jsxs)(s.p,{children:["To parse a stream of GeoJSON, the user can specify the ",(0,r.jsx)(s.code,{children:"options.json.jsonpaths"})," to stream the ",(0,r.jsx)(s.code,{children:"features"})," array."]}),"\n",(0,r.jsx)(s.p,{children:"If no JSONPath is specified the loader will stream the first array it encounters in the JSON payload."}),"\n",(0,r.jsx)(s.h2,{id:"data-format",children:"Data Format"}),"\n",(0,r.jsx)(s.p,{children:"Encoded batches are array buffers or strings"}),"\n",(0,r.jsx)(s.h2,{id:"options",children:"Options"}),"\n",(0,r.jsxs)(s.p,{children:["Supports table category options such as ",(0,r.jsx)(s.code,{children:"batchType"})," and ",(0,r.jsx)(s.code,{children:"batchSize"}),"."]}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Option"}),(0,r.jsx)(s.th,{children:"From"}),(0,r.jsx)(s.th,{children:"Type"}),(0,r.jsx)(s.th,{children:"Default"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"json.table"})}),(0,r.jsxs)(s.td,{children:["[",(0,r.jsx)(s.img,{src:"https://img.shields.io/badge/v2.0-blue.svg?style=flat-square",alt:"Website shields.io"}),"]"]}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"boolean"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"false"})}),(0,r.jsxs)(s.td,{children:["Parses non-streaming JSON as table, i.e. return the first embedded array in the JSON. Always ",(0,r.jsx)(s.code,{children:"true"})," during batched/streaming parsing."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"json.jsonpaths"})}),(0,r.jsxs)(s.td,{children:["[",(0,r.jsx)(s.img,{src:"https://img.shields.io/badge/v2.2-blue.svg?style=flat-square",alt:"Website shields.io"}),"]"]}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"string[]"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"[]"})}),(0,r.jsx)(s.td,{children:"A list of JSON paths (see below) indicating the array that can be streamed."})]})]})]}),"\n",(0,r.jsx)(s.h2,{id:"jsonpaths",children:"JSONPaths"}),"\n",(0,r.jsx)(s.p,{children:"A minimal subset of the JSONPath syntax is supported, to specify which array in a JSON object should be streamed as batchs."}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.code,{children:"$.component1.component2.component3"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["No support for wildcards, brackets etc. Only paths starting with ",(0,r.jsx)(s.code,{children:"$"})," (JSON root) are supported."]}),"\n",(0,r.jsx)(s.li,{children:"Regardless of the paths provided, only arrays will be streamed."}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"attribution",children:"Attribution"}),"\n",(0,r.jsxs)(s.p,{children:["This loader is based on a fork of dscape's ",(0,r.jsx)(s.a,{href:"https://github.com/dscape/clarinet",children:(0,r.jsx)(s.code,{children:"clarinet"})})," under BSD 2-clause license."]})]})}function h(e={}){const{wrapper:s}={...(0,n.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},43023:(e,s,t)=>{t.d(s,{R:()=>d,x:()=>o});var r=t(63696);const n={},i=r.createContext(n);function d(e){const s=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:d(e.components),r.createElement(i.Provider,{value:s},e.children)}}}]);