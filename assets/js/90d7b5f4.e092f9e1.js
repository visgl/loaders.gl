"use strict";(self.webpackChunkproject_website=self.webpackChunkproject_website||[]).push([[1936],{97531:(t,e,n)=>{n.d(e,{Z:()=>ze});var r=n(67294),o=(n(20745),n(21740)),s=n(19193),i=n(36642),a=n(35199),l=n(99031),c=n(43475);function u(t){const e={};for(const[n,r]of Object.entries(t))"fields"!==n&&r&&(e[n]=JSON.stringify(r));return e}function h(t){switch(t.type.toLowerCase()){case"float32":return"float32";case"number":case"float64":return"float64";case"string":case"utf8":return"utf8";case"boolean":return"bool";default:return"null"}}function p(t){const e={};for(const[n,r]of Object.entries(t))"name"!==n&&r&&(e[n]=JSON.stringify(r));return e}var d=n(25108);const f=t=>null!==t&&"object"==typeof t;function g(t,e){if(!t||!f(t))return null;let n={name:t.name||"",description:t.description||""};if("string"==typeof t.generator&&(n.generator=t.generator),"string"==typeof t.generator_options&&(n.generatorOptions=t.generator_options),n.boundingBox=m(t.bounds)||m(t.antimeridian_adjusted_bounds),n.center=function(t){const e=v(t);if(Array.isArray(e)&&3===e.length&&b(e[0])&&w(e[1])&&(n=e[2],Number.isFinite(n)&&n>=0&&n<=22))return e;var n;return null}(t.center),n.maxZoom=y(t.maxzoom),n.minZoom=y(t.minzoom),"string"==typeof t?.json)try{n.metaJson=JSON.parse(t.json)}catch(i){d.warn("Failed to parse tilejson.json field",i)}const r=function(t,e){if(f(t)&&Array.isArray(t.layers))return t.layers.map((t=>function(t,e){const n=[],r={},o=t.attributes||[];for(const s of o){const t=s.attribute;if("string"==typeof t)if(t.split("|").length>1){const e=t.split("|")[0];r[e]=r[e]||[],r[e].push(s),d.warn("ignoring tilestats indexed field",e)}else n[t]||n.push(_(s,e))}return{name:t.layer||"",dominantGeometry:t.geometry,fields:n}}(t,e)));return[]}(t.tilestats||n.metaJson?.tilestats,e),o=function(t){if(!Array.isArray(t))return[];return t.map((t=>function(t){const e=Object.entries(t.fields||[]).map((t=>{let[e,n]=t;return{name:e,...T(String(n))}})),n={...t};return delete n.fields,{name:t.id||"",...n,fields:e}}(t)))}(t.vector_layers),s=function(t,e){return t.map((t=>{const n=e.find((e=>e.name===t.name)),r=n?.fields||t.fields||[],o={...t,...n,fields:r};return o.schema=function(t){const e=[];if(t.fields)for(const n of t.fields)e.push({name:n.name,type:h(n),metadata:p(n)});return{metadata:u(t),fields:e}}(o),o}))}(o,r);return n={...n,layers:s},null===n.maxZoom&&s.length>0&&(n.maxZoom=s[0].maxZoom||null),null===n.minZoom&&s.length>0&&(n.minZoom=s[0].minZoom||null),n}function m(t){const e=v(t);if(Array.isArray(e)&&4===e.length&&[e[0],e[2]].every(b)&&[e[1],e[3]].every(w))return[[e[0],e[1]],[e[2],e[3]]]}function y(t){const e="string"==typeof t?parseFloat(t):"number"==typeof t?t:null;return null===e||isNaN(e)?null:e}function w(t){return Number.isFinite(t)&&t<=90&&t>=-90}function b(t){return Number.isFinite(t)&&t<=180&&t>=-180}function v(t){return"string"==typeof t?t.split(",").map(parseFloat):Array.isArray(t)?t:null}const x={number:{type:"float32"},numeric:{type:"float32"},string:{type:"utf8"},vachar:{type:"utf8"},float:{type:"float32"},int:{type:"int32"},int4:{type:"int32"},boolean:{type:"boolean"},bool:{type:"boolean"}};function _(t,e){void 0===t&&(t={});const n=T(t.type),r={name:t.attribute,...n};return"number"==typeof t.min&&(r.min=t.min),"number"==typeof t.max&&(r.max=t.max),"number"==typeof t.count&&(r.uniqueValueCount=t.count),t.values&&(r.values=t.values),r.values&&"number"==typeof e.maxValues&&(r.values=r.values?.slice(0,e.maxValues)),r}function T(t){const e=t.toLowerCase();return!e||x[e],x[e]||{type:"string"}}const S={dataType:null,batchType:null,name:"TileJSON",id:"tilejson",module:"pmtiles",version:"undefined"!=typeof __VERSION__?__VERSION__:"latest",worker:!0,extensions:["json"],mimeTypes:["application/json"],text:!0,options:{tilejson:{maxValues:void 0}},parse:async(t,e)=>{const n=(new TextDecoder).decode(t);return g(JSON.parse(n),{...S.options.tilejson,...e?.tilejson})},parseTextSync:(t,e)=>g(JSON.parse(t),{...S.options.tilejson,...e?.tilejson})};var A=n(25108);const{TileType:E}=c;function P(t){switch(t){case E.Mvt:return"application/vnd.mapbox-vector-tile";case E.Png:return"image/png";case E.Jpeg:return"image/jpeg";case E.Webp:return"image/webp";case E.Avif:return"image/avif";default:return"application/octet-stream"}}class k{constructor(t,e){this.blob=t,this.key=e}getKey(){return this.blob.url||""}async getBytes(t,e,n){const r=this.blob.slice(t,t+e);return{data:await r.arrayBuffer()}}}const{PMTiles:j}=c,C={name:"PMTiles",id:"pmtiles",module:"pmtiles",version:"1.0.0",extensions:["pmtiles"],mimeTypes:["application/octet-stream"],options:{url:void 0,pmtiles:{}},type:"pmtiles",fromUrl:!0,fromBlob:!0,testURL:t=>t.endsWith(".pmtiles"),createDataSource:(t,e)=>new L(t,e)};class L extends s.o{mimeType=null;constructor(t,e){super(e),this.props=e;const n="string"==typeof t?(0,i.i3)(t):new k(t,"pmtiles");this.data=t,this.pmtiles=new j(n),this.getTileData=this.getTileData.bind(this),this.metadata=this.getMetadata()}async getSchema(){return{fields:[],metadata:{}}}async getMetadata(){const t=function(t,e,n,r){let o=null;if(e)try{const t=JSON.stringify(e);o=S.parseTextSync?.(t,r)||null}catch(a){A.warn("PMTiles metadata could not be interpreted as TileJSON",a)}const s={};"string"==typeof o?.name&&(s.name=o.name),"string"==typeof o?.htmlAttribution&&(s.attributions=[o.htmlAttribution]);const i={...s,format:"pmtiles",formatVersion:t.specVersion,attributions:[],tileMIMEType:P(t.tileType),minZoom:t.minZoom,maxZoom:t.maxZoom,boundingBox:[[t.minLon,t.minLat],[t.maxLon,t.maxLat]],center:[t.centerLon,t.centerLat],centerZoom:t.centerZoom,etag:t.etag};return o&&(i.tilejson=o),n?.includeFormatHeader&&(i.formatHeader=t,i.formatMetadata=i),i}(await this.pmtiles.getHeader(),await this.pmtiles.getMetadata()||{},{includeFormatHeader:!1},this.loadOptions);return this.props.attributions&&(t.attributions=[...this.props.attributions,...t.attributions||[]]),t?.tileMIMEType&&(this.mimeType=t?.tileMIMEType),t}async getTile(t){const{x:e,y:n,z:r}=t,o=await this.pmtiles.getZxy(r,e,n),s=o?.data;return s||null}async getTileData(t){const{x:e,y:n,z:r}=t.index;return"application/vnd.mapbox-vector-tile"===(await this.metadata).tileMIMEType?await this.getVectorTile({x:e,y:n,z:r,layers:[]}):await this.getImageTile({x:e,y:n,z:r,layers:[]})}async getImageTile(t){const e=await this.getTile(t);return e?await a.S.parse(e,this.loadOptions):null}async getVectorTile(t){const e=await this.getTile(t),n={shape:"geojson-table",mvt:{coordinates:"wgs84",tileIndex:{x:t.x,y:t.y,z:t.z},...this.loadOptions?.mvt},...this.loadOptions};return e?await l.Y.parse(e,n):null}}var N=n(89121),I=n(7233),M=n(8700);function R(t,e,n,r,o){const s=e===o.maxZoom?0:o.tolerance/((1<<e)*o.extent),i={protoFeatures:[],sourceFeatures:null,numPoints:0,numSimplified:0,numFeatures:t.length,x:n,y:r,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const a of t)O(i,a,s,o);return i}function O(t,e,n,r){const o=e.geometry,s=e.type,i=[];let a;switch(t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),s){case"Point":case"MultiPoint":a=1;for(let e=0;e<o.length;e+=3)i.push(o[e],o[e+1]),t.numPoints++,t.numSimplified++;break;case"LineString":a=2,U(i,o,t,n,!1,!1);break;case"MultiLineString":a=2;for(let e=0;e<o.length;e++)U(i,o[e],t,n,!1,0===e);break;case"Polygon":a=3;for(let e=0;e<o.length;e++)U(i,o[e],t,n,!0,0===e);break;case"MultiPolygon":a=3;for(let e=0;e<o.length;e++){const r=o[e];for(let e=0;e<r.length;e++)U(i,r[e],t,n,!0,0===e)}break;default:throw new Error(`Unknown geometry type: ${s}`)}if(i.length){let n=e.tags||null;if("LineString"===s&&r.lineMetrics){n={};for(const t in e.tags)n[t]=e.tags[t];n.mapbox_clip_start=o.start/o.size,n.mapbox_clip_end=o.end/o.size}const l={geometry:i,simplifiedType:a,tags:n};null!==e.id&&(l.id=e.id),t.protoFeatures.push(l)}}function U(t,e,n,r,o,s){const i=r*r;if(r>0&&e.size<(o?i:r))return void(n.numPoints+=e.length/3);const a=[];for(let l=0;l<e.length;l+=3)(0===r||e[l+2]>i)&&(n.numSimplified++,a.push(e[l],e[l+1])),n.numPoints++;o&&function(t,e){let n=0;for(let r=0,o=t.length-2;r<t.length;o=r,r+=2)n+=(t[r]-t[o])*(t[r+1]+t[o+1]);if(n>0===e)for(let r=0,o=t.length;r<o/2;r+=2){const e=t[r],n=t[r+1];t[r]=t[o-2-r],t[r+1]=t[o-1-r],t[o-2-r]=e,t[o-1-r]=n}}(a,s),t.push(a)}function B(t,e){if(t.transformed)return t;const n=1<<t.z,r=t.x,o=t.y;for(const s of t.protoFeatures){const t=s.geometry,i=s.simplifiedType;if(s.geometry=[],1===i)for(let a=0;a<t.length;a+=2)s.geometry.push(F(t[a],t[a+1],e,n,r,o));else for(let a=0;a<t.length;a++){const i=[];for(let s=0;s<t[a].length;s+=2)i.push(F(t[a][s],t[a][s+1],e,n,r,o));s.geometry.push(i)}}return t.transformed=!0,t}function F(t,e,n,r,o,s){return[Math.round(n*(t*r-o)),Math.round(n*(e*r-s))]}var $=n(44866);function V(t,e,n,r){const o={id:null==t?null:t,type:e,simplifiedType:void 0,geometry:n,tags:r,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};switch(e){case"Point":case"MultiPoint":case"LineString":z(o,n);break;case"MultiLineString":for(const t of n)z(o,t);break;case"Polygon":z(o,n[0]);break;case"MultiPolygon":for(const t of n)z(o,t[0]);break;default:throw new Error(String(e))}return o}function z(t,e){for(let n=0;n<e.length;n+=3)t.minX=Math.min(t.minX,e[n]),t.minY=Math.min(t.minY,e[n+1]),t.maxX=Math.max(t.maxX,e[n]),t.maxY=Math.max(t.maxY,e[n+1])}function D(t,e,n,r){let o=r;const s=n-e>>1;let i,a=n-e;const l=t[e],c=t[e+1],u=t[n],h=t[n+1];for(let p=e+3;p<n;p+=3){const e=J(t[p],t[p+1],l,c,u,h);if(e>o)i=p,o=e;else if(e===o){const t=Math.abs(p-s);t<a&&(i=p,a=t)}}o>r&&(i-e>3&&D(t,e,i,r),t[i+2]=o,n-i>3&&D(t,i,n,r))}function J(t,e,n,r,o,s){let i=o-n,a=s-r;if(0!==i||0!==a){const l=((t-n)*i+(e-r)*a)/(i*i+a*a);l>1?(n=o,r=s):l>0&&(n+=i*l,r+=a*l)}return i=t-n,a=e-r,i*i+a*a}function Z(t,e,n){if(!t.geometry)return;const r=t.geometry.coordinates,o=t.geometry.type,s=Math.pow(e.tolerance/((1<<e.maxZoom)*e.extent),2);let i=[],a=t.id;switch(e.promoteId?a=t.properties[e.promoteId]:e.generateId&&(a=n||0),o){case"Point":q(r,i);break;case"MultiPoint":for(const t of r)q(t,i);break;case"LineString":W(r,i,s,!1);break;case"MultiLineString":if(e.lineMetrics){for(const e of r)i=[],W(e,i,s,!1),features.push(V(a,"LineString",i,t.properties));return}break;case"Polygon":Y(r,i,s,!0);break;case"MultiPolygon":for(const t of r){const e=[];Y(t,e,s,!0),i.push(e)}break;case"GeometryCollection":for(const n of t.geometry.geometries)Z(features,{id:a,geometry:n,properties:t.properties},e);break;default:throw new Error("Input data is not a valid GeoJSON object.")}return V(a,o,i,t.properties)}function q(t,e){e.push(G(t[0]),X(t[1]),0)}function W(t,e,n,r){let o,s,i=0;for(let l=0;l<t.length;l++){const n=G(t[l][0]),a=X(t[l][1]);e.push(n,a,0),l>0&&(i+=r?(o*a-n*s)/2:Math.sqrt(Math.pow(n-o,2)+Math.pow(a-s,2))),o=n,s=a}const a=e.length-3;e[2]=1,D(e,0,a,n),e[a+2]=1,e.size=Math.abs(i),e.start=0,e.end=e.size}function Y(t,e,n,r){for(let o=0;o<t.length;o++){const s=[];W(t[o],s,n,r),e.push(s)}}function G(t){return t/360+.5}function X(t){const e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function Q(t,e,n,r,o,s,i,a){if(r/=e,s>=(n/=e)&&i<r)return t;if(i<n||s>=r)return null;const l=[];for(const c of t){const t=c.geometry;let e=c.type;const s=0===o?c.minX:c.minY,i=0===o?c.maxX:c.maxY;if(s>=n&&i<r){l.push(c);continue}if(i<n||s>=r)continue;let u=[];if("Point"===e||"MultiPoint"===e)K(t,u,n,r,o);else if("LineString"===e)H(t,u,n,r,o,!1,a.lineMetrics);else if("MultiLineString"===e)et(t,u,n,r,o,!1);else if("Polygon"===e)et(t,u,n,r,o,!0);else if("MultiPolygon"===e)for(const a of t){const t=[];et(a,t,n,r,o,!0),t.length&&u.push(t)}if(u.length){if(a.lineMetrics&&"LineString"===e){for(const t of u)l.push(V(c.id,e,t,c.tags));continue}"LineString"!==e&&"MultiLineString"!==e||(1===u.length?(e="LineString",u=u[0]):e="MultiLineString"),"Point"!==e&&"MultiPoint"!==e||(e=3===u.length?"Point":"MultiPoint"),l.push(V(c.id,e,u,c.tags))}}return l.length?l:null}function K(t,e,n,r,o){for(let s=0;s<t.length;s+=3){const i=t[s+o];i>=n&&i<=r&&nt(e,t[s],t[s+1],t[s+2])}}function H(t,e,n,r,o,s,i){let a=tt(t);const l=0===o?rt:ot;let c,u,h=t.start;for(let y=0;y<t.length-3;y+=3){const p=t[y],d=t[y+1],f=t[y+2],g=t[y+3],m=t[y+4],w=0===o?p:d,b=0===o?g:m;let v=!1;i&&(c=Math.sqrt(Math.pow(p-g,2)+Math.pow(d-m,2))),w<n?b>n&&(u=l(a,p,d,g,m,n),i&&(a.start=h+c*u)):w>r?b<r&&(u=l(a,p,d,g,m,r),i&&(a.start=h+c*u)):nt(a,p,d,f),b<n&&w>=n&&(u=l(a,p,d,g,m,n),v=!0),b>r&&w<=r&&(u=l(a,p,d,g,m,r),v=!0),!s&&v&&(i&&(a.end=h+c*u),e.push(a),a=tt(t)),i&&(h+=c)}let p=t.length-3;const d=t[p],f=t[p+1],g=t[p+2],m=0===o?d:f;m>=n&&m<=r&&nt(a,d,f,g),p=a.length-3,s&&p>=3&&(a[p]!==a[0]||a[p+1]!==a[1])&&nt(a,a[0],a[1],a[2]),a.length&&e.push(a)}function tt(t){const e=[];return e.size=t.size,e.start=t.start,e.end=t.end,e}function et(t,e,n,r,o,s){for(const i of t)H(i,e,n,r,o,s,!1)}function nt(t,e,n,r){t.push(e,n,r)}function rt(t,e,n,r,o,s){const i=(s-e)/(r-e);return nt(t,s,n+(o-n)*i,1),i}function ot(t,e,n,r,o,s){const i=(s-n)/(o-n);return nt(t,e+(r-e)*i,s,1),i}function st(t,e){const n=[];for(let r=0;r<t.length;r++){const o=t[r],s=o.type;let i;switch(s){case"Point":case"MultiPoint":case"LineString":i=it(o.geometry,e);break;case"MultiLineString":case"Polygon":i=[];for(const t of o.geometry)i.push(it(t,e));break;case"MultiPolygon":i=[];for(const t of o.geometry){const n=[];for(const r of t)n.push(it(r,e));i.push(n)}break;default:throw new Error(String(s))}n.push(V(o.id,s,i,o.tags))}return n}function it(t,e){const n=[];n.size=t.size,void 0!==t.start&&(n.start=t.start,n.end=t.end);for(let r=0;r<t.length;r+=3)n.push(t[r]+e,t[r+1],t[r+2]);return n}const at={name:"TableTiler",id:"table-tiler",version:"0.0.0",extensions:["mvt"],mimeTypes:["application/octet-stream"],options:{table:{coordinates:"local",promoteId:void 0,maxZoom:14,indexMaxZoom:5,maxPointsPerTile:1e4,tolerance:3,extent:4096,buffer:64,generateId:void 0}},type:"table",testURL:t=>t.endsWith(".geojson"),createDataSource(t,e){const n="string"==typeof t||t instanceof Blob,r=e?.table?.loaders?.[0],o=n?async function(t,e){if("string"==typeof t){const n=await fetch(t),r=await n.arrayBuffer();return await e.parse(r)}const n=await t.arrayBuffer();return await e.parse(n)}(t,r):t;return new lt(o,e)}};class lt{static stats=new M.jk({id:"table-tile-source-all",stats:[new M.kN("count","tiles"),new M.kN("count","features")]});stats=new M.jk({id:"table-tile-source",stats:[new M.kN("tiles","count"),new M.kN("features","count")]});mimeType="application/vnd.mapbox-vector-tile";localCoordinates=!0;schema=null;tiles={};tileCoords=[];constructor(t,e){this.props={...at.options.table,...e?.table},this.getTileData=this.getTileData.bind(this),this.ready=this.initializeTilesAsync(t),this.metadata=this.getMetadata()}async initializeTilesAsync(t){const e=await t;this.schema=(0,I.d)(e),this.createRootTiles(e)}async getMetadata(){return await this.ready,{schema:this.schema,minZoom:0,maxZoom:this.props.maxZoom}}async getSchema(){return await this.ready,this.schema}async getVectorTile(t){await this.ready;const e=this.getTileSync(t);return N.c.info(2,"getVectorTile",t,e)(),e}async getTile(t){return await this.ready,this.getTileSync(t)}async getTileData(t){const{x:e,y:n,z:r}=t.index,o=await this.getVectorTile({x:e,y:n,z:r});return o?.features||[]}getTileSync(t){const e=this.getProtoTile(t);return e?function(t,e){const n=[];for(const r of t.protoFeatures){if(!r||!r.geometry)continue;let t,o;switch(r.simplifiedType){case 1:1===r.geometry.length?(t="Point",o=r.geometry[0]):(t="MultiPoint",o=r.geometry);break;case 2:1===r.geometry.length?(t="LineString",o=r.geometry[0]):(t="MultiLineString",o=r.geometry);break;case 3:r.geometry.length>1?(t="MultiPolygon",o=[r.geometry]):(t="Polygon",o=r.geometry);break;default:throw new Error(`${r.simplifiedType}is not a valid simplified type`)}switch(e.coordinates){case"EPSG:4326":case"wgs84":(0,$.PX)(o,e.tileIndex,e.extent);break;default:(0,$.lk)(o,e.extent)}const s={type:"Feature",geometry:{type:t,coordinates:o},properties:r.tags||{},id:r.id};n.push(s)}return 0===n.length?null:{shape:"geojson-table",type:"FeatureCollection",features:n}}(e,{coordinates:this.props.coordinates,tileIndex:t,extent:this.props.extent}):null}createRootTiles(t){if(this.props.maxZoom<0||this.props.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(this.props.promoteId&&this.props.generateId)throw new Error("promoteId and generateId cannot be used together.");N.c.log(1,"DynamicVectorTileSource creating root tiles",this.props)(),N.c.time(1,"preprocess table")();let e=function(t,e){const n=[];switch(t.type){case"FeatureCollection":let r=0;for(const o of t.features)n.push(Z(o,e,r++));break;case"Feature":n.push(Z(t,e));break;default:n.push(Z({geometry:t},e))}return n}(t,this.props);if(N.c.timeEnd(1,"preprocess table")(),N.c.time(1,"generate tiles")(),e=function(t,e){const n=e.buffer/e.extent;let r=t;const o=Q(t,1,-1-n,n,0,-1,2,e),s=Q(t,1,1-n,2+n,0,-1,2,e);return(o||s)&&(r=Q(t,1,-n,1+n,0,-1,2,e)||[],o&&(r=st(o,1).concat(r)),s&&(r=r.concat(st(s,-1)))),r}(e,this.props),0===e.length)return void N.c.log(1,"DynamicVectorTileSource: no features generated")();this.splitTile(e,0,0,0);const n=this.tiles[0];N.c.log(1,`root tile features: ${n.numFeatures}, points: ${n.numPoints}`)(),N.c.timeEnd(1,"generate tiles")(),N.c.log(1,`DynamicVectorTileSource: tiles generated: ${this.stats.get("total").count}`,this.stats)()}getProtoTile(t){const{z:e,y:n}=t;let{x:r}=t;const{extent:o}=this.props;if(e<0||e>24)return null;const s=1<<e;r=r+s&s-1;const i=ct(e,r,n);if(this.tiles[i])return B(this.tiles[i],o);N.c.log(N.c,"drilling down to z%d-%d-%d",e,r,n)();let a,l=e,c=r,u=n;for(;!a&&l>0;)l--,c>>=1,u>>=1,a=this.tiles[ct(l,c,u)];return a&&a.sourceFeatures?(N.c.log(1,"found parent tile z%d-%d-%d",l,c,u)(),N.c.time(1,"drilling down")(),this.splitTile(a.sourceFeatures,l,c,u,e,r,n),N.c.timeEnd(1,"drilling down")(),this.tiles[i]?B(this.tiles[i],o):null):null}splitTile(t,e,n,r,o,s,i){const a=[t,e,n,r];for(;a.length;){r=a.pop(),n=a.pop(),e=a.pop(),t=a.pop();const l=1<<e,c=ct(e,n,r);let u=this.tiles[c];if(!u){N.c.time(2,"tile creation")(),u=this.tiles[c]=R(t,e,n,r,this.props),this.tileCoords.push({z:e,x:n,y:r});const o=`z${e}`;let s=this.stats.get(o,"count");s.incrementCount(),s=this.stats.get("total"),s.incrementCount(),s=lt.stats.get(o,"count"),s.incrementCount(),s=lt.stats.get("total"),s.incrementCount(),N.c.log(2,"tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,n,r,u.numFeatures,u.numPoints,u.numSimplified)(),N.c.timeEnd(2,"tile creation")()}if(u.sourceFeatures=t,void 0===o){if(e===this.props.indexMaxZoom||u.numPoints<=this.props.maxPointsPerTile)continue}else{if(e===this.props.maxZoom||e===o)continue;if(void 0!==o){const t=o-e;if(n!==s>>t||r!==i>>t)continue}}if(u.sourceFeatures=null,0===t.length)continue;N.c.time(2,"clipping tile")();const h=.5*this.props.buffer/this.props.extent,p=.5-h,d=.5+h,f=1+h;let g=null,m=null,y=null,w=null,b=Q(t,l,n-h,n+d,0,u.minX,u.maxX,this.props),v=Q(t,l,n+p,n+f,0,u.minX,u.maxX,this.props);t=null,b&&(g=Q(b,l,r-h,r+d,1,u.minY,u.maxY,this.props),m=Q(b,l,r+p,r+f,1,u.minY,u.maxY,this.props),b=null),v&&(y=Q(v,l,r-h,r+d,1,u.minY,u.maxY,this.props),w=Q(v,l,r+p,r+f,1,u.minY,u.maxY,this.props),v=null),N.c.timeEnd(2,"clipping tile")(),a.push(g||[],e+1,2*n,2*r),a.push(m||[],e+1,2*n,2*r+1),a.push(y||[],e+1,2*n+1,2*r),a.push(w||[],e+1,2*n+1,2*r+1)}}}function ct(t,e,n){return 32*((1<<t)*n+e)+t}var ut=n(99377),ht=n(25108);const pt={name:"MVT",id:"mvt",module:"mvt",version:"0.0.0",extensions:["mvt"],mimeTypes:["application/octet-stream"],options:{mvt:{}},type:"mvt",fromUrl:!0,fromBlob:!1,testURL:t=>!0,createDataSource:(t,e)=>new dt(t,e)};class dt extends s.o{metadataUrl=null;schema="tms";mimeType=null;constructor(t,e){var n;super(e),this.props=e,this.url=(0,i.i3)(t),this.metadataUrl=e.mvt?.metadataUrl||`${this.url}/tilejson.json`,this.extension=e.mvt?.extension||".png",this.data=this.url,this.getTileData=this.getTileData.bind(this),this.metadata=this.getMetadata(),n=this.url,/(?=.*{z})(?=.*{x})(?=.*({y}|{-y}))|(?=.*{x})(?=.*({y}|{-y})(?=.*{z}))/.test(n)&&(this.schema="template")}async getMetadata(){if(!this.metadataUrl)return null;let t;try{t=await this.fetch(this.metadataUrl)}catch(n){return ht.error(n.message),null}if(!t.ok)return ht.error(t.statusText),null;const e=await t.text();return S.parseTextSync?.(e)||null}getTileMIMEType(){return this.mimeType}async getTile(t){const{x:e,y:n,z:r}=t,o=this.getTileURL(e,n,r),s=await this.fetch(o);if(!s.ok)return null;return await s.arrayBuffer()}async getTileData(t){const{x:e,y:n,z:r}=t.index,o=await this.getTile({x:e,y:n,z:r,layers:[]});if(null===o)return null;const s=(0,ut.I)(o);return this.mimeType=this.mimeType||s?.mimeType||"application/vnd.mapbox-vector-tile","application/vnd.mapbox-vector-tile"===this.mimeType?await this._parseVectorTile(o,{x:e,y:n,z:r,layers:[]}):await this._parseImageTile(o)}async getImageTile(t){const e=await this.getTile(t);return e?this._parseImageTile(e):null}async _parseImageTile(t){return await a.S.parse(t,this.loadOptions)}async getVectorTile(t){const e=await this.getTile(t);return e?this._parseVectorTile(e,t):null}async _parseVectorTile(t,e){const n={shape:"geojson-table",mvt:{coordinates:"wgs84",tileIndex:{x:e.x,y:e.y,z:e.z},...this.loadOptions?.mvt},...this.loadOptions};return await l.Y.parse(t,n)}getMetadataUrl(){return this.metadataUrl}getTileURL(t,e,n){switch(this.schema){case"xyz":return`${this.url}/${t}/${e}/${n}${this.extension}`;case"tms":return`${this.url}/${n}/${t}/${e}${this.extension}`;case"template":return function(t,e,n,r,o){void 0===o&&(o="0");if(Array.isArray(t)){t=t[(s=o,Math.abs(s.split("").reduce(((t,e)=>(t<<5)-t+e.charCodeAt(0)|0),0))%t.length)]}var s;let i=t;i=i.replace(ft,String(e)),i=i.replace(gt,String(n)),i=i.replace(mt,String(r)),Number.isInteger(n)&&Number.isInteger(r)&&(i=i.replace(/\{-y\}/g,String(Math.pow(2,r)-n-1)));return i}(this.url,t,e,n,"0");default:throw new Error(this.schema)}}}const ft=new RegExp("{x}","g"),gt=new RegExp("{y}","g"),mt=new RegExp("{z}","g");var yt=n(9143);class wt{length=0;rows=null;cursor=0;_headers=[];constructor(t,e){if(this.options=e,this.schema=t,!Array.isArray(t)){this._headers=[];for(const e in t)this._headers[t[e].index]=t[e].name}}rowCount(){return this.length}addArrayRow(t,e){Number.isFinite(e)&&(this.cursor=e),this.shape="array-row-table",this.rows=this.rows||new Array(100),this.rows[this.length]=t,this.length++}addObjectRow(t,e){Number.isFinite(e)&&(this.cursor=e),this.shape="object-row-table",this.rows=this.rows||new Array(100),this.rows[this.length]=t,this.length++}getBatch(){let t=this.rows;if(!t)return null;t=t.slice(0,this.length),this.rows=null;return{shape:this.shape||"array-row-table",batchType:"data",data:t,length:this.length,schema:this.schema,cursor:this.cursor}}}class bt{length=0;objectRows=null;arrayRows=null;cursor=0;_headers=null;constructor(t,e){if(this.options=e,this.schema=t,t){this._headers=[];for(const e in t)this._headers[t[e].index]=t[e].name}}rowCount(){return this.length}addArrayRow(t,e){switch(Number.isFinite(e)&&(this.cursor=e),this._headers||=function(t){const e=[];for(let n=0;n<t.length;n++){const t=`column-${n}`;e.push(t)}return e}(t),this.options.shape){case"object-row-table":const n=function(t,e){if(!t)throw new Error("null row");const n={};if(e)for(let r=0;r<e.length;r++)n[e[r]]=t[r];else for(let r=0;r<t.length;r++)n[`column-${r}`]=t[r];return n}(t,this._headers);this.addObjectRow(n,e);break;case"array-row-table":this.arrayRows=this.arrayRows||new Array(100),this.arrayRows[this.length]=t,this.length++}}addObjectRow(t,e){switch(Number.isFinite(e)&&(this.cursor=e),this._headers||=function(t){return Object.keys(t)}(t),this.options.shape){case"array-row-table":const n=function(t,e){if(!t)throw new Error("null row");if(e){const n=new Array(e.length);for(let r=0;r<e.length;r++)n[r]=t[e[r]];return n}return Object.values(t)}(t,this._headers);this.addArrayRow(n,e);break;case"object-row-table":this.objectRows=this.objectRows||new Array(100),this.objectRows[this.length]=t,this.length++}}getBatch(){let t=this.arrayRows||this.objectRows;return t?(t=t.slice(0,this.length),this.arrayRows=null,this.objectRows=null,{shape:this.options.shape,batchType:"data",data:t,length:this.length,schema:this.schema,cursor:this.cursor}):null}}class vt{length=0;allocated=0;columns={};constructor(t,e){this.schema=t,this._reallocateColumns()}rowCount(){return this.length}addArrayRow(t){this._reallocateColumns();let e=0;for(const n in this.columns)this.columns[n][this.length]=t[e++];this.length++}addObjectRow(t){this._reallocateColumns();for(const e in t)this.columns[e][this.length]=t[e];this.length++}getBatch(){this._pruneColumns();const t=Array.isArray(this.schema)?this.columns:{};if(!Array.isArray(this.schema))for(const e in this.schema){const n=this.schema[e];t[n.name]=this.columns[n.index]}this.columns={};return{shape:"columnar-table",batchType:"data",data:t,schema:this.schema,length:this.length}}_reallocateColumns(){if(!(this.length<this.allocated)){this.allocated=this.allocated>0?this.allocated*=2:100,this.columns={};for(const t in this.schema){const e=this.schema[t],n=e.type||Float32Array,r=this.columns[e.index];if(r&&ArrayBuffer.isView(r)){const t=new n(this.allocated);t.set(r),this.columns[e.index]=t}else r?(r.length=this.allocated,this.columns[e.index]=r):this.columns[e.index]=new n(this.allocated)}}}_pruneColumns(){for(const[t,e]of Object.entries(this.columns))this.columns[t]=e.slice(0,this.length)}}const xt={shape:void 0,batchSize:"auto",batchDebounceMs:0,limit:0,_limitMB:0};class _t{aggregator=null;batchCount=0;bytesUsed=0;isChunkComplete=!1;lastBatchEmittedMs=Date.now();totalLength=0;totalBytes=0;rowBytes=0;constructor(t,e){this.schema=t,this.options={...xt,...e}}limitReached(){return!!(Boolean(this.options?.limit)&&this.totalLength>=this.options.limit)||!!(Boolean(this.options?._limitMB)&&this.totalBytes/1e6>=this.options._limitMB)}addRow(t){this.limitReached()||(this.totalLength++,this.rowBytes=this.rowBytes||this._estimateRowMB(t),this.totalBytes+=this.rowBytes,Array.isArray(t)?this.addArrayRow(t):this.addObjectRow(t))}addArrayRow(t){if(!this.aggregator){const t=this._getTableBatchType();this.aggregator=new t(this.schema,this.options)}this.aggregator.addArrayRow(t)}addObjectRow(t){if(!this.aggregator){const t=this._getTableBatchType();this.aggregator=new t(this.schema,this.options)}this.aggregator.addObjectRow(t)}chunkComplete(t){t instanceof ArrayBuffer&&(this.bytesUsed+=t.byteLength),"string"==typeof t&&(this.bytesUsed+=t.length),this.isChunkComplete=!0}getFullBatch(t){return this._isFull()?this._getBatch(t):null}getFinalBatch(t){return this._getBatch(t)}_estimateRowMB(t){return Array.isArray(t)?8*t.length:8*Object.keys(t).length}_isFull(){if(!this.aggregator||0===this.aggregator.rowCount())return!1;if("auto"===this.options.batchSize){if(!this.isChunkComplete)return!1}else if(this.options.batchSize>this.aggregator.rowCount())return!1;return!(this.options.batchDebounceMs>Date.now()-this.lastBatchEmittedMs)&&(this.isChunkComplete=!1,this.lastBatchEmittedMs=Date.now(),!0)}_getBatch(t){if(!this.aggregator)return null;t?.bytesUsed&&(this.bytesUsed=t.bytesUsed);const e=this.aggregator.getBatch();return e.count=this.batchCount,e.bytesUsed=this.bytesUsed,Object.assign(e,t),this.batchCount++,this.aggregator=null,e}_getTableBatchType(){switch(this.options.shape){case"array-row-table":case"object-row-table":return bt;case"columnar-table":return vt;case"arrow-table":if(!_t.ArrowBatch)throw new Error("TableBatchBuilder");return _t.ArrowBatch;default:return wt}}}var Tt=n(98754);const St=Number.MAX_SAFE_INTEGER;var At=function(t){return t[t.BEGIN=0]="BEGIN",t[t.VALUE=1]="VALUE",t[t.OPEN_OBJECT=2]="OPEN_OBJECT",t[t.CLOSE_OBJECT=3]="CLOSE_OBJECT",t[t.OPEN_ARRAY=4]="OPEN_ARRAY",t[t.CLOSE_ARRAY=5]="CLOSE_ARRAY",t[t.TEXT_ESCAPE=6]="TEXT_ESCAPE",t[t.STRING=7]="STRING",t[t.BACKSLASH=8]="BACKSLASH",t[t.END=9]="END",t[t.OPEN_KEY=10]="OPEN_KEY",t[t.CLOSE_KEY=11]="CLOSE_KEY",t[t.TRUE=12]="TRUE",t[t.TRUE2=13]="TRUE2",t[t.TRUE3=14]="TRUE3",t[t.FALSE=15]="FALSE",t[t.FALSE2=16]="FALSE2",t[t.FALSE3=17]="FALSE3",t[t.FALSE4=18]="FALSE4",t[t.NULL=19]="NULL",t[t.NULL2=20]="NULL2",t[t.NULL3=21]="NULL3",t[t.NUMBER_DECIMAL_POINT=22]="NUMBER_DECIMAL_POINT",t[t.NUMBER_DIGIT=23]="NUMBER_DIGIT",t}(At||{});const Et=9,Pt=10,kt=13,jt=32,Ct=34,Lt=43,Nt=44,It=45,Mt=46,Rt=48,Ot=57,Ut=58,Bt=69,Ft=91,$t=92,Vt=93,zt=97,Dt=98,Jt=101,Zt=102,qt=108,Wt=110,Yt=114,Gt=115,Xt=116,Qt=117,Kt=123,Ht=125,te=/[\\"\n]/g,ee={onready:()=>{},onopenobject:()=>{},onkey:()=>{},oncloseobject:()=>{},onopenarray:()=>{},onclosearray:()=>{},onvalue:()=>{},onerror:()=>{},onend:()=>{},onchunkparsed:()=>{}};class ne{options=ee;bufferCheckPosition=St;q="";c="";p="";closed=!1;closedRoot=!1;sawRoot=!1;error=null;state=At.BEGIN;stack=[];position=0;column=0;line=1;slashed=!1;unicodeI=0;unicodeS=null;depth=0;constructor(t){void 0===t&&(t={}),this.options={...ee,...t},this.textNode=void 0,this.numberNode="",this.emit("onready")}end(){return this.state===At.VALUE&&0===this.depth||this._error("Unexpected end"),this._closeValue(),this.c="",this.closed=!0,this.emit("onend"),this}resume(){return this.error=null,this}close(){return this.write(null)}emit(t,e){this.options[t]?.(e,this)}emitNode(t,e){this._closeValue(),this.emit(t,e)}write(t){if(this.error)throw this.error;if(this.closed)return this._error("Cannot write after close. Assign an onready handler.");if(null===t)return this.end();let e=0,n=t.charCodeAt(0),r=this.p;for(;n&&(r=n,this.c=n=t.charCodeAt(e++),r!==n?this.p=r:r=this.p,n);)switch(this.position++,n===Pt?(this.line++,this.column=0):this.column++,this.state){case At.BEGIN:n===Kt?this.state=At.OPEN_OBJECT:n===Ft?this.state=At.OPEN_ARRAY:re(n)||this._error("Non-whitespace before {[.");continue;case At.OPEN_KEY:case At.OPEN_OBJECT:if(re(n))continue;if(this.state===At.OPEN_KEY)this.stack.push(At.CLOSE_KEY);else{if(n===Ht){this.emit("onopenobject"),this.depth++,this.emit("oncloseobject"),this.depth--,this.state=this.stack.pop()||At.VALUE;continue}this.stack.push(At.CLOSE_OBJECT)}n===Ct?this.state=At.STRING:this._error('Malformed object key should start with "');continue;case At.CLOSE_KEY:case At.CLOSE_OBJECT:if(re(n))continue;n===Ut?(this.state===At.CLOSE_OBJECT?(this.stack.push(At.CLOSE_OBJECT),this._closeValue("onopenobject"),this.depth++):this._closeValue("onkey"),this.state=At.VALUE):n===Ht?(this.emitNode("oncloseobject"),this.depth--,this.state=this.stack.pop()||At.VALUE):n===Nt?(this.state===At.CLOSE_OBJECT&&this.stack.push(At.CLOSE_OBJECT),this._closeValue(),this.state=At.OPEN_KEY):this._error("Bad object");continue;case At.OPEN_ARRAY:case At.VALUE:if(re(n))continue;if(this.state===At.OPEN_ARRAY){if(this.emit("onopenarray"),this.depth++,this.state=At.VALUE,n===Vt){this.emit("onclosearray"),this.depth--,this.state=this.stack.pop()||At.VALUE;continue}this.stack.push(At.CLOSE_ARRAY)}n===Ct?this.state=At.STRING:n===Kt?this.state=At.OPEN_OBJECT:n===Ft?this.state=At.OPEN_ARRAY:n===Xt?this.state=At.TRUE:n===Zt?this.state=At.FALSE:n===Wt?this.state=At.NULL:n===It?this.numberNode+="-":Rt<=n&&n<=Ot?(this.numberNode+=String.fromCharCode(n),this.state=At.NUMBER_DIGIT):this._error("Bad value");continue;case At.CLOSE_ARRAY:if(n===Nt)this.stack.push(At.CLOSE_ARRAY),this._closeValue("onvalue"),this.state=At.VALUE;else if(n===Vt)this.emitNode("onclosearray"),this.depth--,this.state=this.stack.pop()||At.VALUE;else{if(re(n))continue;this._error("Bad array")}continue;case At.STRING:void 0===this.textNode&&(this.textNode="");let o=e-1,s=this.slashed,i=this.unicodeI;t:for(;;){for(;i>0;)if(this.unicodeS+=String.fromCharCode(n),n=t.charCodeAt(e++),this.position++,4===i?(this.textNode+=String.fromCharCode(parseInt(this.unicodeS,16)),i=0,o=e-1):i++,!n)break t;if(n===Ct&&!s){this.state=this.stack.pop()||At.VALUE,this.textNode+=t.substring(o,e-1),this.position+=e-1-o;break}if(n===$t&&!s&&(s=!0,this.textNode+=t.substring(o,e-1),this.position+=e-1-o,n=t.charCodeAt(e++),this.position++,!n))break;if(s){if(s=!1,n===Wt?this.textNode+="\n":n===Yt?this.textNode+="\r":n===Xt?this.textNode+="\t":n===Zt?this.textNode+="\f":n===Dt?this.textNode+="\b":n===Qt?(i=1,this.unicodeS=""):this.textNode+=String.fromCharCode(n),n=t.charCodeAt(e++),this.position++,o=e-1,n)continue;break}te.lastIndex=e;const r=te.exec(t);if(null===r){e=t.length+1,this.textNode+=t.substring(o,e-1),this.position+=e-1-o;break}if(e=r.index+1,n=t.charCodeAt(r.index),!n){this.textNode+=t.substring(o,e-1),this.position+=e-1-o;break}}this.slashed=s,this.unicodeI=i;continue;case At.TRUE:n===Yt?this.state=At.TRUE2:this._error(`Invalid true started with t${n}`);continue;case At.TRUE2:n===Qt?this.state=At.TRUE3:this._error(`Invalid true started with tr${n}`);continue;case At.TRUE3:n===Jt?(this.emit("onvalue",!0),this.state=this.stack.pop()||At.VALUE):this._error(`Invalid true started with tru${n}`);continue;case At.FALSE:n===zt?this.state=At.FALSE2:this._error(`Invalid false started with f${n}`);continue;case At.FALSE2:n===qt?this.state=At.FALSE3:this._error(`Invalid false started with fa${n}`);continue;case At.FALSE3:n===Gt?this.state=At.FALSE4:this._error(`Invalid false started with fal${n}`);continue;case At.FALSE4:n===Jt?(this.emit("onvalue",!1),this.state=this.stack.pop()||At.VALUE):this._error(`Invalid false started with fals${n}`);continue;case At.NULL:n===Qt?this.state=At.NULL2:this._error(`Invalid null started with n${n}`);continue;case At.NULL2:n===qt?this.state=At.NULL3:this._error(`Invalid null started with nu${n}`);continue;case At.NULL3:n===qt?(this.emit("onvalue",null),this.state=this.stack.pop()||At.VALUE):this._error(`Invalid null started with nul${n}`);continue;case At.NUMBER_DECIMAL_POINT:n===Mt?(this.numberNode+=".",this.state=At.NUMBER_DIGIT):this._error("Leading zero not followed by .");continue;case At.NUMBER_DIGIT:Rt<=n&&n<=Ot?this.numberNode+=String.fromCharCode(n):n===Mt?(-1!==this.numberNode.indexOf(".")&&this._error("Invalid number has two dots"),this.numberNode+="."):n===Jt||n===Bt?(-1===this.numberNode.indexOf("e")&&-1===this.numberNode.indexOf("E")||this._error("Invalid number has two exponential"),this.numberNode+="e"):n===Lt||n===It?(r!==Jt&&r!==Bt&&this._error("Invalid symbol in number"),this.numberNode+=String.fromCharCode(n)):(this._closeNumber(),e--,this.state=this.stack.pop()||At.VALUE);continue;default:this._error(`Unknown state: ${this.state}`)}return this.position>=this.bufferCheckPosition&&function(t){const e=Math.max(St,10);let n=0;for(const r of["textNode","numberNode"]){const o=void 0===t[r]?0:t[r].length;if(o>e)if("text"===r);else t._error(`Max buffer length exceeded: ${r}`);n=Math.max(n,o)}t.bufferCheckPosition=St-n+t.position}(this),this.emit("onchunkparsed"),this}_closeValue(t){void 0===t&&(t="onvalue"),void 0!==this.textNode&&this.emit(t,this.textNode),this.textNode=void 0}_closeNumber(){this.numberNode&&this.emit("onvalue",parseFloat(this.numberNode)),this.numberNode=""}_error(t){void 0===t&&(t=""),this._closeValue(),t+=`\nLine: ${this.line}\nColumn: ${this.column}\nChar: ${this.c}`;const e=new Error(t);this.error=e,this.emit("onerror",e)}}function re(t){return t===kt||t===Pt||t===jt||t===Et}class oe{constructor(t){if(void 0===t&&(t=null),this.path=["$"],t instanceof oe)this.path=[...t.path];else if(Array.isArray(t))this.path.push(...t);else if("string"==typeof t&&(this.path=t.split("."),"$"!==this.path[0]))throw new Error("JSONPaths must start with $")}clone(){return new oe(this)}toString(){return this.path.join(".")}push(t){this.path.push(t)}pop(){return this.path.pop()}set(t){this.path[this.path.length-1]=t}equals(t){if(!this||!t||this.path.length!==t.path.length)return!1;for(let e=0;e<this.path.length;++e)if(this.path[e]!==t.path[e])return!1;return!0}setFieldAtPath(t,e){const n=[...this.path];n.shift();const r=n.pop();for(const o of n)t=t[o];t[r]=e}getFieldAtPath(t){const e=[...this.path];e.shift();const n=e.pop();for(const r of e)t=t[r];return t[n]}}class se{result=void 0;previousStates=[];currentState=Object.freeze({container:[],key:null});jsonpath=new oe;constructor(t){this.reset(),this.parser=new ne({onready:()=>{this.jsonpath=new oe,this.previousStates.length=0,this.currentState.container.length=0},onopenobject:t=>{this._openObject({}),void 0!==t&&this.parser.emit("onkey",t)},onkey:t=>{this.jsonpath.set(t),this.currentState.key=t},oncloseobject:()=>{this._closeObject()},onopenarray:()=>{this._openArray()},onclosearray:()=>{this._closeArray()},onvalue:t=>{this._pushOrSet(t)},onerror:t=>{throw t},onend:()=>{this.result=this.currentState.container.pop()},...t})}reset(){this.result=void 0,this.previousStates=[],this.currentState=Object.freeze({container:[],key:null}),this.jsonpath=new oe}write(t){this.parser.write(t)}close(){this.parser.close()}_pushOrSet(t){const{container:e,key:n}=this.currentState;null!==n?(e[n]=t,this.currentState.key=null):e.push(t)}_openArray(t){void 0===t&&(t=[]),this.jsonpath.push(null),this._pushOrSet(t),this.previousStates.push(this.currentState),this.currentState={container:t,isArray:!0,key:null}}_closeArray(){this.jsonpath.pop(),this.currentState=this.previousStates.pop()}_openObject(t){void 0===t&&(t={}),this.jsonpath.push(null),this._pushOrSet(t),this.previousStates.push(this.currentState),this.currentState={container:t,isArray:!1,key:null}}_closeObject(){this.jsonpath.pop(),this.currentState=this.previousStates.pop()}}class ie extends se{streamingJsonPath=null;streamingArray=null;topLevelObject=null;constructor(t){void 0===t&&(t={}),super({onopenarray:()=>{if(!this.streamingArray&&this._matchJSONPath())return this.streamingJsonPath=this.getJsonPath().clone(),this.streamingArray=[],void this._openArray(this.streamingArray);this._openArray()},onopenobject:t=>{this.topLevelObject?this._openObject({}):(this.topLevelObject={},this._openObject(this.topLevelObject)),void 0!==t&&this.parser.emit("onkey",t)}});const e=t.jsonpaths||[];this.jsonPaths=e.map((t=>new oe(t)))}write(t){super.write(t);let e=[];return this.streamingArray&&(e=[...this.streamingArray],this.streamingArray.length=0),e}getPartialResult(){return this.topLevelObject}getStreamingJsonPath(){return this.streamingJsonPath}getStreamingJsonPathAsString(){return this.streamingJsonPath&&this.streamingJsonPath.toString()}getJsonPath(){return this.jsonpath}_matchJSONPath(){const t=this.getJsonPath();if(0===this.jsonPaths.length)return!0;for(const e of this.jsonPaths)if(e.equals(t))return!0;return!1}}const ae={...{dataType:null,batchType:null,name:"GeoJSON",id:"geojson",module:"geojson",version:"undefined"!=typeof __VERSION__?__VERSION__:"latest",worker:!0,extensions:["geojson"],mimeTypes:["application/geo+json"],category:"geometry",text:!0,options:{geojson:{shape:"geojson-table"},json:{shape:"object-row-table",jsonpaths:["$","$.features"]},gis:{format:"geojson"}}},parse:async function(t,e){return le((new TextDecoder).decode(t),e)},parseTextSync:le,parseInBatches:function(t,e){(e={...ae.options,...e}).json={...ae.options.geojson,...e.geojson};const n=async function*(t,e){const n=(0,Tt.wh)(t),{metadata:r}=e,{jsonpaths:o}=e.json||{};let s=!0;const i=new _t(null,e),a=new ie({jsonpaths:o});for await(const u of n){const t=a.write(u),n=t.length>0&&a.getStreamingJsonPathAsString();if(t.length>0&&s){if(r){const t={shape:e?.json?.shape||"array-row-table",batchType:"partial-result",data:[],length:0,bytesUsed:0,container:a.getPartialResult(),jsonpath:n};yield t}s=!1}for(const e of t){i.addRow(e);const t=i.getFullBatch({jsonpath:n});t&&(yield t)}i.chunkComplete(u);const o=i.getFullBatch({jsonpath:n});o&&(yield o)}const l=a.getStreamingJsonPathAsString(),c=i.getFinalBatch({jsonpath:l});if(c&&(yield c),r){const t={shape:"json",batchType:"final-result",container:a.getPartialResult(),jsonpath:a.getStreamingJsonPathAsString(),data:[],length:0};yield t}}(t,e);if("binary"===e.gis.format)return async function*(t){for await(const e of t)e.data=(0,yt.T)(e.data),yield e}(n);return n}};function le(t,e){let n;(e={...ae.options,...e}).geojson={...ae.options.geojson,...e.geojson},e.gis=e.gis||{};try{n=JSON.parse(t)}catch{n={}}const r={shape:"geojson-table",type:"FeatureCollection",features:n?.features||[]};return"binary"===e.gis.format?(0,yt.T)(r.features):r}var ce=n(50501),ue=n(3375),he=n(79185),pe=n(72958),de=n(101),fe=n(6905),ge=n(60432),me=n(63885),ye=n(25108);class we extends de.Z{static defaultProps={data:{type:"object",optional:!1,value:null,async:!1}};updateState(t){super.updateState(t);const{props:e,changeFlags:n}=t;n.dataChanged&&e.data&&this.setState({vectorTileSource:e.data,binary:!1})}async getTileData(t){const e=this.state.vectorTileSource;return await e.getTileData(t)}renderSubLayers(t){return super.renderSubLayers(t)}}class be extends he.Z{static layerName="TileSourceLayer";static defaultProps={...pe.Z.defaultProps,layerMode:"tile",showTileBorders:!0};initializeState(){this.setState({tileSource:null})}updateState(t){let{props:e,changeFlags:n}=t;this.setState({tileSource:e.tileSource})}renderLayers(){const{tileSource:t}=this.state;return this.sourceSupportsMVTLayer()?(t.props.coordinates="local",this.renderMVTLayer()):(t.props.coordinates="wgs84",this.renderTileLayer())}sourceSupportsMVTLayer(){const{tileSource:t}=this.props;return"application/vnd.mapbox-vector-tile"===t.mimeType&&t.localCoordinates}renderMVTLayer(){const{tileSource:t,showTileBorders:e,metadata:n,onTilesLoad:r}=this.props,o=n?.minZoom||0,s=n?.maxZoom||30,i=this.context.device.getCanvasContext().getDevicePixelRatio();return[new we({id:String(t.url),data:t,getLineColor:[0,0,0],getLineWidth:1,getFillColor:[100,120,140],lineWidthUnits:"pixels",pickable:!0,autoHighlight:!0,onViewportLoad:r,minZoom:o,maxZoom:s,tileSize:256,zoomOffset:1===i?-1:0,showTileBorders:e})]}renderTileLayer(){const{tileSource:t,showTileBorders:e,metadata:n,onTilesLoad:r}=this.props,o=n?.minZoom||0,s=n?.maxZoom||30;return[new pe.Z({id:String(t.url),getTileData:t.getTileData,maxRequests:20,pickable:!0,autoHighlight:e,onViewportLoad:r,minZoom:o,maxZoom:s,tileSize:256,zoomOffset:1===devicePixelRatio?-1:0,renderSubLayers:ve,tileSource:t,showTileBorders:e})]}}function ve(t){const{tileSource:e,showTileBorders:n,minZoom:r,maxZoom:o,tile:{index:{z:s},bbox:{west:i,south:a,east:l,north:c}}}=t,u=[],h=s<=r||s>=o?[255,0,0,255]:[0,0,255,255];switch(e.mimeType){case"application/vnd.mapbox-vector-tile":u.push(new fe.Z({id:`${t.id}-geojson`,data:t.data,pickable:!0,autoHighlight:!0,lineWidthScale:500,lineWidthMinPixels:.5,getFillColor:[100,120,140,255],highlightColor:[0,0,200,255]}));break;case"image/png":case"image/jpeg":case"image/webp":case"image/avif":u.push(new ge.Z(t,{data:null,image:t.data,bounds:[i,a,l,c],pickable:!0}));break;default:ye.error("Unknown tile mimeType",e?.mimeType)}return n&&u.push(new me.Z({id:`${t.id}-border`,data:[[[i,c],[i,a],[l,a],[l,c],[i,c]]],getPath:t=>t,getColor:h,widthMinPixels:4})),u}var xe=n(33545),_e=n(85116),Te=n.n(_e),Se=n(19521),Ae=n(63764),Ee=n(85893);const Pe=Se.ZP.div.withConfig({displayName:"example-panel__Container",componentId:"sc-1dag6ia-0"})(["display:flex;flex-direction:column;position:absolute;top:0;right:0;max-width:320px;background:#fff;color:#121212;box-shadow:0 2px 4px rgba(0,0,0,0.3);padding:12px 24px;margin:20px;font-size:13px;line-height:2;outline:none;z-index:100;height:calc(100vh - 105px);width:500px;.loading-indicator{margin:0;text-align:center;transition:opacity 300ms ease-out;}> .monaco-editor{height:calc(100vh - 200px) !important;width:700px !important;}"]),ke=Se.ZP.select.withConfig({displayName:"example-panel__DropDown",componentId:"sc-1dag6ia-1"})(["margin-bottom:6px;"]),je=t=>{t={examples:{},droppedFile:null,exampleName:null,categoryName:null,onExampleChange:()=>{},...t};const[e,n]=(0,r.useState)({examples:[],categoryName:null,exampleName:null,example:null,error:null});return(0,r.useEffect)((()=>{const e=function(t,e){if(e)return{[e]:t[e]};return{...t}}(t.examples,t.format),r=t.format||t.initialCategoryName;let o=t.format?Object.keys(e[r])[0]:t.initialExampleName;const s=e[r][o];n((t=>({...t,examples:e,exampleName:o,categoryName:r,example:s})))}),[t.examples,t.format,t.initialCategoryName,t.initialExampleName]),(0,r.useEffect)((()=>{e.example&&t.onExampleChange({categoryName:e.categoryName,exampleName:e.exampleName,example:e.example})}),[e.example]),(0,Ee.jsxs)(Pe,{children:[(0,Ee.jsx)(Ie,{...e}),(0,Ee.jsx)(Me,{examples:e.examples,categoryName:e.categoryName,exampleName:e.exampleName,onExampleChange:t=>{let{categoryName:e,exampleName:r,example:o}=t;n((t=>({...t,categoryName:e,exampleName:r,example:o})))}}),t.children]})},Ce=t=>(0,Ee.jsx)(Ae.ZP,{language:"json",options:{readOnly:!0},theme:"vs-dark",value:t.metadata||"No metadata available"}),Le={position:"absolute",right:0,bottom:0,backgroundColor:"hsla(0,0%,100%,.5)",padding:"0 5px",font:"12px/20px Helvetica Neue,Arial,Helvetica,sans-serif"};function Ne(t){return(0,Ee.jsx)("div",{style:Le,children:t.attributions?.map((t=>(0,Ee.jsx)("div",{children:t},t)))})}const Ie=t=>{let{categoryName:e,exampleName:n}=t;return e&&n?(0,Ee.jsx)("div",{children:(0,Ee.jsxs)("h3",{children:[n," ",(0,Ee.jsx)("b",{children:e})," "]})}):null},Me=t=>{const{categoryName:e,exampleName:n}=t;if(!e||!n)return!1;const r=`${e}.${n}`;return(0,Ee.jsx)(ke,{value:r,onChange:e=>{const n=e.target.value.split("."),r=n[0],o=n[1],s=t.examples[r][o];t.onExampleChange({categoryName:r,exampleName:o,example:s})},children:Object.keys(t.examples).map(((e,n)=>{const r=t.examples[e];return(0,Ee.jsx)("optgroup",{label:e,children:Object.keys(r).map(((t,n)=>{const r=`${e}.${t}`;return(0,Ee.jsx)("option",{value:r,children:`${t} (${e})`},n)}))},n)}))})};const Re="GeoJSON",Oe="Countries",Ue="https://basemaps.cartocdn.com/gl/positron-nolabels-gl-style/style.json",Be={longitude:-122.4,latitude:37.74,zoom:2,minZoom:1,maxZoom:20,pitch:0,bearing:0},Fe={MVT:{"OpenStreetMap Tiles":{sourceType:"mvt",data:"https://c.tile.openstreetmap.org",viewState:{...Be,longitude:40,latitude:57,zoom:5}}},PMTILES:{"FSQ Tiles":{sourceType:"pmtiles",data:"https://4sq-studio-public.s3.us-west-2.amazonaws.com/pmtiles-test/161727fe-7952-4e57-aa05-850b3086b0b2.pmtiles",attributions:["\xa9 Foursquare"],viewState:{...Be}},"NZ Buildings":{sourceType:"pmtiles",data:"https://r2-public.protomaps.com/protomaps-sample-datasets/nz-buildings-v3.pmtiles",attributions:["\xa9 Land Information New Zealand"],viewState:{...Be}},Terrarium:{sourceType:"pmtiles",data:"https://r2-public.protomaps.com/protomaps-sample-datasets/terrarium_z9.pmtiles",tileSize:[512,512]}},GeoJSON:{Countries:{sourceType:"table",data:"https://d2ad6b4ur7yvpq.cloudfront.net/naturalearth-3.3.0/ne_50m_admin_0_scale_rank.geojson",viewState:{...Be,longitude:-4.65,latitude:-29.76,zoom:1.76}}}};var $e=n(25108);const Ve={latitude:47.65,longitude:7,zoom:2,maxZoom:20};function ze(t){void 0===t&&(t={});const[e,n]=(0,r.useState)({tileSource:null,metadata:null,viewState:Ve,error:null}),{tileSource:s,metadata:i}=e,a=s&&new be({data:s,tileSource:s,showTileBorders:!0,metadata:i,onTilesLoad:t.onTilesLoad,pickable:!0,autoHighlight:!0});return(0,Ee.jsxs)("div",{style:{position:"relative",height:"100%"},children:[(0,Ee.jsxs)(je,{title:"Tileset Metadata",examples:Fe,format:t.format,initialCategoryName:Re,initialExampleName:Oe,onExampleChange:async function(t){const{categoryName:r,exampleName:s,example:i}=t,a=i.data;try{let t=function(t){const e=t.data;return(0,o.B)(e,[C,at,pt],{pmtiles:{attributions:t.attributions,loadOptions:{tilejson:{maxValues:10}}},table:{generateId:!0,loaders:[ae]},mvt:{}})}(i);n((e=>({...e,tileSource:t,metadata:null}))),(async()=>{const r=await t.getMetadata();let o={...e.viewState,...i.viewState};o=function(t,e){if(!e)return t;t={...t},e.minZoom<t.zoom&&(t.zoom=Math.max(e.minZoom,1.2));e.minZoom>t.zoom&&(t.zoom=e.maxZoom);"number"==typeof e.center?.[0]&&"number"==typeof e.center?.[1]&&(t={...t,longitude:e.center[0],latitude:e.center[1]});return t}(o,r),n((t=>({...t,initialViewState:o,metadata:r?JSON.stringify(r,null,2):""})))})()}catch(l){$e.error("Failed to load data",a,l),n((t=>({...t,error:`Could not load ${s}: ${l.message}`})))}},children:[(0,Ee.jsx)(Ce,{metadata:i}),t.children,(0,Ee.jsx)("pre",{style:{textAlign:"center",margin:0}})]}),(0,Ee.jsxs)(ce.Z,{layers:[a],views:new ue.Z({repeat:!0}),initialViewState:e.viewState,controller:!0,getTooltip:De,children:[(0,Ee.jsx)(xe.D5,{mapLib:Te(),mapStyle:Ue}),(0,Ee.jsx)(Ne,{attributions:i?.attributions})]})]})}function De(t){if(t.tile){const{x:e,y:n,z:r}=t.tile.index;return`tile: x: ${e}, y: ${n}, z: ${r}`}return null}},86329:(t,e,n)=>{n.d(e,{D0:()=>l,Ew:()=>c,Kn:()=>s,Lj:()=>u,Os:()=>p,Ss:()=>i,TW:()=>a,zH:()=>h});const r=t=>"boolean"==typeof t,o=t=>"function"==typeof t,s=t=>null!==t&&"object"==typeof t,i=t=>s(t)&&t.constructor==={}.constructor,a=t=>Boolean(t)&&"function"==typeof t[Symbol.iterator],l=t=>t&&"function"==typeof t[Symbol.asyncIterator],c=t=>"undefined"!=typeof Response&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,u=t=>"undefined"!=typeof Blob&&t instanceof Blob,h=t=>t&&"object"==typeof t&&t.isBuffer,p=t=>(t=>"undefined"!=typeof ReadableStream&&t instanceof ReadableStream||s(t)&&o(t.tee)&&o(t.cancel)&&o(t.getReader))(t)||(t=>s(t)&&o(t.read)&&o(t.pipe)&&r(t.readable))(t)},21740:(t,e,n)=>{function r(t,e,n){const{type:r="auto"}=n,o="auto"===r?function(t,e){for(const n of e)if(n.testURL&&n.testURL(t))return n;return null}(t,e):function(t,e){for(const n of e)if(n.type===t)return n;return null}(r,e);if(!o)throw new Error("Not a valid image source type");return o.createDataSource(t,n)}n.d(e,{B:()=>r})},57291:(t,e,n)=>{n.d(e,{z:()=>a});var r=n(86329),o=n(90231),s=n(79955),i=n(80999);async function a(t,e,n,a){let l,c;Array.isArray(e)||(0,o.C)(e)?(l=e,c=n):(l=[],c=e);const u=(0,s.b)(c);let h=t;return"string"==typeof t&&(h=await u(t)),(0,r.Lj)(t)&&(h=await u(t)),Array.isArray(l),await(0,i.Q)(h,l,c)}},80999:(t,e,n)=>{n.d(e,{Q:()=>D});var r=n(60076);class o{terminate(){}}var s=n(6408);const i=new Map;function a(t){(0,s.h)(t.source&&!t.url||!t.source&&t.url);let e=i.get(t.source||t.url);return e||(t.url&&(e=function(t){if(!t.startsWith("http"))return t;return l((e=t,`try {\n  importScripts('${e}');\n} catch (error) {\n  console.error(error);\n  throw error;\n}`));var e}(t.url),i.set(t.url,e)),t.source&&(e=l(t.source),i.set(t.source,e))),(0,s.h)(e),e}function l(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function c(t,e,n){void 0===e&&(e=!0);const r=n||new Set;if(t){if(u(t))r.add(t);else if(u(t.buffer))r.add(t.buffer);else if(ArrayBuffer.isView(t));else if(e&&"object"==typeof t)for(const o in t)c(t[o],e,r)}else;return void 0===n?Array.from(r):[]}function u(t){return!!t&&(t instanceof ArrayBuffer||("undefined"!=typeof MessagePort&&t instanceof MessagePort||("undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&t instanceof OffscreenCanvas)))}var h=n(25108);const p=()=>{};class d{terminated=!1;_loadableURL="";static isSupported(){return"undefined"!=typeof Worker&&r.jU||void 0!==o&&!r.jU}constructor(t){const{name:e,source:n,url:o}=t;(0,s.h)(n||o),this.name=e,this.source=n,this.url=o,this.onMessage=p,this.onError=t=>h.log(t),this.worker=r.jU?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=p,this.onError=p,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage(t,e){e=e||c(t),this.worker.postMessage(t,e)}_getErrorFromErrorEvent(t){let e="Failed to load ";return e+=`worker ${this.name} from ${this.url}. `,t.message&&(e+=`${t.message} in `),t.lineno&&(e+=`:${t.lineno}:${t.colno}`),new Error(e)}_createBrowserWorker(){this._loadableURL=a({source:this.source,url:this.url});const t=new Worker(this._loadableURL,{name:this.name});return t.onmessage=t=>{t.data?this.onMessage(t.data):this.onError(new Error("No data received"))},t.onerror=t=>{this.onError(this._getErrorFromErrorEvent(t)),this.terminated=!0},t.onmessageerror=t=>h.error(t),t}_createNodeWorker(){let t;if(this.url){const e=this.url.includes(":/")||this.url.startsWith("/")?this.url:`./${this.url}`;t=new o(e,{eval:!1})}else{if(!this.source)throw new Error("no worker");t=new o(this.source,{eval:!0})}return t.on("message",(t=>{this.onMessage(t)})),t.on("error",(t=>{this.onError(t)})),t.on("exit",(t=>{})),t}}class f{isRunning=!0;_resolve=()=>{};_reject=()=>{};constructor(t,e){this.name=t,this.workerThread=e,this.result=new Promise(((t,e)=>{this._resolve=t,this._reject=e}))}postMessage(t,e){this.workerThread.postMessage({source:"loaders.gl",type:t,payload:e})}done(t){(0,s.h)(this.isRunning),this.isRunning=!1,this._resolve(t)}error(t){(0,s.h)(this.isRunning),this.isRunning=!1,this._reject(t)}}var g=n(25108);class m{name="unnamed";maxConcurrency=1;maxMobileConcurrency=1;onDebug=()=>{};reuseWorkers=!0;props={};jobQueue=[];idleQueue=[];count=0;isDestroyed=!1;static isSupported(){return d.isSupported()}constructor(t){this.source=t.source,this.url=t.url,this.setProps(t)}destroy(){this.idleQueue.forEach((t=>t.destroy())),this.isDestroyed=!0}setProps(t){this.props={...this.props,...t},void 0!==t.name&&(this.name=t.name),void 0!==t.maxConcurrency&&(this.maxConcurrency=t.maxConcurrency),void 0!==t.maxMobileConcurrency&&(this.maxMobileConcurrency=t.maxMobileConcurrency),void 0!==t.reuseWorkers&&(this.reuseWorkers=t.reuseWorkers),void 0!==t.onDebug&&(this.onDebug=t.onDebug)}async startJob(t,e,n){void 0===e&&(e=(t,e,n)=>t.done(n)),void 0===n&&(n=(t,e)=>t.error(e));const r=new Promise((r=>(this.jobQueue.push({name:t,onMessage:e,onError:n,onStart:r}),this)));return this._startQueuedJob(),await r}async _startQueuedJob(){if(!this.jobQueue.length)return;const t=this._getAvailableWorker();if(!t)return;const e=this.jobQueue.shift();if(e){this.onDebug({message:"Starting job",name:e.name,workerThread:t,backlog:this.jobQueue.length});const r=new f(e.name,t);t.onMessage=t=>e.onMessage(r,t.type,t.payload),t.onError=t=>e.onError(r,t),e.onStart(r);try{await r.result}catch(n){g.error(`Worker exception: ${n}`)}finally{this.returnWorkerToQueue(t)}}}returnWorkerToQueue(t){!r.jU||this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(t.destroy(),this.count--):this.idleQueue.push(t),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const t=`${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;return new d({name:t,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return r.tq?this.maxMobileConcurrency:this.maxConcurrency}}const y={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class w{workerPools=new Map;static isSupported(){return d.isSupported()}static getWorkerFarm(t){return void 0===t&&(t={}),w._workerFarm=w._workerFarm||new w({}),w._workerFarm.setProps(t),w._workerFarm}constructor(t){this.props={...y},this.setProps(t),this.workerPools=new Map}destroy(){for(const t of this.workerPools.values())t.destroy();this.workerPools=new Map}setProps(t){this.props={...this.props,...t};for(const e of this.workerPools.values())e.setProps(this._getWorkerPoolProps())}getWorkerPool(t){const{name:e,source:n,url:r}=t;let o=this.workerPools.get(e);return o||(o=new m({name:e,source:n,url:r}),o.setProps(this._getWorkerPoolProps()),this.workerPools.set(e,o)),o}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}var b=n(25501);var v=n(25108);async function x(t,e,n,o,i){const a=t.id,l=function(t,e){void 0===e&&(e={});const n=e[t.id]||{},o=r.jU?`${t.id}-worker.js`:`${t.id}-worker-node.js`;let i=n.workerUrl;if(i||"compression"!==t.id||(i=e.workerUrl),"test"===e._workerType&&(i=r.jU?`modules/${t.module}/dist/${o}`:`modules/${t.module}/src/workers/${t.id}-worker-node.ts`),!i){let e=t.version;"latest"===e&&(e=b.e);const n=e?`@${e}`:"";i=`https://unpkg.com/@loaders.gl/${t.module}${n}/dist/${o}`}return(0,s.h)(i),i}(t,n),c=w.getWorkerFarm(n).getWorkerPool({name:a,url:l});n=JSON.parse(JSON.stringify(n)),o=JSON.parse(JSON.stringify(o||{}));const u=await c.startJob("process-on-worker",_.bind(null,i));u.postMessage("process",{input:e,options:n,context:o});const h=await u.result;return await h.result}async function _(t,e,n,r){switch(n){case"done":e.done(r);break;case"error":e.error(new Error(r.error));break;case"process":const{id:s,input:i,options:a}=r;try{const n=await t(i,a);e.postMessage("done",{id:s,result:n})}catch(o){const t=o instanceof Error?o.message:"unknown error";e.postMessage("error",{id:s,error:t})}break;default:v.warn(`parse-with-worker unknown message ${n}`)}}var T=n(90231),S=n(86329),A=n(62190),E=n(3895),P=n(92013);const k=262144;const j=262144;const C=1048576;var L=n(82707),N=n(59045);function I(t,e){return L.jU?async function*(t,e){const n=t.getReader();let r;try{for(;;){const t=r||n.read();e?._streamReadAhead&&(r=n.read());const{done:o,value:s}=await t;if(o)return;yield(0,N.rJ)(s)}}catch(o){n.releaseLock()}}(t,e):async function*(t,e){for await(const n of t)yield(0,N.rJ)(n)}(t)}function M(t,e){if("string"==typeof t)return function*(t,e){const n=e?.chunkSize||k;let r=0;const o=new TextEncoder;for(;r<t.length;){const e=Math.min(t.length-r,n),s=t.slice(r,r+e);r+=e,yield o.encode(s)}}(t,e);if(t instanceof ArrayBuffer)return function(t,e){return void 0===e&&(e={}),function*(){const{chunkSize:n=j}=e;let r=0;for(;r<t.byteLength;){const e=Math.min(t.byteLength-r,n),o=new ArrayBuffer(e),s=new Uint8Array(t,r,e);new Uint8Array(o).set(s),r+=e,yield o}}()}(t,e);if((0,S.Lj)(t))return async function*(t,e){const n=e?.chunkSize||C;let r=0;for(;r<t.size;){const e=r+n,o=await t.slice(r,e).arrayBuffer();r=e,yield o}}(t,e);if((0,S.Os)(t))return I(t,e);if((0,S.Ew)(t)){return I(t.body,e)}throw new Error("makeIterator")}var R=n(34804);const O="Cannot convert supplied data type";async function U(t,e,n){const r=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if("string"==typeof t||r)return function(t,e,n){if(e.text&&"string"==typeof t)return t;if((0,S.zH)(t)&&(t=t.buffer),t instanceof ArrayBuffer){const n=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(n):n}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let n=t.buffer;const r=t.byteLength||t.length;return 0===t.byteOffset&&r===n.byteLength||(n=n.slice(t.byteOffset,t.byteOffset+r)),n}throw new Error(O)}(t,e);if((0,S.Lj)(t)&&(t=await(0,R.L1)(t)),(0,S.Ew)(t)){const n=t;return await(0,R.mm)(n),e.binary?await n.arrayBuffer():await n.text()}if((0,S.Os)(t)&&(t=M(t,n)),(0,S.TW)(t)||(0,S.D0)(t))return(0,P.GZ)(t);throw new Error(O)}var B=n(79955),F=n(44727),$=n(25083);var V=n(30139),z=n(9167);async function D(t,e,n,o){!e||Array.isArray(e)||(0,T.C)(e)||(o=void 0,n=e,e=void 0),t=await t,n=n||{};const i=(0,V.vM)(t),a=function(t,e){if(t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const t=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...t]:t}return n&&n.length?n:void 0}(e,o),l=await(0,z.A)(t,a,n);return l?(o=function(t,e,n){if(n)return n;const r={fetch:(0,B.b)(e,t),...t};if(r.url){const t=(0,F.kr)(r.url);r.baseUrl=t,r.queryString=(0,F.Si)(r.url),r.filename=$.vB(t),r.baseUrl=$.XX(t)}return Array.isArray(r.loaders)||(r.loaders=null),r}({url:i,_parse:D,loaders:a},n=(0,A.GR)(n,l,a,i),o||null),await async function(t,e,n,o){if(function(t,e){void 0===e&&(e=b.q),(0,s.h)(t,"no worker provided");const n=t.version}(t),n=(0,E.N)(t.options,n),(0,S.Ew)(e)){const t=e,{ok:n,redirected:r,status:s,statusText:i,type:a,url:l}=t,c=Object.fromEntries(t.headers.entries());o.response={headers:c,ok:n,redirected:r,status:s,statusText:i,type:a,url:l}}e=await U(e,t,n);const i=t;if(i.parseTextSync&&"string"==typeof e)return i.parseTextSync(e,n,o);if(function(t,e){return!!w.isSupported()&&!(!r.jU&&!e?._nodeWorkers)&&t.worker&&e?.worker}(t,n))return await x(t,e,n,o,D);if(i.parseText&&"string"==typeof e)return await i.parseText(e,n,o);if(i.parse)return await i.parse(e,n,o);throw(0,s.h)(!i.parseSync),new Error(`${t.id} loader - no parser found and worker is disabled`)}(l,t,n,o)):null}},57089:(t,e,n)=>{n.d(e,{fh:()=>i,kO:()=>a});var r=n(90231),o=n(62190);const s=()=>{const t=(0,o.rx)();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function i(t){const e=s();t=Array.isArray(t)?t:[t];for(const n of t){const t=(0,r.T)(n);e.find((e=>t===e))||e.unshift(t)}}function a(){return s()}},9167:(t,e,n)=>{n.d(e,{A:()=>d});var r=n(89121),o=n(25083),s=n(77420),i=n(90231),a=n(30139),l=n(95199),c=n(57089),u=n(86329),h=n(44727);const p=/\.([^.]+)$/;async function d(t,e,n,r){if(void 0===e&&(e=[]),!g(t))return null;let o=f(t,e,{...n,nothrow:!0},r);if(o)return o;if((0,u.Lj)(t)&&(o=f(t=await t.slice(0,10).arrayBuffer(),e,n,r)),!o&&!n?.nothrow)throw new Error(m(t));return o}function f(t,e,n,o){if(void 0===e&&(e=[]),!g(t))return null;if(e&&!Array.isArray(e))return(0,i.T)(e);let s=[];e&&(s=s.concat(e)),n?.ignoreRegisteredLoaders||s.push(...(0,c.kO)()),function(t){for(const e of t)(0,i.T)(e)}(s);const l=function(t,e,n,o){const s=(0,a.vM)(t),i=(0,a.Ry)(t),l=(0,h.kr)(s)||o?.url;let c=null,u="";n?.mimeType&&(c=y(e,n?.mimeType),u=`match forced by supplied MIME type ${n?.mimeType}`);c=c||function(t,e){const n=e&&p.exec(e),r=n&&n[1];return r?function(t,e){e=e.toLowerCase();for(const n of t)for(const t of n.extensions)if(t.toLowerCase()===e)return n;return null}(t,r):null}(e,l),u=u||(c?`matched url ${l}`:""),c=c||y(e,i),u=u||(c?`matched MIME type ${i}`:""),c=c||function(t,e){if(!e)return null;for(const n of t)if("string"==typeof e){if(w(e,n))return n}else if(ArrayBuffer.isView(e)){if(b(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer){if(b(e,0,n))return n}return null}(e,t),u=u||(c?`matched initial data ${v(t)}`:""),n?.fallbackMimeType&&(c=c||y(e,n?.fallbackMimeType),u=u||(c?`matched fallback MIME type ${i}`:""));u&&r.c.log(1,`selectLoader selected ${c?.name}: ${u}.`);return c}(t,s,n,o);if(!l&&!n?.nothrow)throw new Error(m(t));return l}function g(t){return!(t instanceof Response&&204===t.status)}function m(t){const e=(0,a.vM)(t),n=(0,a.Ry)(t);let r="No valid loader found (";r+=e?`${o.vB(e)}, `:"no url provided, ",r+=`MIME type: ${n?`"${n}"`:"not provided"}, `;const s=t?v(t):"";return r+=s?` first bytes: "${s}"`:"first bytes: not available",r+=")",r}function y(t,e){for(const n of t){if(n.mimeTypes?.some((t=>(0,l.BB)(e,t))))return n;if((0,l.BB)(e,`application/x.${n.id}`))return n}return null}function w(t,e){if(e.testText)return e.testText(t);return(Array.isArray(e.tests)?e.tests:[e.tests]).some((e=>t.startsWith(e)))}function b(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some((n=>function(t,e,n,r){if(r instanceof ArrayBuffer)return(0,s.Xq)(r,t,r.byteLength);switch(typeof r){case"function":return r(t);case"string":return r===x(t,e,r.length);default:return!1}}(t,e,0,n)))}function v(t,e){if(void 0===e&&(e=5),"string"==typeof t)return t.slice(0,e);if(ArrayBuffer.isView(t))return x(t.buffer,t.byteOffset,e);if(t instanceof ArrayBuffer){return x(t,0,e)}return""}function x(t,e,n){if(t.byteLength<e+n)return"";const r=new DataView(t);let o="";for(let s=0;s<n;s++)o+=String.fromCharCode(r.getUint8(e+s));return o}},94023:(t,e,n)=>{n.d(e,{dc:()=>s});var r=n(36642),o=n(34804);async function s(t,e){if("string"==typeof t){const n=(0,r.i3)(t);return function(t){return!function(t){return t.startsWith("http:")||t.startsWith("https:")}(t)&&!function(t){return t.startsWith("data:")}(t)}(n)&&globalThis.loaders?.fetchNode?globalThis.loaders?.fetchNode(n,e):await fetch(n,e)}return await(0,o.L1)(t)}},79955:(t,e,n)=>{n.d(e,{b:()=>i});var r=n(86329),o=n(94023),s=n(62190);function i(t,e){const n=(0,s.pm)(),i=t||n;return"function"==typeof i.fetch?i.fetch:(0,r.Kn)(i.fetch)?t=>(0,o.dc)(t,i.fetch):e?.fetch?e?.fetch:o.dc}},90231:(t,e,n)=>{n.d(e,{C:()=>o,T:()=>s});var r=n(10517);function o(t){if(!t)return!1;Array.isArray(t)&&(t=t[0]);return Array.isArray(t?.extensions)}function s(t){let e;return(0,r.h)(t,"null loader"),(0,r.h)(o(t),"invalid loader"),Array.isArray(t)&&(e=t[1],t=t[0],t={...t,options:{...t.options,...e}}),(t?.parseTextSync||t?.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}},62190:(t,e,n)=>{n.d(e,{pm:()=>p,rx:()=>h,GR:()=>d});var r=n(86329),o=n(79962),s=n(25108);const i=new o.Z({id:"loaders.gl"});class a{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}var l=n(82707);const c={fetch:null,mimeType:void 0,nothrow:!1,log:new class{constructor(){this.console=s}log(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.console.log.bind(this.console,...e)}info(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.console.info.bind(this.console,...e)}warn(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.console.warn.bind(this.console,...e)}error(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.console.error.bind(this.console,...e)}},useLocalLibraries:!1,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:l.jU,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},u={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function h(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state||(t._state={}),t._state}function p(){const t=h();return t.globalOptions=t.globalOptions||{...c},t.globalOptions}function d(t,e,n,r){return n=n||[],function(t,e){f(t,null,c,u,e);for(const n of e){const r=t&&t[n.id]||{},o=n.options&&n.options[n.id]||{},s=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};f(r,n.id,o,s,e)}}(t,n=Array.isArray(n)?n:[n]),m(e,t,r)}function f(t,e,n,o,s){const a=e||"Top level",l=e?`${e}.`:"";for(const c in t){const u=!e&&(0,r.Kn)(t[c]);if(!(c in n)&&!("baseUri"===c&&!e)&&!("workerUrl"===c&&e))if(c in o)i.warn(`${a} loader option '${l}${c}' no longer supported, use '${o[c]}'`)();else if(!u){const t=g(c,s);i.warn(`${a} loader option '${l}${c}' not recognized. ${t}`)()}}}function g(t,e){const n=t.toLowerCase();let r="";for(const o of e)for(const e in o.options){if(t===e)return`Did you mean '${o.id}.${e}'?`;const s=e.toLowerCase();(n.startsWith(s)||s.startsWith(n))&&(r=r||`Did you mean '${o.id}.${e}'?`)}return r}function m(t,e,n){const r={...t.options||{}};return function(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}(r,n),null===r.log&&(r.log=new a),y(r,p()),y(r,e),r}function y(t,e){for(const n in e)if(n in e){const o=e[n];(0,r.Ss)(o)&&(0,r.Ss)(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}},95199:(t,e,n)=>{n.d(e,{BB:()=>s,qZ:()=>i,zB:()=>a});const r=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,o=/^([-\w.]+\/[-\w.+]+)/;function s(t,e){return t.toLowerCase()===e.toLowerCase()}function i(t){const e=o.exec(t);return e?e[1]:t}function a(t){const e=r.exec(t);return e?e[1]:""}},30139:(t,e,n)=>{n.d(e,{Cu:()=>l,Ry:()=>a,vM:()=>i});var r=n(86329),o=n(95199),s=n(44727);function i(t){if((0,r.Ew)(t)){return t.url}if((0,r.Lj)(t)){return t.name||""}return"string"==typeof t?t:""}function a(t){if((0,r.Ew)(t)){const e=t,n=e.headers.get("content-type")||"",r=(0,s.kr)(e.url);return(0,o.qZ)(n)||(0,o.zB)(r)}if((0,r.Lj)(t)){return t.type||""}return"string"==typeof t?(0,o.zB)(t):""}function l(t){if((0,r.Ew)(t)){return t.headers["content-length"]||-1}if((0,r.Lj)(t)){return t.size}return"string"==typeof t?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}},34804:(t,e,n)=>{n.d(e,{mm:()=>l,L1:()=>a});var r=n(86329);class o extends Error{constructor(t,e){super(t),this.reason=e.reason,this.url=e.url,this.response=e.response}}var s=n(30139),i=n(44727);async function a(t){if((0,r.Ew)(t))return t;const e={},n=(0,s.Cu)(t);n>=0&&(e["content-length"]=String(n));const o=(0,s.vM)(t),i=(0,s.Ry)(t);i&&(e["content-type"]=i);const a=await async function(t){const e=5;if("string"==typeof t)return`data:,${t.slice(0,e)}`;if(t instanceof Blob){const e=t.slice(0,5);return await new Promise((t=>{const n=new FileReader;n.onload=e=>t(e?.target?.result),n.readAsDataURL(e)}))}if(t instanceof ArrayBuffer){return`data:base64,${function(t){let e="";const n=new Uint8Array(t);for(let r=0;r<n.byteLength;r++)e+=String.fromCharCode(n[r]);return btoa(e)}(t.slice(0,e))}`}return null}(t);a&&(e["x-first-bytes"]=a),"string"==typeof t&&(t=(new TextEncoder).encode(t));const l=new Response(t,{headers:e});return Object.defineProperty(l,"url",{value:o}),l}async function l(t){if(!t.ok){const e=await async function(t){const n=(0,i.Ni)(t.url);let r=`Failed to fetch resource (${t.status}) ${t.statusText}: ${n}`;r=r.length>100?`${r.slice(0,100)}...`:r;const s={reason:t.statusText,url:t.url,response:t};try{const e=t.headers.get("Content-Type");s.reason=!t.bodyUsed&&e?.includes("application/json")?await t.json():await t.text()}catch(e){}return new o(r,s)}(t);throw e}}},44727:(t,e,n)=>{n.d(e,{Ni:()=>i,Si:()=>o,kr:()=>s});const r=/\?.*/;function o(t){const e=t.match(r);return e&&e[0]}function s(t){return t.replace(r,"")}function i(t){if(t.length<50)return t;const e=t.slice(t.length-15);return`${t.substr(0,32)}...${e}`}},53390:(t,e,n)=>{function r(t,e){const n=e?.globalFeatureId;return void 0!==n?function(t,e){const n=s(t);for(const r of n){let t=0,n=r.featureIds.value[0];for(let o=0;o<r.featureIds.value.length;o++){const s=r.featureIds.value[o];if(s!==n){if(e===r.globalFeatureIds.value[t])return i(r,t,o);t=o,n=s}}if(e===r.globalFeatureIds.value[t])return i(r,t,r.featureIds.value.length)}throw new Error(`featureId:${e} not found`)}(t,n):function(t,e){const n=s(t,e);return function(t){const e=[];for(const n of t){if(0===n.featureIds.value.length)continue;let t=0,r=n.featureIds.value[0];for(let o=0;o<n.featureIds.value.length;o++){const s=n.featureIds.value[o];s!==r&&(e.push(i(n,t,o)),t=o,r=s)}e.push(i(n,t,n.featureIds.value.length))}return e}(n)}(t,e?.type)}function o(t,e,n){switch(t.type){case"Point":return function(t,e,n){const{positions:r}=t,o=l(r,e,n);if(o.length>1)return{type:"MultiPoint",coordinates:o};return{type:"Point",coordinates:o[0]}}(t,e,n);case"LineString":return function(t,e,n){void 0===e&&(e=-1/0);void 0===n&&(n=1/0);const{positions:r}=t,o=t.pathIndices.value.filter((t=>t>=e&&t<=n));if(!(o.length>2)){return{type:"LineString",coordinates:l(r,o[0],o[1])}}const s=[];for(let i=0;i<o.length-1;i++){const t=l(r,o[i],o[i+1]);s.push(t)}return{type:"MultiLineString",coordinates:s}}(t,e,n);case"Polygon":return a(t,e,n);default:const r=t;throw new Error(`Unsupported geometry type: ${r?.type}`)}}function s(t,e){const n=[];return t.points&&(t.points.type="Point",n.push(t.points)),t.lines&&(t.lines.type="LineString",n.push(t.lines)),t.polygons&&(t.polygons.type="Polygon",n.push(t.polygons)),n}function i(t,e,n){const r=o(t,e,n),s=function(t,e,n){void 0===e&&(e=0);const r=Object.assign({},t.properties[t.featureIds.value[e]]);for(const o in t.numericProps)r[o]=t.numericProps[o].value[e];return r}(t,e),i=function(t,e,n){void 0===e&&(e=0);return t.fields&&t.fields[t.featureIds.value[e]]}(t,e);return{type:"Feature",geometry:r,properties:s,...i}}function a(t,e,n){void 0===e&&(e=-1/0),void 0===n&&(n=1/0);const{positions:r}=t,o=t.polygonIndices.value.filter((t=>t>=e&&t<=n)),s=t.primitivePolygonIndices.value.filter((t=>t>=e&&t<=n));if(!(o.length>2)){const t=[];for(let e=0;e<s.length-1;e++){const n=l(r,s[e],s[e+1]);t.push(n)}return{type:"Polygon",coordinates:t}}const i=[];for(let l=0;l<o.length-1;l++){const e=a(t,o[l],o[l+1]).coordinates;i.push(e)}return{type:"MultiPolygon",coordinates:i}}function l(t,e,n){e=e||0,n=n||t.value.length/t.size;const r=[];for(let o=e;o<n;o++){const e=Array();for(let n=o*t.size;n<(o+1)*t.size;n++)e.push(Number(t.value[n]));r.push(e)}return r}n.d(e,{F:()=>r,f:()=>o})},43319:(t,e,n)=>{n.d(e,{E:()=>o});var r=n(50533);function o(t,e,n){const r=s(t),o=Object.keys(r).filter((t=>r[t]!==Array));return function(t,e,n){const{pointPositionsCount:r,pointFeaturesCount:o,linePositionsCount:s,linePathsCount:c,lineFeaturesCount:h,polygonPositionsCount:d,polygonObjectsCount:f,polygonRingsCount:g,polygonFeaturesCount:m,propArrayTypes:y,coordLength:w}=e,{numericPropKeys:b=[],PositionDataType:v=Float32Array,triangulate:x=!0}=n,_=t[0]&&"id"in t[0],T=t.length>65535?Uint32Array:Uint16Array,S={type:"Point",positions:new v(r*w),globalFeatureIds:new T(r),featureIds:o>65535?new Uint32Array(r):new Uint16Array(r),numericProps:{},properties:[],fields:[]},A={type:"LineString",pathIndices:s>65535?new Uint32Array(c+1):new Uint16Array(c+1),positions:new v(s*w),globalFeatureIds:new T(s),featureIds:h>65535?new Uint32Array(s):new Uint16Array(s),numericProps:{},properties:[],fields:[]},E={type:"Polygon",polygonIndices:d>65535?new Uint32Array(f+1):new Uint16Array(f+1),primitivePolygonIndices:d>65535?new Uint32Array(g+1):new Uint16Array(g+1),positions:new v(d*w),globalFeatureIds:new T(d),featureIds:m>65535?new Uint32Array(d):new Uint16Array(d),numericProps:{},properties:[],fields:[]};x&&(E.triangles=[]);for(const i of[S,A,E])for(const t of b){const e=y[t];i.numericProps[t]=new e(i.positions.length/w)}A.pathIndices[c]=s,E.polygonIndices[f]=d,E.primitivePolygonIndices[g]=d;const P={pointPosition:0,pointFeature:0,linePosition:0,linePath:0,lineFeature:0,polygonPosition:0,polygonObject:0,polygonRing:0,polygonFeature:0,feature:0};for(const u of t){const t=u.geometry,e=u.properties||{};switch(t.type){case"Point":i(t,S,P,w,e),S.properties.push(p(e,b)),_&&S.fields.push({id:u.id}),P.pointFeature++;break;case"LineString":a(t,A,P,w,e),A.properties.push(p(e,b)),_&&A.fields.push({id:u.id}),P.lineFeature++;break;case"Polygon":l(t,E,P,w,e),E.properties.push(p(e,b)),_&&E.fields.push({id:u.id}),P.polygonFeature++;break;default:throw new Error("Invalid geometry type")}P.feature++}return function(t,e,n,r){const o={shape:"binary-feature-collection",points:{...t,positions:{value:t.positions,size:r},globalFeatureIds:{value:t.globalFeatureIds,size:1},featureIds:{value:t.featureIds,size:1},numericProps:u(t.numericProps,1)},lines:{...e,positions:{value:e.positions,size:r},pathIndices:{value:e.pathIndices,size:1},globalFeatureIds:{value:e.globalFeatureIds,size:1},featureIds:{value:e.featureIds,size:1},numericProps:u(e.numericProps,1)},polygons:{...n,positions:{value:n.positions,size:r},polygonIndices:{value:n.polygonIndices,size:1},primitivePolygonIndices:{value:n.primitivePolygonIndices,size:1},globalFeatureIds:{value:n.globalFeatureIds,size:1},featureIds:{value:n.featureIds,size:1},numericProps:u(n.numericProps,1)}};o.polygons&&n.triangles&&(o.polygons.triangles={value:new Uint32Array(n.triangles),size:1});return o}(S,A,E,w)}(t,{propArrayTypes:r,...e},{numericPropKeys:n&&n.numericPropKeys||o,PositionDataType:n?n.PositionDataType:Float32Array,triangulate:!n||n.triangulate})}function s(t){const e={};for(const n of t)if(n.properties)for(const t in n.properties){const r=n.properties[t];e[t]=d(r,e[t])}return e}function i(t,e,n,r,o){e.positions.set(t.data,n.pointPosition*r);const s=t.data.length/r;h(e,o,n.pointPosition,s),e.globalFeatureIds.fill(n.feature,n.pointPosition,n.pointPosition+s),e.featureIds.fill(n.pointFeature,n.pointPosition,n.pointPosition+s),n.pointPosition+=s}function a(t,e,n,r,o){e.positions.set(t.data,n.linePosition*r);const s=t.data.length/r;h(e,o,n.linePosition,s),e.globalFeatureIds.fill(n.feature,n.linePosition,n.linePosition+s),e.featureIds.fill(n.lineFeature,n.linePosition,n.linePosition+s);for(let i=0,a=t.indices.length;i<a;++i){const o=t.indices[i],s=i===a-1?t.data.length:t.indices[i+1];e.pathIndices[n.linePath++]=n.linePosition,n.linePosition+=(s-o)/r}}function l(t,e,n,r,o){e.positions.set(t.data,n.polygonPosition*r);const s=t.data.length/r;h(e,o,n.polygonPosition,s),e.globalFeatureIds.fill(n.feature,n.polygonPosition,n.polygonPosition+s),e.featureIds.fill(n.polygonFeature,n.polygonPosition,n.polygonPosition+s);for(let i=0,a=t.indices.length;i<a;++i){const o=n.polygonPosition;e.polygonIndices[n.polygonObject++]=o;const s=t.areas[i],a=t.indices[i],l=t.indices[i+1];for(let i=0,c=a.length;i<c;++i){const o=a[i],s=i===c-1?void 0===l?t.data.length:l[0]:a[i+1];e.primitivePolygonIndices[n.polygonRing++]=n.polygonPosition,n.polygonPosition+=(s-o)/r}c(e,s,a,{startPosition:o,endPosition:n.polygonPosition,coordLength:r})}}function c(t,e,n,o){let{startPosition:s,endPosition:i,coordLength:a}=o;if(!t.triangles)return;const l=s*a,c=i*a,u=t.positions.subarray(l,c),h=n[0],p=n.slice(1).map((t=>(t-h)/a)),d=(0,r.OT)(u,p,a,e);for(let r=0,f=d.length;r<f;++r)t.triangles.push(s+d[r])}function u(t,e){const n={};for(const r in t)n[r]={value:t[r],size:e};return n}function h(t,e,n,r){for(const o in t.numericProps)if(o in e){const s=e[o];t.numericProps[o].fill(s,n,n+r)}}function p(t,e){const n={};for(const r in t)e.includes(r)||(n[r]=t[r]);return n}function d(t,e){return e!==Array&&Number.isFinite(t)?e===Float64Array||Math.fround(t)!==t?Float64Array:Float32Array:Array}},9143:(t,e,n)=>{n.d(e,{T:()=>c});var r=n(50533);function o(t,e){return void 0===e&&(e={coordLength:2,fixRingWinding:!0}),t.map((t=>function(t,e){const{geometry:n}=t;if("GeometryCollection"===n.type)throw new Error("GeometryCollection type not supported");const r=[],o=[];let l,c;switch(n.type){case"Point":c="Point",s(n.coordinates,r,o,e);break;case"MultiPoint":c="Point",n.coordinates.map((t=>s(t,r,o,e)));break;case"LineString":c="LineString",i(n.coordinates,r,o,e);break;case"MultiLineString":c="LineString",n.coordinates.map((t=>i(t,r,o,e)));break;case"Polygon":c="Polygon",l=[],a(n.coordinates,r,o,l,e);break;case"MultiPolygon":c="Polygon",l=[],n.coordinates.map((t=>a(t,r,o,l,e)));break;default:throw new Error(`Unknown type: ${c}`)}return{...t,geometry:{type:c,indices:o,data:r,areas:l}}}(t,e)))}function s(t,e,n,r){n.push(e.length),e.push(...t);for(let o=t.length;o<r.coordLength;o++)e.push(0)}function i(t,e,n,r){n.push(e.length);for(const o of t){e.push(...o);for(let t=o.length;t<r.coordLength;t++)e.push(0)}}function a(t,e,n,o,s){let a=0;const l=[],c=[];for(const u of t){const t=u.map((t=>t.slice(0,2)));let n=(0,r.ap)(t.flat());const o=n<0;s.fixRingWinding&&(0===a&&!o||a>0&&o)&&(u.reverse(),n=-n),l.push(n),i(u,e,c,s),a++}a>0&&(o.push(l),n.push(c))}var l=n(43319);function c(t,e){void 0===e&&(e={fixRingWinding:!0,triangulate:!0});const n=function(t){let e=0,n=0,r=0,o=0,s=0,i=0,a=0,l=0,c=0;const u=new Set;for(const h of t){const t=h.geometry;switch(t.type){case"Point":n++,e++,u.add(t.coordinates.length);break;case"MultiPoint":n++,e+=t.coordinates.length;for(const e of t.coordinates)u.add(e.length);break;case"LineString":s++,r+=t.coordinates.length,o++;for(const e of t.coordinates)u.add(e.length);break;case"MultiLineString":s++;for(const e of t.coordinates){r+=e.length,o++;for(const t of e)u.add(t.length)}break;case"Polygon":c++,a++,l+=t.coordinates.length;const h=t.coordinates.flat();i+=h.length;for(const t of h)u.add(t.length);break;case"MultiPolygon":c++;for(const e of t.coordinates){a++,l+=e.length;const t=e.flat();i+=t.length;for(const e of t)u.add(e.length)}break;default:throw new Error(`Unsupported geometry type: ${t.type}`)}}return{coordLength:u.size>0?Math.max(...u):2,pointPositionsCount:e,pointFeaturesCount:n,linePositionsCount:r,linePathsCount:o,lineFeaturesCount:s,polygonPositionsCount:i,polygonObjectsCount:a,polygonRingsCount:l,polygonFeaturesCount:c}}(t),r=n.coordLength,{fixRingWinding:s}=e,i=o(t,{coordLength:r,fixRingWinding:s});return(0,l.E)(i,n,{numericPropKeys:e.numericPropKeys,PositionDataType:e.PositionDataType||Float32Array,triangulate:e.triangulate})}},35199:(t,e,n)=>{n.d(e,{S:()=>_});const r="undefined"!=typeof __VERSION__?__VERSION__:"latest";var o=n(10517),s=n(82707);const i=globalThis.loaders?.parseImageNode,a="undefined"!=typeof Image,l="undefined"!=typeof ImageBitmap,c=Boolean(i),u=!!s.jU||c;var h=n(62713);const p=/^data:image\/svg\+xml/,d=/\.svg((\?|#).*)?$/;function f(t){return t&&(p.test(t)||d.test(t))}function g(t,e){if(f(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function m(t,e,n){const r=function(t,e){if(f(e)){let e=(new TextDecoder).decode(t);try{"function"==typeof unescape&&"function"==typeof encodeURIComponent&&(e=unescape(encodeURIComponent(e)))}catch(n){throw new Error(n.message)}return`data:image/svg+xml;base64,${btoa(e)}`}return g(t,e)}(t,n),o=self.URL||self.webkitURL,s="string"!=typeof r&&o.createObjectURL(r);try{return await async function(t,e){const n=new Image;if(n.src=t,e.image&&e.image.decode&&n.decode)return await n.decode(),n;return await new Promise(((t,e)=>{try{n.onload=()=>t(n),n.onerror=t=>{const n=t instanceof Error?t.message:"error";e(new Error(n))}}catch(r){e(r)}}))}(s||r,e)}finally{s&&o.revokeObjectURL(s)}}var y=n(25108);const w={};let b=!0;async function v(t,e,n){let r;if(f(n)){r=await m(t,e,n)}else r=g(t,n);const o=e&&e.imagebitmap;return await async function(t,e){void 0===e&&(e=null);!function(t){for(const e in t||w)return!1;return!0}(e)&&b||(e=null);if(e)try{return await createImageBitmap(t,e)}catch(n){y.warn(n),b=!1}return await createImageBitmap(t)}(r,o)}var x=n(99377);const _={dataType:null,batchType:null,id:"image",module:"images",name:"Images",version:r,mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],parse:async function(t,e,n){const r=((e=e||{}).image||{}).type||"auto",{url:s}=n||{};let i;switch(function(t){switch(t){case"auto":case"data":return function(){if(l)return"imagebitmap";if(a)return"image";if(u)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return function(t){switch(t){case"auto":return l||a||u;case"imagebitmap":return l;case"image":return a;case"data":return u;default:throw new Error(`@loaders.gl/images: image ${t} not supported in this environment`)}}(t),t}}(r)){case"imagebitmap":i=await v(t,e,s);break;case"image":i=await m(t,e,s);break;case"data":i=await async function(t,e){const{mimeType:n}=(0,x.I)(t)||{},r=globalThis.loaders?.parseImageNode;return(0,o.h)(r),await r(t,n)}(t);break;default:(0,o.h)(!1)}return"data"===r&&(i=(0,h.n$)(i)),i},tests:[t=>Boolean((0,x.I)(new DataView(t)))],options:{image:{type:"auto",decode:!0}}}},99377:(t,e,n)=>{function r(t){return function(t,e,n){void 0===n&&(n=0);const r=(o=e,[...o].map((t=>t.charCodeAt(0))));var o;for(let s=0;s<r.length;++s)if(r[s]!==t[s+n])return!1;return!0}(t,"ftyp",4)?0==(96&t[8])?null:function(t){switch((e=t,n=8,r=12,String.fromCharCode(...e.slice(n,r))).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}var e,n,r}(t):null}n.d(e,{I:()=>i});const o=!1,s=!0;function i(t){const e=a(t);return function(t){const e=a(t),n=e.byteLength>=24&&2303741511===e.getUint32(0,o);if(!n)return null;return{mimeType:"image/png",width:e.getUint32(16,o),height:e.getUint32(20,o)}}(e)||function(t){const e=a(t),n=e.byteLength>=3&&65496===e.getUint16(0,o)&&255===e.getUint8(2);if(!n)return null;const{tableMarkers:r,sofMarkers:s}=function(){const t=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)t.add(n);const e=new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502]);return{tableMarkers:t,sofMarkers:e}}();let i=2;for(;i+9<e.byteLength;){const t=e.getUint16(i,o);if(s.has(t))return{mimeType:"image/jpeg",height:e.getUint16(i+5,o),width:e.getUint16(i+7,o)};if(!r.has(t))return null;i+=2,i+=e.getUint16(i,o)}return null}(e)||function(t){const e=a(t),n=e.byteLength>=10&&1195984440===e.getUint32(0,o);if(!n)return null;return{mimeType:"image/gif",width:e.getUint16(6,s),height:e.getUint16(8,s)}}(e)||function(t){const e=a(t),n=e.byteLength>=14&&16973===e.getUint16(0,o)&&e.getUint32(2,s)===e.byteLength;if(!n)return null;return{mimeType:"image/bmp",width:e.getUint32(18,s),height:e.getUint32(22,s)}}(e)||function(t){const e=new Uint8Array(t instanceof DataView?t.buffer:t),n=r(e);if(!n)return null;return{mimeType:n.mimeType,width:0,height:0}}(e)}function a(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}},62713:(t,e,n)=>{function r(t){const e=s(t);if(!e)throw new Error("Not an image");return e}function o(t){switch(r(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function s(t){return"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap?"imagebitmap":"undefined"!=typeof Image&&t instanceof Image?"image":t&&"object"==typeof t&&t.data&&t.width&&t.height?"data":null}n.d(e,{n$:()=>o})},77420:(t,e,n)=>{function r(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const r=new Uint8Array(t),o=new Uint8Array(e);for(let s=0;s<r.length;++s)if(r[s]!==o[s])return!1;return!0}function o(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(t){const e=t.map((t=>t instanceof ArrayBuffer?new Uint8Array(t):t)),n=e.reduce(((t,e)=>t+e.byteLength),0),r=new Uint8Array(n);let o=0;for(const s of e)r.set(s,o),o+=s.byteLength;return r.buffer}(e)}function s(t,e,n){const r=void 0!==n?new Uint8Array(t).subarray(e,e+n):new Uint8Array(t).subarray(e);return new Uint8Array(r).buffer}n.d(e,{JY:()=>o,Xq:()=>r,qv:()=>s})},59045:(t,e,n)=>{function r(t){if((e=t)&&"object"==typeof e&&e.isBuffer)return t;var e;if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return 0===t.byteOffset&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if("string"==typeof t){const e=t;return(new TextEncoder).encode(e).buffer}if(t&&"object"==typeof t&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}n.d(e,{rJ:()=>r})},10517:(t,e,n)=>{function r(t,e){if(!t)throw new Error(e||"loader assertion failed.")}n.d(e,{h:()=>r})},82707:(t,e,n)=>{n.d(e,{jU:()=>o});var r=n(34155);"undefined"!=typeof self&&self,"undefined"!=typeof window&&window,void 0!==n.g&&n.g,"undefined"!=typeof document&&document;const o=Boolean("object"!=typeof r||"[object process]"!==String(r)||r.browser),s=void 0!==r&&r.version&&/v([0-9]*)/.exec(r.version);s&&parseFloat(s[1])},92013:(t,e,n)=>{n.d(e,{Ed:()=>o,GZ:()=>s});var r=n(77420);async function o(t,e){for(;;){const{done:n,value:r}=await t.next();if(n)return void t.return();if(e(r))return}}async function s(t){const e=[];for await(const n of t)e.push(n);return(0,r.JY)(...e)}},98754:(t,e,n)=>{function r(t,e){try{return void 0===e&&(e={}),async function*(){const n=new TextDecoder(void 0,e);for await(const e of t)yield"string"==typeof e?e:n.decode(e,{stream:!0})}()}catch(n){return Promise.reject(n)}}async function*o(t){let e="";for await(const n of t){let t;for(e+=n;(t=e.indexOf("\n"))>=0;){const n=e.slice(0,t+1);e=e.slice(t+1),yield n}}e.length>0&&(yield e)}n.d(e,{JT:()=>o,wh:()=>r})},89121:(t,e,n)=>{n.d(e,{c:()=>i});var r=n(79962);const o="undefined"!=typeof __VERSION__?__VERSION__:"latest",s=o[0]>="0"&&o[0]<="9"?`v${o}`:"";const i=function(){const t=new r.Z({id:"loaders.gl"});return globalThis.loaders=globalThis.loaders||{},globalThis.loaders.log=t,globalThis.loaders.version=s,globalThis.probe=globalThis.probe||{},globalThis.probe.loaders=t,t}()},3895:(t,e,n)=>{function r(t,e){return o(t||{},e)}function o(t,e,n){if(void 0===n&&(n=0),n>3)return e;const r={...t};for(const[s,i]of Object.entries(e))i&&"object"==typeof i&&!Array.isArray(i)?r[s]=o(r[s]||{},e[s],n+1):r[s]=e[s];return r}n.d(e,{N:()=>r})},36642:(t,e,n)=>{n.d(e,{i3:()=>s});let r="";const o={};function s(t){for(const e in o)if(t.startsWith(e)){const n=o[e];t=t.replace(e,n)}return t.startsWith("http://")||t.startsWith("https://")||(t=`${r}${t}`),t}},25083:(t,e,n)=>{n.d(e,{XX:()=>i,vB:()=>s,DB:()=>a});var r=n(34155);function o(){if(void 0!==r&&void 0!==r.cwd)return r.cwd();const t=window.location?.pathname;return t?.slice(0,t.lastIndexOf("/")+1)||""}function s(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(e+1):""}function i(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(0,e):""}function a(){const t=[];for(let o=0;o<arguments.length;o++)t[o]=o<0||arguments.length<=o?void 0:arguments[o];let e,n="",r=!1;for(let s=t.length-1;s>=-1&&!r;s--){let i;s>=0?i=t[s]:(void 0===e&&(e=o()),i=e),0!==i.length&&(n=`${i}/${n}`,r=i.charCodeAt(0)===l)}return n=function(t,e){let n,r="",o=-1,s=0,i=!1;for(let a=0;a<=t.length;++a){if(a<t.length)n=t.charCodeAt(a);else{if(n===l)break;n=l}if(n===l){if(o===a-1||1===s);else if(o!==a-1&&2===s){if(r.length<2||!i||r.charCodeAt(r.length-1)!==c||r.charCodeAt(r.length-2)!==c)if(r.length>2){const t=r.length-1;let e=t;for(;e>=0&&r.charCodeAt(e)!==l;--e);if(e!==t){r=-1===e?"":r.slice(0,e),o=a,s=0,i=!1;continue}}else if(2===r.length||1===r.length){r="",o=a,s=0,i=!1;continue}e&&(r.length>0?r+="/..":r="..",i=!0)}else{const e=t.slice(o+1,a);r.length>0?r+=`/${e}`:r=e,i=!1}o=a,s=0}else n===c&&-1!==s?++s:s=-1}return r}(n,!r),r?`/${n}`:n.length>0?n:"."}const l=47,c=46},17663:(t,e,n)=>{n.d(e,{Z:()=>s});var r=n(8700);const o={id:"request-scheduler",throttleRequests:!0,maxRequests:6,debounceTime:0};class s{activeRequestCount=0;requestQueue=[];requestMap=new Map;updateTimer=null;constructor(t){void 0===t&&(t={}),this.props={...o,...t},this.stats=new r.jk({id:this.props.id}),this.stats.get("Queued Requests"),this.stats.get("Active Requests"),this.stats.get("Cancelled Requests"),this.stats.get("Queued Requests Ever"),this.stats.get("Active Requests Ever")}scheduleRequest(t,e){if(void 0===e&&(e=()=>0),!this.props.throttleRequests)return Promise.resolve({done:()=>{}});if(this.requestMap.has(t))return this.requestMap.get(t);const n={handle:t,priority:0,getPriority:e},r=new Promise((t=>(n.resolve=t,n)));return this.requestQueue.push(n),this.requestMap.set(t,r),this._issueNewRequests(),r}_issueRequest(t){const{handle:e,resolve:n}=t;let r=!1;const o=()=>{r||(r=!0,this.requestMap.delete(e),this.activeRequestCount--,this._issueNewRequests())};return this.activeRequestCount++,n?n({done:o}):Promise.resolve({done:o})}_issueNewRequests(){null!==this.updateTimer&&clearTimeout(this.updateTimer),this.updateTimer=setTimeout((()=>this._issueNewRequestsAsync()),this.props.debounceTime)}_issueNewRequestsAsync(){null!==this.updateTimer&&clearTimeout(this.updateTimer),this.updateTimer=null;const t=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(0!==t){this._updateAllRequests();for(let e=0;e<t;++e){const t=this.requestQueue.shift();t&&this._issueRequest(t)}}}_updateAllRequests(){const t=this.requestQueue;for(let e=0;e<t.length;++e){const n=t[e];this._updateRequest(n)||(t.splice(e,1),this.requestMap.delete(n.handle),e--)}t.sort(((t,e)=>t.priority-e.priority))}_updateRequest(t){return t.priority=t.getPriority(t.handle),!(t.priority<0)||(t.resolve(null),!1)}}},19193:(t,e,n)=>{n.d(e,{o:()=>r});class r{_needsRefresh=!0;constructor(t){this.props={...t},this.loadOptions={...t.loadOptions},this.fetch=function(t){const e=t?.fetch;if(e&&"function"==typeof e)return(t,n)=>e(t,n);const n=t?.fetch;if(n&&"function"!=typeof n)return t=>fetch(t,n);return t=>fetch(t)}(this.loadOptions)}setProps(t){this.props=Object.assign(this.props,t),this.setNeedsRefresh()}setNeedsRefresh(){this._needsRefresh=!0}getNeedsRefresh(t){void 0===t&&(t=!0);const e=this._needsRefresh;return t&&(this._needsRefresh=!1),e}}},44866:(t,e,n)=>{n.d(e,{P7:()=>c,PX:()=>a,g9:()=>i,lk:()=>s,wy:()=>u,xj:()=>l});var r=n(50533);function o(t){let e=0;for(let n,r,o=0,s=t.length-1;o<t.length;s=o++)n=t[o],r=t[s],e+=(r[0]-n[0])*(n[1]+r[1]);return e}function s(t,e){if(Array.isArray(t[0])){for(const n of t)s(n,e);return}const n=t;n[0]/=e,n[1]/=e}function i(t,e){for(let n=0;n<t.length;++n)t[n]/=e}function a(t,e,n){if("number"!=typeof t[0][0]){for(const r of t)a(r,e,n);return}const r=n*Math.pow(2,e.z),o=n*e.x,s=n*e.y;for(let i=0;i<t.length;i++){const e=t[i];e[0]=360*(e[0]+o)/r-180;const n=180-360*(e[1]+s)/r;e[1]=360/Math.PI*Math.atan(Math.exp(n*Math.PI/180))-90}}function l(t,e,n){const{x:r,y:o,z:s}=e,i=n*Math.pow(2,s),a=n*r,l=n*o;for(let c=0,u=t.length;c<u;c+=2){t[c]=360*(t[c]+a)/i-180;const e=180-360*(t[c+1]+l)/i;t[c+1]=360/Math.PI*Math.atan(Math.exp(e*Math.PI/180))-90}}function c(t){const e=t.length;if(e<=1)return[t];const n=[];let r,s;for(let i=0;i<e;i++){const e=o(t[i]);0!==e&&(void 0===s&&(s=e<0),s===e<0?(r&&n.push(r),r=[t[i]]):r&&r.push(t[i]))}return r&&n.push(r),n}function u(t){const e=t.indices.length,n="Polygon";if(e<=1)return{type:n,data:t.data,areas:[[(0,r.ap)(t.data)]],indices:[t.indices]};const o=[],s=[];let i,a=[],l=[],c=0;for(let u,h,p=0;p<e;p++){h=t.indices[p]-c,u=t.indices[p+1]-c||t.data.length;const e=t.data.slice(h,u),n=(0,r.ap)(e);if(0!==n)void 0===i&&(i=n<0),i===n<0?(l.length&&(o.push(a),s.push(l)),l=[h],a=[n]):(a.push(n),l.push(h));else{const e=t.data.slice(0,h),n=t.data.slice(u);t.data=e.concat(n),c+=u-h}}return a&&o.push(a),l.length&&s.push(l),{type:n,areas:o,indices:s,data:t.data}}},99031:(t,e,n)=>{n.d(e,{Y:()=>x,D:()=>v});var r=n(43319),o=n(89121),s=n(3614),i=n.n(s),a=n(44866);class l{static types=["Unknown","Point","LineString","Polygon"];constructor(t,e,n,r,o,s){this.properties={},this.extent=n,this.type=0,this.id=null,this._pbf=t,this._geometry=-1,this._keys=r,this._values=o,this._geometryInfo=s,t.readFields(u,this,e)}toGeoJSONFeature(t,e){const n=this.loadGeometry();return c(this,n,"wgs84"===t?t=>(0,a.PX)(t,e,this.extent):a.lk)}toBinaryFeature(t,e){const n=this.loadFlatGeometry();return"wgs84"===t?this._toBinaryCoordinates(n,(t=>(0,a.xj)(t,e,this.extent))):this._toBinaryCoordinates(n,a.g9)}bbox(){const t=this._pbf;t.pos=this._geometry;const e=t.readVarint()+t.pos;let n=1,r=0,o=0,s=0,i=1/0,a=-1/0,l=1/0,c=-1/0;for(;t.pos<e;){if(r<=0){const e=t.readVarint();n=7&e,r=e>>3}if(r--,1===n||2===n)o+=t.readSVarint(),s+=t.readSVarint(),o<i&&(i=o),o>a&&(a=o),s<l&&(l=s),s>c&&(c=s);else if(7!==n)throw new Error(`unknown command ${n}`)}return[i,l,a,c]}_toBinaryCoordinates(t,e){let n;e(t.data,this.extent);switch(this.type){case 1:this._geometryInfo.pointFeaturesCount++,this._geometryInfo.pointPositionsCount+=t.indices.length,n={type:"Point",...t};break;case 2:this._geometryInfo.lineFeaturesCount++,this._geometryInfo.linePathsCount+=t.indices.length,this._geometryInfo.linePositionsCount+=t.data.length/2,n={type:"LineString",...t};break;case 3:n=(0,a.wy)(t),this._geometryInfo.polygonFeaturesCount++,this._geometryInfo.polygonObjectsCount+=n.indices.length;for(const t of n.indices)this._geometryInfo.polygonRingsCount+=t.length;this._geometryInfo.polygonPositionsCount+=n.data.length/2;break;default:throw new Error(`Invalid geometry type: ${this.type}`)}const r={type:"Feature",geometry:n,properties:this.properties};return null!==this.id&&(r.id=this.id),r}loadGeometry(){const t=this._pbf;t.pos=this._geometry;const e=t.readVarint()+t.pos;let n=1,r=0,o=0,s=0;const i=[];let a;for(;t.pos<e;){if(r<=0){const e=t.readVarint();n=7&e,r=e>>3}switch(r--,n){case 1:case 2:o+=t.readSVarint(),s+=t.readSVarint(),1===n&&(a&&i.push(a),a=[]),a&&a.push([o,s]);break;case 7:a&&a.push(a[0].slice());break;default:throw new Error(`unknown command ${n}`)}}return a&&i.push(a),i}loadFlatGeometry(){const t=this._pbf;t.pos=this._geometry;const e=t.readVarint()+t.pos;let n,r=1,o=0,s=0,i=0,a=0;const l=[],c=[];for(;t.pos<e;)if(o<=0&&(n=t.readVarint(),r=7&n,o=n>>3),o--,1===r||2===r)s+=t.readSVarint(),i+=t.readSVarint(),1===r&&l.push(a),c.push(s,i),a+=2;else{if(7!==r)throw new Error(`unknown command ${r}`);if(a>0){const t=l[l.length-1];c.push(c[t],c[t+1]),a+=2}}return{data:c,indices:l}}}function c(t,e,n){let r,o,s,i=l.types[t.type];switch(t.type){case 1:const i=[];for(r=0;r<e.length;r++)i[r]=e[r][0];s=i,n(s,t.extent);break;case 2:for(s=e,r=0;r<s.length;r++)n(s[r],t.extent);break;case 3:for(s=(0,a.P7)(e),r=0;r<s.length;r++)for(o=0;o<s[r].length;o++)n(s[r][o],t.extent);break;default:throw new Error("illegal vector tile type")}1===s.length?s=s[0]:i=`Multi${i}`;const c={type:"Feature",geometry:{type:i,coordinates:s},properties:t.properties};return null!==t.id&&(c.properties||={},c.properties.id=t.id),c}function u(t,e,n){e&&n&&(1===t?e.id=n.readVarint():2===t?function(t,e){const n=t.readVarint()+t.pos;for(;t.pos<n;){const n=e._keys[t.readVarint()],r=e._values[t.readVarint()];e.properties[n]=r}}(n,e):3===t?e.type=n.readVarint():4===t&&(e._geometry=n.pos))}class h{constructor(t,e){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(p,this,e),this.length=this._features.length}getGeoJSONFeature(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];const e=this._pbf.readVarint()+this._pbf.pos;return new l(this._pbf,e,this.extent,this._keys,this._values)}getBinaryFeature(t,e){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];const n=this._pbf.readVarint()+this._pbf.pos;return new l(this._pbf,n,this.extent,this._keys,this._values,e)}}function p(t,e,n){e&&n&&(15===t?e.version=n.readVarint():1===t?e.name=n.readString():5===t?e.extent=n.readVarint():2===t?e._features.push(n.pos):3===t?e._keys.push(n.readString()):4===t&&e._values.push(function(t){let e=null;const n=t.readVarint()+t.pos;for(;t.pos<n;){const n=t.readVarint()>>3;e=1===n?t.readString():2===n?t.readFloat():3===n?t.readDouble():4===n?t.readVarint64():5===n?t.readVarint():6===n?t.readSVarint():7===n?t.readBoolean():null}return e}(n)))}class d{constructor(t,e){this.layers=t.readFields(f,{},e)}}function f(t,e,n){if(3===t&&n){const t=new h(n,n.readVarint()+n.pos);t.length&&e&&(e[t.name]=t)}}function g(t,e){const n=function(t){if(!t?.mvt)throw new Error("mvt options required");if("wgs84"===t.mvt?.coordinates&&!t.mvt.tileIndex)throw new Error("MVT Loader: WGS84 coordinates need tileIndex property");t.gis&&o.c.warn('MVTLoader: "options.gis" is deprecated, use "options.mvt.shape" instead')();return t.mvt}(e),r=e?.gis?.format||e?.mvt?.shape||e?.shape;switch(r){case"columnar-table":return{shape:"columnar-table",data:m(t,n)};case"geojson-table":return{shape:"geojson-table",type:"FeatureCollection",features:y(t,n)};case"geojson":return y(t,n);case"binary-geometry":case"binary":return m(t,n);default:throw new Error(r||"undefined shape")}}function m(t,e){const[n,o]=function(t,e){const n=[],r={coordLength:2,pointPositionsCount:0,pointFeaturesCount:0,linePositionsCount:0,linePathsCount:0,lineFeaturesCount:0,polygonPositionsCount:0,polygonObjectsCount:0,polygonRingsCount:0,polygonFeaturesCount:0};if(t.byteLength<=0)return[n,r];const o=new d(new(i())(t)),s=e&&Array.isArray(e.layers)?e.layers:Object.keys(o.layers);return s.forEach((t=>{const s=o.layers[t];if(s)for(let o=0;o<s.length;o++){const i=b(s.getBinaryFeature(o,r),e,t);n.push(i)}})),[n,r]}(t,e),s=(0,r.E)(n,o);return s.byteLength=t.byteLength,s}function y(t,e){if(t.byteLength<=0)return[];const n=[],r=new d(new(i())(t));return(Array.isArray(e.layers)?e.layers:Object.keys(r.layers)).forEach((t=>{const o=r.layers[t];if(o)for(let r=0;r<o.length;r++){const s=w(o.getGeoJSONFeature(r),e,t);n.push(s)}})),n}function w(t,e,n){const r=t.toGeoJSONFeature(e.coordinates||"local",e.tileIndex);return e.layerProperty&&(r.properties||={},r.properties[e.layerProperty]=n),r}function b(t,e,n){const r=t.toBinaryFeature(e.coordinates||"local",e.tileIndex);return e.layerProperty&&r.properties&&(r.properties[e.layerProperty]=n),r}const v={dataType:null,batchType:null,name:"Mapbox Vector Tile",id:"mvt",module:"mvt",version:"undefined"!=typeof __VERSION__?__VERSION__:"latest",extensions:["mvt","pbf"],mimeTypes:["application/vnd.mapbox-vector-tile","application/x-protobuf"],worker:!0,category:"geometry",options:{mvt:{shape:"geojson",coordinates:"local",layerProperty:"layerName",layers:void 0,tileIndex:void 0}}},x={...v,parse:async(t,e)=>g(t,e),parseSync:g,binary:!0}},31531:(t,e,n)=>{function r(t,e){return void 0===e&&(e="float32"),t instanceof Date?"date-millisecond":t instanceof Number?e:"string"==typeof t?"utf8":"null"}function o(t){let e=s(t);return"null"!==e?{type:e,nullable:!1}:t.length>0?(e=r(t[0]),{type:e,nullable:!0}):{type:"null",nullable:!0}}function s(t){switch(t.constructor){case Int8Array:return"int8";case Uint8Array:case Uint8ClampedArray:return"uint8";case Int16Array:return"int16";case Uint16Array:return"uint16";case Int32Array:return"int32";case Uint32Array:return"uint32";case Float32Array:return"float32";case Float64Array:return"float64";default:return"null"}}function i(t,e){if(!e)switch(t){case"int8":return Int8Array;case"uint8":return Uint8Array;case"int16":return Int16Array;case"uint16":return Uint16Array;case"int32":return Int32Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array}return Array}n.d(e,{Aw:()=>i,C9:()=>s,gU:()=>o,vE:()=>r})},7233:(t,e,n)=>{n.d(e,{d:()=>o});var r=n(31531);function o(t){switch(t.shape){case"array-row-table":case"object-row-table":return i(t.data);case"geojson-table":return function(t){if(!t.length)throw new Error("deduce from empty table");const e=[],n=t[0].properties||{};for(const[r,o]of Object.entries(n))e.push(l(o,r));return{fields:e,metadata:{}}}(t.features);case"columnar-table":return s(t.data);default:throw new Error("Deduce schema")}}function s(t){const e=[];for(const[n,r]of Object.entries(t)){const t=a(r,n);e.push(t)}return{fields:e,metadata:{}}}function i(t){if(!t.length)throw new Error("deduce from empty table");const e=[],n=t[0];for(const[r,o]of Object.entries(n))e.push(l(o,r));return{fields:e,metadata:{}}}function a(t,e){if(ArrayBuffer.isView(t)){const n=(0,r.gU)(t);return{name:e,type:n.type||"null",nullable:n.nullable}}if(Array.isArray(t)&&t.length>0){const n=t[0];return{name:e,type:(0,r.vE)(n),nullable:!0}}throw new Error("empty table")}function l(t,e){return{name:e,type:(0,r.vE)(t),nullable:!0}}},6408:(t,e,n)=>{function r(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}n.d(e,{h:()=>r})},60076:(t,e,n)=>{n.d(e,{hJ:()=>s,jU:()=>o,tq:()=>i});var r=n(34155);"undefined"!=typeof self&&self,"undefined"!=typeof window&&window,void 0!==n.g&&n.g,"undefined"!=typeof document&&document;const o="object"!=typeof r||"[object process]"!==String(r)||r.browser,s="function"==typeof importScripts,i="undefined"!=typeof window&&void 0!==window.orientation,a=void 0!==r&&r.version&&/v([0-9]*)/.exec(r.version);a&&parseFloat(a[1])},25501:(t,e,n)=>{n.d(e,{e:()=>o,q:()=>s});var r=n(25108);const o="latest";const s=(globalThis._loadersgl_?.version||(globalThis._loadersgl_=globalThis._loadersgl_||{},"undefined"==typeof __VERSION__?(r.warn("loaders.gl: The __VERSION__ variable is not injected using babel plugin. Latest unstable workers would be fetched from the CDN."),globalThis._loadersgl_.version=o):globalThis._loadersgl_.version=__VERSION__),globalThis._loadersgl_.version)},55978:(t,e,n)=>{n.r(e),n.d(e,{assets:()=>c,contentTitle:()=>a,default:()=>p,frontMatter:()=>i,metadata:()=>l,toc:()=>u});var r=n(85893),o=n(11151),s=n(97531);const i={},a="TableTileSource",l={id:"tiles/table-tiler",title:"TableTileSource",description:"TableTileSource dynamically generates tiles from GeoJSON data loaded into the browser.",source:"@site/src/examples/tiles/table-tiler.mdx",sourceDirName:"tiles",slug:"/tiles/table-tiler",permalink:"/examples/tiles/table-tiler",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"examplesSidebar",previous:{title:"PMTiles",permalink:"/examples/tiles/pmtiles"},next:{title:"WMS",permalink:"/examples/tiles/wms"}},c={},u=[];function h(t){const e={a:"a",code:"code",h1:"h1",p:"p",strong:"strong",...(0,o.a)(),...t.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.h1,{id:"tabletilesource",children:"TableTileSource"}),"\n","\n",(0,r.jsx)("div",{style:{height:"100vh"},children:(0,r.jsx)(s.Z,{format:"GeoJSON",children:(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.a,{href:"/docs/modules/mvt/api-reference/table-tile-source",children:(0,r.jsx)(e.strong,{children:(0,r.jsx)(e.code,{children:"TableTileSource"})})})," dynamically ",(0,r.jsx)(e.strong,{children:"generates"})," tiles from GeoJSON data loaded into the browser."]})})})]})}function p(t={}){const{wrapper:e}={...(0,o.a)(),...t.components};return e?(0,r.jsx)(e,{...t,children:(0,r.jsx)(h,{...t})}):h(t)}}}]);