(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{"+Jdq":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={name:"pbr",vs:"uniform mat4 u_MVPMatrix;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_NormalMatrix;\n\nvarying vec3 pbr_vPosition;\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n# ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n# else\nvarying vec3 pbr_vNormal;\n# endif\n#endif\n\nvoid pbr_setPositionNormalTangentUV(vec4 position, vec4 normal, vec4 tangent, vec2 uv)\n{\n  vec4 pos = u_ModelMatrix * position;\n  pbr_vPosition = vec3(pos.xyz) / pos.w;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\n  vec3 normalW = normalize(vec3(u_NormalMatrix * vec4(normal.xyz, 0.0)));\n  vec3 tangentW = normalize(vec3(u_ModelMatrix * vec4(tangent.xyz, 0.0)));\n  vec3 bitangentW = cross(normalW, tangentW) * tangent.w;\n  pbr_vTBN = mat3(tangentW, bitangentW, normalW);\n#else\n  pbr_vNormal = normalize(vec3(u_ModelMatrix * vec4(normal.xyz, 0.0)));\n#endif\n#endif\n\n#ifdef HAS_UV\n  pbr_vUV = uv;\n#else\n  pbr_vUV = vec2(0.,0.);\n#endif\n}\n",fs:"#if defined(USE_TEX_LOD) && !defined(FEATURE_GLSL_TEXTURE_LOD)\n# error PBR fragment shader: Texture LOD is not available\n#endif\n\n#if !defined(HAS_TANGENTS) && !defined(FEATURE_GLSL_DERIVATIVES)\n# error PBR fragment shader: Derivatives are not available\n#endif\n\n\n#if (__VERSION__ < 300)\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL1COND; INCR)\n#else\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL2COND; INCR)\n#endif\n\nprecision highp float;\n\nuniform bool pbr_uUnlit;\n\n#ifdef USE_IBL\nuniform samplerCube u_DiffuseEnvSampler;\nuniform samplerCube u_SpecularEnvSampler;\nuniform sampler2D u_brdfLUT;\nuniform vec2 u_ScaleIBLAmbient;\n#endif\n\n#ifdef HAS_BASECOLORMAP\nuniform sampler2D u_BaseColorSampler;\n#endif\n#ifdef HAS_NORMALMAP\nuniform sampler2D u_NormalSampler;\nuniform float u_NormalScale;\n#endif\n#ifdef HAS_EMISSIVEMAP\nuniform sampler2D u_EmissiveSampler;\nuniform vec3 u_EmissiveFactor;\n#endif\n#ifdef HAS_METALROUGHNESSMAP\nuniform sampler2D u_MetallicRoughnessSampler;\n#endif\n#ifdef HAS_OCCLUSIONMAP\nuniform sampler2D u_OcclusionSampler;\nuniform float u_OcclusionStrength;\n#endif\n\n#ifdef ALPHA_CUTOFF\nuniform float u_AlphaCutoff;\n#endif\n\nuniform vec2 u_MetallicRoughnessValues;\nuniform vec4 u_BaseColorFactor;\n\nuniform vec3 u_Camera;\n#ifdef PBR_DEBUG\nuniform vec4 u_ScaleDiffBaseMR;\nuniform vec4 u_ScaleFGDSpec;\n#endif\n\nvarying vec3 pbr_vPosition;\n\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n#else\nvarying vec3 pbr_vNormal;\n#endif\n#endif\n\n\nstruct PBRInfo\n{\n  float NdotL;\n  float NdotV;\n  float NdotH;\n  float LdotH;\n  float VdotH;\n  float perceptualRoughness;\n  float metalness;\n  vec3 reflectance0;\n  vec3 reflectance90;\n  float alphaRoughness;\n  vec3 diffuseColor;\n  vec3 specularColor;\n  vec3 n;\n  vec3 v;\n};\n\nconst float M_PI = 3.141592653589793;\nconst float c_MinRoughness = 0.04;\n\nvec4 SRGBtoLINEAR(vec4 srgbIn)\n{\n#ifdef MANUAL_SRGB\n#ifdef SRGB_FAST_APPROXIMATION\n  vec3 linOut = pow(srgbIn.xyz,vec3(2.2));\n#else\n  vec3 bLess = step(vec3(0.04045),srgbIn.xyz);\n  vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );\n#endif\n  return vec4(linOut,srgbIn.w);;\n#else\n  return srgbIn;\n#endif\n}\n\nvec3 getNormal()\n{\n#ifndef HAS_TANGENTS\n  vec3 pos_dx = dFdx(pbr_vPosition);\n  vec3 pos_dy = dFdy(pbr_vPosition);\n  vec3 tex_dx = dFdx(vec3(pbr_vUV, 0.0));\n  vec3 tex_dy = dFdy(vec3(pbr_vUV, 0.0));\n  vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\n\n#ifdef HAS_NORMALS\n  vec3 ng = normalize(pbr_vNormal);\n#else\n  vec3 ng = cross(pos_dx, pos_dy);\n#endif\n\n  t = normalize(t - ng * dot(ng, t));\n  vec3 b = normalize(cross(ng, t));\n  mat3 tbn = mat3(t, b, ng);\n#else\n  mat3 tbn = pbr_vTBN;\n#endif\n\n#ifdef HAS_NORMALMAP\n  vec3 n = texture2D(u_NormalSampler, pbr_vUV).rgb;\n  n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_NormalScale, u_NormalScale, 1.0)));\n#else\n  vec3 n = normalize(tbn[2].xyz);\n#endif\n\n  return n;\n}\n\n\n#ifdef USE_IBL\nvec3 getIBLContribution(PBRInfo pbrInputs, vec3 n, vec3 reflection)\n{\n  float mipCount = 9.0;\n  float lod = (pbrInputs.perceptualRoughness * mipCount);\n  vec3 brdf = SRGBtoLINEAR(texture2D(u_brdfLUT,\n    vec2(pbrInputs.NdotV, 1.0 - pbrInputs.perceptualRoughness))).rgb;\n  vec3 diffuseLight = SRGBtoLINEAR(textureCube(u_DiffuseEnvSampler, n)).rgb;\n\n#ifdef USE_TEX_LOD\n  vec3 specularLight = SRGBtoLINEAR(textureCubeLod(u_SpecularEnvSampler, reflection, lod)).rgb;\n#else\n  vec3 specularLight = SRGBtoLINEAR(textureCube(u_SpecularEnvSampler, reflection)).rgb;\n#endif\n\n  vec3 diffuse = diffuseLight * pbrInputs.diffuseColor;\n  vec3 specular = specularLight * (pbrInputs.specularColor * brdf.x + brdf.y);\n  diffuse *= u_ScaleIBLAmbient.x;\n  specular *= u_ScaleIBLAmbient.y;\n\n  return diffuse + specular;\n}\n#endif\n\n\nvec3 diffuse(PBRInfo pbrInputs)\n{\n  return pbrInputs.diffuseColor / M_PI;\n}\n\nvec3 specularReflection(PBRInfo pbrInputs)\n{\n  return pbrInputs.reflectance0 +\n    (pbrInputs.reflectance90 - pbrInputs.reflectance0) *\n    pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);\n}\n\n\n\nfloat geometricOcclusion(PBRInfo pbrInputs)\n{\n  float NdotL = pbrInputs.NdotL;\n  float NdotV = pbrInputs.NdotV;\n  float r = pbrInputs.alphaRoughness;\n\n  float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));\n  float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));\n  return attenuationL * attenuationV;\n}\n\n\n\n\n\nfloat microfacetDistribution(PBRInfo pbrInputs)\n{\n  float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;\n  float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;\n  return roughnessSq / (M_PI * f * f);\n}\n\nvoid PBRInfo_setAmbientLight(inout PBRInfo pbrInputs) {\n  pbrInputs.NdotL = 1.0;\n  pbrInputs.NdotH = 0.0;\n  pbrInputs.LdotH = 0.0;\n  pbrInputs.VdotH = 1.0;\n}\n\nvoid PBRInfo_setDirectionalLight(inout PBRInfo pbrInputs, vec3 lightDirection) {\n  vec3 n = pbrInputs.n;\n  vec3 v = pbrInputs.v;\n  vec3 l = normalize(lightDirection);\n  vec3 h = normalize(l+v);\n\n  pbrInputs.NdotL = clamp(dot(n, l), 0.001, 1.0);\n  pbrInputs.NdotH = clamp(dot(n, h), 0.0, 1.0);\n  pbrInputs.LdotH = clamp(dot(l, h), 0.0, 1.0);\n  pbrInputs.VdotH = clamp(dot(v, h), 0.0, 1.0);\n}\n\nvoid PBRInfo_setPointLight(inout PBRInfo pbrInputs, PointLight pointLight) {\n  vec3 light_direction = normalize(pointLight.position - pbr_vPosition);\n  PBRInfo_setDirectionalLight(pbrInputs, light_direction);\n}\n\nvec3 calculateFinalColor(PBRInfo pbrInputs, vec3 lightColor) {\n  vec3 F = specularReflection(pbrInputs);\n  float G = geometricOcclusion(pbrInputs);\n  float D = microfacetDistribution(pbrInputs);\n  vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);\n  vec3 specContrib = F * G * D / (4.0 * pbrInputs.NdotL * pbrInputs.NdotV);\n  return pbrInputs.NdotL * lightColor * (diffuseContrib + specContrib);\n}\n\nvec4 pbr_filterColor(vec4 colorUnused)\n{\n#ifdef HAS_BASECOLORMAP\n  vec4 baseColor = SRGBtoLINEAR(texture2D(u_BaseColorSampler, pbr_vUV)) * u_BaseColorFactor;\n#else\n  vec4 baseColor = u_BaseColorFactor;\n#endif\n\n#ifdef ALPHA_CUTOFF\n  if (baseColor.a < u_AlphaCutoff) {\n    discard;\n  }\n#endif\n\n  vec3 color = vec3(0, 0, 0);\n\n  if(pbr_uUnlit){\n    color.rgb = baseColor.rgb;\n  }\n  else{\n\n\n    float perceptualRoughness = u_MetallicRoughnessValues.y;\n    float metallic = u_MetallicRoughnessValues.x;\n#ifdef HAS_METALROUGHNESSMAP\n\n    vec4 mrSample = texture2D(u_MetallicRoughnessSampler, pbr_vUV);\n    perceptualRoughness = mrSample.g * perceptualRoughness;\n    metallic = mrSample.b * metallic;\n#endif\n    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);\n    metallic = clamp(metallic, 0.0, 1.0);\n\n    float alphaRoughness = perceptualRoughness * perceptualRoughness;\n\n    vec3 f0 = vec3(0.04);\n    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);\n    diffuseColor *= 1.0 - metallic;\n    vec3 specularColor = mix(f0, baseColor.rgb, metallic);\n    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\n\n\n\n    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);\n    vec3 specularEnvironmentR0 = specularColor.rgb;\n    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;\n\n    vec3 n = getNormal();\n    vec3 v = normalize(u_Camera - pbr_vPosition);\n\n    float NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);\n    vec3 reflection = -normalize(reflect(v, n));\n\n    PBRInfo pbrInputs = PBRInfo(\n      0.0,\n      NdotV,\n      0.0,\n      0.0,\n      0.0,\n      perceptualRoughness,\n      metallic,\n      specularEnvironmentR0,\n      specularEnvironmentR90,\n      alphaRoughness,\n      diffuseColor,\n      specularColor,\n      n,\n      v\n    );\n\n#ifdef USE_LIGHTS\n    PBRInfo_setAmbientLight(pbrInputs);\n    color += calculateFinalColor(pbrInputs, lighting_uAmbientLight.color);\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uDirectionalLightCount, i++) {\n      if (i < lighting_uDirectionalLightCount) {\n        PBRInfo_setDirectionalLight(pbrInputs, lighting_uDirectionalLight[i].direction);\n        color += calculateFinalColor(pbrInputs, lighting_uDirectionalLight[i].color);\n      }\n    }\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uPointLightCount, i++) {\n      if (i < lighting_uPointLightCount) {\n        PBRInfo_setPointLight(pbrInputs, lighting_uPointLight[i]);\n        float attenuation = getPointLightAttenuation(lighting_uPointLight[i], distance(lighting_uPointLight[i].position, pbr_vPosition));\n        color += calculateFinalColor(pbrInputs, lighting_uPointLight[i].color / attenuation);\n      }\n    }\n#endif\n#ifdef USE_IBL\n    color += getIBLContribution(pbrInputs, n, reflection);\n#endif\n#ifdef HAS_OCCLUSIONMAP\n    float ao = texture2D(u_OcclusionSampler, pbr_vUV).r;\n    color = mix(color, color * ao, u_OcclusionStrength);\n#endif\n\n#ifdef HAS_EMISSIVEMAP\n    vec3 emissive = SRGBtoLINEAR(texture2D(u_EmissiveSampler, pbr_vUV)).rgb * u_EmissiveFactor;\n    color += emissive;\n#endif\n\n#ifdef PBR_DEBUG\n\n\n\n\n\n    color = mix(color, baseColor.rgb, u_ScaleDiffBaseMR.y);\n    color = mix(color, vec3(metallic), u_ScaleDiffBaseMR.z);\n    color = mix(color, vec3(perceptualRoughness), u_ScaleDiffBaseMR.w);\n#endif\n\n  }\n\n  return vec4(pow(color,vec3(1.0/2.2)), baseColor.a);\n}\n",defines:{LIGHTING_FRAGMENT:1},dependencies:[n("QPTa").a]}},IIFb:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("1OyB"),i=n("vuIU"),s=n("zXfU"),o=n("Nw31"),a=n("VdrS"),u=n("CxzY"),c=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(r.a)(this,e);var n=t.id;this.id=n||Object(a.c)(this.constructor.name),this.display=!0,this.position=new s.a,this.rotation=new s.a,this.scale=new s.a(1,1,1),this.matrix=new o.a,this.userData={},this.props={},this._setScenegraphNodeProps(t)}return Object(i.a)(e,[{key:"delete",value:function(){}},{key:"setProps",value:function(e){return this._setScenegraphNodeProps(e),this}},{key:"toString",value:function(){return"{type: ScenegraphNode, id: ".concat(this.id,")}")}},{key:"setPosition",value:function(e){return Object(u.a)(3===e.length,"setPosition requires vector argument"),this.position=e,this}},{key:"setRotation",value:function(e){return Object(u.a)(3===e.length,"setRotation requires vector argument"),this.rotation=e,this}},{key:"setScale",value:function(e){return Object(u.a)(3===e.length,"setScale requires vector argument"),this.scale=e,this}},{key:"setMatrix",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t?this.matrix.copy(e):this.matrix=e}},{key:"setMatrixComponents",value:function(e){var t=e.position,n=e.rotation,r=e.scale,i=e.update,s=void 0===i||i;return t&&this.setPosition(t),n&&this.setRotation(n),r&&this.setScale(r),s&&this.updateMatrix(),this}},{key:"updateMatrix",value:function(){var e=this.position,t=this.rotation,n=this.scale;return this.matrix.identity(),this.matrix.translate(e),this.matrix.rotateXYZ(t),this.matrix.scale(n),this}},{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.position,n=e.rotation,r=e.scale;return t&&this.setPosition(t),n&&this.setRotation(n),r&&this.setScale(r),this.updateMatrix(),this}},{key:"getCoordinateUniforms",value:function(e,t){Object(u.a)(e),t=t||this.matrix;var n=new o.a(e).multiplyRight(t),r=n.invert(),i=r.transpose();return{viewMatrix:e,modelMatrix:t,objectMatrix:t,worldMatrix:n,worldInverseMatrix:r,worldInverseTransposeMatrix:i}}},{key:"_setScenegraphNodeProps",value:function(e){"display"in e&&(this.display=e.display),"position"in e&&this.setPosition(e.position),"rotation"in e&&this.setRotation(e.rotation),"scale"in e&&this.setScale(e.scale),"matrix"in e&&this.setMatrix(e.matrix),Object.assign(this.props,e)}}]),e}()},J4mz:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n("1OyB"),i=n("vuIU"),s=1048576,o=1024*s;function a(e){var t,n,r;return e<1?(t=1e3*e,n="Î¼s",r=0):e<1e3?(t=e,n="ms",r=2):(t=e/1e3,n="s",r=2),"".concat(t.toFixed(r)).concat(n)}var u=n("laie"),c={position:"fixed",zIndex:1e4,color:"#ccc",background:"#000",fontFamily:"Helvetica,Arial,sans-serif",padding:"8px",fontSize:"12px",lineSpacing:6},f={fontSize:"16px"},l={paddingLeft:"8px"},d={count:function(e){return"".concat(e.name,": ").concat(e.count)},averageTime:function(e){return"".concat(e.name,": ").concat(a(e.getAverageTime()))},totalTime:function(e){return"".concat(e.name,": ").concat(a(e.time))},fps:function(e){return"".concat(e.name,": ").concat(Math.round(e.getHz()),"fps")},memory:function(e){return"".concat(e.name,": ").concat(((t=e.count)<1024?(n=t,r=" bytes",i=0):t<s?(n=t/1024,r="kB",i=2):t<o?(n=t/s,r="MB",i=2):(n=t/o,r="GB",i=2),"".concat(n.toFixed(i)).concat(r)));var t,n,r,i}},h=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(r.a)(this,e),this.stats=t,this.title=n.title,this._framesPerUpdate=Math.round(Math.max(n.framesPerUpdate||1,1)),this._formatters=d,this._resetOnUpdate={},this._counter=0,this._initializeFormatters(n),this._initializeUpdateConfigs(n),this._css=Object.assign({},c,n.css),this._headerCSS=Object.assign({},f,this._css.header),this._itemCSS=Object.assign({},l,this._css.item),delete this._css.header,delete this._css.item,this._container=null,this._header=null,this._items={},this._createDOM(n.container),this._createDOMHeader(),this._createDOMStats()}return Object(i.a)(e,[{key:"setStats",value:function(e){this.stats=e,this._createDOMStats(this._container),this._setHeaderContent(e.id),this.update()}},{key:"update",value:function(){var e=this.stats&&this.stats.stats;e&&0!==Object.keys(e).length&&this._counter++%this._framesPerUpdate==0&&this._update()}},{key:"_update",value:function(){var e=this;this.stats.forEach((function(t){e._createDOMItem(t.name),e._items[t.name].innerHTML=e._getLines(t).join("<BR>"),e._resetOnUpdate[t.name]&&t.reset()}))}},{key:"_initializeFormatters",value:function(e){if(e.formatters)for(var t in e.formatters){var n=e.formatters[t];"string"==typeof n&&(n=d[n]),this._formatters[t]=n}}},{key:"_initializeUpdateConfigs",value:function(e){if(e.resetOnUpdate)for(var t in e.resetOnUpdate)this._resetOnUpdate[t]=e.resetOnUpdate[t]}},{key:"_createDOM",value:function(e){if("undefined"!=typeof document&&document&&(this._container=e,!this._container)){for(var t in this._container=document.createElement("div"),this._css)this._container.style[t]=this._css[t];document.body.appendChild(this._container)}}},{key:"_createDOMHeader",value:function(){if(!this._header){for(var e in this._header=document.createElement("div"),this._headerCSS)this._header.style[e]=this._headerCSS[e];this._container.appendChild(this._header)}this._setHeaderContent()}},{key:"_setHeaderContent",value:function(e){this._header&&(this._header.innerText=e||this.title||this.stats&&this.stats.id||"")}},{key:"_createDOMStats",value:function(){var e=this;this.stats instanceof u.b&&this.stats.forEach((function(t){e._createDOMItem(t.name)}))}},{key:"_createDOMItem",value:function(e){if(this._container&&!this._items[e]){for(var t in this._items[e]=document.createElement("div"),this._itemCSS)this._items[e].style[t]=this._itemCSS[t];this._container.appendChild(this._items[e])}}},{key:"_getLines",value:function(e){return(this._formatters[e.name]||this._formatters[e.type]||d.count)(this.stats.get(e.name)).split("\n")}}]),e}()},NY3r:function(e,t,n){"use strict";n.d(t,"a",(function(){return H}));var r=n("1OyB"),i=n("vuIU"),s=n("Nw31"),o=n("iein"),a=n("sc/6"),u=n("T2Hy"),c=n("KQm4"),f=n("ReuC"),l=n("Ji7U"),d=n("md7G"),h=n("foSv"),p=n("IIFb");function m(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){a=!0,s=e},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw s}}}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var i=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(d.a)(this,n)}}var g=function(e){Object(l.a)(n,e);var t=b(n);function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(r.a)(this,n);var s=i=Array.isArray(i)?{children:i}:i,a=s.children,u=void 0===a?[]:a;return o.j.assert(u.every((function(e){return e instanceof p.a})),"every child must an instance of ScenegraphNode"),(e=t.call(this,i)).children=u,e}return Object(i.a)(n,[{key:"add",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0,i=t;r<i.length;r++){var s=i[r];Array.isArray(s)?this.add.apply(this,Object(c.a)(s)):this.children.push(s)}return this}},{key:"remove",value:function(e){var t=this.children,n=t.indexOf(e);return n>-1&&t.splice(n,1),this}},{key:"removeAll",value:function(){return this.children=[],this}},{key:"delete",value:function(){this.children.forEach((function(e){return e.delete()})),this.removeAll(),Object(f.a)(Object(h.a)(n.prototype),"delete",this).call(this)}},{key:"traverse",value:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=r.worldMatrix,o=void 0===i?new s.a:i,a=new s.a(o).multiplyRight(this.matrix),u=m(this.children);try{for(u.s();!(t=u.n()).done;){var c=t.value;c instanceof n?c.traverse(e,{worldMatrix:a}):e(c,{worldMatrix:a})}}catch(f){u.e(f)}finally{u.f()}}}]),n}(p.a),_=n("CxzY"),y=n("Xjzu"),x={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},A={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function O(e){if(!e._animation){var t=A[e.componentType],n=x[e.type],r=n*e.count,i=e.bufferView.data,s=new t(i.buffer,i.byteOffset+(e.byteOffset||0),r);if(1===n)e._animation=Array.from(s);else{for(var o=[],a=0;a<s.length;a+=n)o.push(Array.from(s.slice(a,a+n)));e._animation=o}}return e._animation}var S=new s.a;var j=new y.a;function T(e,t,n,r){var i=t.input,s=t.interpolation,a=t.output,u=e%i[i.length-1],c=i.findIndex((function(e){return e>=u})),f=Math.max(0,c-1);if(!Array.isArray(n[r]))switch(r){case"translation":n[r]=[0,0,0];break;case"rotation":n[r]=[0,0,0,1];break;case"scale":n[r]=[1,1,1];break;default:o.j.warn("Bad animation path ".concat(r))()}Object(_.a)(n[r].length===a[f].length);var l=i[f],d=i[c];switch(s){case"STEP":!function(e,t,n){for(var r=0;r<n.length;r++)e[t][r]=n[r]}(n,r,a[f]);break;case"LINEAR":if(d>l){var h=(u-l)/(d-l);!function(e,t,n,r,i){if("rotation"===t){j.slerp({start:n,target:r,ratio:i});for(var s=0;s<j.length;s++)e[t][s]=j[s]}else for(var o=0;o<n.length;o++)e[t][o]=i*r[o]+(1-i)*n[o]}(n,r,a[f],a[c],h)}break;case"CUBICSPLINE":if(d>l){var p=(u-l)/(d-l),m=d-l;!function(e,t,n){for(var r=n.p0,i=n.outTangent0,s=n.inTangent1,o=n.p1,a=n.tDiff,u=n.ratio,c=0;c<e[t].length;c++){var f=i[c]*a,l=s[c]*a;e[t][c]=(2*Math.pow(u,3)-3*Math.pow(u,2)+1)*r[c]+(Math.pow(u,3)-2*Math.pow(u,2)+u)*f+(-2*Math.pow(u,3)+3*Math.pow(u,2))*o[c]+(Math.pow(u,3)-Math.pow(u,2))*l}}(n,r,{p0:a[3*f+1],outTangent0:a[3*f+2],inTangent1:a[3*c+0],p1:a[3*c+1],tDiff:m,ratio:p})}break;default:o.j.warn("Interpolation ".concat(s," not supported"))()}}var I=function(){function e(t){Object(r.a)(this,e),this.startTime=0,this.playing=!0,this.speed=1,this.channels=[],Object.assign(this,t)}return Object(i.a)(e,[{key:"animate",value:function(e){if(this.playing){var t=(e/1e3-this.startTime)*this.speed;this.channels.forEach((function(e){var n=e.sampler,r=e.target,i=e.path;T(t,n,r,i),function(e,t){if(t.matrix.identity(),e.translation&&t.matrix.translate(e.translation),e.rotation){var n=S.fromQuaternion(e.rotation);t.matrix.multiplyRight(n)}e.scale&&t.matrix.scale(e.scale)}(r,r._node)}))}}}]),e}(),R=function(){function e(t){Object(r.a)(this,e),this.animations=t.animations.map((function(e,n){var r=e.name||"Animation-".concat(n),i=e.samplers.map((function(e){var n=e.input,r=e.interpolation,i=void 0===r?"LINEAR":r,s=e.output;return{input:O(t.accessors[n]),interpolation:i,output:O(t.accessors[s])}})),s=e.channels.map((function(e){var n=e.sampler,r=e.target;return{sampler:i[n],target:t.nodes[r.node],path:r.path}}));return new I({name:r,channels:s})}))}return Object(i.a)(e,[{key:"animate",value:function(e){this.setTime(e)}},{key:"setTime",value:function(e){this.animations.forEach((function(t){return t.animate(e)}))}},{key:"getAnimations",value:function(){return this.animations}}]),e}(),w=n("+Jdq"),E=n("ykdB");function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var i=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(d.a)(this,n)}}var L=function(e){Object(l.a)(n,e);var t=M(n);function n(e){var i,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(r.a)(this,n),(i=t.call(this,s)).onBeforeRender=null,i.AfterRender=null,e instanceof E.a?(i.model=e,i._setModelNodeProps(s)):i.model=new E.a(e,s),i.managedResources=s.managedResources||[],i}return Object(i.a)(n,[{key:"setProps",value:function(e){return Object(f.a)(Object(h.a)(n.prototype),"setProps",this).call(this,e),this._setModelNodeProps(e),this}},{key:"delete",value:function(){this.model&&(this.model.delete(),this.model=null),this.managedResources.forEach((function(e){return e.delete()})),this.managedResources=[]}},{key:"draw",value:function(){var e;return(e=this.model).draw.apply(e,arguments)}},{key:"setUniforms",value:function(){var e;return(e=this.model).setUniforms.apply(e,arguments),this}},{key:"setAttributes",value:function(){var e;return(e=this.model).setAttributes.apply(e,arguments),this}},{key:"updateModuleSettings",value:function(){var e;return(e=this.model).updateModuleSettings.apply(e,arguments),this}},{key:"_setModelNodeProps",value:function(e){this.model.setProps(e)}}]),n}(p.a),C=n("rePB"),N=n("d3kR"),P=n("tMmZ"),B=n("f5Sf"),U=function(){function e(t,n){var i=n.attributes,s=n.material,o=n.pbrDebug,a=n.imageBasedLightingEnvironment,u=n.lights,c=n.useTangents;Object(r.a)(this,e),this.gl=t,this.defines={MANUAL_SRGB:1,SRGB_FAST_APPROXIMATION:1},Object(N.b)(t,P.a.GLSL_TEXTURE_LOD)&&(this.defines.USE_TEX_LOD=1),this.uniforms={u_Camera:[0,0,0],u_MetallicRoughnessValues:[1,1]},this.parameters={},this.generatedTextures=[],a&&(this.uniforms.u_DiffuseEnvSampler=a.getDiffuseEnvSampler(),this.uniforms.u_SpecularEnvSampler=a.getSpecularEnvSampler(),this.uniforms.u_brdfLUT=a.getBrdfTexture(),this.uniforms.u_ScaleIBLAmbient=[1,1]),o&&(this.uniforms.u_ScaleDiffBaseMR=[0,0,0,0],this.uniforms.u_ScaleFGDSpec=[0,0,0,0]),this.defineIfPresent(i.NORMAL,"HAS_NORMALS"),this.defineIfPresent(i.TANGENT&&c,"HAS_TANGENTS"),this.defineIfPresent(i.TEXCOORD_0,"HAS_UV"),this.defineIfPresent(a,"USE_IBL"),this.defineIfPresent(u,"USE_LIGHTS"),this.defineIfPresent(o,"PBR_DEBUG"),s&&this.parseMaterial(s)}return Object(i.a)(e,[{key:"defineIfPresent",value:function(e,t){e&&(this.defines[t]=1)}},{key:"parseTexture",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=e.texture&&e.texture.sampler&&e.texture.sampler.parameters||{},i=new B.a(this.gl,{id:e.name||e.id,parameters:r,pixelStore:Object(C.a)({},this.gl.UNPACK_FLIP_Y_WEBGL,!1),data:e.texture.source.image});this.uniforms[t]=i,this.defineIfPresent(n,n),this.generatedTextures.push(i)}},{key:"parsePbrMetallicRoughness",value:function(e){e.baseColorTexture&&this.parseTexture(e.baseColorTexture,"u_BaseColorSampler","HAS_BASECOLORMAP"),this.uniforms.u_BaseColorFactor=e.baseColorFactor||[1,1,1,1],e.metallicRoughnessTexture&&this.parseTexture(e.metallicRoughnessTexture,"u_MetallicRoughnessSampler","HAS_METALROUGHNESSMAP");var t=e.metallicFactor,n=void 0===t?1:t,r=e.roughnessFactor,i=void 0===r?1:r;this.uniforms.u_MetallicRoughnessValues=[n,i]}},{key:"parseMaterial",value:function(e){if(this.uniforms.pbr_uUnlit=Boolean(e.unlit),e.pbrMetallicRoughness&&this.parsePbrMetallicRoughness(e.pbrMetallicRoughness),e.normalTexture){this.parseTexture(e.normalTexture,"u_NormalSampler","HAS_NORMALMAP");var t=e.normalTexture.scale,n=void 0===t?1:t;this.uniforms.u_NormalScale=n}if(e.occlusionTexture){this.parseTexture(e.occlusionTexture,"u_OcclusionSampler","HAS_OCCLUSIONMAP");var r=e.occlusionTexture.strength,i=void 0===r?1:r;this.uniforms.u_OcclusionStrength=i}if(e.emissiveTexture&&(this.parseTexture(e.emissiveTexture,"u_EmissiveSampler","HAS_EMISSIVEMAP"),this.uniforms.u_EmissiveFactor=e.emissiveFactor||[0,0,0]),"MASK"===e.alphaMode){var s=e.alphaCutoff,a=void 0===s?.5:s;this.defines.ALPHA_CUTOFF=1,this.uniforms.u_AlphaCutoff=a}else"BLEND"===e.alphaMode&&(o.j.warn("BLEND alphaMode might not work well because it requires mesh sorting")(),Object.assign(this.parameters,{blend:!0,blendEquation:this.gl.FUNC_ADD,blendFunc:[this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA]}))}}]),e}();function V(e,t){return Object(o.i)(e)?"#version 300 es\n".concat(t):t}var k={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},D={modelOptions:{},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1},F=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(r.a)(this,e),this.gl=t,this.options=Object.assign({},D,n)}return Object(i.a)(e,[{key:"instantiate",value:function(e){var t=this;return this.gltf=e,(e.scenes||[]).map((function(e){return t.createScene(e)}))}},{key:"createAnimator",value:function(){return Array.isArray(this.gltf.animations)?new R(this.gltf):null}},{key:"createScene",value:function(e){var t=this,n=(e.nodes||[]).map((function(e){return t.createNode(e)}));return new g({id:e.name||e.id,children:n})}},{key:"createNode",value:function(e){var t=this;if(!e._node){var n=(e.children||[]).map((function(e){return t.createNode(e)}));e.mesh&&n.push(this.createMesh(e.mesh));var r=new g({id:e.name||e.id,children:n});if(e.matrix)r.setMatrix(e.matrix);else{if(r.matrix.identity(),e.translation&&r.matrix.translate(e.translation),e.rotation){var i=(new s.a).fromQuaternion(e.rotation);r.matrix.multiplyRight(i)}e.scale&&r.matrix.scale(e.scale)}e._node=r}return e._node}},{key:"createMesh",value:function(e){var t=this;if(!e._mesh){var n=(e.primitives||[]).map((function(n,r){return t.createPrimitive(n,r,e)})),r=new g({id:e.name||e.id,children:n});e._mesh=r}return e._mesh}},{key:"getVertexCount",value:function(e){o.j.warn("getVertexCount() not found")()}},{key:"createPrimitive",value:function(e,t,n){return function(e,t){var n=t.id,r=t.drawMode,i=t.vertexCount,s=t.attributes,a=t.modelOptions,u=new U(e,t);o.j.info(4,"createGLTFModel defines: ",u.defines)();var f=[];f.push.apply(f,Object(c.a)(u.generatedTextures)),f.push.apply(f,Object(c.a)(Object.values(s).map((function(e){return e.buffer}))));var l=new L(e,Object.assign({id:n,drawMode:r,vertexCount:i,modules:[w.a],defines:u.defines,parameters:u.parameters,vs:V(e,"\n#if (__VERSION__ < 300)\n  #define _attr attribute\n#else\n  #define _attr in\n#endif\n\n  _attr vec4 POSITION;\n\n  #ifdef HAS_NORMALS\n    _attr vec4 NORMAL;\n  #endif\n\n  #ifdef HAS_TANGENTS\n    _attr vec4 TANGENT;\n  #endif\n\n  #ifdef HAS_UV\n    _attr vec2 TEXCOORD_0;\n  #endif\n\n  void main(void) {\n    vec4 _NORMAL = vec4(0.);\n    vec4 _TANGENT = vec4(0.);\n    vec2 _TEXCOORD_0 = vec2(0.);\n\n    #ifdef HAS_NORMALS\n      _NORMAL = NORMAL;\n    #endif\n\n    #ifdef HAS_TANGENTS\n      _TANGENT = TANGENT;\n    #endif\n\n    #ifdef HAS_UV\n      _TEXCOORD_0 = TEXCOORD_0;\n    #endif\n\n    pbr_setPositionNormalTangentUV(POSITION, _NORMAL, _TANGENT, _TEXCOORD_0);\n    gl_Position = u_MVPMatrix * POSITION;\n  }\n"),fs:V(e,"\n#if (__VERSION__ < 300)\n  #define fragmentColor gl_FragColor\n#else\n  out vec4 fragmentColor;\n#endif\n\n  void main(void) {\n    fragmentColor = pbr_filterColor(vec4(0));\n  }\n"),managedResources:f},a));return l.setProps({attributes:s}),l.setUniforms(u.uniforms),l}(this.gl,Object.assign({id:e.name||"".concat(n.name||n.id,"-primitive-").concat(t),drawMode:e.mode||4,vertexCount:e.indices?e.indices.count:this.getVertexCount(e.attributes),attributes:this.createAttributes(e.attributes,e.indices),material:e.material},this.options))}},{key:"createAttributes",value:function(e,t){var n=this,r={};return Object.keys(e).forEach((function(t){r[t]=n.createAccessor(e[t],n.createBuffer(e[t],n.gl.ARRAY_BUFFER))})),t&&(r.indices=this.createAccessor(t,this.createBuffer(t,this.gl.ELEMENT_ARRAY_BUFFER))),o.j.info(4,"glTF Attributes",{attributes:e,indices:t,generated:r})(),r}},{key:"createBuffer",value:function(e,t){e.bufferView||(e.bufferView={});var n=e.bufferView;return n.lumaBuffers||(n.lumaBuffers={}),n.lumaBuffers[t]||(n.lumaBuffers[t]=new a.a(this.gl,{id:"from-".concat(n.id),data:n.data||e.value,target:t})),n.lumaBuffers[t]}},{key:"createAccessor",value:function(e,t){return new u.a({buffer:t,offset:e.byteOffset||0,stride:e.bufferView.byteStride||0,type:e.componentType,size:k[e.type]})}},{key:"createSampler",value:function(e){return e}},{key:"needsPOT",value:function(){return!1}}]),e}();function H(e,t,n){var r=new F(e,n);return{scenes:r.instantiate(t),animator:r.createAnimator()}}},WraG:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("lC2f");function i(e){try{return JSON.parse(e)}catch(t){throw new Error('Failed to parse JSON from data starting with "'+Object(r.a)(e)+'"')}}},lC2f:function(e,t,n){"use strict";function r(e,t){if(void 0===t&&(t=5),"string"==typeof e)return e.slice(0,t);if(ArrayBuffer.isView(e))return i(e.buffer,e.byteOffset,t);if(e instanceof ArrayBuffer){return i(e,0,t)}return""}function i(e,t,n){if(e.byteLength<=t+n)return"";for(var r=new DataView(e),i="",s=0;s<n;s++)i+=String.fromCharCode(r.getUint8(t+s));return i}n.d(t,"a",(function(){return r}))},ngZ5:function(e,t,n){"use strict";n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a}));var r=n("P+ME"),i=n("itLl");function s(e,t){return Object(r.a)(e>=0),Object(r.a)(t>0),e+(t-1)&~(t-1)}function o(e,t,n){return Object(i.c)(e,t,n)}function a(e,t,n){var r;if(e instanceof ArrayBuffer)r=new Uint8Array(e);else{var i=e.byteOffset,o=e.byteLength;r=new Uint8Array(e.buffer||e.arrayBuffer,i,o)}return t.set(r,n),n+s(r.byteLength,4)}},"yx+g":function(e,t,n){"use strict";n.d(t,"a",(function(){return ze}));var r={};n.r(r),n.d(r,"decode",(function(){return D})),n.d(r,"encode",(function(){return H}));var i={};n.r(i),n.d(i,"decode",(function(){return $})),n.d(i,"encode",(function(){return Y}));var s={};n.r(s),n.d(s,"decode",(function(){return ee})),n.d(s,"encode",(function(){return te}));var o={};n.r(o),n.d(o,"decode",(function(){return ie})),n.d(o,"encode",(function(){return se}));var a=n("o0o1"),u=n.n(a),c=n("rePB"),f=(n("wcNg"),n("HaE+")),l="undefined"!=typeof __VERSION__?__VERSION__:"latest",d=n("gQyj"),h=n("WraG"),p=n("ngZ5");function m(e,t){if(!e)throw new Error(t||"assert failed: gltf")}function v(e,t){if(e.startsWith("data:")||e.startsWith("http:")||e.startsWith("https:"))return e;var n=t.baseUri||t.uri;if(!n)throw new Error("'baseUri' must be provided to resolve relative url "+e);return n.substr(0,n.lastIndexOf("/")+1)+e}function b(e,t,n){var r=e.bufferViews[n];m(r);var i=t[r.buffer];m(i);var s=(r.byteOffset||0)+i.byteOffset;return new Uint8Array(i.arrayBuffer,s,r.byteLength)}var g=n("1Nab"),_=n("vuIU"),y=n("9upa");var x=["SCALAR","VEC2","VEC3","VEC4"],A=[[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126],[Float64Array,5130]],O=new Map(A),S={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},j={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},T={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function I(e){return x[e-1]||x[0]}function R(e){var t=O.get(e.constructor);if(!t)throw new Error("Illegal typed array");return t}function w(e,t){var n=T[e.componentType],r=S[e.type],i=j[e.componentType],s=e.count*r,o=e.count*r*i;return m(o>=0&&o<=t.byteLength),{ArrayType:n,length:s,byteLength:o}}function E(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return M(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return M(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var L=function(){function e(t){if(t instanceof e)return t;t||(t={json:{asset:{version:"2.0",generator:"loaders.gl"},buffers:[]},buffers:[]}),this.sourceBuffers=[],this.byteLength=0,t.buffers&&t.buffers[0]&&(this.byteLength=t.buffers[0].byteLength,this.sourceBuffers=[t.buffers[0]]),this.gltf=t,m(this.gltf.json)}var t=e.prototype;return t.getApplicationData=function(e){return this.json[e]},t.getExtraData=function(e){return(this.json.extras||{})[e]},t.getExtension=function(e){var t=this.getUsedExtensions().find((function(t){return t===e})),n=this.json.extensions||{};return t?n[e]||!0:null},t.getRequiredExtension=function(e){return this.getRequiredExtensions().find((function(t){return t===e}))?this.getExtension(e):null},t.getRequiredExtensions=function(){return this.json.extensionsRequired||[]},t.getUsedExtensions=function(){return this.json.extensionsUsed||[]},t.getObjectExtension=function(e,t){return(e.extensions||{})[t]},t.getScene=function(e){return this.getObject("scenes",e)},t.getNode=function(e){return this.getObject("nodes",e)},t.getSkin=function(e){return this.getObject("skins",e)},t.getMesh=function(e){return this.getObject("meshes",e)},t.getMaterial=function(e){return this.getObject("materials",e)},t.getAccessor=function(e){return this.getObject("accessors",e)},t.getCamera=function(e){return null},t.getTexture=function(e){return this.getObject("textures",e)},t.getSampler=function(e){return this.getObject("samplers",e)},t.getImage=function(e){return this.getObject("images",e)},t.getBufferView=function(e){return this.getObject("bufferViews",e)},t.getBuffer=function(e){return this.getObject("buffers",e)},t.getObject=function(e,t){if("object"==typeof t)return t;var n=this.json[e]&&this.json[e][t];if(!n)throw new Error("glTF file error: Could not find "+e+"["+t+"]");return n},t.getTypedArrayForBufferView=function(e){var t=(e=this.getBufferView(e)).buffer,n=this.gltf.buffers[t];m(n);var r=(e.byteOffset||0)+n.byteOffset;return new Uint8Array(n.arrayBuffer,r,e.byteLength)},t.getTypedArrayForAccessor=function(e){e=this.getAccessor(e);var t=this.getBufferView(e.bufferView),n=this.getBuffer(t.buffer).data,r=w(e,t),i=r.ArrayType,s=r.length;return new i(n,t.byteOffset+e.byteOffset,s)},t.getTypedArrayForImageData=function(e){e=this.getAccessor(e);var t=this.getBufferView(e.bufferView),n=this.getBuffer(t.buffer).data,r=t.byteOffset||0;return new Uint8Array(n,r,t.byteLength)},t.addApplicationData=function(e,t){return this.json[e]=t,this},t.addExtraData=function(e,t){return this.json.extras=this.json.extras||{},this.json.extras[e]=t,this},t.addObjectExtension=function(e,t,n){return m(n),e.extensions=e.extensions||{},e.extensions[t]=n,this.registerUsedExtension(t),this},t.setObjectExtension=function(e,t,n){(e.extensions||{})[t]=n},t.removeObjectExtension=function(e,t){var n=e.extensions||{},r=n[t];return delete n[t],r},t.addExtension=function(e,t){return void 0===t&&(t={}),m(t),this.json.extensions=this.json.extensions||{},this.json.extensions[e]=t,this.registerUsedExtension(e),t},t.addRequiredExtension=function(e,t){return void 0===t&&(t={}),m(t),this.addExtension(e,t),this.registerRequiredExtension(e),t},t.registerUsedExtension=function(e){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find((function(t){return t===e}))||this.json.extensionsUsed.push(e)},t.registerRequiredExtension=function(e){this.registerUsedExtension(e),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find((function(t){return t===e}))||this.json.extensionsRequired.push(e)},t.removeExtension=function(e){this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,e),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,e),this.json.extensions&&delete this.json.extensions[e]},t.setDefaultScene=function(e){this.json.scene=e},t.addScene=function(e){var t=e.nodeIndices;return this.json.scenes=this.json.scenes||[],this.json.scenes.push({nodes:t}),this.json.scenes.length-1},t.addNode=function(e){var t=e.meshIndex,n=e.matrix,r=void 0===n?null:n;this.json.nodes=this.json.nodes||[];var i={mesh:t};return r&&(i.matrix=r),this.json.nodes.push(i),this.json.nodes.length-1},t.addMesh=function(e){var t=e.attributes,n=e.indices,r=e.material,i=e.mode,s=void 0===i?4:i,o={primitives:[{attributes:this._addAttributes(t),mode:s}]};if(n){var a=this._addIndices(n);o.primitives[0].indices=a}return Number.isFinite(r)&&(o.primitives[0].material=r),this.json.meshes=this.json.meshes||[],this.json.meshes.push(o),this.json.meshes.length-1},t.addPointCloud=function(e){var t={primitives:[{attributes:this._addAttributes(e),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(t),this.json.meshes.length-1},t.addImage=function(e,t){var n,r;t=t||(n=e,(r=Object(y.a)(n))?r.mimeType:null);var i={bufferView:this.addBufferView(e),mimeType:t};return this.json.images=this.json.images||[],this.json.images.push(i),this.json.images.length-1},t.addBufferView=function(e){var t=e.byteLength;m(Number.isFinite(t)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(e);var n={buffer:0,byteOffset:this.byteLength,byteLength:t};return this.byteLength+=Object(p.c)(t,4),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(n),this.json.bufferViews.length-1},t.addAccessor=function(e,t){var n={bufferView:e,type:I(t.size),componentType:t.componentType,count:t.count,max:t.max,min:t.min};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(n),this.json.accessors.length-1},t.addBinaryBuffer=function(e,t){void 0===t&&(t={size:3});var n=this.addBufferView(e),r={min:t.min,max:t.max};r.min&&r.max||(r=this._getAccessorMinMax(e,t.size));var i={size:t.size,componentType:R(e),count:Math.round(e.length/t.size),min:r.min,max:r.max};return this.addAccessor(n,Object.assign(i,t))},t.addTexture=function(e){var t={source:e.imageIndex};return this.json.textures=this.json.textures||[],this.json.textures.push(t),this.json.textures.length-1},t.addMaterial=function(e){return this.json.materials=this.json.materials||[],this.json.materials.push(e),this.json.materials.length-1},t.createBinaryChunk=function(){this.gltf.buffers=[];for(var e=this.byteLength,t=new ArrayBuffer(e),n=new Uint8Array(t),r=this.sourceBuffers||[],i=0,s=0;s<r.length;s++){var o=r[s];i=Object(p.a)(o,n,i)}this.json.buffers[0]=this.json.buffers[0]||{},this.json.buffers[0].byteLength=e,this.gltf.binary=t,this.sourceBuffers=[t]},t._removeStringFromArray=function(e,t){for(var n=!0;n;){var r=e.indexOf(t);r>-1?e.splice(r,1):n=!1}},t._addAttributes=function(e){void 0===e&&(e={});var t={};for(var n in e){var r=e[n],i=this._getGltfAttributeName(n),s=this.addBinaryBuffer(r.value,r);t[i]=s}return t},t._addIndices=function(e){return this.addBinaryBuffer(e,{size:1})},t._getGltfAttributeName=function(e){switch(e.toLowerCase()){case"position":case"positions":case"vertices":return"POSITION";case"normal":case"normals":return"NORMAL";case"color":case"colors":return"COLOR_0";case"texcoord":case"texcoords":return"TEXCOORD_0";default:return e}},t._getAccessorMinMax=function(e,t){var n={min:null,max:null};if(e.length<t)return n;n.min=[],n.max=[];for(var r,i=E(e.subarray(0,t));!(r=i()).done;){var s=r.value;n.min.push(s),n.max.push(s)}for(var o=t;o<e.length;o+=t)for(var a=0;a<t;a++)n.min[0+a]=Math.min(n.min[0+a],e[o+a]),n.max[0+a]=Math.max(n.max[0+a],e[o+a]);return n},Object(_.a)(e,[{key:"json",get:function(){return this.gltf.json}}]),e}();function C(e){var t={};for(var n in e){var r=e[n];if("indices"!==n){var i=N(r);t[n]=i}}return t}function N(e,t){var n=function(e,t){var n=e,r=1,i=0;e&&e.value&&(n=e.value,r=e.size||1);n&&(ArrayBuffer.isView(n)||(n=function(e,t,n){void 0===n&&(n=!1);if(!e)return null;if(Array.isArray(e))return new t(e);if(n&&!(e instanceof t))return new t(e);return e}(n,Float32Array)),i=n.length/r);return{buffer:n,size:r,count:i}}(e),r=n.buffer,i=n.size;return{value:r,size:i,bufferView:null,byteOffset:0,count:n.count,type:I(i),componentType:R(r)}}function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function B(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){Object(c.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var U=u.a.mark(K);function V(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return k(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function D(e,t,n){return F.apply(this,arguments)}function F(){return(F=Object(f.a)(u.a.mark((function e(t,n,r){var i,s,o,a,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.gltf.decompressMeshes){e.next=2;break}return e.abrupt("return");case 2:for(i=new L(t),s=[],o=V(K(i));!(a=o()).done;)c=a.value,i.getObjectExtension(c,"KHR_draco_mesh_compression")&&s.push(G(c,i,n,r));return e.next=7,Promise.all(s);case 7:i.removeExtension("KHR_draco_mesh_compression");case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function H(e,t){void 0===t&&(t={});for(var n,r=new L(e),i=V(r.json.meshes||[]);!(n=i()).done;){q(n.value,t),r.addRequiredExtension("KHR_draco_mesh_compression")}}function G(e,t,n,r){return z.apply(this,arguments)}function z(){return(z=Object(f.a)(u.a.mark((function e(t,n,r,i){var s,o,a,c,f,l;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=n.getObjectExtension(t,"KHR_draco_mesh_compression"),o=n.getTypedArrayForBufferView(s.bufferView),a=Object(p.b)(o.buffer,o.byteOffset),c=i.parse,delete(f=B({},r))["3d-tiles"],e.next=8,c(a,g.a,f,i);case 8:l=e.sent,t.attributes=C(l.attributes),l.indices&&(t.indices=N(l.indices)),X(t);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(e,t,n,r,i){var s;if(void 0===n&&(n=4),!r.DracoWriter)throw new Error("options.gltf.DracoWriter not provided");var o=r.DracoWriter.encodeSync({attributes:e}),a=(0,i.parseSync)({attributes:e}),u=r._addFauxAttributes(a.attributes),c=r.addBufferView(o);return{primitives:[{attributes:u,mode:n,extensions:(s={},s.KHR_draco_mesh_compression={bufferView:c,attributes:u},s)}]}}function X(e){if(!e.attributes&&Object.keys(e.attributes).length>0)throw new Error("Empty glTF primitive detected: Draco decompression failure?")}function K(e){var t,n,r,i,s,o;return u.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:t=V(e.json.meshes||[]);case 1:if((n=t()).done){a.next=12;break}r=n.value,i=V(r.primitives);case 4:if((s=i()).done){a.next=10;break}return o=s.value,a.next=8,o;case 8:a.next=4;break;case 10:a.next=1;break;case 12:case"end":return a.stop()}}),U)}function W(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return J(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return J(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function J(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function $(e,t){var n=new L(e),r=n.json,i=n.getExtension("KHR_lights_punctual");i&&(n.json.lights=i.lights,n.removeExtension("KHR_lights_punctual"));for(var s,o=W(r.nodes||[]);!(s=o()).done;){var a=s.value,u=n.getObjectExtension(a,"KHR_lights_punctual");u&&(a.light=u.light),n.removeObjectExtension(a,"KHR_lights_punctual")}}function Y(e,t){var n=new L(e),r=n.json;if(r.lights){var i=n.addExtension("KHR_lights_punctual");m(!i.lights),i.lights=r.lights,delete r.lights}if(n.json.lights){for(var s,o=W(n.json.lights);!(s=o()).done;){var a=s.value,u=a.node;n.addObjectExtension(u,"KHR_lights_punctual",a)}delete n.json.lights}}function Q(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Z(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function Z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ee(e,t){var n=new L(e),r=n.json;n.removeExtension("KHR_materials_unlit");for(var i,s=Q(r.materials||[]);!(i=s()).done;){var o=i.value;o.extensions&&o.extensions.KHR_materials_unlit&&(o.unlit=!0),n.removeObjectExtension(o,"KHR_materials_unlit")}}function te(e,t){var n=new L(e),r=n.json;if(n.materials)for(var i,s=Q(r.materials);!(i=s()).done;){var o=i.value;o.unlit&&(delete o.unlit,n.addObjectExtension(o,"KHR_materials_unlit",{}),n.addExtension("KHR_materials_unlit"))}}function ne(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return re(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return re(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function re(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ie(e,t){var n=new L(e),r=n.json,i=n.getExtension("KHR_techniques_webgl");if(i){for(var s,o=function(e,t){var n=e.programs,r=void 0===n?[]:n,i=e.shaders,s=void 0===i?[]:i,o=e.techniques,a=void 0===o?[]:o,u=new TextDecoder;return s.forEach((function(e){if(!Number.isFinite(e.bufferView))throw new Error("KHR_techniques_webgl: no shader code");e.code=u.decode(t.getTypedArrayForBufferView(e.bufferView))})),r.forEach((function(e){e.fragmentShader=s[e.fragmentShader],e.vertexShader=s[e.vertexShader]})),a.forEach((function(e){e.program=r[e.program]})),a}(i,n),a=ne(r.materials||[]);!(s=a()).done;){var u=s.value,c=n.getObjectExtension(u,"KHR_techniques_webgl");c&&(u.technique=Object.assign({},c,o[c.technique]),u.technique.values=oe(u.technique,n)),n.removeObjectExtension(u,"KHR_techniques_webgl")}n.removeExtension("KHR_techniques_webgl")}}function se(e,t){}function oe(e,t){var n=Object.assign({},e.values);return Object.keys(e.uniforms||{}).forEach((function(t){e.uniforms[t].value&&!(t in n)&&(n[t]=e.uniforms[t].value)})),Object.keys(n).forEach((function(e){"object"==typeof n[e]&&void 0!==n[e].index&&(n[e].texture=t.getTexture(n[e].index))})),n}var ae={KHR_draco_mesh_compression:r,KHR_lights_punctual:i,KHR_materials_unlit:s,KHR_techniques_webgl:o};function ue(e,t,n){return ce.apply(this,arguments)}function ce(){return(ce=Object(f.a)(u.a.mark((function e(t,n,r){var i,s,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0===n&&(n={}),n.gltf=n.gltf||{},e.t0=u.a.keys(ae);case 3:if((e.t1=e.t0()).done){e.next=13;break}if(i=e.t1.value,s=n.gltf.excludeExtensions||{},i in s&&!s[i]){e.next=11;break}return o=ae[i],e.next=11,o.decode(t,n,r);case 11:e.next=3;break;case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function fe(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return le(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return le(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function le(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function de(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return he(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return he(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function he(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var pe={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},me={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"},ve=function(){function e(e){this.idToIndexMap={animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}}}var t=e.prototype;return t.normalize=function(e,t){this.json=e.json;var n=e.json;switch(n.asset&&n.asset.version){case"2.0":return;case void 0:case"1.0":break;default:return void console.warn("glTF: Unknown version "+n.asset.version)}if(!t.normalize)throw new Error("glTF v1 is not supported.");console.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(n),this._convertTopLevelObjectsToArrays(n),function(e,t){for(var n,r=new L(e),i=r.json,s=fe(i.images||[]);!(n=s()).done;){var o=n.value,a=r.removeObjectExtension(o,"KHR_binary_glTF");a&&Object.assign(o,a)}i.buffers&&i.buffers[0]&&delete i.buffers[0].uri,r.removeExtension("KHR_binary_glTF")}(e),this._convertObjectIdsToArrayIndices(n),this._updateObjects(n),this._updateMaterial(n)},t._addAsset=function(e){e.asset=e.asset||{},e.asset.version="2.0",e.asset.generator=e.asset.generator||"Normalized to glTF 2.0 by loaders.gl"},t._convertTopLevelObjectsToArrays=function(e){for(var t in pe)this._convertTopLevelObjectToArray(e,t)},t._convertTopLevelObjectToArray=function(e,t){var n=e[t];if(n&&!Array.isArray(n))for(var r in e[t]=[],n){var i=n[r];i.id=i.id||r;var s=e[t].length;e[t].push(i),this.idToIndexMap[t][r]=s}},t._convertObjectIdsToArrayIndices=function(e){for(var t in pe)this._convertIdsToIndices(e,t);"scene"in e&&(e.scene=this._convertIdToIndex(e.scene,"scene"));for(var n,r=de(e.textures);!(n=r()).done;){var i=n.value;this._convertTextureIds(i)}for(var s,o=de(e.meshes);!(s=o()).done;){var a=s.value;this._convertMeshIds(a)}for(var u,c=de(e.nodes);!(u=c()).done;){var f=u.value;this._convertNodeIds(f)}for(var l,d=de(e.scenes);!(l=d()).done;){var h=l.value;this._convertSceneIds(h)}},t._convertTextureIds=function(e){e.source&&(e.source=this._convertIdToIndex(e.source,"image"))},t._convertMeshIds=function(e){for(var t,n=de(e.primitives);!(t=n()).done;){var r=t.value,i=r.attributes,s=r.indices,o=r.material;for(var a in i)i[a]=this._convertIdToIndex(i[a],"accessor");s&&(r.indices=this._convertIdToIndex(s,"accessor")),o&&(r.material=this._convertIdToIndex(o,"material"))}},t._convertNodeIds=function(e){var t=this;e.children&&(e.children=e.children.map((function(e){return t._convertIdToIndex(e,"node")}))),e.meshes&&(e.meshes=e.meshes.map((function(e){return t._convertIdToIndex(e,"mesh")})))},t._convertSceneIds=function(e){var t=this;e.nodes&&(e.nodes=e.nodes.map((function(e){return t._convertIdToIndex(e,"node")})))},t._convertIdsToIndices=function(e,t){e[t]||(console.warn("gltf v1: json doesn't contain attribute "+t),e[t]=[]);for(var n,r=de(e[t]);!(n=r()).done;){var i=n.value;for(var s in i){var o=i[s],a=this._convertIdToIndex(o,s);i[s]=a}}},t._convertIdToIndex=function(e,t){var n=me[t];if(n in this.idToIndexMap){var r=this.idToIndexMap[n][e];if(!Number.isFinite(r))throw new Error("gltf v1: failed to resolve "+t+" with id "+e);return r}return e},t._updateObjects=function(e){for(var t,n=de(this.json.buffers);!(t=n()).done;){delete t.value.type}},t._updateMaterial=function(e){for(var t,n=function(){var n=t.value;n.pbrMetallicRoughness={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1};var r=n.values&&n.values.tex,i=e.textures.findIndex((function(e){return e.id===r}));-1!==i&&(n.pbrMetallicRoughness.baseColorTexture={index:i})},r=de(e.materials);!(t=r()).done;)n()},e}();function be(e,t){return void 0===t&&(t={}),(new ve).normalize(e,t)}var ge;n("E9XD");function _e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ye(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_e(Object(n),!0).forEach((function(t){Object(c.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_e(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var xe={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Ae={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},Oe={TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,REPEAT:10497,LINEAR:9729,NEAREST_MIPMAP_LINEAR:9986},Se={magFilter:Oe.TEXTURE_MAG_FILTER,minFilter:Oe.TEXTURE_MIN_FILTER,wrapS:Oe.TEXTURE_WRAP_S,wrapT:Oe.TEXTURE_WRAP_T},je=((ge={})[Oe.TEXTURE_MAG_FILTER]=Oe.LINEAR,ge[Oe.TEXTURE_MIN_FILTER]=Oe.NEAREST_MIPMAP_LINEAR,ge[Oe.TEXTURE_WRAP_S]=Oe.REPEAT,ge[Oe.TEXTURE_WRAP_]=Oe.REPEAT,ge);var Te=function(){function e(){}var t=e.prototype;return t.postProcess=function(e,t){void 0===t&&(t={});var n=e.json,r=e.buffers,i=void 0===r?[]:r,s=e.images,o=void 0===s?[]:s,a=e.baseUri,u=void 0===a?"":a;return m(n),this.baseUri=u,this.json=n,this.buffers=i,this.images=o,this._resolveTree(this.json,t),this.json},t._resolveTree=function(e,t){var n=this;void 0===t&&(t={}),e.bufferViews&&(e.bufferViews=e.bufferViews.map((function(e,t){return n._resolveBufferView(e,t)}))),e.images&&(e.images=e.images.map((function(e,t){return n._resolveImage(e,t)}))),e.samplers&&(e.samplers=e.samplers.map((function(e,t){return n._resolveSampler(e,t)}))),e.textures&&(e.textures=e.textures.map((function(e,t){return n._resolveTexture(e,t)}))),e.accessors&&(e.accessors=e.accessors.map((function(e,t){return n._resolveAccessor(e,t)}))),e.materials&&(e.materials=e.materials.map((function(e,t){return n._resolveMaterial(e,t)}))),e.meshes&&(e.meshes=e.meshes.map((function(e,t){return n._resolveMesh(e,t)}))),e.nodes&&(e.nodes=e.nodes.map((function(e,t){return n._resolveNode(e,t)}))),e.skins&&(e.skins=e.skins.map((function(e,t){return n._resolveSkin(e,t)}))),e.scenes&&(e.scenes=e.scenes.map((function(e,t){return n._resolveScene(e,t)}))),void 0!==e.scene&&(e.scene=e.scenes[this.json.scene])},t.getScene=function(e){return this._get("scenes",e)},t.getNode=function(e){return this._get("nodes",e)},t.getSkin=function(e){return this._get("skins",e)},t.getMesh=function(e){return this._get("meshes",e)},t.getMaterial=function(e){return this._get("materials",e)},t.getAccessor=function(e){return this._get("accessors",e)},t.getCamera=function(e){return null},t.getTexture=function(e){return this._get("textures",e)},t.getSampler=function(e){return this._get("samplers",e)},t.getImage=function(e){return this._get("images",e)},t.getBufferView=function(e){return this._get("bufferViews",e)},t.getBuffer=function(e){return this._get("buffers",e)},t._get=function(e,t){if("object"==typeof t)return t;var n=this.json[e]&&this.json[e][t];return n||console.warn("glTF file error: Could not find "+e+"["+t+"]"),n},t._resolveScene=function(e,t){var n=this;return e.id=e.id||"scene-"+t,e.nodes=(e.nodes||[]).map((function(e){return n.getNode(e)})),e},t._resolveNode=function(e,t){var n=this;return e.id=e.id||"node-"+t,e.children&&(e.children=e.children.map((function(e){return n.getNode(e)}))),void 0!==e.mesh?e.mesh=this.getMesh(e.mesh):void 0!==e.meshes&&e.meshes.length&&(e.mesh=e.meshes.reduce((function(e,t){var r=n.getMesh(t);return e.id=r.id,e.primitives=e.primitives.concat(r.primitives),e}),{primitives:[]})),void 0!==e.camera&&(e.camera=this.getCamera(e.camera)),void 0!==e.skin&&(e.skin=this.getSkin(e.skin)),e},t._resolveSkin=function(e,t){return e.id=e.id||"skin-"+t,e.inverseBindMatrices=this.getAccessor(e.inverseBindMatrices),e},t._resolveMesh=function(e,t){var n=this;return e.id=e.id||"mesh-"+t,e.primitives&&(e.primitives=e.primitives.map((function(e){var t=(e=ye({},e)).attributes;for(var r in e.attributes={},t)e.attributes[r]=n.getAccessor(t[r]);return void 0!==e.indices&&(e.indices=n.getAccessor(e.indices)),void 0!==e.material&&(e.material=n.getMaterial(e.material)),e}))),e},t._resolveMaterial=function(e,t){if(e.id=e.id||"material-"+t,e.normalTexture&&(e.normalTexture=ye({},e.normalTexture),e.normalTexture.texture=this.getTexture(e.normalTexture.index)),e.occlusionTexture&&(e.occlustionTexture=ye({},e.occlustionTexture),e.occlusionTexture.texture=this.getTexture(e.occlusionTexture.index)),e.emissiveTexture&&(e.emmisiveTexture=ye({},e.emmisiveTexture),e.emissiveTexture.texture=this.getTexture(e.emissiveTexture.index)),e.emissiveFactor||(e.emissiveFactor=e.emmisiveTexture?[1,1,1]:[0,0,0]),e.pbrMetallicRoughness){e.pbrMetallicRoughness=ye({},e.pbrMetallicRoughness);var n=e.pbrMetallicRoughness;n.baseColorTexture&&(n.baseColorTexture=ye({},n.baseColorTexture),n.baseColorTexture.texture=this.getTexture(n.baseColorTexture.index)),n.metallicRoughnessTexture&&(n.metallicRoughnessTexture=ye({},n.metallicRoughnessTexture),n.metallicRoughnessTexture.texture=this.getTexture(n.metallicRoughnessTexture.index))}return e},t._resolveAccessor=function(e,t){var n,r;if(e.id=e.id||"accessor-"+t,void 0!==e.bufferView&&(e.bufferView=this.getBufferView(e.bufferView)),e.bytesPerComponent=(n=e.componentType,Ae[n]),e.components=(r=e.type,xe[r]),e.bytesPerElement=e.bytesPerComponent*e.components,e.bufferView){var i=e.bufferView.buffer,s=w(e,e.bufferView),o=s.ArrayType,a=s.byteLength,u=(e.bufferView.byteOffset||0)+(e.byteOffset||0)+i.byteOffset,c=i.arrayBuffer.slice(u,u+a);e.value=new o(c)}return e},t._resolveTexture=function(e,t){return e.id=e.id||"texture-"+t,e.sampler="sampler"in e?this.getSampler(e.sampler):je,e.source=this.getImage(e.source),e},t._resolveSampler=function(e,t){for(var n in e.id=e.id||"sampler-"+t,e.parameters={},e){var r=this._enumSamplerParameter(n);void 0!==r&&(e.parameters[r]=e[n])}return e},t._enumSamplerParameter=function(e){return Se[e]},t._resolveImage=function(e,t){e.id=e.id||"image-"+t,void 0!==e.bufferView&&(e.bufferView=this.getBufferView(e.bufferView));var n=this.images[t];return n&&(e.image=n),e},t._resolveBufferView=function(e,t){e.id=e.id||"bufferView-"+t;var n=e.buffer;e.buffer=this.buffers[n];var r=this.buffers[n].arrayBuffer,i=this.buffers[n].byteOffset||0;return"byteOffset"in e&&(i+=e.byteOffset),e.data=new Uint8Array(r,i,e.byteLength),e},t._resolveCamera=function(e,t){return e.id=e.id||"camera-"+t,e.perspective,e.orthographic,e},e}();function Ie(e,t){return(new Te).postProcess(e,t)}var Re=n("P+ME");function we(e,t,n){void 0===t&&(t=0),void 0===n&&(n={});var r=new DataView(e),i=n.magic,s=void 0===i?1735152710:i,o=r.getUint32(t,!1);return o===s||1735152710===o}function Ee(e,t,n,r){void 0===n&&(n=0),void 0===r&&(r={});var i=new DataView(t);e.type=function(e,t){return void 0===t&&(t=0),""+String.fromCharCode(e.getUint8(t+0))+String.fromCharCode(e.getUint8(t+1))+String.fromCharCode(e.getUint8(t+2))+String.fromCharCode(e.getUint8(t+3))}(i,n+0),e.version=i.getUint32(n+4,!0);var s=i.getUint32(n+8,!0);switch(e.header={byteOffset:n,byteLength:s},e.json={},e.binChunks=[],n+=12,e.version){case 1:return function(e,t,n,r){Object(Re.a)(e.header.byteLength>20);var i=t.getUint32(n+0,!0),s=t.getUint32(n+4,!0);return n+=8,Object(Re.a)(0===s),Me(e,t,n,i,r),n+=i,n+=Le(e,t,n,e.header.byteLength,r)}(e,i,n,r={});case 2:return function(e,t,n,r){return Object(Re.a)(e.header.byteLength>20),function(e,t,n,r){for(;n+8<=e.header.byteLength;){var i=t.getUint32(n+0,!0),s=t.getUint32(n+4,!0);switch(n+=8,s){case 1313821514:Me(e,t,n,i,r);break;case 5130562:Le(e,t,n,i,r);break;case 0:r.glb.strict||Me(e,t,n,i,r);break;case 1:r.glb.strict||Le(e,t,n,i,r)}n+=Object(p.c)(i,4)}}(e,t,n,r),n+e.header.byteLength}(e,i,n,r={});default:throw new Error("Invalid GLB version "+e.version+". Only supports v1 and v2.")}}function Me(e,t,n,r,i){var s=new Uint8Array(t.buffer,n,r),o=new TextDecoder("utf8").decode(s);return e.json=JSON.parse(o),Object(p.c)(r,4)}function Le(e,t,n,r,i){return e.header.hasBinChunk=!0,e.binChunks.push({byteOffset:n,byteLength:r,arrayBuffer:t.buffer}),Object(p.c)(r,4)}function Ce(e,t,n,r,i){return Ne.apply(this,arguments)}function Ne(){return(Ne=Object(f.a)(u.a.mark((function e(t,n,r,i,s){var o,a,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===r&&(r=0),Pe(t,n,r,i),be(t,{normalize:i.gltf.normalize}),o=[],!i.gltf.loadBuffers||!t.json.buffers){e.next=7;break}return e.next=7,Be(t,i,s);case 7:return i.gltf.loadImages&&(a=Ve(t,i,s),o.push(a)),c=ue(t,i,s),o.push(c),e.next=12,Promise.all(o);case 12:return e.abrupt("return",i.gltf.postProcess?Ie(t,i):t);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Pe(e,t,n,r){(r.uri&&(e.baseUri=r.uri),t instanceof ArrayBuffer&&!we(t,n,r))&&(t=(new TextDecoder).decode(t));if("string"==typeof t)e.json=Object(h.a)(t);else if(t instanceof ArrayBuffer){var i={};n=Ee(i,t,n,r),m("glTF"===i.type,"Invalid GLB magic string "+i.type),e._glb=i,e.json=i.json}else m(!1,"GLTF: must be ArrayBuffer or string");var s=e.json.buffers||[];if(e.buffers=new Array(s.length).fill(null),e._glb&&e._glb.header.hasBinChunk){var o=e._glb.binChunks;e.buffers[0]={arrayBuffer:o[0].arrayBuffer,byteOffset:o[0].byteOffset,byteLength:o[0].byteLength}}var a=e.json.images||[];e.images=new Array(a.length).fill({})}function Be(e,t,n){return Ue.apply(this,arguments)}function Ue(){return(Ue=Object(f.a)(u.a.mark((function e(t,n,r){var i,s,o,a,c,f;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=0;case 1:if(!(i<t.json.buffers.length)){e.next=18;break}if(!(s=t.json.buffers[i]).uri){e.next=15;break}return m(o=r.fetch),a=v(s.uri,n),e.next=9,o(a);case 9:return c=e.sent,e.next=12,c.arrayBuffer();case 12:f=e.sent,t.buffers[i]={arrayBuffer:f,byteOffset:0,byteLength:f.byteLength},delete s.uri;case 15:++i,e.next=1;break;case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ve(e,t,n){return ke.apply(this,arguments)}function ke(){return(ke=Object(f.a)(u.a.mark((function e(t,n,r){var i,s,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(i=t.json.images||[],s=[],o=0;o<i.length;++o)s.push(De(t,i[o],o,n,r));return e.next=5,Promise.all(s);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function De(e,t,n,r,i){return Fe.apply(this,arguments)}function Fe(){return(Fe=Object(f.a)(u.a.mark((function e(t,n,r,i,s){var o,a,c,f,l,h,g;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=s.fetch,a=s.parse,!n.uri){e.next=9;break}return f=v(n.uri,i),e.next=5,o(f);case 5:return l=e.sent,e.next=8,l.arrayBuffer();case 8:c=e.sent;case 9:return Number.isFinite(n.bufferView)&&(h=b(t.json,t.buffers,n.bufferView),c=Object(p.b)(h.buffer,h.byteOffset,h.byteLength)),m(c,"glTF image has no data"),e.next=13,a(c,d.a,{},s);case 13:g=e.sent,t.images[r]=g;case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function He(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ge(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?He(Object(n),!0).forEach((function(t){Object(c.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):He(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ze={name:"glTF",id:"gltf",module:"gltf",version:l,extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:function(e,t,n){return qe.apply(this,arguments)},options:{gltf:{normalize:!0,loadBuffers:!0,loadImages:!0,decompressMeshes:!0,postProcess:!0},log:console},deprecatedOptions:{fetchImages:"gltf.loadImages",createImages:"gltf.loadImages",decompress:"gltf.decompressMeshes",postProcess:"gltf.postProcess",gltf:{decompress:"gltf.decompressMeshes"}}};function qe(){return(qe=Object(f.a)(u.a.mark((function e(t,n,r){var i,s,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===n&&(n={}),(n=Ge(Ge({},ze.options),n)).gltf=Ge(Ge({},ze.options.gltf),n.gltf),Xe(n),i=n.byteOffset,s=void 0===i?0:i,o={},e.next=8,Ce(o,t,s,n,r);case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Xe(e){"fetchImages"in e&&(e.gltf.loadImages=e.fetchImages),"createImages"in e&&(e.gltf.loadImages=e.createImages),"fetchLinkedResources"in e&&(e.gltf.fetchBuffers=e.fetchLinkedResources),"decompress"in e&&(e.gltf.decompressMeshes=e.decompress),"decompress"in e.gltf&&(e.gltf.decompressMeshes=e.gltf.decompress),"postProcess"in e&&(e.gltf.postProcess=e.postProcess)}},zLVn:function(e,t,n){"use strict";function r(e,t){if(null==e)return{};var n,r,i={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}n.d(t,"a",(function(){return r}))}}]);