(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"2lZV":function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}));var r="undefined"!=typeof window?window:e,i=(void 0!==e||window,"undefined"!=typeof document?document:{})}).call(this,n("yLpj"))},"6pOq":function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return f}));var r=n("1OyB"),i=n("vuIU"),a=n("rePB"),o=n("17x9"),s=n.n(o),c=n("2lZV");var u={container:s.a.object,gl:s.a.object,mapboxApiAccessToken:s.a.string,mapboxApiUrl:s.a.string,attributionControl:s.a.bool,preserveDrawingBuffer:s.a.bool,reuseMaps:s.a.bool,transformRequest:s.a.func,mapOptions:s.a.object,mapStyle:s.a.oneOfType([s.a.string,s.a.object]),visible:s.a.bool,asyncRender:s.a.bool,onLoad:s.a.func,onError:s.a.func,width:s.a.number,height:s.a.number,viewState:s.a.object,longitude:s.a.number,latitude:s.a.number,zoom:s.a.number,bearing:s.a.number,pitch:s.a.number,altitude:s.a.number},l={container:c.a.body,mapboxApiAccessToken:function(){var t=null;if("undefined"!=typeof window&&window.location){var n=window.location.search.match(/access_token=([^&\/]*)/);t=n&&n[1]}t||void 0===e||(t=t||{}.MapboxAccessToken||{}.REACT_APP_MAPBOX_ACCESS_TOKEN);return t||"no-token"}(),mapboxApiUrl:"https://api.mapbox.com",preserveDrawingBuffer:!1,attributionControl:!0,reuseMaps:!1,mapOptions:{},mapStyle:"mapbox://styles/mapbox/light-v8",visible:!0,asyncRender:!1,onLoad:function(){},onError:function(e){e&&console.error(e.error)},width:0,height:0,longitude:0,latitude:0,zoom:0,bearing:0,pitch:0,altitude:1.5};function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"component";e.debug&&s.a.checkPropTypes(u,e,"prop",t)}var f=function(){function e(t){var n=this;if(Object(r.a)(this,e),Object(a.a)(this,"mapboxgl",void 0),Object(a.a)(this,"props",l),Object(a.a)(this,"_map",null),Object(a.a)(this,"width",0),Object(a.a)(this,"height",0),Object(a.a)(this,"_fireLoadEvent",(function(){n.props.onLoad({type:"load",target:n._map})})),!t.mapboxgl)throw new Error("Mapbox not available");this.mapboxgl=t.mapboxgl,e.initialized||(e.initialized=!0,this._checkStyleSheet(this.mapboxgl.version)),this._initialize(t)}return Object(i.a)(e,[{key:"finalize",value:function(){return this._destroy(),this}},{key:"setProps",value:function(e){return this._update(this.props,e),this}},{key:"resize",value:function(){return this._map.resize(),this}},{key:"redraw",value:function(){var e=this._map;e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}},{key:"getMap",value:function(){return this._map}},{key:"_reuse",value:function(t){this._map=e.savedMap;var n=this._map.getContainer(),r=t.container;for(r.classList.add("mapboxgl-map");n.childNodes.length>0;)r.appendChild(n.childNodes[0]);this._map._container=r,e.savedMap=null,t.mapStyle&&this._map.setStyle(t.mapStyle,{diff:!1}),this._map.isStyleLoaded()?this._fireLoadEvent():this._map.once("styledata",this._fireLoadEvent)}},{key:"_create",value:function(t){if(t.reuseMaps&&e.savedMap)this._reuse(t);else{if(t.gl){var n=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=function(){return HTMLCanvasElement.prototype.getContext=n,t.gl}}var r={container:t.container,center:[0,0],zoom:8,pitch:0,bearing:0,maxZoom:24,style:t.mapStyle,interactive:!1,trackResize:!1,attributionControl:t.attributionControl,preserveDrawingBuffer:t.preserveDrawingBuffer};t.transformRequest&&(r.transformRequest=t.transformRequest),this._map=new this.mapboxgl.Map(Object.assign({},r,t.mapOptions)),this._map.once("load",t.onLoad),this._map.on("error",t.onError)}return this}},{key:"_destroy",value:function(){this._map&&(e.savedMap?this._map.remove():(e.savedMap=this._map,this._map.off("load",this.props.onLoad),this._map.off("error",this.props.onError),this._map.off("styledata",this._fireLoadEvent)),this._map=null)}},{key:"_initialize",value:function(e){var t=this;h(e=Object.assign({},l,e),"Mapbox"),this.mapboxgl.accessToken=e.mapboxApiAccessToken||l.mapboxApiAccessToken,this.mapboxgl.baseApiUrl=e.mapboxApiUrl,this._create(e);var n=e.container;Object.defineProperty(n,"offsetWidth",{get:function(){return t.width}}),Object.defineProperty(n,"clientWidth",{get:function(){return t.width}}),Object.defineProperty(n,"offsetHeight",{get:function(){return t.height}}),Object.defineProperty(n,"clientHeight",{get:function(){return t.height}});var r=this._map.getCanvas();r&&(r.style.outline="none"),this._updateMapViewport({},e),this._updateMapSize({},e),this.props=e}},{key:"_update",value:function(e,t){if(this._map){h(t=Object.assign({},this.props,t),"Mapbox");var n=this._updateMapViewport(e,t),r=this._updateMapSize(e,t);t.asyncRender||!n&&!r||this.redraw(),this.props=t}}},{key:"_updateMapSize",value:function(e,t){var n=e.width!==t.width||e.height!==t.height;return n&&(this.width=t.width,this.height=t.height,this.resize()),n}},{key:"_updateMapViewport",value:function(e,t){var n=this._getViewState(e),r=this._getViewState(t),i=r.latitude!==n.latitude||r.longitude!==n.longitude||r.zoom!==n.zoom||r.pitch!==n.pitch||r.bearing!==n.bearing||r.altitude!==n.altitude;return i&&(this._map.jumpTo(this._viewStateToMapboxProps(r)),r.altitude!==n.altitude&&(this._map.transform.altitude=r.altitude)),i}},{key:"_getViewState",value:function(e){var t=e.viewState||e,n=t.longitude,r=t.latitude,i=t.zoom,a=t.pitch,o=void 0===a?0:a,s=t.bearing,c=void 0===s?0:s,u=t.altitude;return{longitude:n,latitude:r,zoom:i,pitch:o,bearing:c,altitude:void 0===u?1.5:u}}},{key:"_checkStyleSheet",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"0.47.0";if(void 0!==c.a)try{var t=c.a.createElement("div");t.className="mapboxgl-map",t.style.display="none",c.a.body.append(t);var n="static"!==window.getComputedStyle(t).position;if(!n){var r=c.a.createElement("link");r.setAttribute("rel","stylesheet"),r.setAttribute("type","text/css"),r.setAttribute("href","https://api.tiles.mapbox.com/mapbox-gl-js/v".concat(e,"/mapbox-gl.css")),c.a.head.append(r)}}catch(i){}}},{key:"_viewStateToMapboxProps",value:function(e){return{center:[e.longitude,e.latitude],zoom:e.zoom,bearing:e.bearing,pitch:e.pitch}}}]),e}();Object(a.a)(f,"initialized",!1),Object(a.a)(f,"propTypes",u),Object(a.a)(f,"defaultProps",l),Object(a.a)(f,"savedMap",null)}).call(this,n("8oxB"))},"9h7C":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={};function i(e){var t=e&&e.lastIndexOf("/");return t>=0?e.substr(0,t):""}function a(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r="/";return(t=t.map((function(e,n){return n&&(e=e.replace(new RegExp("^"+r),"")),n!==t.length-1&&(e=e.replace(new RegExp(r+"$"),"")),e}))).join(r)}n.r(r),n.d(r,"dirname",(function(){return i})),n.d(r,"join",(function(){return a}))},Ed8q:function(e,t,n){"use strict";var r=n("o0o1"),i=n.n(r),a=(n("wcNg"),n("HaE+")),o=n("9h7C"),s=n("O6hP"),c={COMPOSITE:"cmpt",POINT_CLOUD:"pnts",BATCHED_3D_MODEL:"b3dm",INSTANCED_3D_MODEL:"i3dm",GEOMETRY:"geom",VECTOR:"vect"},u=(Object.keys(c),n("P+ME"));function l(e,t,n){Object(u.a)(e instanceof ArrayBuffer);var r=new TextDecoder("utf8"),i=new Uint8Array(e,t,n);return r.decode(i)}function h(e,t){void 0===t&&(t=0);var n=new DataView(e);return""+String.fromCharCode(n.getUint8(t+0))+String.fromCharCode(n.getUint8(t+1))+String.fromCharCode(n.getUint8(t+2))+String.fromCharCode(n.getUint8(t+3))}var f=n("rePB"),p=n("1Nab");function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){Object(f.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var m,g={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DOUBLE:5130},b=v(v({},{POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6}),g),y=n("zXfU"),_=((m={})[g.DOUBLE]=Float64Array,m[g.FLOAT]=Float32Array,m[g.UNSIGNED_SHORT]=Uint16Array,m[g.UNSIGNED_INT]=Uint32Array,m[g.UNSIGNED_BYTE]=Uint8Array,m[g.BYTE]=Int8Array,m[g.SHORT]=Int16Array,m[g.INT]=Int32Array,m),O={DOUBLE:g.DOUBLE,FLOAT:g.FLOAT,UNSIGNED_SHORT:g.UNSIGNED_SHORT,UNSIGNED_INT:g.UNSIGNED_INT,UNSIGNED_BYTE:g.UNSIGNED_BYTE,BYTE:g.BYTE,SHORT:g.SHORT,INT:g.INT},j=function(){function e(){}return e.fromTypedArray=function(e){for(var t in e=ArrayBuffer.isView(e)?e.constructor:e,_){if(_[t]===e)return t}throw new Error("Failed to convert GL type")},e.fromName=function(e){var t=O[e];if(!t)throw new Error("Failed to convert GL type");return t},e.getArrayType=function(e,t){switch(void 0===t&&(t=!1),e){case g.UNSIGNED_SHORT_5_6_5:case g.UNSIGNED_SHORT_4_4_4_4:case g.UNSIGNED_SHORT_5_5_5_1:return Uint16Array;default:var n=_[e];if(!n)throw new Error("Failed to convert GL type");return n}},e.getByteSize=function(t){return e.getArrayType(t).BYTES_PER_ELEMENT},e.validate=function(t){return Boolean(e.getArrayType(t))},e.createTypedArray=function(t,n,r,i){return void 0===r&&(r=0),void 0===i&&(i=(n.byteLength-r)/e.getByteSize(t)),new(e.getArrayType(t))(n,r,i)},e}(),w=function(){function e(e,t){this.json=e,this.buffer=t,this.featuresLength=0,this._cachedTypedArrays={}}var t=e.prototype;return t.getExtension=function(e){return this.json.extensions&&this.json.extensions[e]},t.hasProperty=function(e){return Boolean(this.json[e])},t.getGlobalProperty=function(e,t,n){void 0===t&&(t=b.UNSIGNED_INT),void 0===n&&(n=1);var r=this.json[e];return r&&Number.isFinite(r.byteOffset)?this._getTypedArrayFromBinary(e,t,n,1,r.byteOffset):r},t.getPropertyArray=function(e,t,n){var r=this.json[e];return r&&Number.isFinite(r.byteOffset)?("componentType"in r&&(t=j.fromName(r.componentType)),this._getTypedArrayFromBinary(e,t,n,this.featuresLength,r.byteOffset)):this._getTypedArrayFromArray(e,t,r)},t.getProperty=function(e,t,n,r,i){var a=this.json[e];if(!a)return a;var o=this.getPropertyArray(e,t,n);if(1===n)return o[r];for(var s=0;s<n;++s)i[s]=o[n*r+s];return i},t._getTypedArrayFromBinary=function(e,t,n,r,i){var a=this._cachedTypedArrays,o=a[e];return o||(o=j.createTypedArray(t,this.buffer.buffer,this.buffer.byteOffset+i,r*n),a[e]=o),o},t._getTypedArrayFromArray=function(e,t,n){var r=this._cachedTypedArrays,i=r[e];return i||(i=j.createTypedArray(t,n),r[e]=i),i},e}(),S=n("KQm4"),T={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},E={SCALAR:function(e,t){return e[t]},VEC2:function(e,t){return[e[2*t+0],e[2*t+1]]},VEC3:function(e,t){return[e[3*t+0],e[3*t+1],e[3*t+2]]},VEC4:function(e,t){return[e[4*t+0],e[4*t+1],e[4*t+2],e[4*t+3]]},MAT2:function(e,t){return[e[4*t+0],e[4*t+1],e[4*t+2],e[4*t+3]]},MAT3:function(e,t){return[e[9*t+0],e[9*t+1],e[9*t+2],e[9*t+3],e[9*t+4],e[9*t+5],e[9*t+6],e[9*t+7],e[9*t+8]]},MAT4:function(e,t){return[e[16*t+0],e[16*t+1],e[16*t+2],e[16*t+3],e[16*t+4],e[16*t+5],e[16*t+6],e[16*t+7],e[16*t+8],e[16*t+9],e[16*t+10],e[16*t+11],e[16*t+12],e[16*t+13],e[16*t+14],e[16*t+15]]}},x={SCALAR:function(e,t,n){t[n]=e},VEC2:function(e,t,n){t[2*n+0]=e[0],t[2*n+1]=e[1]},VEC3:function(e,t,n){t[3*n+0]=e[0],t[3*n+1]=e[1],t[3*n+2]=e[2]},VEC4:function(e,t,n){t[4*n+0]=e[0],t[4*n+1]=e[1],t[4*n+2]=e[2],t[4*n+3]=e[3]},MAT2:function(e,t,n){t[4*n+0]=e[0],t[4*n+1]=e[1],t[4*n+2]=e[2],t[4*n+3]=e[3]},MAT3:function(e,t,n){t[9*n+0]=e[0],t[9*n+1]=e[1],t[9*n+2]=e[2],t[9*n+3]=e[3],t[9*n+4]=e[4],t[9*n+5]=e[5],t[9*n+6]=e[6],t[9*n+7]=e[7],t[9*n+8]=e[8],t[9*n+9]=e[9]},MAT4:function(e,t,n){t[16*n+0]=e[0],t[16*n+1]=e[1],t[16*n+2]=e[2],t[16*n+3]=e[3],t[16*n+4]=e[4],t[16*n+5]=e[5],t[16*n+6]=e[6],t[16*n+7]=e[7],t[16*n+8]=e[8],t[16*n+9]=e[9],t[16*n+10]=e[10],t[16*n+11]=e[11],t[16*n+12]=e[12],t[16*n+13]=e[13],t[16*n+14]=e[14],t[16*n+15]=e[15]}};function P(e){throw new Error('"'+e+'" is read-only')}var M=function(e){return void 0!==e};function A(e,t,n){if(!t)return null;var r=e.getExtension("3DTILES_batch_table_hierarchy"),i=t.HIERARCHY;return i&&(console.warn("3D Tile Parser: HIERARCHY is deprecated. Use 3DTILES_batch_table_hierarchy."),t.extensions=t.extensions||{},t.extensions["3DTILES_batch_table_hierarchy"]=i,r=i),r?function(e,t){var n,r,i,a,o=e.instancesLength,s=e.classes,c=e.classIds,u=e.parentCounts,l=e.parentIds,h=o;M(c.byteOffset)&&(c.componentType=defaultValue(c.componentType,GL.UNSIGNED_SHORT),c.type=AttributeType.SCALAR,i=getBinaryAccessor(c),P("classIds"),c=i.createArrayBufferView(t.buffer,t.byteOffset+c.byteOffset,o));if(M(u))for(M(u.byteOffset)&&(u.componentType=defaultValue(u.componentType,GL.UNSIGNED_SHORT),u.type=AttributeType.SCALAR,i=getBinaryAccessor(u),P("parentCounts"),u=i.createArrayBufferView(t.buffer,t.byteOffset+u.byteOffset,o)),a=new Uint16Array(o),P("parentIdsLength"),h=0,n=0;n<o;++n)a[n]=h,h+=(P("parentIdsLength"),u[n]);M(l)&&M(l.byteOffset)&&(l.componentType=defaultValue(l.componentType,GL.UNSIGNED_SHORT),l.type=AttributeType.SCALAR,i=getBinaryAccessor(l),P("parentIds"),l=i.createArrayBufferView(t.buffer,t.byteOffset+l.byteOffset,h));var f=s.length;for(n=0;n<f;++n){var p=s[n].length,d=s[n].instances,v=getBinaryProperties(p,d,t);s[n].instances=combine(v,d)}var m=new Array(f).fill(0),g=new Uint16Array(o);for(n=0;n<o;++n)r=c[n],g[n]=m[r],++m[r];var b={classes:s,classIds:c,classIndexes:g,parentCounts:u,parentIndexes:a,parentIds:l};return function(e){for(var t=e.classIds.length,n=0;n<t;++n)R(e,n,stack)}(b),b}(r,n):null}function k(e,t,n){if(e){var r=e.parentCounts;return e.parentIds?n(e,t):r>0?function(e,t,n){var r=e.classIds,i=e.parentCounts,a=e.parentIds,o=e.parentIndexes,s=r.length,c=scratchVisited;c.length=Math.max(c.length,s);var u=++marker,l=scratchStack;l.length=0,l.push(t);for(;l.length>0;)if(t=l.pop(),c[t]!==u){c[t]=u;var h=n(e,t);if(M(h))return h;for(var f=i[t],p=o[t],d=0;d<f;++d){var v=a[p+d];v!==t&&l.push(v)}}return null}(e,t,n):function(e,t,n){var r=!0;for(;r;){var i=n(e,t);if(M(i))return i;var a=e.parentIds[t];r=a!==t,t=a}throw new Error("traverseHierarchySingleParent")}(e,t,n)}}function R(e,t,n){var r=e.parentCounts,i=e.parentIds,a=e.parentIndexes,o=e.classIds.length;if(M(i)){assert(t<o,"Parent index "+t+" exceeds the total number of instances: "+o),assert(-1===n.indexOf(t),"Circular dependency detected in the batch table hierarchy."),n.push(t);for(var s=M(r)?r[t]:1,c=M(r)?a[t]:t,u=0;u<s;++u){var l=i[c+u];l!==t&&R(e,l,n)}n.pop(t)}}function C(e){return null!=e}var I=function(e,t){return e},L={HIERARCHY:!0,extensions:!0,extras:!0},N=function(){function e(e,t,n,r){for(var i in void 0===r&&(r={}),Object(u.a)(n>=0),this.json=e||{},this.binary=t,this.featureCount=n,this._extensions=this.json&&this.json.extensions||{},this._properties={},this.json)L[i]||(this._properties[i]=this.json[i]);this._binaryProperties=this._initializeBinaryProperties(),r["3DTILES_batch_table_hierarchy"]&&(this._hierarchy=A(this,this.json,this.binary))}var t=e.prototype;return t.getExtension=function(e){return this.json&&this.json.extensions&&this.json.extensions[e]},t.memorySizeInBytes=function(){return 0},t.isClass=function(e,t){return this._checkBatchId(e),Object(u.a)("string"==typeof t,t),!!this._hierarchy&&C(k(this._hierarchy,e,(function(e,n){var r=e.classIds[n];return e.classes[r].name===t})))},t.isExactClass=function(e,t){return Object(u.a)("string"==typeof t,t),this.getExactClassName(e)===t},t.getExactClassName=function(e){if(this._checkBatchId(e),this._hierarchy){var t=this._hierarchy.classIds[e];return this._hierarchy.classes[t].name}},t.hasProperty=function(e,t){return this._checkBatchId(e),Object(u.a)("string"==typeof t,t),C(this._properties[t])||this._hasPropertyInHierarchy(e,t)},t.getPropertyNames=function(e,t){var n;this._checkBatchId(e),(t=C(t)?t:[]).length=0;var r=Object.keys(this._properties);return(n=t).push.apply(n,Object(S.a)(r)),this._hierarchy&&this._getPropertyNamesInHierarchy(e,t),t},t.getProperty=function(e,t){if(this._checkBatchId(e),Object(u.a)("string"==typeof t,t),this._binaryProperties){var n=this._binaryProperties[t];if(C(n))return this._getBinaryProperty(n,e)}var r=this._properties[t];if(C(r))return I(r[e]);if(this._hierarchy){var i=this._getHierarchyProperty(e,t);if(C(i))return i}},t.setProperty=function(e,t,n){var r=this.featureCount;if(this._checkBatchId(e),Object(u.a)("string"==typeof t,t),this._binaryProperties){var i=this._binaryProperties[t];if(i)return void this._setBinaryProperty(i,e,n)}if(!this._hierarchy||!this._setHierarchyProperty(this,e,t,n)){var a=this._properties[t];C(a)||(this._properties[t]=new Array(r),a=this._properties[t]),a[e]=I(n)}},t._checkBatchId=function(e){if(!(e>=0&&e<this.featureCount))throw new Error("batchId not in range [0, featureCount - 1].")},t._getBinaryProperty=function(e,t){return e.unpack(e.typedArray,t)},t._setBinaryProperty=function(e,t,n){e.pack(n,e.typedArray,t)},t._initializeBinaryProperties=function(){var e=null;for(var t in this._properties){var n=this._properties[t],r=this._initializeBinaryProperty(t,n);r&&((e=e||{})[t]=r)}return e},t._initializeBinaryProperty=function(e,t){if("byteOffset"in t){var n=t;Object(u.a)(this.binary,"Property "+e+" requires a batch table binary."),Object(u.a)(n.type,"Property "+e+" requires a type.");var r=function(e,t,n,r){var i=e.componentType;Object(u.a)(e.componentType);var a="string"==typeof i?j.fromName(i):i,o=T[e.type],s=E[e.type],c=x[e.type];return n+=e.byteOffset,{values:j.createTypedArray(a,t,n,o*r),type:a,size:o,unpacker:s,packer:c}}(n,this.binary.buffer,0|this.binary.byteOffset,this.featureCount);return{typedArray:r.values,componentCount:r.size,unpack:r.unpacker,pack:r.packer}}return null},t._hasPropertyInHierarchy=function(e,t){if(!this._hierarchy)return!1;var n=k(this._hierarchy,e,(function(e,n){var r=e.classIds[n];return C(e.classes[r].instances[t])}));return C(n)},t._getPropertyNamesInHierarchy=function(e,t){k(this._hierarchy,e,(function(e,n){var r=e.classIds[n],i=e.classes[r].instances;for(var a in i)i.hasOwnProperty(a)&&-1===t.indexOf(a)&&t.push(a)}))},t._getHierarchyProperty=function(e,t){var n=this;return k(this._hierarchy,e,(function(e,r){var i=e.classIds[r],a=e.classes[i],o=e.classIndexes[r],s=a.instances[t];return C(s)?C(s.typedArray)?n._getBinaryProperty(s,o):I(s[o]):null}))},t._setHierarchyProperty=function(e,t,n,r){var i=this,a=k(this._hierarchy,t,(function(e,a){var o=e.classIds[a],s=e.classes[o],c=e.classIndexes[a],l=s.instances[n];return!!C(l)&&(Object(u.a)(a===t,'Inherited property "'+n+'" is read-only.'),C(l.typedArray)?i._setBinaryProperty(l,c,r):l[c]=I(r),!0)}));return C(a)},e}();function D(e,t,n){void 0===n&&(n=0);var r=new DataView(t);if(e.magic=r.getUint32(n,!0),n+=4,e.version=r.getUint32(n,!0),n+=4,e.byteLength=r.getUint32(n,!0),n+=4,1!==e.version)throw new Error("3D Tile Version "+e.version+" not supported");return n}function z(e,t,n){var r=new DataView(t);return e.header=e.header||{},e.header.featureTableJsonByteLength=r.getUint32(n,!0),n+=4,e.header.featureTableBinaryByteLength=r.getUint32(n,!0),n+=4,e.header.batchTableJsonByteLength=r.getUint32(n,!0),n+=4,e.header.batchTableBinaryByteLength=r.getUint32(n,!0),n+=4}function U(e,t,n,r){return n=function(e,t,n,r){var i=e.header,a=i.featureTableJsonByteLength,o=i.featureTableBinaryByteLength;if(e.featureTableJson={BATCH_LENGTH:0},a>0){var s=l(t,n,a);e.featureTableJson=JSON.parse(s)}return n+=a,e.featureTableBinary=new Uint8Array(t,n,o),n+=o}(e,t,n),n=function(e,t,n,r){var i=e.header,a=i.batchTableJsonByteLength,o=i.batchTableBinaryByteLength;if(a>0){var s=l(t,n,a);e.batchTableJson=JSON.parse(s),n+=a,o>0&&(e.batchTableBinary=new Uint8Array(t,n,o),e.batchTableBinary=new Uint8Array(e.batchTableBinary),n+=o)}return n}(e,t,n)}function B(e,t){void 0===t&&(t=[0,0,0]);var n=e>>11&31,r=e>>5&63,i=31&e;return t[0]=n<<3,t[1]=r<<2,t[2]=i<<3,t}function V(e,t,n){if(!(t||e&&e.batchIds&&n))return null;var r=e.batchIds,i=e.isRGB565,a=e.pointCount;if(r&&n){for(var o=new Uint8ClampedArray(3*a),s=0;s<a;s++){var c=r[s],u=n.getProperty(c,"dimensions").map((function(e){return 255*e}));o[3*s]=u[0],o[3*s+1]=u[1],o[3*s+2]=u[2]}return{type:b.UNSIGNED_BYTE,value:o,size:3,normalized:!0}}if(i){for(var l=new Uint8ClampedArray(3*a),h=0;h<a;h++){var f=B(t[h]);l[3*h]=f[0],l[3*h+1]=f[1],l[3*h+2]=f[2]}return{type:b.UNSIGNED_BYTE,value:l,size:3,normalized:!0}}return t&&t.length===3*a?{type:b.UNSIGNED_BYTE,value:t,size:3,normalized:!0}:{type:b.UNSIGNED_BYTE,value:t,size:4,normalized:!0}}var F=n("Oz/4"),G=n("a3TU");n("gOKY");function q(e,t){if(!e)throw new Error("math.gl assertion failed. "+t)}new F.a,new y.a,new F.a,new F.a,new Uint8Array(1);function H(e,t){return void 0===t&&(t=255),Object(G.a)(e,0,t)/t*2-1}function Z(e){return e<0?-1:1}function W(e,t,n,r){if(q(r),e<0||e>n||t<0||t>n)throw new Error("x and y must be unsigned normalized integers between 0 and "+n);if(r.x=H(e,n),r.y=H(t,n),r.z=1-(Math.abs(r.x)+Math.abs(r.y)),r.z<0){var i=r.x;r.x=(1-Math.abs(r.y))*Z(i),r.y=(1-Math.abs(i))*Z(r.y)}return r.normalize()}function K(e,t,n){return W(e,t,255,n)}var X=new y.a;function Y(e,t,n){return e.isQuantized?n["3d-tiles"]&&n["3d-tiles"].decodeQuantizedPositions?(e.isQuantized=!1,function(e,t){for(var n=new y.a,r=new Float32Array(3*e.pointCount),i=0;i<e.pointCount;i++)n.set(t[3*i],t[3*i+1],t[3*i+2]).scale(1/e.quantizedRange).multiply(e.quantizedVolumeScale).add(e.quantizedVolumeOffset).toArray(r,3*i);return r}(e,t)):{type:b.UNSIGNED_SHORT,value:t,size:3,normalized:!0}:t}function Q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function J(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(n),!0).forEach((function(t){Object(f.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function $(e,t,n,r,i){return ee.apply(this,arguments)}function ee(){return(ee=Object(a.a)(i.a.mark((function e(t,n,r,a,o){var s,c,u;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=D(t,n,r),r=z(t,n,r),r=U(t,n,r),te(t),s=ne(t),c=s.featureTable,u=s.batchTable,e.next=7,oe(t,c,u,a,o);case 7:return re(t,c,a),ie(t,c,u),ae(t,c),e.abrupt("return",r);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function te(e){e.attributes={positions:null,colors:null,normals:null,batchIds:null},e.isQuantized=!1,e.isTranslucent=!1,e.isRGB565=!1,e.isOctEncoded16P=!1}function ne(e){var t=new w(e.featureTableJson,e.featureTableBinary),n=t.getGlobalProperty("POINTS_LENGTH");if(!Number.isFinite(n))throw new Error("POINTS_LENGTH must be defined");t.featuresLength=n,e.featuresLength=n,e.pointsLength=n,e.pointCount=n,e.rtcCenter=t.getGlobalProperty("RTC_CENTER",b.FLOAT,3);var r=function(e,t){var n=null;if(!e.batchIds&&t.hasProperty("BATCH_ID")&&(e.batchIds=t.getPropertyArray("BATCH_ID",b.UNSIGNED_SHORT,1),e.batchIds)){var r=t.getGlobalProperty("BATCH_LENGTH");if(!r)throw new Error("Global property: BATCH_LENGTH must be defined when BATCH_ID is defined.");var i=e.batchTableJson,a=e.batchTableBinary;n=new N(i,a,r)}return n}(e,t);return{featureTable:t,batchTable:r}}function re(e,t,n){if(!e.attributes.positions)if(t.hasProperty("POSITION"))e.attributes.positions=t.getPropertyArray("POSITION",b.FLOAT,3);else if(t.hasProperty("POSITION_QUANTIZED")){var r=t.getPropertyArray("POSITION_QUANTIZED",b.UNSIGNED_SHORT,3);if(e.isQuantized=!0,e.quantizedRange=65535,e.quantizedVolumeScale=t.getGlobalProperty("QUANTIZED_VOLUME_SCALE",b.FLOAT,3),!e.quantizedVolumeScale)throw new Error("QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");if(e.quantizedVolumeOffset=t.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",b.FLOAT,3),!e.quantizedVolumeOffset)throw new Error("QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");e.attributes.positions=Y(e,r,n)}if(!e.attributes.positions)throw new Error("Either POSITION or POSITION_QUANTIZED must be defined.")}function ie(e,t,n){if(!e.attributes.colors){var r=null;t.hasProperty("RGBA")?(r=t.getPropertyArray("RGBA",b.UNSIGNED_BYTE,4),e.isTranslucent=!0):t.hasProperty("RGB")?r=t.getPropertyArray("RGB",b.UNSIGNED_BYTE,3):t.hasProperty("RGB565")&&(r=t.getPropertyArray("RGB565",b.UNSIGNED_SHORT,1),e.isRGB565=!0),e.attributes.colors=V(e,r,n)}t.hasProperty("CONSTANT_RGBA")&&(e.constantRGBA=t.getGlobalProperty("CONSTANT_RGBA",b.UNSIGNED_BYTE,4))}function ae(e,t){if(!e.attributes.normals){var n=null;t.hasProperty("NORMAL")?n=t.getPropertyArray("NORMAL",b.FLOAT,3):t.hasProperty("NORMAL_OCT16P")&&(n=t.getPropertyArray("NORMAL_OCT16P",b.UNSIGNED_BYTE,2),e.isOctEncoded16P=!0),e.attributes.normals=function(e,t){if(!t)return null;if(e.isOctEncoded16P){for(var n=new Float32Array(3*e.pointsLength),r=0;r<e.pointsLength;r++)K(t[2*r],t[2*r+1],X),X.toArray(n,3*r);return{type:b.FLOAT,size:2,value:n}}return{type:b.FLOAT,size:2,value:t}}(e,n)}}function oe(e,t,n,r,i){return se.apply(this,arguments)}function se(){return(se=Object(a.a)(i.a.mark((function e(t,n,r,a,o){var s,c,u,l,h,f,p,d;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((l=t.batchTableJson&&t.batchTableJson.extensions&&t.batchTableJson.extensions["3DTILES_draco_point_compression"])&&(u=l.properties),!(h=n.getExtension("3DTILES_draco_point_compression"))){e.next=15;break}if(c=h.properties,f=h.byteOffset,p=h.byteLength,c&&Number.isFinite(f)&&p){e.next=9;break}throw new Error("Draco properties, byteOffset, and byteLength must be defined");case 9:s=t.featureTableBinary.slice(f,f+p),t.hasPositions=Number.isFinite(c.POSITION),t.hasColors=Number.isFinite(c.RGB)||Number.isFinite(c.RGBA),t.hasNormals=Number.isFinite(c.NORMAL),t.hasBatchIds=Number.isFinite(c.BATCH_ID),t.isTranslucent=Number.isFinite(c.RGBA);case 15:if(s){e.next=17;break}return e.abrupt("return",!0);case 17:return d={buffer:s,properties:J(J({},c),u),featureTableProperties:c,batchTableProperties:u,dequantizeInShader:!1},e.next=20,ce(t,d,a,o);case 20:return e.abrupt("return",e.sent);case 21:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ce(e,t,n,r){return ue.apply(this,arguments)}function ue(){return(ue=Object(a.a)(i.a.mark((function e(t,n,r,a){var o,s,c,u,l,h,f,d,v,m,g,b,_,O,j;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=a.parse,delete(s=J(J({},r),{},{draco:J(J({},r.draco),{},{extraAttributes:n.batchTableProperties||{}})}))["3d-tiles"],e.next=5,o(n.buffer,p.a,s);case 5:if(c=e.sent,u=c.attributes.POSITION&&c.attributes.POSITION.value,l=c.attributes.COLOR_0&&c.attributes.COLOR_0.value,h=c.attributes.NORMAL&&c.attributes.NORMAL.value,f=c.attributes.BATCH_ID&&c.attributes.BATCH_ID.value,d=u&&c.attributes.POSITION.value.quantization,v=h&&c.attributes.NORMAL.value.quantization,d&&(m=c.POSITION.data.quantization,g=m.range,t.quantizedVolumeScale=new y.a(g,g,g),t.quantizedVolumeOffset=new y.a(m.minValues),t.quantizedRange=(1<<m.quantizationBits)-1,t.isQuantizedDraco=!0),v&&(t.octEncodedRange=(1<<c.NORMAL.data.quantization.quantizationBits)-1,t.isOctEncodedDraco=!0),b={},n.batchTableProperties)for(_=0,O=Object.keys(n.batchTableProperties);_<O.length;_++)j=O[_],c.attributes[j]&&c.attributes[j].value&&(b[j.toLowerCase()]=c.attributes[j].value);t.attributes=J({positions:u,colors:V(t,l),normals:h,batchIds:f},b);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var le=n("yx+g"),he=n("ngZ5"),fe=0,pe=1;function de(e,t,n,r){e.rotateYtoZ=!0;var i=e.byteOffset+e.byteLength-n;if(0===i)throw new Error("glTF byte length must be greater than 0.");return e.gltfUpAxis=r["3d-tiles"]&&r["3d-tiles"].assetGltfUpAxis?r["3d-tiles"].assetGltfUpAxis:"Y",e.gltfArrayBuffer=Object(he.b)(t,n,i),e.gltfByteOffset=0,e.gltfByteLength=i,n%4==0||console.warn(e.type+": embedded glb is not aligned to a 4-byte boundary."),e.byteOffset+e.byteLength}function ve(e,t,n,r){return me.apply(this,arguments)}function me(){return(me=Object(a.a)(i.a.mark((function e(t,n,r,a){var o,s,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=r["3d-tiles"]||{},ge(t,n,r),!o.loadGLTF){e.next=16;break}if(s=a.parse,c=a.fetch,!t.gltfUrl){e.next=9;break}return e.next=7,c(t.gltfUrl,r);case 7:t.gltfArrayBuffer=e.sent,t.gltfByteOffset=0;case 9:if(!t.gltfArrayBuffer){e.next=16;break}return e.next=12,s(t.gltfArrayBuffer,le.a,r,a);case 12:t.gltf=e.sent,delete t.gltfArrayBuffer,delete t.gltfByteOffset,delete t.gltfByteLength;case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ge(e,t,n){switch(t){case fe:var r=new Uint8Array(e.gltfArrayBuffer,e.gltfByteOffset),i=(new TextDecoder).decode(r);e.gltfUrl=i.replace(/[\s\0]+$/,""),delete e.gltfArrayBuffer,delete e.gltfByteOffset,delete e.gltfByteLength;break;case pe:break;default:throw new Error("b3dm: Illegal glTF format field")}}function be(e,t,n,r,i){return ye.apply(this,arguments)}function ye(){return(ye=Object(a.a)(i.a.mark((function e(t,n,r,a,o){var s,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=_e(t,n,r,a,o),e.next=3,ve(t,pe,a,o);case 3:return s=t.gltf||{},(c=s.extensions)&&c.CESIUM_RTC&&(t.rtcCenter=c.CESIUM_RTC.center),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _e(e,t,n,r,i){n=de(e,t,n=U(e,t,n=z(e,t,n=D(e,t,n))),r);var a=new w(e.featureTableJson,e.featureTableBinary);return e.rtcCenter=a.getGlobalProperty("RTC_CENTER",b.FLOAT,3),n}var Oe=n("GA6j"),je=n("Xjzu"),we=n("Nw31"),Se=n("Ns70");function Te(e,t,n,r,i){return Ee.apply(this,arguments)}function Ee(){return(Ee=Object(a.a)(i.a.mark((function e(t,n,r,a,o){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=xe(t,n,r,a,o),e.next=3,ve(t,t.gltfFormat,a,o);case 3:return e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function xe(e,t,n,r,i){if(n=D(e,t,n),1!==e.version)throw new Error("Instanced 3D Model version "+e.version+" is not supported");n=z(e,t,n);var a=new DataView(t);if(e.gltfFormat=a.getUint32(n,!0),n=de(e,t,n=U(e,t,n+=4),r),0===e.featureTableJsonByteLength)throw new Error("i3dm parser: featureTableJsonByteLength is zero.");var o=new w(e.featureTableJson,e.featureTableBinary),s=o.getGlobalProperty("INSTANCES_LENGTH");if(o.featuresLength=s,!Number.isFinite(s))throw new Error("i3dm parser: INSTANCES_LENGTH must be defined");e.eastNorthUp=o.getGlobalProperty("EAST_NORTH_UP"),e.rtcCenter=o.getGlobalProperty("RTC_CENTER",b.FLOAT,3);new N(e.batchTableJson,e.batchTableBinary,s);return function(e,t,n,r){for(var i=[new Array(r),e._batchTable][0],a=new y.a,o=(new y.a,new y.a,new y.a,new Oe.a),s=new je.a,c=new y.a,u={},l=new we.a,h=[],f=[],p=new y.a,d=new y.a,v=0;v<r;v++){var m=void 0;if(t.hasProperty("POSITION"))m=t.getProperty("POSITION",b.FLOAT,3,v,a);else if(t.hasProperty("POSITION_QUANTIZED")){m=t.getProperty("POSITION_QUANTIZED",b.UNSIGNED_SHORT,3,v,a);var g=t.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",b.FLOAT,3,p);if(!g)throw new Error("i3dm parser: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");var _=t.getGlobalProperty("QUANTIZED_VOLUME_SCALE",b.FLOAT,3,d);if(!_)throw new Error("i3dm parser: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");for(var O=0;O<3;O++)m[O]=m[O]/65535*_[O]+g[O]}if(!m)throw new Error("i3dm: POSITION or POSITION_QUANTIZED must be defined for each instance.");a.copy(m),u.translation=a,e.normalUp=t.getProperty("NORMAL_UP",b.FLOAT,3,v,h),e.normalRight=t.getProperty("NORMAL_RIGHT",b.FLOAT,3,v,f);if(e.normalUp){if(!e.normalRight)throw new Error("i3dm: Custom orientation requires both NORMAL_UP and NORMAL_RIGHT.");e.hasCustomOrientation=!0}else{if(e.octNormalUp=t.getProperty("NORMAL_UP_OCT32P",b.UNSIGNED_SHORT,2,h),e.octNormalRight=t.getProperty("NORMAL_RIGHT_OCT32P",b.UNSIGNED_SHORT,2,f),e.octNormalUp){if(!e.octNormalRight)throw new Error("i3dm: oct-encoded orientation requires NORMAL_UP_OCT32P and NORMAL_RIGHT_OCT32P");throw new Error("i3dm: oct-encoded orientation not implemented")}e.eastNorthUp?(Se.a.WGS84.eastNorthUpToFixedFrame(a,l),l.getRotationMatrix3(o)):o.identity()}!1,s.fromMatrix3(o),u.rotation=s,c.set(1,1,1);var j=t.getProperty("SCALE",b.FLOAT,1,v);Number.isFinite(j)&&c.multiplyByScalar(j);var w=t.getProperty("SCALE_NON_UNIFORM",b.FLOAT,3,v,h);w&&c.scale(w),u.scale=c;var S=t.getProperty("BATCH_ID",b.UNSIGNED_SHORT,1,v);void 0===S&&(S=v);var T=(new we.a).fromQuaternion(u.rotation);l.identity(),l.translate(u.translation),l.multiplyRight(T),l.scale(u.scale);var E=l.clone();i[v]={modelMatrix:E,batchId:S}}e.instances=i}(e,o,0,s),n}function Pe(e,t,n,r,i,a){return Me.apply(this,arguments)}function Me(){return(Me=Object(a.a)(i.a.mark((function e(t,n,r,a,o,s){var c,u;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=D(t,n,r),c=new DataView(n),t.tilesLength=c.getUint32(r,!0),r+=4,t.tiles=[];case 5:if(!(t.tiles.length<t.tilesLength&&t.byteLength-r>12)){e.next=13;break}return u={},t.tiles.push(u),e.next=10,s(n,r,a,o,u);case 10:r=e.sent,e.next=5;break;case 13:return e.abrupt("return",r);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ae(e,t,n,r,i){return ke.apply(this,arguments)}function ke(){return(ke=Object(a.a)(i.a.mark((function e(t,n,r,a,o){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0===n&&(n=0),void 0===o&&(o={}),o.byteOffset=n,o.type=h(t,n),e.t0=o.type,e.next=e.t0===c.COMPOSITE?7:e.t0===c.BATCHED_3D_MODEL?10:e.t0===c.INSTANCED_3D_MODEL?13:e.t0===c.POINT_CLOUD?16:19;break;case 7:return e.next=9,Pe(o,t,n,r,a,Ae);case 9:return e.abrupt("return",e.sent);case 10:return e.next=12,be(o,t,n,r,a);case 12:return e.abrupt("return",e.sent);case 13:return e.next=15,Te(o,t,n,r,a);case 15:return e.abrupt("return",e.sent);case 16:return e.next=18,$(o,t,n,r,a);case 18:return e.abrupt("return",e.sent);case 19:throw new Error("3DTileLoader: unknown type "+o.type);case 20:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Re(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Ce(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ce(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function Ce(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ie(e,t){if(e.content){var n=e.content.uri||e.content.url;e.contentUrl=t.basePath+"/"+n}return e.id=e.contentUrl,e.lodMetricType=s.a.GEOMETRIC_ERROR,e.lodMetricValue=e.geometricError,e.transformMatrix=e.transform,e.type=function(e){if(!e.contentUrl)return s.f.EMPTY;var t=e.contentUrl.split(".").pop();switch(t){case"pnts":return s.f.POINTCLOUD;case"i3dm":case"b3dm":return s.f.SCENEGRAPH;default:return t}}(e),e.refine=function(e){switch(e){case"REPLACE":case"replace":return s.e.REPLACE;case"ADD":case"add":return s.e.ADD;default:return e}}(e.refine),e}function Le(e){var t=e.basePath,n=Ie(e.root,e),r=[];for(r.push(n);r.length>0;)for(var i,a=Re(r.pop().children||[]);!(i=a()).done;){var o=i.value;Ie(o,{basePath:t}),r.push(o)}return n}function Ne(e){return o.a.dirname(e.url)}function De(e,t,n){return ze.apply(this,arguments)}function ze(){return(ze=Object(a.a)(i.a.mark((function e(t,n,r){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a={}).content=a.content||{},0,e.next=5,Ae(t,0,n,r,a.content);case 5:return e.abrupt("return",a.content);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ue(e,t,n){return Be.apply(this,arguments)}function Be(){return(Be=Object(a.a)(i.a.mark((function e(t,n,r){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=JSON.parse((new TextDecoder).decode(t))).loader=n.loader||Fe,a.url=r.url,a.basePath=Ne(a),a.root=Le(a),a.type=s.c.TILES3D,a.lodMetricType=s.a.GEOMETRIC_ERROR,a.lodMetricValue=a.root.lodMetricValue,e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ve(){return(Ve=Object(a.a)(i.a.mark((function e(t,n,r,a){var o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=n["3d-tiles"]||{},!("auto"===o.isTileset?r.url&&-1!==r.url.indexOf(".json"):o.isTileset)){e.next=8;break}return e.next=5,Ue(t,n,r);case 5:t=e.sent,e.next=11;break;case 8:return e.next=10,De(t,n,r);case 10:t=e.sent;case 11:return e.abrupt("return",t);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Fe={id:"3d-tiles",name:"3D Tiles",version:"undefined"!=typeof __VERSION__?__VERSION__:"latest",extensions:["cmpt","pnts","b3dm","i3dm"],mimeTypes:["application/octet-stream"],tests:["cmpt","pnts","b3dm","i3dm"],parse:function(e,t,n,r){return Ve.apply(this,arguments)},options:{"3d-tiles":{loadGLTF:!0,decodeQuantizedPositions:!1,isTileset:"auto",tile:null,tileset:null,assetGltfUpAxis:null}}};t.a=Fe},"G+eI":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("1OyB"),i=n("vuIU"),a=n("OyGM"),o=function(){function e(t,n){Object(r.a)(this,e),this.name=t,this.type=n,this.sampleSize=1,this.reset()}return Object(i.a)(e,[{key:"setSampleSize",value:function(e){return this.sampleSize=e,this}},{key:"incrementCount",value:function(){return this.addCount(1),this}},{key:"decrementCount",value:function(){return this.subtractCount(1),this}},{key:"addCount",value:function(e){return this._count+=e,this._samples++,this._checkSampling(),this}},{key:"subtractCount",value:function(e){return this._count-=e,this._samples++,this._checkSampling(),this}},{key:"addTime",value:function(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}},{key:"timeStart",value:function(){return this._startTime=Object(a.a)(),this._timerPending=!0,this}},{key:"timeEnd",value:function(){return this._timerPending?(this.addTime(Object(a.a)()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}},{key:"getSampleAverageCount",value:function(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}},{key:"getSampleAverageTime",value:function(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}},{key:"getSampleHz",value:function(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}},{key:"getAverageCount",value:function(){return this.samples>0?this.count/this.samples:0}},{key:"getAverageTime",value:function(){return this.samples>0?this.time/this.samples:0}},{key:"getHz",value:function(){return this.time>0?this.samples/(this.time/1e3):0}},{key:"reset",value:function(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}},{key:"_checkSampling",value:function(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}]),e}(),s=function(){function e(t){var n=t.id,i=t.stats;Object(r.a)(this,e),this.id=n,this.stats={},this._initializeStats(i),Object.seal(this)}return Object(i.a)(e,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"count";return this._getOrCreate({name:e,type:t})}},{key:"reset",value:function(){for(var e in this.stats)this.stats[e].reset();return this}},{key:"forEach",value:function(e){for(var t in this.stats)e(this.stats[t])}},{key:"getTable",value:function(){var e={};return this.forEach((function(t){e[t.name]={time:t.time||0,count:t.count||0,average:t.getAverageTime()||0,hz:t.getHz()||0}})),e}},{key:"_initializeStats",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.forEach((function(t){return e._getOrCreate(t)}))}},{key:"_getOrCreate",value:function(e){if(!e||!e.name)return null;var t=e.name,n=e.type;return this.stats[t]||(this.stats[t]=e instanceof o?e:new o(t,n)),this.stats[t]}},{key:"size",get:function(){return Object.keys(this.stats).length}}]),e}()},G8qk:function(e,t,n){"use strict";n.d(t,"a",(function(){return qt}));var r=n("o0o1"),i=n.n(r),a=n("rePB"),o=n("HaE+"),s=n("1OyB"),c=n("vuIU"),u=n("Ji7U"),l=n("md7G"),h=n("foSv"),f=n("0i8A"),p=n("V3d6"),d=n("ReuC"),v=n("K7jV"),m=n("hZZG"),g=n("Zk56");function b(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var i=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var O=function(e){Object(u.a)(n,e);var t=_(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"getSubLayers",value:function(){return this.internalState&&this.internalState.subLayers||[]}},{key:"initializeState",value:function(){}},{key:"setState",value:function(e){Object(d.a)(Object(h.a)(n.prototype),"setState",this).call(this,e),this.setNeedsUpdate()}},{key:"getPickingInfo",value:function(e){var t=e.info,n=t.object;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id?Object.assign(t,{object:n.__source.object,index:n.__source.index}):t}},{key:"renderLayers",value:function(){return null}},{key:"shouldRenderSubLayer",value:function(e,t){var n=this.props._subLayerProps;return t&&t.length||n&&n[e]}},{key:"getSubLayerClass",value:function(e,t){var n=this.props._subLayerProps;return n&&n[e]&&n[e].type||t}},{key:"getSubLayerRow",value:function(e,t,n){return e.__source={parent:this,object:t,index:n},e}},{key:"getSubLayerAccessor",value:function(e){if("function"==typeof e){var t={data:this.props.data,target:[]};return function(n,r){return n&&n.__source?(t.index=n.__source.index,e(n.__source.object,t)):e(n,r)}}return e}},{key:"getSubLayerProps",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.props,n=t.opacity,r=t.pickable,i=t.visible,a=t.parameters,o=t.getPolygonOffset,s=t.highlightedObjectIndex,c=t.autoHighlight,u=t.highlightColor,l=t.coordinateSystem,h=t.coordinateOrigin,f=t.wrapLongitude,p=t.positionFormat,d=t.modelMatrix,v=t.extensions,m=t._subLayerProps,g={opacity:n,pickable:r,visible:i,parameters:a,getPolygonOffset:o,highlightedObjectIndex:s,autoHighlight:c,highlightColor:u,coordinateSystem:l,coordinateOrigin:h,wrapLongitude:f,positionFormat:p,modelMatrix:d,extensions:v},y=m&&m[e.id],_=y&&y.updateTriggers,O=e.id||"sublayer";if(y){var j=this.constructor._propTypes;for(var w in y){var S=j[w];S&&"accessor"===S.type&&(y[w]=this.getSubLayerAccessor(y[w]))}}Object.assign(g,e,y,{id:"".concat(this.props.id,"-").concat(O),updateTriggers:Object.assign({all:this.props.updateTriggers.all},e.updateTriggers,_)});var T,E=b(v);try{for(E.s();!(T=E.n()).done;){var x=T.value,P=x.getSubLayerProps.call(this,x);P&&Object.assign(g,P,{updateTriggers:Object.assign(g.updateTriggers,P.updateTriggers)})}}catch(M){E.e(M)}finally{E.f()}return g}},{key:"_getAttributeManager",value:function(){return null}},{key:"_renderLayers",value:function(){var e=this.internalState.subLayers,t=!e||this.needsUpdate();t&&(e=this.renderLayers(),e=Object(g.b)(e,Boolean),this.internalState.subLayers=e),Object(m.a)("compositeLayer.renderLayers",this,t,e);var n,r=b(e);try{for(r.s();!(n=r.n()).done;){n.value.parent=this}}catch(i){r.e(i)}finally{r.f()}}},{key:"isComposite",get:function(){return!0}},{key:"isLoaded",get:function(){return Object(d.a)(Object(h.a)(n.prototype),"isLoaded",this)&&this.getSubLayers().every((function(e){return e.isLoaded}))}}]),n}(v.a);O.layerName="CompositeLayer";var j=n("FR1t"),w=n("U8pU"),S=n("K4gp"),T=n("BQ9P"),E=n("Jh/b"),x=n("iein"),P={name:"pbr",vs:"uniform mat4 u_MVPMatrix;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_NormalMatrix;\n\nvarying vec3 pbr_vPosition;\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n# ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n# else\nvarying vec3 pbr_vNormal;\n# endif\n#endif\n\nvoid pbr_setPositionNormalTangentUV(vec4 position, vec4 normal, vec4 tangent, vec2 uv)\n{\n  vec4 pos = u_ModelMatrix * position;\n  pbr_vPosition = vec3(pos.xyz) / pos.w;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\n  vec3 normalW = normalize(vec3(u_NormalMatrix * vec4(normal.xyz, 0.0)));\n  vec3 tangentW = normalize(vec3(u_ModelMatrix * vec4(tangent.xyz, 0.0)));\n  vec3 bitangentW = cross(normalW, tangentW) * tangent.w;\n  pbr_vTBN = mat3(tangentW, bitangentW, normalW);\n#else\n  pbr_vNormal = normalize(vec3(u_ModelMatrix * vec4(normal.xyz, 0.0)));\n#endif\n#endif\n\n#ifdef HAS_UV\n  pbr_vUV = uv;\n#else\n  pbr_vUV = vec2(0.,0.);\n#endif\n}\n",fs:"#if defined(USE_TEX_LOD) && !defined(FEATURE_GLSL_TEXTURE_LOD)\n# error PBR fragment shader: Texture LOD is not available\n#endif\n\n#if !defined(HAS_TANGENTS) && !defined(FEATURE_GLSL_DERIVATIVES)\n# error PBR fragment shader: Derivatives are not available\n#endif\n\n\n#if (__VERSION__ < 300)\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL1COND; INCR)\n#else\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL2COND; INCR)\n#endif\n\nprecision highp float;\n\nuniform bool pbr_uUnlit;\n\n#ifdef USE_IBL\nuniform samplerCube u_DiffuseEnvSampler;\nuniform samplerCube u_SpecularEnvSampler;\nuniform sampler2D u_brdfLUT;\nuniform vec2 u_ScaleIBLAmbient;\n#endif\n\n#ifdef HAS_BASECOLORMAP\nuniform sampler2D u_BaseColorSampler;\n#endif\n#ifdef HAS_NORMALMAP\nuniform sampler2D u_NormalSampler;\nuniform float u_NormalScale;\n#endif\n#ifdef HAS_EMISSIVEMAP\nuniform sampler2D u_EmissiveSampler;\nuniform vec3 u_EmissiveFactor;\n#endif\n#ifdef HAS_METALROUGHNESSMAP\nuniform sampler2D u_MetallicRoughnessSampler;\n#endif\n#ifdef HAS_OCCLUSIONMAP\nuniform sampler2D u_OcclusionSampler;\nuniform float u_OcclusionStrength;\n#endif\n\n#ifdef ALPHA_CUTOFF\nuniform float u_AlphaCutoff;\n#endif\n\nuniform vec2 u_MetallicRoughnessValues;\nuniform vec4 u_BaseColorFactor;\n\nuniform vec3 u_Camera;\n#ifdef PBR_DEBUG\nuniform vec4 u_ScaleDiffBaseMR;\nuniform vec4 u_ScaleFGDSpec;\n#endif\n\nvarying vec3 pbr_vPosition;\n\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n#else\nvarying vec3 pbr_vNormal;\n#endif\n#endif\n\n\nstruct PBRInfo\n{\n  float NdotL;\n  float NdotV;\n  float NdotH;\n  float LdotH;\n  float VdotH;\n  float perceptualRoughness;\n  float metalness;\n  vec3 reflectance0;\n  vec3 reflectance90;\n  float alphaRoughness;\n  vec3 diffuseColor;\n  vec3 specularColor;\n  vec3 n;\n  vec3 v;\n};\n\nconst float M_PI = 3.141592653589793;\nconst float c_MinRoughness = 0.04;\n\nvec4 SRGBtoLINEAR(vec4 srgbIn)\n{\n#ifdef MANUAL_SRGB\n#ifdef SRGB_FAST_APPROXIMATION\n  vec3 linOut = pow(srgbIn.xyz,vec3(2.2));\n#else\n  vec3 bLess = step(vec3(0.04045),srgbIn.xyz);\n  vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );\n#endif\n  return vec4(linOut,srgbIn.w);;\n#else\n  return srgbIn;\n#endif\n}\n\nvec3 getNormal()\n{\n#ifndef HAS_TANGENTS\n  vec3 pos_dx = dFdx(pbr_vPosition);\n  vec3 pos_dy = dFdy(pbr_vPosition);\n  vec3 tex_dx = dFdx(vec3(pbr_vUV, 0.0));\n  vec3 tex_dy = dFdy(vec3(pbr_vUV, 0.0));\n  vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\n\n#ifdef HAS_NORMALS\n  vec3 ng = normalize(pbr_vNormal);\n#else\n  vec3 ng = cross(pos_dx, pos_dy);\n#endif\n\n  t = normalize(t - ng * dot(ng, t));\n  vec3 b = normalize(cross(ng, t));\n  mat3 tbn = mat3(t, b, ng);\n#else\n  mat3 tbn = pbr_vTBN;\n#endif\n\n#ifdef HAS_NORMALMAP\n  vec3 n = texture2D(u_NormalSampler, pbr_vUV).rgb;\n  n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_NormalScale, u_NormalScale, 1.0)));\n#else\n  vec3 n = normalize(tbn[2].xyz);\n#endif\n\n  return n;\n}\n\n\n#ifdef USE_IBL\nvec3 getIBLContribution(PBRInfo pbrInputs, vec3 n, vec3 reflection)\n{\n  float mipCount = 9.0;\n  float lod = (pbrInputs.perceptualRoughness * mipCount);\n  vec3 brdf = SRGBtoLINEAR(texture2D(u_brdfLUT,\n    vec2(pbrInputs.NdotV, 1.0 - pbrInputs.perceptualRoughness))).rgb;\n  vec3 diffuseLight = SRGBtoLINEAR(textureCube(u_DiffuseEnvSampler, n)).rgb;\n\n#ifdef USE_TEX_LOD\n  vec3 specularLight = SRGBtoLINEAR(textureCubeLod(u_SpecularEnvSampler, reflection, lod)).rgb;\n#else\n  vec3 specularLight = SRGBtoLINEAR(textureCube(u_SpecularEnvSampler, reflection)).rgb;\n#endif\n\n  vec3 diffuse = diffuseLight * pbrInputs.diffuseColor;\n  vec3 specular = specularLight * (pbrInputs.specularColor * brdf.x + brdf.y);\n  diffuse *= u_ScaleIBLAmbient.x;\n  specular *= u_ScaleIBLAmbient.y;\n\n  return diffuse + specular;\n}\n#endif\n\n\nvec3 diffuse(PBRInfo pbrInputs)\n{\n  return pbrInputs.diffuseColor / M_PI;\n}\n\nvec3 specularReflection(PBRInfo pbrInputs)\n{\n  return pbrInputs.reflectance0 +\n    (pbrInputs.reflectance90 - pbrInputs.reflectance0) *\n    pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);\n}\n\n\n\nfloat geometricOcclusion(PBRInfo pbrInputs)\n{\n  float NdotL = pbrInputs.NdotL;\n  float NdotV = pbrInputs.NdotV;\n  float r = pbrInputs.alphaRoughness;\n\n  float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));\n  float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));\n  return attenuationL * attenuationV;\n}\n\n\n\n\n\nfloat microfacetDistribution(PBRInfo pbrInputs)\n{\n  float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;\n  float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;\n  return roughnessSq / (M_PI * f * f);\n}\n\nvoid PBRInfo_setAmbientLight(inout PBRInfo pbrInputs) {\n  pbrInputs.NdotL = 1.0;\n  pbrInputs.NdotH = 0.0;\n  pbrInputs.LdotH = 0.0;\n  pbrInputs.VdotH = 1.0;\n}\n\nvoid PBRInfo_setDirectionalLight(inout PBRInfo pbrInputs, vec3 lightDirection) {\n  vec3 n = pbrInputs.n;\n  vec3 v = pbrInputs.v;\n  vec3 l = normalize(lightDirection);\n  vec3 h = normalize(l+v);\n\n  pbrInputs.NdotL = clamp(dot(n, l), 0.001, 1.0);\n  pbrInputs.NdotH = clamp(dot(n, h), 0.0, 1.0);\n  pbrInputs.LdotH = clamp(dot(l, h), 0.0, 1.0);\n  pbrInputs.VdotH = clamp(dot(v, h), 0.0, 1.0);\n}\n\nvoid PBRInfo_setPointLight(inout PBRInfo pbrInputs, PointLight pointLight) {\n  vec3 light_direction = normalize(pointLight.position - pbr_vPosition);\n  PBRInfo_setDirectionalLight(pbrInputs, light_direction);\n}\n\nvec3 calculateFinalColor(PBRInfo pbrInputs, vec3 lightColor) {\n  vec3 F = specularReflection(pbrInputs);\n  float G = geometricOcclusion(pbrInputs);\n  float D = microfacetDistribution(pbrInputs);\n  vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);\n  vec3 specContrib = F * G * D / (4.0 * pbrInputs.NdotL * pbrInputs.NdotV);\n  return pbrInputs.NdotL * lightColor * (diffuseContrib + specContrib);\n}\n\nvec4 pbr_filterColor(vec4 colorUnused)\n{\n#ifdef HAS_BASECOLORMAP\n  vec4 baseColor = SRGBtoLINEAR(texture2D(u_BaseColorSampler, pbr_vUV)) * u_BaseColorFactor;\n#else\n  vec4 baseColor = u_BaseColorFactor;\n#endif\n\n#ifdef ALPHA_CUTOFF\n  if (baseColor.a < u_AlphaCutoff) {\n    discard;\n  }\n#endif\n\n  vec3 color = vec3(0, 0, 0);\n\n  if(pbr_uUnlit){\n    color.rgb = baseColor.rgb;\n  }\n  else{\n\n\n    float perceptualRoughness = u_MetallicRoughnessValues.y;\n    float metallic = u_MetallicRoughnessValues.x;\n#ifdef HAS_METALROUGHNESSMAP\n\n    vec4 mrSample = texture2D(u_MetallicRoughnessSampler, pbr_vUV);\n    perceptualRoughness = mrSample.g * perceptualRoughness;\n    metallic = mrSample.b * metallic;\n#endif\n    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);\n    metallic = clamp(metallic, 0.0, 1.0);\n\n    float alphaRoughness = perceptualRoughness * perceptualRoughness;\n\n    vec3 f0 = vec3(0.04);\n    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);\n    diffuseColor *= 1.0 - metallic;\n    vec3 specularColor = mix(f0, baseColor.rgb, metallic);\n    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\n\n\n\n    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);\n    vec3 specularEnvironmentR0 = specularColor.rgb;\n    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;\n\n    vec3 n = getNormal();\n    vec3 v = normalize(u_Camera - pbr_vPosition);\n\n    float NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);\n    vec3 reflection = -normalize(reflect(v, n));\n\n    PBRInfo pbrInputs = PBRInfo(\n      0.0,\n      NdotV,\n      0.0,\n      0.0,\n      0.0,\n      perceptualRoughness,\n      metallic,\n      specularEnvironmentR0,\n      specularEnvironmentR90,\n      alphaRoughness,\n      diffuseColor,\n      specularColor,\n      n,\n      v\n    );\n\n#ifdef USE_LIGHTS\n    PBRInfo_setAmbientLight(pbrInputs);\n    color += calculateFinalColor(pbrInputs, lighting_uAmbientLight.color);\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uDirectionalLightCount, i++) {\n      if (i < lighting_uDirectionalLightCount) {\n        PBRInfo_setDirectionalLight(pbrInputs, lighting_uDirectionalLight[i].direction);\n        color += calculateFinalColor(pbrInputs, lighting_uDirectionalLight[i].color);\n      }\n    }\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uPointLightCount, i++) {\n      if (i < lighting_uPointLightCount) {\n        PBRInfo_setPointLight(pbrInputs, lighting_uPointLight[i]);\n        float attenuation = getPointLightAttenuation(lighting_uPointLight[i], distance(lighting_uPointLight[i].position, pbr_vPosition));\n        color += calculateFinalColor(pbrInputs, lighting_uPointLight[i].color / attenuation);\n      }\n    }\n#endif\n#ifdef USE_IBL\n    color += getIBLContribution(pbrInputs, n, reflection);\n#endif\n#ifdef HAS_OCCLUSIONMAP\n    float ao = texture2D(u_OcclusionSampler, pbr_vUV).r;\n    color = mix(color, color * ao, u_OcclusionStrength);\n#endif\n\n#ifdef HAS_EMISSIVEMAP\n    vec3 emissive = SRGBtoLINEAR(texture2D(u_EmissiveSampler, pbr_vUV)).rgb * u_EmissiveFactor;\n    color += emissive;\n#endif\n\n#ifdef PBR_DEBUG\n\n\n\n\n\n    color = mix(color, baseColor.rgb, u_ScaleDiffBaseMR.y);\n    color = mix(color, vec3(metallic), u_ScaleDiffBaseMR.z);\n    color = mix(color, vec3(perceptualRoughness), u_ScaleDiffBaseMR.w);\n#endif\n\n  }\n\n  return vec4(pow(color,vec3(1.0/2.2)), baseColor.a);\n}\n",defines:{LIGHTING_FRAGMENT:1},dependencies:[n("QPTa").a]},M=n("zXfU"),A=n("Nw31"),k=n("VdrS"),R=n("CxzY"),C=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(s.a)(this,e);var n=t.id;this.id=n||Object(k.c)(this.constructor.name),this.display=!0,this.position=new M.a,this.rotation=new M.a,this.scale=new M.a(1,1,1),this.matrix=new A.a,this.userData={},this.props={},this._setScenegraphNodeProps(t)}return Object(c.a)(e,[{key:"delete",value:function(){}},{key:"setProps",value:function(e){return this._setScenegraphNodeProps(e),this}},{key:"toString",value:function(){return"{type: ScenegraphNode, id: ".concat(this.id,")}")}},{key:"setPosition",value:function(e){return Object(R.a)(3===e.length,"setPosition requires vector argument"),this.position=e,this}},{key:"setRotation",value:function(e){return Object(R.a)(3===e.length,"setRotation requires vector argument"),this.rotation=e,this}},{key:"setScale",value:function(e){return Object(R.a)(3===e.length,"setScale requires vector argument"),this.scale=e,this}},{key:"setMatrix",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t?this.matrix.copy(e):this.matrix=e}},{key:"setMatrixComponents",value:function(e){var t=e.position,n=e.rotation,r=e.scale,i=e.update,a=void 0===i||i;return t&&this.setPosition(t),n&&this.setRotation(n),r&&this.setScale(r),a&&this.updateMatrix(),this}},{key:"updateMatrix",value:function(){var e=this.position,t=this.rotation,n=this.scale;return this.matrix.identity(),this.matrix.translate(e),this.matrix.rotateXYZ(t),this.matrix.scale(n),this}},{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.position,n=e.rotation,r=e.scale;return t&&this.setPosition(t),n&&this.setRotation(n),r&&this.setScale(r),this.updateMatrix(),this}},{key:"getCoordinateUniforms",value:function(e,t){Object(R.a)(e),t=t||this.matrix;var n=new A.a(e).multiplyRight(t),r=n.invert(),i=r.transpose();return{viewMatrix:e,modelMatrix:t,objectMatrix:t,worldMatrix:n,worldInverseMatrix:r,worldInverseTransposeMatrix:i}}},{key:"_setScenegraphNodeProps",value:function(e){"display"in e&&(this.display=e.display),"position"in e&&this.setPosition(e.position),"rotation"in e&&this.setRotation(e.rotation),"scale"in e&&this.setScale(e.scale),"matrix"in e&&this.setMatrix(e.matrix),Object.assign(this.props,e)}}]),e}(),I=n("sc/6"),L=n("T2Hy"),N=n("KQm4");function D(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return z(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function U(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var i=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var B=function(e){Object(u.a)(n,e);var t=U(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(s.a)(this,n);var i=r=Array.isArray(r)?{children:r}:r,a=i.children,o=void 0===a?[]:a;return x.j.assert(o.every((function(e){return e instanceof C})),"every child must an instance of ScenegraphNode"),(e=t.call(this,r)).children=o,e}return Object(c.a)(n,[{key:"add",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0,i=t;r<i.length;r++){var a=i[r];Array.isArray(a)?this.add.apply(this,Object(N.a)(a)):this.children.push(a)}return this}},{key:"remove",value:function(e){var t=this.children,n=t.indexOf(e);return n>-1&&t.splice(n,1),this}},{key:"removeAll",value:function(){return this.children=[],this}},{key:"delete",value:function(){this.children.forEach((function(e){return e.delete()})),this.removeAll(),Object(d.a)(Object(h.a)(n.prototype),"delete",this).call(this)}},{key:"traverse",value:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=r.worldMatrix,a=void 0===i?new A.a:i,o=new A.a(a).multiplyRight(this.matrix),s=D(this.children);try{for(s.s();!(t=s.n()).done;){var c=t.value;c instanceof n?c.traverse(e,{worldMatrix:o}):e(c,{worldMatrix:o})}}catch(u){s.e(u)}finally{s.f()}}}]),n}(C),V=n("Xjzu"),F={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},G={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function q(e){if(!e._animation){var t=G[e.componentType],n=F[e.type],r=n*e.count,i=e.bufferView.data,a=new t(i.buffer,i.byteOffset+(e.byteOffset||0),r);if(1===n)e._animation=Array.from(a);else{for(var o=[],s=0;s<a.length;s+=n)o.push(Array.from(a.slice(s,s+n)));e._animation=o}}return e._animation}var H=new A.a;var Z=new V.a;function W(e,t,n,r){var i=t.input,a=t.interpolation,o=t.output,s=e%i[i.length-1],c=i.findIndex((function(e){return e>=s})),u=Math.max(0,c-1);if(!Array.isArray(n[r]))switch(r){case"translation":n[r]=[0,0,0];break;case"rotation":n[r]=[0,0,0,1];break;case"scale":n[r]=[1,1,1];break;default:x.j.warn("Bad animation path ".concat(r))()}Object(R.a)(n[r].length===o[u].length);var l=i[u],h=i[c];switch(a){case"STEP":!function(e,t,n){for(var r=0;r<n.length;r++)e[t][r]=n[r]}(n,r,o[u]);break;case"LINEAR":if(h>l){var f=(s-l)/(h-l);!function(e,t,n,r,i){if("rotation"===t){Z.slerp({start:n,target:r,ratio:i});for(var a=0;a<Z.length;a++)e[t][a]=Z[a]}else for(var o=0;o<n.length;o++)e[t][o]=i*r[o]+(1-i)*n[o]}(n,r,o[u],o[c],f)}break;case"CUBICSPLINE":if(h>l){var p=(s-l)/(h-l),d=h-l;!function(e,t,n){for(var r=n.p0,i=n.outTangent0,a=n.inTangent1,o=n.p1,s=n.tDiff,c=n.ratio,u=0;u<e[t].length;u++){var l=i[u]*s,h=a[u]*s;e[t][u]=(2*Math.pow(c,3)-3*Math.pow(c,2)+1)*r[u]+(Math.pow(c,3)-2*Math.pow(c,2)+c)*l+(-2*Math.pow(c,3)+3*Math.pow(c,2))*o[u]+(Math.pow(c,3)-Math.pow(c,2))*h}}(n,r,{p0:o[3*u+1],outTangent0:o[3*u+2],inTangent1:o[3*c+0],p1:o[3*c+1],tDiff:d,ratio:p})}break;default:x.j.warn("Interpolation ".concat(a," not supported"))()}}var K=function(){function e(t){Object(s.a)(this,e),this.startTime=0,this.playing=!0,this.speed=1,this.channels=[],Object.assign(this,t)}return Object(c.a)(e,[{key:"animate",value:function(e){if(this.playing){var t=(e/1e3-this.startTime)*this.speed;this.channels.forEach((function(e){var n=e.sampler,r=e.target,i=e.path;W(t,n,r,i),function(e,t){if(t.matrix.identity(),e.translation&&t.matrix.translate(e.translation),e.rotation){var n=H.fromQuaternion(e.rotation);t.matrix.multiplyRight(n)}e.scale&&t.matrix.scale(e.scale)}(r,r._node)}))}}}]),e}(),X=function(){function e(t){Object(s.a)(this,e),this.animations=t.animations.map((function(e,n){var r=e.name||"Animation-".concat(n),i=e.samplers.map((function(e){var n=e.input,r=e.interpolation,i=void 0===r?"LINEAR":r,a=e.output;return{input:q(t.accessors[n]),interpolation:i,output:q(t.accessors[a])}})),a=e.channels.map((function(e){var n=e.sampler,r=e.target;return{sampler:i[n],target:t.nodes[r.node],path:r.path}}));return new K({name:r,channels:a})}))}return Object(c.a)(e,[{key:"animate",value:function(e){this.setTime(e)}},{key:"setTime",value:function(e){this.animations.forEach((function(t){return t.animate(e)}))}},{key:"getAnimations",value:function(){return this.animations}}]),e}(),Y=n("ykdB");function Q(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var i=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var J=function(e){Object(u.a)(n,e);var t=Q(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(s.a)(this,n),(r=t.call(this,i)).onBeforeRender=null,r.AfterRender=null,e instanceof Y.a?(r.model=e,r._setModelNodeProps(i)):r.model=new Y.a(e,i),r.managedResources=i.managedResources||[],r}return Object(c.a)(n,[{key:"setProps",value:function(e){return Object(d.a)(Object(h.a)(n.prototype),"setProps",this).call(this,e),this._setModelNodeProps(e),this}},{key:"delete",value:function(){this.model&&(this.model.delete(),this.model=null),this.managedResources.forEach((function(e){return e.delete()})),this.managedResources=[]}},{key:"draw",value:function(){var e;return(e=this.model).draw.apply(e,arguments)}},{key:"setUniforms",value:function(){var e;return(e=this.model).setUniforms.apply(e,arguments),this}},{key:"setAttributes",value:function(){var e;return(e=this.model).setAttributes.apply(e,arguments),this}},{key:"updateModuleSettings",value:function(){var e;return(e=this.model).updateModuleSettings.apply(e,arguments),this}},{key:"_setModelNodeProps",value:function(e){this.model.setProps(e)}}]),n}(C),$=n("d3kR"),ee=n("tMmZ"),te=n("f5Sf"),ne=function(){function e(t,n){var r=n.attributes,i=n.material,a=n.pbrDebug,o=n.imageBasedLightingEnvironment,c=n.lights,u=n.useTangents;Object(s.a)(this,e),this.gl=t,this.defines={MANUAL_SRGB:1,SRGB_FAST_APPROXIMATION:1},Object($.b)(t,ee.a.GLSL_TEXTURE_LOD)&&(this.defines.USE_TEX_LOD=1),this.uniforms={u_Camera:[0,0,0],u_MetallicRoughnessValues:[1,1]},this.parameters={},this.generatedTextures=[],o&&(this.uniforms.u_DiffuseEnvSampler=o.getDiffuseEnvSampler(),this.uniforms.u_SpecularEnvSampler=o.getSpecularEnvSampler(),this.uniforms.u_brdfLUT=o.getBrdfTexture(),this.uniforms.u_ScaleIBLAmbient=[1,1]),a&&(this.uniforms.u_ScaleDiffBaseMR=[0,0,0,0],this.uniforms.u_ScaleFGDSpec=[0,0,0,0]),this.defineIfPresent(r.NORMAL,"HAS_NORMALS"),this.defineIfPresent(r.TANGENT&&u,"HAS_TANGENTS"),this.defineIfPresent(r.TEXCOORD_0,"HAS_UV"),this.defineIfPresent(o,"USE_IBL"),this.defineIfPresent(c,"USE_LIGHTS"),this.defineIfPresent(a,"PBR_DEBUG"),i&&this.parseMaterial(i)}return Object(c.a)(e,[{key:"defineIfPresent",value:function(e,t){e&&(this.defines[t]=1)}},{key:"parseTexture",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=e.texture&&e.texture.sampler&&e.texture.sampler.parameters||{},i=new te.a(this.gl,{id:e.name||e.id,parameters:r,pixelStore:Object(a.a)({},this.gl.UNPACK_FLIP_Y_WEBGL,!1),data:e.texture.source.image});this.uniforms[t]=i,this.defineIfPresent(n,n),this.generatedTextures.push(i)}},{key:"parsePbrMetallicRoughness",value:function(e){e.baseColorTexture&&this.parseTexture(e.baseColorTexture,"u_BaseColorSampler","HAS_BASECOLORMAP"),this.uniforms.u_BaseColorFactor=e.baseColorFactor||[1,1,1,1],e.metallicRoughnessTexture&&this.parseTexture(e.metallicRoughnessTexture,"u_MetallicRoughnessSampler","HAS_METALROUGHNESSMAP");var t=e.metallicFactor,n=void 0===t?1:t,r=e.roughnessFactor,i=void 0===r?1:r;this.uniforms.u_MetallicRoughnessValues=[n,i]}},{key:"parseMaterial",value:function(e){if(this.uniforms.pbr_uUnlit=Boolean(e.unlit),e.pbrMetallicRoughness&&this.parsePbrMetallicRoughness(e.pbrMetallicRoughness),e.normalTexture){this.parseTexture(e.normalTexture,"u_NormalSampler","HAS_NORMALMAP");var t=e.normalTexture.scale,n=void 0===t?1:t;this.uniforms.u_NormalScale=n}if(e.occlusionTexture){this.parseTexture(e.occlusionTexture,"u_OcclusionSampler","HAS_OCCLUSIONMAP");var r=e.occlusionTexture.strength,i=void 0===r?1:r;this.uniforms.u_OcclusionStrength=i}if(e.emissiveTexture&&(this.parseTexture(e.emissiveTexture,"u_EmissiveSampler","HAS_EMISSIVEMAP"),this.uniforms.u_EmissiveFactor=e.emissiveFactor||[0,0,0]),"MASK"===e.alphaMode){var a=e.alphaCutoff,o=void 0===a?.5:a;this.defines.ALPHA_CUTOFF=1,this.uniforms.u_AlphaCutoff=o}else"BLEND"===e.alphaMode&&(x.j.warn("BLEND alphaMode might not work well because it requires mesh sorting")(),Object.assign(this.parameters,{blend:!0,blendEquation:this.gl.FUNC_ADD,blendFunc:[this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA]}))}}]),e}();function re(e,t){return Object(x.i)(e)?"#version 300 es\n".concat(t):t}var ie={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},ae={modelOptions:{},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1},oe=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(s.a)(this,e),this.gl=t,this.options=Object.assign({},ae,n)}return Object(c.a)(e,[{key:"instantiate",value:function(e){var t=this;return this.gltf=e,(e.scenes||[]).map((function(e){return t.createScene(e)}))}},{key:"createAnimator",value:function(){return Array.isArray(this.gltf.animations)?new X(this.gltf):null}},{key:"createScene",value:function(e){var t=this,n=(e.nodes||[]).map((function(e){return t.createNode(e)}));return new B({id:e.name||e.id,children:n})}},{key:"createNode",value:function(e){var t=this;if(!e._node){var n=(e.children||[]).map((function(e){return t.createNode(e)}));e.mesh&&n.push(this.createMesh(e.mesh));var r=new B({id:e.name||e.id,children:n});if(e.matrix)r.setMatrix(e.matrix);else{if(r.matrix.identity(),e.translation&&r.matrix.translate(e.translation),e.rotation){var i=(new A.a).fromQuaternion(e.rotation);r.matrix.multiplyRight(i)}e.scale&&r.matrix.scale(e.scale)}e._node=r}return e._node}},{key:"createMesh",value:function(e){var t=this;if(!e._mesh){var n=(e.primitives||[]).map((function(n,r){return t.createPrimitive(n,r,e)})),r=new B({id:e.name||e.id,children:n});e._mesh=r}return e._mesh}},{key:"getVertexCount",value:function(e){x.j.warn("getVertexCount() not found")()}},{key:"createPrimitive",value:function(e,t,n){return function(e,t){var n=t.id,r=t.drawMode,i=t.vertexCount,a=t.attributes,o=t.modelOptions,s=new ne(e,t);x.j.info(4,"createGLTFModel defines: ",s.defines)();var c=[];c.push.apply(c,Object(N.a)(s.generatedTextures)),c.push.apply(c,Object(N.a)(Object.values(a).map((function(e){return e.buffer}))));var u=new J(e,Object.assign({id:n,drawMode:r,vertexCount:i,modules:[P],defines:s.defines,parameters:s.parameters,vs:re(e,"\n#if (__VERSION__ < 300)\n  #define _attr attribute\n#else\n  #define _attr in\n#endif\n\n  _attr vec4 POSITION;\n\n  #ifdef HAS_NORMALS\n    _attr vec4 NORMAL;\n  #endif\n\n  #ifdef HAS_TANGENTS\n    _attr vec4 TANGENT;\n  #endif\n\n  #ifdef HAS_UV\n    _attr vec2 TEXCOORD_0;\n  #endif\n\n  void main(void) {\n    vec4 _NORMAL = vec4(0.);\n    vec4 _TANGENT = vec4(0.);\n    vec2 _TEXCOORD_0 = vec2(0.);\n\n    #ifdef HAS_NORMALS\n      _NORMAL = NORMAL;\n    #endif\n\n    #ifdef HAS_TANGENTS\n      _TANGENT = TANGENT;\n    #endif\n\n    #ifdef HAS_UV\n      _TEXCOORD_0 = TEXCOORD_0;\n    #endif\n\n    pbr_setPositionNormalTangentUV(POSITION, _NORMAL, _TANGENT, _TEXCOORD_0);\n    gl_Position = u_MVPMatrix * POSITION;\n  }\n"),fs:re(e,"\n#if (__VERSION__ < 300)\n  #define fragmentColor gl_FragColor\n#else\n  out vec4 fragmentColor;\n#endif\n\n  void main(void) {\n    fragmentColor = pbr_filterColor(vec4(0));\n  }\n"),managedResources:c},o));return u.setProps({attributes:a}),u.setUniforms(s.uniforms),u}(this.gl,Object.assign({id:e.name||"".concat(n.name||n.id,"-primitive-").concat(t),drawMode:e.mode||4,vertexCount:e.indices?e.indices.count:this.getVertexCount(e.attributes),attributes:this.createAttributes(e.attributes,e.indices),material:e.material},this.options))}},{key:"createAttributes",value:function(e,t){var n=this,r={};return Object.keys(e).forEach((function(t){r[t]=n.createAccessor(e[t],n.createBuffer(e[t],n.gl.ARRAY_BUFFER))})),t&&(r.indices=this.createAccessor(t,this.createBuffer(t,this.gl.ELEMENT_ARRAY_BUFFER))),x.j.info(4,"glTF Attributes",{attributes:e,indices:t,generated:r})(),r}},{key:"createBuffer",value:function(e,t){e.bufferView||(e.bufferView={});var n=e.bufferView;return n.lumaBuffers||(n.lumaBuffers={}),n.lumaBuffers[t]||(n.lumaBuffers[t]=new I.a(this.gl,{id:"from-".concat(n.id),data:n.data||e.value,target:t})),n.lumaBuffers[t]}},{key:"createAccessor",value:function(e,t){return new L.a({buffer:t,offset:e.byteOffset||0,stride:e.bufferView.byteStride||0,type:e.componentType,size:ie[e.type]})}},{key:"createSampler",value:function(e){return e}},{key:"needsPOT",value:function(){return!1}}]),e}();var se=n("yx+g");function ce(){return(ce=Object(o.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],t.scenes.forEach((function(e){e.traverse((function(e){Object.values(e.model.getUniforms()).forEach((function(e){!1===e.loaded&&n.push(e)}))}))})),e.next=4,ue((function(){return n.some((function(e){return!e.loaded}))}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ue(e){return le.apply(this,arguments)}function le(){return(le=Object(o.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t()){e.next=5;break}return e.next=3,new Promise((function(e){return requestAnimationFrame(e)}));case 3:e.next=0;break;case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var he=n("rpwb");function fe(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return pe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return pe(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function pe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var de=Math.PI/180,ve=new Float32Array(16),me=new Float32Array(12);function ge(e,t,n){var r=t[0]*de,i=t[1]*de,a=t[2]*de,o=Math.sin(a),s=Math.sin(r),c=Math.sin(i),u=Math.cos(a),l=Math.cos(r),h=Math.cos(i),f=n[0],p=n[1],d=n[2];e[0]=f*h*l,e[1]=f*c*l,e[2]=f*-s,e[3]=p*(-c*u+h*s*o),e[4]=p*(h*u+c*s*o),e[5]=p*l*o,e[6]=d*(c*o+h*s*u),e[7]=d*(-h*o+c*s*u),e[8]=d*l*u}function be(e){return e[0]=e[0],e[1]=e[1],e[2]=e[2],e[3]=e[4],e[4]=e[5],e[5]=e[6],e[6]=e[8],e[7]=e[9],e[8]=e[10],e[9]=e[12],e[10]=e[13],e[11]=e[14],e.subarray(0,12)}var ye={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrix__LOCATION_0:{size:3,elementOffset:0},instanceModelMatrix__LOCATION_1:{size:3,elementOffset:3},instanceModelMatrix__LOCATION_2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update:function(e,t){var n=t.startRow,r=t.endRow,i=this.props,a=i.data,o=i.getOrientation,s=i.getScale,c=i.getTranslation,u=i.getTransformMatrix,l=Array.isArray(u),h=l&&16===u.length,f=Array.isArray(s),p=Array.isArray(o),d=Array.isArray(c),v=h||!l&&Boolean(u(a[0]));e.constant=v?h:p&&f&&d;var m=e.value;if(e.constant){var g;if(v)ve.set(u),g=be(ve);else ge(g=me,o,s),g.set(c,9);e.value=new Float32Array(g)}else{var b,y=n*e.size,_=Object(he.a)(a,n,r),O=_.iterable,j=_.objectInfo,w=fe(O);try{for(w.s();!(b=w.n()).done;){var S=b.value;j.index++;var T=void 0;if(v)ve.set(h?u:u(S,j)),T=be(ve);else ge(T=me,p?o:o(S,j),f?s:s(S,j)),T.set(d?c:c(S,j),9);m[y++]=T[0],m[y++]=T[1],m[y++]=T[2],m[y++]=T[3],m[y++]=T[4],m[y++]=T[5],m[y++]=T[6],m[y++]=T[7],m[y++]=T[8],m[y++]=T[9],m[y++]=T[10],m[y++]=T[11]}}catch(E){w.e(E)}finally{w.f()}}}};function _e(e,t){return t===p.a.CARTESIAN||t===p.a.METER_OFFSETS||t===p.a.DEFAULT&&!e.isGeospatial}function Oe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function je(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Oe(Object(n),!0).forEach((function(t){Object(a.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Oe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function we(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var i=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Se=[255,255,255,255],Te={scenegraph:{type:"object",value:null,async:!0},getScene:function(e){return e&&e.scenes?"object"===Object(w.a)(e.scene)?e.scene:e.scenes[e.scene||0]:e},getAnimator:function(e){return e&&e.animator},_animations:null,sizeScale:{type:"number",value:1,min:0},sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},getPosition:{type:"accessor",value:function(e){return e.position}},getColor:{type:"accessor",value:Se},_lighting:"flat",_imageBasedLightingEnvironment:null,getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},loaders:[se.a]},Ee=function(e){Object(u.a)(n,e);var t=we(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"getShaders",value:function(){var e=[S.a,T.a];return"pbr"===this.props._lighting&&e.push(P),{vs:"#version 300 es\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform mat4 sceneModelMatrix;\nuniform bool composeModelMatrix;\nin vec4 POSITION;\n\n#ifdef HAS_UV\n  in vec2 TEXCOORD_0;\n#endif\n\n#ifdef MODULE_PBR\n  #ifdef HAS_NORMALS\n    in vec4 NORMAL;\n  #endif\n#endif\nout vec4 vColor;\n#ifndef MODULE_PBR\n  #ifdef HAS_UV\n    out vec2 vTEXCOORD_0;\n  #endif\n#endif\nvoid main(void) {\n  #if defined(HAS_UV) && !defined(MODULE_PBR)\n    vTEXCOORD_0 = TEXCOORD_0;\n    geometry.uv = vTEXCOORD_0;\n  #endif\n\n  geometry.worldPosition = instancePositions;\n  geometry.pickingColor = instancePickingColors;\n\n  #ifdef MODULE_PBR\n    #ifdef HAS_NORMALS\n      pbr_vNormal = project_normal(instanceModelMatrix * (sceneModelMatrix * vec4(NORMAL.xyz, 0.0)).xyz);\n      geometry.normal = pbr_vNormal;\n    #endif\n\n    #ifdef HAS_UV\n      pbr_vUV = TEXCOORD_0;\n    #else\n      pbr_vUV = vec2(0., 0.);\n    #endif\n    geometry.uv = pbr_vUV;\n  #endif\n\n  float originalSize = project_size_to_pixel(sizeScale);\n  float clampedSize = clamp(originalSize, sizeMinPixels, sizeMaxPixels);\n\n  vec3 pos = (instanceModelMatrix * (sceneModelMatrix * POSITION).xyz) * sizeScale * (clampedSize / originalSize) + instanceTranslation;\n  if(composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, geometry.position);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  #ifdef MODULE_PBR\n    pbr_vPosition = geometry.position.xyz;\n  #endif\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\nuniform float opacity;\nin vec4 vColor;\n\nout vec4 fragmentColor;\n#ifndef MODULE_PBR\n  #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n    in vec2 vTEXCOORD_0;\n    uniform sampler2D u_BaseColorSampler;\n  #endif\n#endif\n\nvoid main(void) {\n  #ifdef MODULE_PBR\n    fragmentColor = vColor * pbr_filterColor(vec4(0));\n    geometry.uv = pbr_vUV;\n  #else\n    #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n      fragmentColor = vColor * texture2D(u_BaseColorSampler, vTEXCOORD_0);\n      geometry.uv = vTEXCOORD_0;\n    #else\n      fragmentColor = vColor;\n    #endif\n  #endif\n\n  fragmentColor.a *= opacity;\n  DECKGL_FILTER_COLOR(fragmentColor, geometry);\n}\n",modules:e}}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),accessor:"getPosition",transition:!0},instanceColors:{type:5121,size:this.props.colorFormat.length,accessor:"getColor",normalized:!0,defaultValue:Se,transition:!0},instanceModelMatrix:ye})}},{key:"updateState",value:function(e){Object(d.a)(Object(h.a)(n.prototype),"updateState",this).call(this,e);var t=e.props,r=e.oldProps;t.scenegraph!==r.scenegraph?this._updateScenegraph(t):t._animations!==r._animations&&this._applyAnimationsProp(this.state.scenegraph,this.state.animator,t._animations)}},{key:"finalizeState",value:function(){Object(d.a)(Object(h.a)(n.prototype),"finalizeState",this).call(this),this._deleteScenegraph()}},{key:"_updateScenegraph",value:function(e){var t=this,n=this.context.gl,r=null;if(e.scenegraph instanceof C)r={scenes:[e.scenegraph]};else if(e.scenegraph&&!e.scenegraph.gltf){var i=e.scenegraph,a=function(e,t,n){var r=new oe(e,n);return{scenes:r.instantiate(t),animator:r.createAnimator()}}(n,i,this._getModelOptions());r=Object.assign({gltf:i},a),function(e){return ce.apply(this,arguments)}(a).then((function(){return t.setNeedsRedraw()}))}else e.scenegraph&&(E.a.deprecated("ScenegraphLayer.props.scenegraph","Use GLTFLoader instead of GLTFScenegraphLoader")(),r=e.scenegraph);var o={layer:this,gl:n},s=e.getScene(r,o),c=e.getAnimator(r,o);s instanceof C?(this._deleteScenegraph(),this._applyAllAttributes(s),this._applyAnimationsProp(s,c,e._animations),this.setState({scenegraph:s,animator:c})):null!==s&&E.a.warn("invalid scenegraph:",s)()}},{key:"_applyAllAttributes",value:function(e){var t=this;if(this.state.attributesAvailable){var n=this.getAttributeManager().getAttributes();e.traverse((function(e){t._setModelAttributes(e.model,n)}))}}},{key:"_applyAnimationsProp",value:function(e,t,n){if(e&&t&&n){var r=t.getAnimations();Object.keys(n).sort().forEach((function(e){var t=n[e];if("*"===e)r.forEach((function(e){Object.assign(e,t)}));else if(Number.isFinite(Number(e))){var i=Number(e);i>=0&&i<r.length?Object.assign(r[i],t):E.a.warn("animation ".concat(e," not found"))()}else{var a=r.find((function(t){return t.name===e}));a?Object.assign(a,t):E.a.warn("animation ".concat(e," not found"))()}}))}}},{key:"_deleteScenegraph",value:function(){var e=this.state.scenegraph;e instanceof C&&e.delete()}},{key:"_getModelOptions",value:function(){var e=this.props._imageBasedLightingEnvironment,t=null;return e&&(t="function"==typeof e?e({gl:this.context.gl,layer:this}):e),{gl:this.context.gl,waitForFullLoad:!0,imageBasedLightingEnvironment:t,modelOptions:je({isInstanced:!0,transpileToGLSL100:!Object(x.i)(this.context.gl)},this.getShaders()),useTangents:!1}}},{key:"updateAttributes",value:function(e){var t=this;this.setState({attributesAvailable:!0}),this.state.scenegraph&&this.state.scenegraph.traverse((function(n){t._setModelAttributes(n.model,e)}))}},{key:"draw",value:function(e){var t=e.moduleParameters,n=void 0===t?null:t,r=e.parameters,i=void 0===r?{}:r,a=e.context;if(this.state.scenegraph){this.props._animations&&this.state.animator&&(this.state.animator.animate(a.timeline.getTime()),this.setNeedsRedraw());var o=this.context.viewport,s=this.props,c=s.sizeScale,u=s.sizeMinPixels,l=s.sizeMaxPixels,h=s.opacity,f=s.coordinateSystem,p=this.getNumInstances();this.state.scenegraph.traverse((function(e,t){var r=t.worldMatrix;e.model.setInstanceCount(p),e.updateModuleSettings(n),e.draw({parameters:i,uniforms:{sizeScale:c,opacity:h,sizeMinPixels:u,sizeMaxPixels:l,composeModelMatrix:_e(o,f),sceneModelMatrix:r,u_Camera:e.model.getUniforms().project_uCameraPosition}})}))}}}]),n}(v.a);Ee.layerName="ScenegraphLayer",Ee.defaultProps=Te;var xe=n("91Zk");function Pe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var i=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}function Me(e,t){(e.COLOR_0||e.colors)&&t||(e.colors={constant:!0,value:new Float32Array([1,1,1])}),E.a.assert(e.positions||e.POSITION,'SimpleMeshLayer requires "postions" or "POSITION" attribute in mesh property.')}function Ae(e,t){if(e.attributes)return Me(e.attributes,t),e instanceof f.a?e:new f.a(e);if(e.positions||e.POSITION)return Me(e,t),new f.a({attributes:e});throw Error("Invalid mesh")}var ke={mesh:{value:null,type:"object",async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_useMeshColors:{type:"boolean",value:!1},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:function(e){return e.position}},getColor:{type:"accessor",value:[0,0,0,255]},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]}},Re=function(e){Object(u.a)(n,e);var t=Pe(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"getShaders",value:function(){var e=!Object(x.i)(this.context.gl),t={};return Object($.b)(this.context.gl,ee.a.GLSL_DERIVATIVES)&&(t.DERIVATIVES_AVAILABLE=1),Object(d.a)(Object(h.a)(n.prototype),"getShaders",this).call(this,{vs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-vs\nuniform float sizeScale;\nuniform bool composeModelMatrix;\nin vec3 positions;\nin vec3 normals;\nin vec3 colors;\nin vec2 texCoords;\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\nout vec2 vTexCoord;\nout vec3 cameraPosition;\nout vec3 normals_commonspace;\nout vec4 position_commonspace;\nout vec4 vColor;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = texCoords;\n  geometry.pickingColor = instancePickingColors;\n\n  vTexCoord = texCoords;\n  cameraPosition = project_uCameraPosition;\n  normals_commonspace = project_normal(instanceModelMatrix * normals);\n  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);\n  geometry.normal = normals_commonspace;\n\n  vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;\n\n  if (composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);\n  }\n\n  geometry.position = position_commonspace;\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-fs\n\nprecision highp float;\n\nuniform bool hasTexture;\nuniform sampler2D sampler;\nuniform bool flatShading;\nuniform float opacity;\n\nin vec2 vTexCoord;\nin vec3 cameraPosition;\nin vec3 normals_commonspace;\nin vec4 position_commonspace;\nin vec4 vColor;\n\nout vec4 fragColor;\n\nvoid main(void) {\n  geometry.uv = vTexCoord;\n\n  vec3 normal;\n  if (flatShading) {\n#ifdef DERIVATIVES_AVAILABLE\n    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));\n#else\n    normal = vec3(0.0, 0.0, 1.0);\n#endif\n  } else {\n    normal = normals_commonspace;\n  }\n\n  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;\n  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);\n  fragColor = vec4(lightColor, color.a * opacity);\n\n  DECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",modules:[S.a,xe.b,T.a],transpileToGLSL100:e,defines:t})}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:5130,fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:5121,transition:!0,size:this.props.colorFormat.length,normalized:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:ye}),this.setState({emptyTexture:new te.a(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}},{key:"updateState",value:function(e){var t=e.props,r=e.oldProps,i=e.changeFlags;if(Object(d.a)(Object(h.a)(n.prototype),"updateState",this).call(this,{props:t,oldProps:r,changeFlags:i}),t.mesh!==r.mesh||i.extensionsChanged){if(this.state.model&&this.state.model.delete(),t.mesh){this.setState({model:this.getModel(t.mesh)});var a=t.mesh.attributes||t.mesh;this.setState({hasNormals:Boolean(a.NORMAL||a.normals)})}this.getAttributeManager().invalidateAll()}t.texture!==r.texture&&this.setTexture(t.texture),this.state.model&&this.state.model.setDrawMode(this.props.wireframe?3:4)}},{key:"finalizeState",value:function(){Object(d.a)(Object(h.a)(n.prototype),"finalizeState",this).call(this),this.state.emptyTexture.delete()}},{key:"draw",value:function(e){var t=e.uniforms;if(this.state.model){var n=this.context.viewport,r=this.props,i=r.sizeScale,a=r.coordinateSystem,o=r._instanced;this.state.model.draw({uniforms:Object.assign({},t,{sizeScale:i,composeModelMatrix:!o||_e(n,a),flatShading:!this.state.hasNormals})})}}},{key:"getModel",value:function(e){var t=new Y.a(this.context.gl,Object.assign({},this.getShaders(),{id:this.props.id,geometry:Ae(e,this.props._useMeshColors),isInstanced:!0})),n=this.props.texture,r=this.state.emptyTexture;return t.setUniforms({sampler:n||r,hasTexture:Boolean(n)}),t}},{key:"setTexture",value:function(e){this.context.gl;var t=this.state,n=t.emptyTexture,r=t.model;r&&r.setUniforms({sampler:e||n,hasTexture:Boolean(e)})}}]),n}(v.a);Re.layerName="SimpleMeshLayer",Re.defaultProps=ke;var Ce=n("24Wh"),Ie=(n("wcNg"),n("Ns70")),Le=n("G+eI"),Ne=n("P+ME"),De=n("9h7C"),ze=n("Vmat"),Ue=function(e,t,n){this.item=e,this.previous=t,this.next=n},Be=function(){function e(){this.head=null,this.tail=null,this._length=0}var t=e.prototype;return t.add=function(e){var t=new Ue(e,this.tail,null);return this.tail?(this.tail.next=t,this.tail=t):(this.head=t,this.tail=t),++this._length,t},t.remove=function(e){e&&(e.previous&&e.next?(e.previous.next=e.next,e.next.previous=e.previous):e.previous?(e.previous.next=null,this.tail=e.previous):e.next?(e.next.previous=null,this.head=e.next):(this.head=null,this.tail=null),e.next=null,e.previous=null,--this._length)},t.splice=function(e,t){e!==t&&(this.remove(t),this._insert(e,t))},t._insert=function(e,t){var n=e.next;e.next=t,this.tail===e?this.tail=t:n.previous=t,t.next=n,t.previous=e,++this._length},Object(c.a)(e,[{key:"length",get:function(){return this._length}}]),e}();function Ve(e){return null!=e}var Fe=function(){function e(){this._list=new Be,this._sentinel=this._list.add("sentinel"),this._trimTiles=!1}var t=e.prototype;return t.reset=function(){this._list.splice(this._list.tail,this._sentinel)},t.touch=function(e){var t=e._cacheNode;Ve(t)&&this._list.splice(this._sentinel,t)},t.add=function(e,t,n){Ve(t._cacheNode)||(t._cacheNode=this._list.add(t),n&&n(e,t))},t.unloadTile=function(e,t,n){var r=t._cacheNode;Ve(r)&&(this._list.remove(r),t._cacheNode=void 0,n&&n(e,t))},t.unloadTiles=function(e,t){var n=this._trimTiles;this._trimTiles=!1;for(var r=this._list,i=1024*e.maximumMemoryUsage*1024,a=this._sentinel,o=r.head;o!==a&&(e.gpuMemoryUsageInBytes>i||n);){var s=o.item;o=o.next,this.unloadTile(e,s,t)}},t.trim=function(){this._trimTiles=!0},e}();var Ge=n("rOwd"),qe=new M.a,He=new M.a,Ze=new Ge.b([new Ge.d,new Ge.d,new Ge.d,new Ge.d,new Ge.d,new Ge.d]);function We(e,t){var n=e.cameraDirection,r=e.cameraUp,i=e.height,a=e.distanceScales.metersPerUnit,o=[e.longitude,e.latitude,0],s=Ie.a.WGS84.cartographicToCartesian(o,new M.a),c=Ie.a.WGS84.eastNorthUpToFixedFrame(s),u=e.unprojectPosition(e.cameraPosition),l=Ie.a.WGS84.cartographicToCartesian(u,new M.a),h=new M.a(c.transformAsVector(new M.a(n).scale(a))).normalize(),f=new M.a(c.transformAsVector(new M.a(r).scale(a))).normalize();return function(e,t){var n=e.getFrustumPlanes(),r=0;for(var i in n){var a=n[i],o=a.normal.dot(e.center);He.copy(a.normal).scale(a.distance-o).add(e.center);var s=e.unprojectPosition(He),c=Ie.a.WGS84.cartographicToCartesian(s,new M.a);Ze.planes[r++].fromPointNormal(c,qe.copy(t).subtract(c))}}(e,s),{camera:{position:l,direction:h,up:f},viewport:e,height:i,cullingVolume:Ze,frameNumber:t,sseDenominator:1.15}}var Ke=new M.a;var Xe=n("O6hP"),Ye=n("a3TU"),Qe=n("GA6j");function Je(e){return null!=e}var $e=new M.a,et=new M.a,tt=new M.a;new A.a;function nt(e,t,n){if(Object(Ne.a)(e,"3D Tile: boundingVolume must be defined"),e.box)return function(e,t,n){var r=new M.a(e[0],e[1],e[2]);t.transform(r,r);var i=t.transformAsVector(e.slice(3,6)),a=t.transformAsVector(e.slice(6,9)),o=t.transformAsVector(e.slice(9,12)),s=new Qe.a([i[0],i[1],i[2],a[0],a[1],a[2],o[0],o[1],o[2]]);if(Je(n))return n.center=r,n.halfAxes=s,n;return new Ge.c(r,s)}(e.box,t,n);if(e.region){var r=e.region,i=r[0],a=r[1],o=r[2],s=r[3],c=r[4],u=r[5],l=Ie.a.WGS84.cartographicToCartesian([Object(Ye.c)(i),Object(Ye.c)(s),c],et),h=Ie.a.WGS84.cartographicToCartesian([Object(Ye.c)(o),Object(Ye.c)(a),u],tt),f=(new M.a).addVectors(l,h).multiplyScalar(.5),p=(new M.a).subVectors(l,h).len()/2;return rt([f[0],f[1],f[2],p],new A.a)}if(e.sphere)return rt(e.sphere,t,n);throw new Error("3D Tile: boundingVolume must contain a sphere, region, or box")}function rt(e,t,n){var r=new M.a(e[0],e[1],e[2]);t.transform(r,r);var i=t.getScale($e),a=Math.max(Math.max(i[0],i[1]),i[2]),o=e[3]*a;return Je(n)?(n.center=r,n.radius=o,n):new Ge.a(r,o)}new M.a,new M.a,new A.a,new M.a,new M.a,new M.a;function it(e,t){if(e.dynamicScreenSpaceError&&e._dynamicScreenSpaceErrorComputedDensity){var n=e._dynamicScreenSpaceErrorComputedDensity,r=e.dynamicScreenSpaceErrorFactor;return function(e,t){var n=e*t;return 1-Math.exp(-n*n)}(t,n)*r}return 0}var at=Math.PI/2;function ot(e){var t=e[0],n=e[1],r=e[2],i=Object(Ye.i)(t),a=Object(Ye.i)(n),o=1+r/6378137,s=o*Math.cos(a);return[t=s*Math.cos(i),n=s*Math.sin(i),r=o*Math.sin(a)]}function st(e,t){var n=e[0],r=e[1],i=e[2],a=void 0===i?0:i,o=t[0],s=t[1],c=t[2],u=ot([o,s,void 0===c?0:c]),l=ot([n,r,a]),h=l[0]-u[0],f=l[1]-u[1],p=l[2]-u[2];return h*h+f*f+p*p}function ct(e,t){var n=t.viewport,r=e.header.mbs[1],i=[e.header.mbs[0],r,e.header.mbs[2]],a=e.header.mbs[3]/6378137,o=st(n.unprojectPosition(n.cameraPosition),i)-a*a;if(o<=0)return 170141175e30;var s=function(e,t){var n=t.viewport,r=n.width,i=n.height,a=n.pixelProjectionMatrix,o=Math.tan(Math.atan(Math.sqrt(1/(a[0]*a[0])+1/(a[5]*a[5]))));return Math.sqrt(i*i+r*r)/o}(0,t);return s*=a/Math.sqrt(o)/n.scale}function ut(e){return{dracoGeometryIndex:(e&&e.geometryDefinitions&&e.geometryDefinitions[0]&&e.geometryDefinitions[0].geometryBuffers||[]).findIndex((function(e){return e.compressedAttributes&&"draco"===e.compressedAttributes.encoding}))}}function lt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ht(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?lt(Object(n),!0).forEach((function(t){Object(a.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ft=new M.a;var pt=function(){function e(e,t,n){Object(Ne.a)("object"==typeof t),this.header=t,this.tileset=e,this.id=t.id,this.url=t.url,this.parent=n,this.refine=this._getRefine(t.refine),this.type=t.type,this.contentUrl=t.contentUrl,this.lodMetricType=null,this.lodMetricValue=null,this.boundingVolume=null,this.content=null,this.contentState=Xe.d.UNLOADED,this.gpuMemoryUsageInBytes=0,this.children=[],this.depth=0,this._cacheNode=null,this._frameNumber=null,this._cacheNode=null,this._initializeLodMetric(t),this._initializeTransforms(t),this._initializeBoundingVolumes(t),this._initializeContent(t),this._initializeRenderingState(t),this._lodJudge=null,this._expireDate=null,this._expiredContent=null,this._getPriority=this._getPriority.bind(this),Object.seal(this)}var t=e.prototype;return t.destroy=function(){this.header=null},t.isDestroyed=function(){return null===this.header},t.getScreenSpaceError=function(e,t){switch(this.tileset.type){case Xe.c.I3S:return ct(this,e);case Xe.c.TILES3D:return function(e,t,n){var r=e.tileset,i=e.parent&&e.parent.lodMetricValue||e.lodMetricValue,a=n?i:e.lodMetricValue;if(0===a)return 0;var o=Math.max(e._distanceToCamera,1e-7),s=a*t.height/(o*t.sseDenominator);return s-=it(r,o)}(this,e,t);default:return console.error("Unsupported tileset type"),null}},t._getPriority=function(){return this.isVisible?this.contentState===Xe.d.UNLOADED?-1:Math.max(1e7-this._priority,0)||0:-1},t.loadContent=function(){var e=Object(o.a)(i.a.mark((function e(){var t,n,r,a,o,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.hasEmptyContent){e.next=2;break}return e.abrupt("return",!1);case 2:if(!this.content){e.next=4;break}return e.abrupt("return",!0);case 4:return this.contentExpired&&(this._expireDate=null),this.contentState=Xe.d.LOADING,e.next=9,this.tileset._requestScheduler.scheduleRequest(this.id,this._getPriority);case 9:if(t=e.sent){e.next=13;break}return this.contentState=Xe.d.UNLOADED,e.abrupt("return",!1);case 13:return e.prev=13,r=this.tileset.getTileUrl(this.contentUrl),a=this.tileset.fetchOptions,o=this.tileset.loader,s=ht(ht({},a),{},((n={})[o.id]=ht({tile:this.header,tileset:this.tileset.tileset,isTileset:"json"===this.type,isTileHeader:!1},this._getLoaderSpecificOptions(o.id)),n)),e.next=20,Object(Ce.a)(r,o,s);case 20:return this.content=e.sent,this._isTileset()&&this.tileset._initializeTileHeaders(this.content,this,De.a.dirname(this.contentUrl)),this.contentState=Xe.d.READY,this._onContentLoaded(),e.abrupt("return",!0);case 27:throw e.prev=27,e.t0=e.catch(13),this.contentState=Xe.d.FAILED,e.t0;case 31:return e.prev=31,t.done(),e.finish(31);case 34:case"end":return e.stop()}}),e,this,[[13,27,31,34]])})));return function(){return e.apply(this,arguments)}}(),t.unloadContent=function(){return this.content&&this.content.destroy&&this.content.destroy(),this.content=null,this.header.content&&this.header.content.destroy&&this.header.content.destroy(),this.header.content=null,this.contentState=Xe.d.UNLOADED,!0},t.updateVisibility=function(e){if(this._frameNumber!==e.frameNumber){var t=this.parent,n=t?t.computedTransform:this.tileset.modelMatrix,r=t?t._visibilityPlaneMask:Ge.b.MASK_INDETERMINATE;this._updateTransform(n),this._distanceToCamera=this.distanceToTile(e),this._screenSpaceError=this.getScreenSpaceError(e,!1),this._visibilityPlaneMask=this.visibility(e,r),this._visible=this._visibilityPlaneMask!==Ge.b.MASK_OUTSIDE,this._inRequestVolume=this.insideViewerRequestVolume(e),this._priority=this.lodMetricValue,this._frameNumber=e.frameNumber}},t.visibility=function(e,t){var n=e.cullingVolume,r=this.boundingVolume;return n.computeVisibilityWithPlaneMask(r,t)},t.contentVisibility=function(e){return!0},t.distanceToTile=function(e){var t=this.boundingVolume;return Math.sqrt(Math.max(t.distanceSquaredTo(e.camera.position),0))},t.cameraSpaceZDepth=function(e){var t=e.camera,n=this.boundingVolume;return ft.subVectors(n.center,t.position),t.direction.dot(ft)},t.insideViewerRequestVolume=function(e){var t=this._viewerRequestVolume;return!t||0===t.distanceToCamera(e)},t._initializeLodMetric=function(e){"lodMetricType"in e?this.lodMetricType=e.lodMetricType:(this.lodMetricType=this.parent&&this.parent.lodMetricType||this.tileset.lodMetricType,console.warn("3D Tile: Required prop lodMetricType is undefined. Using parent lodMetricType")),"lodMetricValue"in e?this.lodMetricValue=e.lodMetricValue:(this.lodMetricValue=this.parent&&this.parent.lodMetricValue||this.tileset.lodMetricValue,console.warn("3D Tile: Required prop lodMetricValue is undefined. Using parent lodMetricValue"))},t._initializeTransforms=function(e){this.transform=e.transform?new A.a(e.transform):new A.a;var t=this.parent,n=this.tileset,r=t&&t.computedTransform?t.computedTransform.clone():n.modelMatrix.clone();this.computedTransform=new A.a(r).multiplyRight(this.transform);var i=t&&t._initialTransform?t._initialTransform.clone():new A.a;this._initialTransform=new A.a(i).multiplyRight(this.transform)},t._initializeBoundingVolumes=function(e){this._contentBoundingVolume=null,this._viewerRequestVolume=null,this._updateBoundingVolume(e)},t._initializeContent=function(e){this.content={_tileset:this.tileset,_tile:this},this.hasEmptyContent=!0,this.contentState=Xe.d.UNLOADED,this.hasTilesetContent=!1,e.contentUrl&&(this.content=null,this.hasEmptyContent=!1)},t._initializeRenderingState=function(e){this.depth=e.level,this._shouldRefine=!1,this._distanceToCamera=0,this._centerZDepth=0,this._screenSpaceError=0,this._visibilityPlaneMask=Ge.b.MASK_INDETERMINATE,this._visible=!1,this._inRequestVolume=!1,this._stackLength=0,this._selectionDepth=0,this._frameNumber=0,this._touchedFrame=0,this._visitedFrame=0,this._selectedFrame=0,this._requestedFrame=0,this._priority=0},t._getRefine=function(e){return e||this.parent&&this.parent.refine||Xe.e.REPLACE},t._isTileset=function(){return-1!==this.contentUrl.indexOf(".json")},t._onContentLoaded=function(){switch(this.content&&this.content.type){case"vctr":case"geom":this.tileset.traverser.disableSkipLevelOfDetail=!0}this._isTileset()&&(this.hasTilesetContent=!0)},t._updateBoundingVolume=function(e){this.boundingVolume=nt(e.boundingVolume,this.computedTransform,this.boundingVolume);var t=e.content;t&&(t.boundingVolume&&(this._contentBoundingVolume=nt(t.boundingVolume,this.computedTransform,this._contentBoundingVolume)),e.viewerRequestVolume&&(this._viewerRequestVolume=nt(e.viewerRequestVolume,this.computedTransform,this._viewerRequestVolume)))},t._updateTransform=function(e){void 0===e&&(e=new A.a);var t=e.clone().multiplyRight(this.transform);!t.equals(this.computedTransform)&&(this.computedTransform=t,this._updateBoundingVolume(this.header))},t._getLoaderSpecificOptions=function(e){switch(e){case"i3s":return ut(this.tileset.tileset);case"3d-tiles":case"cesium-ion":default:return{assetGltfUpAxis:(t=this.tileset.tileset).asset&&t.asset.gltfUpAxis||"Y"}}var t},t.updateExpiration=function(){if(null!=this._expireDate&&this.contentReady&&!this.hasEmptyContent){var e=Date.now();Date.lessThan(this._expireDate,e)&&(this.contentState=Xe.d.EXPIRED,this._expiredContent=this.content)}},Object(c.a)(e,[{key:"selected",get:function(){return this._selectedFrame===this.tileset._frameNumber}},{key:"isVisible",get:function(){return this._visible}},{key:"isVisibleAndInRequestVolume",get:function(){return this._visible&&this._inRequestVolume}},{key:"hasRenderContent",get:function(){return!this.hasEmptyContent&&!this.hasTilesetContent}},{key:"hasChildren",get:function(){return this.children.length>0||this.header.children&&this.header.children.length>0}},{key:"contentReady",get:function(){return this.contentState===Xe.d.READY||this.hasEmptyContent}},{key:"contentAvailable",get:function(){return Boolean(this.contentReady&&this.hasRenderContent||this._expiredContent&&!this.contentFailed)}},{key:"hasUnloadedContent",get:function(){return this.hasRenderContent&&this.contentUnloaded}},{key:"contentUnloaded",get:function(){return this.contentState===Xe.d.UNLOADED}},{key:"contentExpired",get:function(){return this.contentState===Xe.d.EXPIRED}},{key:"contentFailed",get:function(){return this.contentState===Xe.d.FAILED}},{key:"extras",get:function(){return this.header.extras}}]),e}(),dt=n("dI71"),vt=function(){function e(e){void 0===e&&(e=0),this._array=new Array(e),this._map=new Map,this._length=e}var t=e.prototype;return t.get=function(e){return Object(Ne.a)(e<this._array.length),this._array[e]},t.set=function(e,t){Object(Ne.a)(e>=0),e>=this.length&&(this.length=e+1),this._map.has(this._array[e])&&this._map.delete(this._array[e]),this._array[e]=t,this._map.set(t,e)},t.delete=function(e){var t=this._map.get(e);t>=0&&(this._array.splice(t,1),this._map.delete(e),this.length--)},t.peek=function(){return this._array[this._length-1]},t.push=function(e){if(!this._map.has(e)){var t=this.length++;this._array[t]=e,this._map.set(e,t)}},t.pop=function(){var e=this._array[--this.length];return this._map.delete(e),e},t.reserve=function(e){Object(Ne.a)(e>=0),e>this._array.length&&(this._array.length=e)},t.resize=function(e){Object(Ne.a)(e>=0),this.length=e},t.trim=function(e){null==e&&(e=this.length),this._array.length=e},t.reset=function(){this._array=[],this._map=new Map,this._length=0},t.find=function(e){return this._map.has(e)},Object(c.a)(e,[{key:"length",get:function(){return this._length},set:function(e){this._length=e,e>this._array.length&&(this._array.length=e)}},{key:"values",get:function(){return this._array}}]),e}();function mt(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return gt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return gt(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function gt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function bt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function yt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bt(Object(n),!0).forEach((function(t){Object(a.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _t={loadSiblings:!1,skipLevelOfDetail:!1,maximumScreenSpaceError:2},Ot=function(){function e(e){this.options=yt(yt({},_t),e),this._traversalStack=new vt,this._emptyTraversalStack=new vt,this._frameNumber=null,this.root=null,this.selectedTiles={},this.requestedTiles={},this.emptyTiles={}}var t=e.prototype;return t.traverse=function(e,t,n){this.root=e,this.options=yt(yt({},this.options),n),this.reset(),this.updateTile(e,t),this._frameNumber=t.frameNumber,this.executeTraversal(e,t)},t.reset=function(){this.requestedTiles={},this.selectedTiles={},this.emptyTiles={},this._traversalStack.reset(),this._emptyTraversalStack.reset()},t.executeTraversal=function(e,t){var n=this._traversalStack;for(n.push(e);n.length>0;){var r=n.pop(),i=!1;this.canTraverse(r,t)&&(this.updateChildTiles(r,t),i=this.updateAndPushChildren(r,t,n));var a=r.parent,o=Boolean(!a||a._shouldRefine),s=!i;r.hasRenderContent?r.refine===Xe.e.ADD?(this.loadTile(r,t),this.selectTile(r,t)):r.refine===Xe.e.REPLACE&&(this.loadTile(r,t),s&&this.selectTile(r,t)):(this.emptyTiles[r.id]=r,this.loadTile(r,t),s&&this.selectTile(r,t)),this.touchTile(r,t),r._shouldRefine=i&&o}this.options.onTraversalEnd&&this.options.onTraversalEnd(t)},t.updateChildTiles=function(e,t){for(var n,r=mt(e.children);!(n=r()).done;){var i=n.value;this.updateTile(i,t)}return!0},t.updateAndPushChildren=function(e,t,n){var r=this.options,i=r.loadSiblings,a=r.skipLevelOfDetail,o=e.children;o.sort(this.compareDistanceToCamera);for(var s,c=!a&&e.refine===Xe.e.REPLACE&&e.hasRenderContent,u=!1,l=mt(o);!(s=l()).done;){var h=s.value;if(h.isVisibleAndInRequestVolume?(n.find(h)&&n.delete(h),n.push(h),u=!0):(c||i)&&(this.loadTile(h,t),this.touchTile(h,t)),c){var f=void 0;if(!(f=!!h._inRequestVolume&&(h.hasRenderContent?h.contentAvailable:this.executeEmptyTraversal(h,t))))return f}}return u},t.updateTile=function(e,t){this.updateTileVisibility(e,t)},t.selectTile=function(e,t){this.shouldSelectTile(e,t)&&(e._selectedFrame=t.frameNumber,this.selectedTiles[e.id]=e)},t.loadTile=function(e,t){this.shouldLoadTile(e,t)&&(e._requestedFrame=t.frameNumber,e._priority=this.getPriority(e),this.requestedTiles[e.id]=e)},t.touchTile=function(e,t){e.tileset._cache.touch(e),e._touchedFrame=t.frameNumber},t.canTraverse=function(e,t,n,r){return void 0===n&&(n=!1),void 0===r&&(r=!1),!(!r&&!e.isVisibleAndInRequestVolume)&&(!!e.hasChildren&&(e.hasTilesetContent?!e.contentExpired:this.shouldRefine(e,t,n)))},t.shouldLoadTile=function(e,t){return e.hasUnloadedContent||e.contentExpired},t.shouldSelectTile=function(e,t){return e.contentAvailable&&!this.options.skipLevelOfDetail},t.shouldRefine=function(e,t,n){var r=e._screenSpaceError;return n&&(r=e.getScreenSpaceError(t,!0)),r>this.options.maximumScreenSpaceError},t.updateTileVisibility=function(e,t){e.updateVisibility(t)},t.compareDistanceToCamera=function(e,t){return e._distanceToCamera-t._distanceToCamera},t.getPriority=function(e){var t=this.options;switch(e.refine){case Xe.e.ADD:return e._distanceToCamera;case Xe.e.REPLACE:var n=e.parent,r=n&&(!t.skipLevelOfDetail||0===e._screenSpaceError||n.hasTilesetContent)?n._screenSpaceError:e._screenSpaceError;return this.root._screenSpaceError-r;default:return Object(Ne.a)(!1)}},t.anyChildrenVisible=function(e,t){for(var n,r=!1,i=mt(e.children);!(n=i()).done;){var a=n.value;a.updateVisibility(t),r=r||a.isVisibleAndInRequestVolume}return r},t.executeEmptyTraversal=function(e,t){for(var n=!0,r=this._emptyTraversalStack;r.length>0;){var i=r.pop();this.updateTile(i,t),i.isVisibleAndInRequestVolume||(this.loadTile(i,t),this.touchTile(i,t));var a=!i.hasRenderContent&&this.canTraverse(i,t,!1,!0);if(a||i.contentAvailable||(n=!1),a)for(var o,s=mt(i.children.filter((function(e){return e})));!(o=s()).done;){var c=o.value;r.find(c)&&r.delete(c),r.push(c)}}return n},e}(),jt=function(e){function t(){return e.apply(this,arguments)||this}Object(dt.a)(t,e);var n=t.prototype;return n.compareDistanceToCamera=function(e,t){return 0===t._distanceToCamera&&0===e._distanceToCamera?t._centerZDepth-e._centerZDepth:t._distanceToCamera-e._distanceToCamera},n.updateTileVisibility=function(e,t){if(e.updateVisibility(t),e.isVisibleAndInRequestVolume){var n=e.children.length>0;if(e.hasTilesetContent&&n){var r=e.children[0];return this.updateTileVisibility(r,t),void(e._visible=r._visible)}if(this.meetsScreenSpaceErrorEarly(e,t))e._visible=!1;else{var i=e.refine===Xe.e.REPLACE,a=e._optimChildrenWithinParent===Xe.b.USE_OPTIMIZATION;i&&a&&n&&!this.anyChildrenVisible(e,t)&&(e._visible=!1)}}},n.meetsScreenSpaceErrorEarly=function(e,t){var n=e.parent;return!(!n||n.hasTilesetContent||n.refine!==Xe.e.ADD)&&!this.shouldRefine(e,t,!0)},t}(Ot),wt="REQUESTED",St="COMPLETED",Tt="ERROR",Et=function(){function e(){this._statusMap={}}var t=e.prototype;return t.add=function(e,t,n,r){var i=this;this._statusMap[t]||(this._statusMap[t]={request:e,callback:n,key:t,frameState:r,status:wt},e().then((function(e){i._statusMap[t].status=St,i._statusMap[t].callback(e,r)})).catch((function(e){i._statusMap[t].status=Tt,n(e)})))},t.update=function(e,t){this._statusMap[e]&&(this._statusMap[e].frameState=t)},t.find=function(e){return this._statusMap[e]},e}();function xt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Pt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xt(Object(n),!0).forEach((function(t){Object(a.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Mt(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return At(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return At(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function At(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var kt=function(e){function t(t){var n;return(n=e.call(this,t)||this)._tileManager=new Et,n}Object(dt.a)(t,e);var n=t.prototype;return n.shouldRefine=function(e,t){return e._lodJudge=function(e,t){var n=t.viewport,r=n.metersPerPixel,i=e.header.mbs[1],a=e.header.mbs[0],o=e.header.mbs[2],s=e.header.mbs[3],c=n.height,u=n.width,l=n.latitude,h=n.longitude,f=[h,l],p=[a,i,o],d=[h,i],v=[a,l],m=Math.sqrt(c*c+u*u)*r[0],g=.5*c+s/6378137,b=.5*u+s/6378137;if(st(f,p)>m+s/6378137)return"OUT";if(st(f,d)>g)return"OUT";if(st(f,v)>b)return"OUT";if(0===e.lodMetricValue)return"DIG";var y=ct(e,t);return(y*=at)<.5?"OUT":!e.header.children||y<=e.lodMetricValue?"DRAW":e.header.children?"DIG":"OUT"}(e,t),"DIG"===e._lodJudge},n.updateChildTiles=function(e,t){for(var n,r=this,i=e.header.children||[],a=e.children,o=e.tileset,s=function(){var i=n.value,s=a&&a.find((function(e){return e.id===i.id}));if(s)s&&r.updateTile(s,t);else{var c=function(){return r._loadTile(i.id,o)};r._tileManager.find(i.id)?r._tileManager.update(i.id,t):(o.tileset.nodePages&&(c=function(){return o.tileset.nodePagesTile.formTileFromNodePages(i.id)}),r._tileManager.add(c,i.id,(function(t){return r._onTileLoad(t,e)}),t))}},c=Mt(i);!(n=c()).done;)s()},n._loadTile=function(){var e=Object(o.a)(i.a.mark((function e(t,n){var r,a,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.loader,a=n.getTileUrl(n.url+"/nodes/"+t),o={i3s:Pt(Pt({},n.fetchOptions),{},{isTileHeader:!0,loadContent:!1},ut(n.tileset))},e.next=5,Object(Ce.a)(a,r,o);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),n._onTileLoad=function(e,t){var n=this.options.basePath,r=new pt(t.tileset,e,t,n);t.children.push(r);var i=this._tileManager.find(r.id).frameState;this.updateTile(r,i),this._frameNumber===i.frameNumber&&this.executeTraversal(r,i)},t}(Ot);function Rt(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Ct(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ct(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function Ct(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function It(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Lt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?It(Object(n),!0).forEach((function(t){Object(a.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):It(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Nt={ellipsoid:Ie.a.WGS84,modelMatrix:new A.a,throttleRequests:!1,maximumMemoryUsage:32,onTileLoad:function(){},onTileUnload:function(){},onTileError:function(e,t,n){},maximumScreenSpaceError:8},Dt=function(){function e(e,t){void 0===t&&(t={}),Object(Ne.a)(e),this.options=Lt(Lt({},Nt),t),this.tileset=e,this.loader=e.loader,this.type=e.type,this.url=e.url,this.basePath=e.basePath||De.a.dirname(this.url),this.modelMatrix=this.options.modelMatrix,this.ellipsoid=this.options.ellipsoid,this.lodMetricType=e.lodMetricType,this.lodMetricValue=e.lodMetricValue,this.refine=e.root.refine,this.fetchOptions=this.options.fetchOptions||{},this.options.headers&&(this.fetchOptions.headers=this.options.headers),this.options.token&&(this.fetchOptions.token=this.options.token),this.root=null,this.cartographicCenter=null,this.cartesianCenter=null,this.zoom=1,this.boundingVolume=null,this._traverser=this._initializeTraverser(),this._cache=new Fe,this._requestScheduler=new ze.a({throttleRequests:this.options.throttleRequests}),this._frameNumber=0,this._updateFrameNumber=0,this._pendingCount=0,this._tiles={},this.selectedTiles=[],this._emptyTiles=[],this._requestedTiles=[],this._selectedTilesToStyle=[],this._queryParams={},this._queryParamsString=null,this.maximumMemoryUsage=this.options.maximumMemoryUsage,this.gpuMemoryUsageInBytes=0,this.stats=new Le.a({id:this.url}),this._initializeStats(),this._hasMixedContent=!1,this._maximumScreenSpaceError=this.options.maximumScreenSpaceError,this._properties=void 0,this._extensionsUsed=void 0,this._gltfUpAxis=void 0,this._dynamicScreenSpaceErrorComputedDensity=0,this.extras=null,this.asset={},this.credits={},this.description=this.options.description,this._defaultGeometrySchema=[],this._initializeTileSet(e,this.options)}var t=e.prototype;return t.isLoaded=function(){return 0===this._pendingCount},t.destroy=function(){this._destroy()},t.getTileUrl=function(e){return e.startsWith("data:")?e:""+e+this.queryParams},t.update=function(e){this._cache.reset(),this._frameNumber++,this._frameState=We(e,this._frameNumber),this._traverser.traverse(this.root,this._frameState,this.options)},t._onTraversalEnd=function(){var e=Object.values(this._traverser.selectedTiles);this._tilesChanged(this.selectedTiles,e)&&this._updateFrameNumber++,this.selectedTiles=e;for(var t,n=Rt(this.selectedTiles);!(t=n()).done;){var r=t.value;this._tiles[r.id]=r}return this._requestedTiles=Object.values(this._traverser.requestedTiles),this._emptyTiles=Object.values(this._traverser.emptyTiles),this._loadTiles(this._frameState),this._unloadTiles(),this._updateStats(),this._updateFrameNumber},t._tilesChanged=function(e,t){if(e.length!==t.length)return!0;var n=new Set(e.map((function(e){return e.id}))),r=new Set(t.map((function(e){return e.id}))),i=e.filter((function(e){return!r.has(e.id)})).length>0;return i=i||t.filter((function(e){return!n.has(e.id)})).length>0},t._loadTiles=function(e){for(var t,n=Rt(this._requestedTiles);!(t=n()).done;){var r=t.value;r.contentUnloaded&&this._loadTile(r,e)}},t._unloadTiles=function(){this._cache.unloadTiles(this,(function(e,t){return e._unloadTile(t)}))},t._updateStats=function(){for(var e,t=0,n=0,r=Rt(this.selectedTiles);!(e=r()).done;){var i=e.value;i.contentAvailable&&(t++,i.content.pointCount&&(n+=i.content.pointCount))}this.stats.get("Tiles In View").count=this.selectedTiles.length,this.stats.get("Tiles To Render").count=t,this.stats.get("Points").count=n},t._initializeTileSet=function(e){this.root=this._initializeTileHeaders(e,null,this.basePath),this.type===Xe.c.TILES3D&&this._initializeCesiumTileset(e),this.type===Xe.c.I3S&&this._initializeI3STileset(e),this._calculateViewProps()},t._calculateViewProps=function(){var e=this.root,t=e.boundingVolume.center;if(!t)return console.warn("center was not pre-calculated for the root tile"),this.cartographicCenter=new M.a,void(this.zoom=1);this.cartographicCenter=Ie.a.WGS84.cartesianToCartographic(t,new M.a),this.cartesianCenter=t,this.zoom=function(e){var t=e.halfAxes,n=e.radius,r=e.width,i=e.height;if(t){t.getColumn(0,Ke);var a=Ke.len();t.getColumn(1,Ke);var o=Ke.len();t.getColumn(2,Ke);var s=a/2,c=o/2,u=Ke.len()/2;return(Math.log2(6378137/s)+Math.log2(6378137/c)+Math.log2(6356752.314245179/u))/3}return n?Math.log2(6356752.314245179/n):i&&r?(Math.log2(6378137/r)+Math.log2(6378137/i))/2:1}(e.boundingVolume)},t._initializeStats=function(){this.stats.get("Tiles In Tileset(s)"),this.stats.get("Tiles Loading"),this.stats.get("Tiles In Memory"),this.stats.get("Tiles In View"),this.stats.get("Tiles To Render"),this.stats.get("Tiles Loaded"),this.stats.get("Tiles Unloaded"),this.stats.get("Failed Tile Loads"),this.stats.get("Points","memory"),this.stats.get("Tile Memory Use","memory")},t._initializeTileHeaders=function(e,t,n){var r=new pt(this,e.root,t,n);if(t&&(t.children.push(r),r.depth=t.depth+1),this.type===Xe.c.TILES3D){var i=[];for(i.push(r);i.length>0;){var a=i.pop();this.stats.get("Tiles In Tileset(s)").incrementCount();for(var o,s=Rt(a.header.children||[]);!(o=s()).done;){var c=o.value,u=new pt(this,c,a,n);a.children.push(u),u.depth=a.depth+1,i.push(u)}}}return r},t._initializeTraverser=function(){var e;switch(this.type){case Xe.c.TILES3D:e=jt;break;case Xe.c.I3S:e=kt;break;default:e=Ot}return new e({basePath:this.basePath,onTraversalEnd:this._onTraversalEnd.bind(this)})},t._destroyTileHeaders=function(e){this._destroySubtree(e)},t._loadTile=function(){var e=Object(o.a)(i.a.mark((function e(t,n){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this._onStartTileLoading(),e.next=4,t.loadContent(n);case 4:r=e.sent,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),this._onTileLoadError(t,e.t0);case 10:return e.prev=10,this._onEndTileLoading(),this._onTileLoad(t,r),e.finish(10);case 14:case"end":return e.stop()}}),e,this,[[0,7,10,14]])})));return function(t,n){return e.apply(this,arguments)}}(),t._onTileLoadError=function(e,t){this.stats.get("Failed Tile Loads").incrementCount();var n=t.message||t.toString(),r=e.url;console.error("A 3D tile failed to load: "+e.url+" "+n),this.options.onTileError(e,n,r)},t._onTileLoad=function(e,t){t&&(e&&e.content&&function(e,t){Object(Ne.a)(e),Object(Ne.a)(t);var n=t.rtcCenter,r=t.gltfUpAxis,i=e.computedTransform,a=e.boundingVolume.center,o=new A.a(i);switch(n&&o.translate(n),r){case"Z":break;case"Y":var s=(new A.a).rotateX(Math.PI/2);o=o.multiplyRight(s);break;case"X":var c=(new A.a).rotateY(-Math.PI/2);o=o.multiplyRight(c)}t.isQuantized&&o.translate(t.quantizedVolumeOffset).scale(t.quantizedVolumeScale);var u=new M.a(a);t.cartesianModelMatrix=o,t.cartesianOrigin=u;var l=Ie.a.WGS84.cartesianToCartographic(u,new M.a),h=Ie.a.WGS84.eastNorthUpToFixedFrame(u).invert();t.cartographicModelMatrix=h.multiplyRight(o),t.cartographicOrigin=l,t.modelMatrix=t.cartographicModelMatrix}(e,e.content),this._addTileToCache(e),this.options.onTileLoad(e))},t._onStartTileLoading=function(){this._pendingCount++,this.stats.get("Tiles Loading").incrementCount()},t._onEndTileLoading=function(){this._pendingCount--,this.stats.get("Tiles Loading").decrementCount()},t._addTileToCache=function(e){this._cache.add(this,e,(function(t){return t._updateCacheStats(e)}))},t._updateCacheStats=function(e){this.stats.get("Tiles Loaded").incrementCount(),this.stats.get("Tiles In Memory").incrementCount(),this.gpuMemoryUsageInBytes+=e.content.byteLength||0,this.stats.get("Tile Memory Use").count=this.gpuMemoryUsageInBytes},t._unloadTile=function(e){this.gpuMemoryUsageInBytes-=e.content.byteLength||0,this.stats.get("Tiles In Memory").decrementCount(),this.stats.get("Tiles Unloaded").incrementCount(),this.stats.get("Tile Memory Use").count=this.gpuMemoryUsageInBytes,this.options.onTileUnload(e),e.unloadContent()},t._destroy=function(){var e=[];for(this.root&&e.push(this.root);e.length>0;){for(var t,n=e.pop(),r=Rt(n.children);!(t=r()).done;){var i=t.value;e.push(i)}this._destroyTile(n)}this.root=null},t._destroySubtree=function(e){var t=e,n=[];for(n.push(t);n.length>0;){for(var r,i=Rt((e=n.pop()).children);!(r=i()).done;){var a=r.value;n.push(a)}e!==t&&this._destroyTile(e)}t.children=[]},t._destroyTile=function(e){this._cache.unloadTile(this,e),this._unloadTile(e),e.destroy()},t._initializeCesiumTileset=function(e){if(this.asset=e.asset,!this.asset)throw new Error("Tileset must have an asset property.");if("0.0"!==this.asset.version&&"1.0"!==this.asset.version)throw new Error("The tileset must be 3D Tiles version 0.0 or 1.0.");"tilesetVersion"in this.asset&&(this._queryParams.v=this.asset.tilesetVersion),this.credits={attributions:this.options.attributions||[]},this.description=this.options.description,this.properties=e.properties,this.geometricError=e.geometricError,this._extensionsUsed=e.extensionsUsed,this.extras=e.extras},t._initializeI3STileset=function(e){"token"in this.options&&(this._queryParams.token=this.options.token),this._defaultGeometrySchema=e.store.defaultGeometrySchema},t.hasExtension=function(e){return Boolean(this._extensionsUsed&&this._extensionsUsed.indexOf(e)>-1)},Object(c.a)(e,[{key:"tiles",get:function(){return Object.values(this._tiles)}},{key:"queryParams",get:function(){return this._queryParamsString||(this._queryParamsString=function(e){for(var t=[],n=0,r=Object.keys(e);n<r.length;n++){var i=r[n];t.push(i+"="+e[i])}switch(t.length){case 0:return"";case 1:return"?"+t[0];default:return"?"+t.join("&")}}(this._queryParams)),this._queryParamsString}}]),e}(),zt=n("Ed8q");function Ut(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Bt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ut(Object(n),!0).forEach((function(t){Object(a.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ut(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Vt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var i=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Ft=[0],Gt={getPointColor:{type:"accessor",value:[0,0,0,255]},pointSize:1,data:null,loader:zt.a,onTilesetLoad:{type:"function",value:function(e){},compare:!1},onTileLoad:{type:"function",value:function(e){},compare:!1},onTileUnload:{type:"function",value:function(e){},compare:!1},onTileError:{type:"function",value:function(e,t,n){},compare:!1}},qt=function(e){Object(u.a)(r,e);var t,n=Vt(r);function r(){return Object(s.a)(this,r),n.apply(this,arguments)}return Object(c.a)(r,[{key:"initializeState",value:function(){"onTileLoadFail"in this.props&&E.a.removed("onTileLoadFail","onTileError")(),this.state={layerMap:{},tileset3d:null}}},{key:"shouldUpdateState",value:function(e){return e.changeFlags.somethingChanged}},{key:"updateState",value:function(e){var t=e.props,n=e.oldProps,r=e.changeFlags;if(t.data&&t.data!==n.data&&this._loadTileset(t.data),r.viewportChanged){var i=this.state.tileset3d;this._updateTileset(i)}if(r.propsChanged){var a=this.state.layerMap;for(var o in a)a[o].needsUpdate=!0}}},{key:"getPickingInfo",value:function(e){var t=e.info,n=e.sourceLayer,r=this.state.layerMap,i=n&&n.id;if(i){var a=i.substring(this.id.length+1),o=a.substring(a.indexOf("-")+1);t.object=r[o]&&r[o].tile}return t}},{key:"_loadTileset",value:(t=Object(o.a)(i.a.mark((function e(t){var n,r,a,o,s,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.props.loadOptions,r=this.props.loader||this.props.loaders,Array.isArray(r)&&(r=r[0]),a=Bt({},n),!r.preload){e.next=9;break}return e.next=7,r.preload(t,n);case 7:o=e.sent,Object.assign(a,o);case 9:return e.next=11,Object(Ce.a)(t,r,a);case 11:s=e.sent,c=new Dt(s,Bt({onTileLoad:this._onTileLoad.bind(this),onTileUnload:this._onTileUnload.bind(this),onTileLoadFail:this.props.onTileError},a)),this.setState({tileset3d:c,layerMap:{}}),this._updateTileset(c),this.props.onTilesetLoad(c);case 16:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"_onTileLoad",value:function(e){this.props.onTileLoad(e),this._updateTileset(this.state.tileset3d),this.setNeedsUpdate()}},{key:"_onTileUnload",value:function(e){delete this.state.layerMap[e.id],this.props.onTileUnload(e)}},{key:"_updateTileset",value:function(e){var t=this.context,n=t.timeline,r=t.viewport;if(n&&r&&e){var i=e.update(r);this.state.frameNumber!==i&&this.setState({frameNumber:i})}}},{key:"_getSubLayer",value:function(e,t){if(!e.content)return null;switch(e.type){case Xe.f.POINTCLOUD:return this._makePointCloudLayer(e,t);case Xe.f.SCENEGRAPH:return this._make3DModelLayer(e,t);case Xe.f.MESH:return this._makeSimpleMeshLayer(e,t);default:throw new Error("Tile3DLayer: Failed to render layer of type ".concat(e.content.type))}}},{key:"_makePointCloudLayer",value:function(e,t){var n=e.content,r=n.attributes,i=n.pointCount,a=n.constantRGBA,o=n.cartographicOrigin,s=n.modelMatrix,c=r.positions,u=r.normals,l=r.colors;if(!c)return null;var h=t&&t.props.data||{header:{vertexCount:i},attributes:{POSITION:c,NORMAL:u,COLOR_0:l}},f=this.props,d=f.pointSize,v=f.getPointColor;return new(this.getSubLayerClass("pointcloud",j.a))({pointSize:d},this.getSubLayerProps({id:"pointcloud"}),{id:"".concat(this.id,"-pointcloud-").concat(e.id),data:h,coordinateSystem:p.a.METER_OFFSETS,coordinateOrigin:o,modelMatrix:s,getColor:a||v})}},{key:"_make3DModelLayer",value:function(e){var t=e.content,n=t.gltf,r=t.instances,i=t.cartographicOrigin,a=t.modelMatrix;return new(this.getSubLayerClass("scenegraph",Ee))({_lighting:"pbr"},this.getSubLayerProps({id:"scenegraph"}),{id:"".concat(this.id,"-scenegraph-").concat(e.id),data:r||Ft,scenegraph:n,coordinateSystem:p.a.METER_OFFSETS,coordinateOrigin:i,modelMatrix:a,getTransformMatrix:function(e){return e.modelMatrix},getPosition:[0,0,0]})}},{key:"_makeSimpleMeshLayer",value:function(e,t){var n=e.content,r=n.attributes,i=n.modelMatrix,a=n.cartographicOrigin,o=n.texture,s=r.positions,c=r.normals,u=r.texCoords,l=t&&t.props.mesh||new f.a({drawMode:4,attributes:{positions:Bt(Bt({},s),{},{value:new Float32Array(s.value)}),normals:c,texCoords:u}});return new(this.getSubLayerClass("mesh",Re))(this.getSubLayerProps({id:"mesh"}),{id:"".concat(this.id,"-mesh-").concat(e.id),mesh:l,data:Ft,getPosition:[0,0,0],getColor:[255,255,255],texture:o,modelMatrix:i,coordinateOrigin:a,coordinateSystem:p.a.METER_OFFSETS})}},{key:"renderLayers",value:function(){var e=this,t=this.state,n=t.tileset3d,r=t.layerMap;return n?n.tiles.map((function(t){var n=r[t.id]=r[t.id]||{tile:t},i=n.layer;return t.selected?i?n.needsUpdate?(i=e._getSubLayer(t,i),n.needsUpdate=!1):i.props.visible||(i=i.clone({visible:!0})):i=e._getSubLayer(t):i&&i.props.visible&&(i=i.clone({visible:!1})),n.layer=i,i})).filter(Boolean):null}},{key:"isLoaded",get:function(){var e=this.state.tileset3d;return e&&e.isLoaded()}}]),r}(O);qt.layerName="Tile3DLayer",qt.defaultProps=Gt},GA6j:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var r=n("1OyB"),i=n("vuIU"),a=n("Ji7U"),o=n("md7G"),s=n("foSv"),c=n("fxzv"),u=n("+H0l"),l=n("sSh/"),h=n("HwUG"),f=n("ZxFD"),p=n("n+fv");function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var i=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var v=Object.freeze([1,0,0,0,1,0,0,0,1]),m=Object.freeze([0,0,0,0,0,0,0,0,0]),g=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL1ROW0:3,COL1ROW1:4,COL1ROW2:5,COL2ROW0:6,COL2ROW1:7,COL2ROW2:8}),b={},y=function(e){Object(a.a)(n,e);var t=d(n);function n(e){var i;return Object(r.a)(this,n),i=t.call(this,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(e)?i.copy(e):i.identity(),i}return Object(i.a)(n,[{key:"ELEMENTS",get:function(){return 9}},{key:"RANK",get:function(){return 3}},{key:"INDICES",get:function(){return g}}],[{key:"IDENTITY",get:function(){return b.IDENTITY=b.IDENTITY||Object.freeze(new n(v)),b.IDENTITY}},{key:"ZERO",get:function(){return b.ZERO=b.ZERO||Object.freeze(new n(m)),b.ZERO}}]),Object(i.a)(n,[{key:"copy",value:function(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this.check()}},{key:"set",value:function(e,t,n,r,i,a,o,s,c){return this[0]=e,this[1]=t,this[2]=n,this[3]=r,this[4]=i,this[5]=a,this[6]=o,this[7]=s,this[8]=c,this.check()}},{key:"setRowMajor",value:function(e,t,n,r,i,a,o,s,c){return this[0]=e,this[1]=r,this[2]=o,this[3]=t,this[4]=i,this[5]=s,this[6]=n,this[7]=a,this[8]=c,this.check()}},{key:"determinant",value:function(){return h.b(this)}},{key:"identity",value:function(){return this.copy(v)}},{key:"fromQuaternion",value:function(e){return h.c(this,e),this.check()}},{key:"transpose",value:function(){return h.i(this,this),this.check()}},{key:"invert",value:function(){return h.d(this,this),this.check()}},{key:"multiplyLeft",value:function(e){return h.e(this,e,this),this.check()}},{key:"multiplyRight",value:function(e){return h.e(this,this,e),this.check()}},{key:"rotate",value:function(e){return h.f(this,this,e),this.check()}},{key:"scale",value:function(e){return Array.isArray(e)?h.g(this,this,e):h.g(this,this,[e,e,e]),this.check()}},{key:"translate",value:function(e){return h.h(this,this,e),this.check()}},{key:"transform",value:function(e,t){switch(e.length){case 2:t=f.i(t||[-0,-0],e,this);break;case 3:t=p.n(t||[-0,-0,-0],e,this);break;case 4:t=Object(l.d)(t||[-0,-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Object(u.b)(t,e.length),t}},{key:"transformVector",value:function(e,t){return Object(u.c)("Matrix3.transformVector"),this.transform(e,t)}},{key:"transformVector2",value:function(e,t){return Object(u.c)("Matrix3.transformVector"),this.transform(e,t)}},{key:"transformVector3",value:function(e,t){return Object(u.c)("Matrix3.transformVector"),this.transform(e,t)}}]),n}(c.a)},HwUG:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"i",(function(){return a})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"h",(function(){return u})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return h})),n.d(t,"c",(function(){return f}));n("mbBF");var r=n("yU0y");function i(){var e=new r.a(9);return r.a!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function a(e,t){if(e===t){var n=t[1],r=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=r,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function o(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],c=t[6],u=t[7],l=t[8],h=l*o-s*u,f=-l*a+s*c,p=u*a-o*c,d=n*h+r*f+i*p;return d?(d=1/d,e[0]=h*d,e[1]=(-l*r+i*u)*d,e[2]=(s*r-i*o)*d,e[3]=f*d,e[4]=(l*n-i*c)*d,e[5]=(-s*n+i*a)*d,e[6]=p*d,e[7]=(-u*n+r*c)*d,e[8]=(o*n-r*a)*d,e):null}function s(e){var t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],c=e[7],u=e[8];return t*(u*a-o*c)+n*(-u*i+o*s)+r*(c*i-a*s)}function c(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3],s=t[4],c=t[5],u=t[6],l=t[7],h=t[8],f=n[0],p=n[1],d=n[2],v=n[3],m=n[4],g=n[5],b=n[6],y=n[7],_=n[8];return e[0]=f*r+p*o+d*u,e[1]=f*i+p*s+d*l,e[2]=f*a+p*c+d*h,e[3]=v*r+m*o+g*u,e[4]=v*i+m*s+g*l,e[5]=v*a+m*c+g*h,e[6]=b*r+y*o+_*u,e[7]=b*i+y*s+_*l,e[8]=b*a+y*c+_*h,e}function u(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3],s=t[4],c=t[5],u=t[6],l=t[7],h=t[8],f=n[0],p=n[1];return e[0]=r,e[1]=i,e[2]=a,e[3]=o,e[4]=s,e[5]=c,e[6]=f*r+p*o+u,e[7]=f*i+p*s+l,e[8]=f*a+p*c+h,e}function l(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3],s=t[4],c=t[5],u=t[6],l=t[7],h=t[8],f=Math.sin(n),p=Math.cos(n);return e[0]=p*r+f*o,e[1]=p*i+f*s,e[2]=p*a+f*c,e[3]=p*o-f*r,e[4]=p*s-f*i,e[5]=p*c-f*a,e[6]=u,e[7]=l,e[8]=h,e}function h(e,t,n){var r=n[0],i=n[1];return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function f(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=n+n,s=r+r,c=i+i,u=n*o,l=r*o,h=r*s,f=i*o,p=i*s,d=i*c,v=a*o,m=a*s,g=a*c;return e[0]=1-h-d,e[3]=l-g,e[6]=f+m,e[1]=l+g,e[4]=1-u-d,e[7]=p-v,e[2]=f-m,e[5]=p+v,e[8]=1-u-h,e}},J4mz:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n("1OyB"),i=n("vuIU"),a=1048576,o=1024*a;function s(e){var t,n,r;return e<1?(t=1e3*e,n="s",r=0):e<1e3?(t=e,n="ms",r=2):(t=e/1e3,n="s",r=2),"".concat(t.toFixed(r)).concat(n)}var c=n("laie"),u={position:"fixed",zIndex:1e4,color:"#ccc",background:"#000",fontFamily:"Helvetica,Arial,sans-serif",padding:"8px",fontSize:"12px",lineSpacing:6},l={fontSize:"16px"},h={paddingLeft:"8px"},f={count:function(e){return"".concat(e.name,": ").concat(e.count)},averageTime:function(e){return"".concat(e.name,": ").concat(s(e.getAverageTime()))},totalTime:function(e){return"".concat(e.name,": ").concat(s(e.time))},fps:function(e){return"".concat(e.name,": ").concat(Math.round(e.getHz()),"fps")},memory:function(e){return"".concat(e.name,": ").concat(((t=e.count)<1024?(n=t,r=" bytes",i=0):t<a?(n=t/1024,r="kB",i=2):t<o?(n=t/a,r="MB",i=2):(n=t/o,r="GB",i=2),"".concat(n.toFixed(i)).concat(r)));var t,n,r,i}},p=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(r.a)(this,e),this.stats=t,this.title=n.title,this._framesPerUpdate=Math.round(Math.max(n.framesPerUpdate||1,1)),this._formatters=f,this._resetOnUpdate={},this._counter=0,this._initializeFormatters(n),this._initializeUpdateConfigs(n),this._css=Object.assign({},u,n.css),this._headerCSS=Object.assign({},l,this._css.header),this._itemCSS=Object.assign({},h,this._css.item),delete this._css.header,delete this._css.item,this._container=null,this._header=null,this._items={},this._createDOM(n.container),this._createDOMHeader(),this._createDOMStats()}return Object(i.a)(e,[{key:"setStats",value:function(e){this.stats=e,this._createDOMStats(this._container),this._setHeaderContent(e.id),this.update()}},{key:"update",value:function(){var e=this.stats&&this.stats.stats;e&&0!==Object.keys(e).length&&this._counter++%this._framesPerUpdate==0&&this._update()}},{key:"_update",value:function(){var e=this;this.stats.forEach((function(t){e._createDOMItem(t.name),e._items[t.name].innerHTML=e._getLines(t).join("<BR>"),e._resetOnUpdate[t.name]&&t.reset()}))}},{key:"_initializeFormatters",value:function(e){if(e.formatters)for(var t in e.formatters){var n=e.formatters[t];"string"==typeof n&&(n=f[n]),this._formatters[t]=n}}},{key:"_initializeUpdateConfigs",value:function(e){if(e.resetOnUpdate)for(var t in e.resetOnUpdate)this._resetOnUpdate[t]=e.resetOnUpdate[t]}},{key:"_createDOM",value:function(e){if("undefined"!=typeof document&&document&&(this._container=e,!this._container)){for(var t in this._container=document.createElement("div"),this._css)this._container.style[t]=this._css[t];document.body.appendChild(this._container)}}},{key:"_createDOMHeader",value:function(){if(!this._header){for(var e in this._header=document.createElement("div"),this._headerCSS)this._header.style[e]=this._headerCSS[e];this._container.appendChild(this._header)}this._setHeaderContent()}},{key:"_setHeaderContent",value:function(e){this._header&&(this._header.innerText=e||this.title||this.stats&&this.stats.id||"")}},{key:"_createDOMStats",value:function(){var e=this;this.stats instanceof c.b&&this.stats.forEach((function(t){e._createDOMItem(t.name)}))}},{key:"_createDOMItem",value:function(e){if(this._container&&!this._items[e]){for(var t in this._items[e]=document.createElement("div"),this._itemCSS)this._items[e].style[t]=this._itemCSS[t];this._container.appendChild(this._items[e])}}},{key:"_getLines",value:function(e){return(this._formatters[e.name]||this._formatters[e.type]||f.count)(this.stats.get(e.name)).split("\n")}}]),e}()},Ns70:function(e,t,n){"use strict";n.d(t,"a",(function(){return N}));var r=n("ODXe"),i=n("1OyB"),a=n("vuIU"),o=n("zXfU"),s=n("tS8E"),c=n("gOKY"),u=n("Nw31"),l=n("a3TU"),h=n("n+fv"),f=(Math.max(6378137,6378137,6356752.314245179),function(e){return e}),p=new o.a;function d(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:f;return Object(l.f)(e)?(t[0]=n(e[0]),t[1]=n(e[1]),t[2]=e[2]):"longitude"in e?(t[0]=n(e.longitude),t[1]=n(e.latitude),t[2]=e.height):(t[0]=n(e.x),t[1]=n(e.y),t[2]=e.z),t}function v(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p;return d(e,t,l.b._cartographicRadians?f:l.i)}function m(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:f;return Object(l.f)(t)?(t[0]=n(e[0]),t[1]=n(e[1]),t[2]=e[2]):"longitude"in t?(t.longitude=n(e[0]),t.latitude=n(e[1]),t.height=e[2]):(t.x=n(e[0]),t.y=n(e[1]),t.z=e[2]),t}function g(e,t){return m(e,t,l.b._cartographicRadians?f:l.h)}var b=new o.a,y=new o.a,_=new o.a;var O=new o.a,j={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}},w={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]},S={east:new o.a,north:new o.a,up:new o.a,west:new o.a,south:new o.a,down:new o.a},T=new o.a,E=new o.a,x=new o.a;function P(e,t,n,r,i,a){var o,c,u,h=j[t]&&j[t][n];Object(s.a)(h&&(!r||r===h));var f=O.copy(i);if(Object(l.d)(f.x,0,1e-14)&&Object(l.d)(f.y,0,1e-14)){var p=Math.sign(f.z);o=T.fromArray(w[t]),"east"!==t&&"west"!==t&&o.scale(p),c=E.fromArray(w[n]),"east"!==n&&"west"!==n&&c.scale(p),u=x.fromArray(w[r]),"east"!==r&&"west"!==r&&u.scale(p)}else{var d=S.up,v=S.east,m=S.north;v.set(-f.y,f.x,0).normalize(),e.geodeticSurfaceNormal(f,d),m.copy(d).cross(v);var g=S.west,b=S.south;S.down.copy(d).scale(-1),g.copy(v).scale(-1),b.copy(m).scale(-1),o=S[t],c=S[n],u=S[r]}return a[0]=o.x,a[1]=o.y,a[2]=o.z,a[3]=0,a[4]=c.x,a[5]=c.y,a[6]=c.z,a[7]=0,a[8]=u.x,a[9]=u.y,a[10]=u.z,a[11]=0,a[12]=f.x,a[13]=f.y,a[14]=f.z,a[15]=1,a}var M,A=new o.a,k=new o.a,R=new o.a,C=new o.a,I=new o.a,L=new o.a,N=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;Object(i.a)(this,e),Object(s.a)(t>=0),Object(s.a)(n>=0),Object(s.a)(r>=0),this.radii=new o.a(t,n,r),this.radiiSquared=new o.a(t*t,n*n,r*r),this.radiiToTheFourth=new o.a(t*t*t*t,n*n*n*n,r*r*r*r),this.oneOverRadii=new o.a(0===t?0:1/t,0===n?0:1/n,0===r?0:1/r),this.oneOverRadiiSquared=new o.a(0===t?0:1/(t*t),0===n?0:1/(n*n),0===r?0:1/(r*r)),this.minimumRadius=Math.min(t,n,r),this.maximumRadius=Math.max(t,n,r),this.centerToleranceSquared=c.a.EPSILON1,0!==this.radiiSquared.z&&(this.squaredXOverSquaredZ=this.radiiSquared.x/this.radiiSquared.z),Object.freeze(this)}return Object(a.a)(e,null,[{key:"WGS84",get:function(){return M=M||new e(6378137,6378137,6356752.314245179)}}]),Object(a.a)(e,[{key:"equals",value:function(e){return this===e||Boolean(e&&this.radii.equals(e.radii))}},{key:"toString",value:function(){return this.radii.toString()}},{key:"cartographicToCartesian",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],n=k,i=R,a=Object(r.a)(e,3),o=a[2];this.geodeticSurfaceNormalCartographic(e,n),i.copy(this.radiiSquared).scale(n);var s=Math.sqrt(n.dot(i));return i.scale(1/s),n.scale(o),i.add(n),i.to(t)}},{key:"cartesianToCartographic",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];L.from(e);var n=this.scaleToGeodeticSurface(L,C);if(n){var r=this.geodeticSurfaceNormal(n,k),i=I;i.copy(L).subtract(n);var a=Math.atan2(r.y,r.x),o=Math.asin(r.z),s=Math.sign(h.d(i,L))*h.g(i);return g([a,o,s],t)}}},{key:"eastNorthUpToFixedFrame",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new u.a;return P(this,"east","north","up",e,t)}},{key:"localFrameToFixedFrame",value:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new u.a;return P(this,e,t,n,r,i)}},{key:"geocentricSurfaceNormal",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return A.from(e).normalize().to(t)}},{key:"geodeticSurfaceNormalCartographic",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],n=v(e),r=n[0],i=n[1],a=Math.cos(i);return A.set(a*Math.cos(r),a*Math.sin(r),Math.sin(i)).normalize(),A.to(t)}},{key:"geodeticSurfaceNormal",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return A.from(e).scale(this.oneOverRadiiSquared).normalize().to(t)}},{key:"scaleToGeodeticSurface",value:function(e,t){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new o.a,r=t.oneOverRadii,i=t.oneOverRadiiSquared,a=t.centerToleranceSquared;b.from(e);var s=e.x,u=e.y,l=e.z,h=r.x,f=r.y,p=r.z,d=s*s*h*h,v=u*u*f*f,m=l*l*p*p,g=d+v+m,O=Math.sqrt(1/g);if(Number.isFinite(O)){var j=y;if(j.copy(e).scale(O),g<a)return j.to(n);var w=i.x,S=i.y,T=i.z,E=_;E.set(j.x*w*2,j.y*S*2,j.z*T*2);var x,P,M,A,k=(1-O)*e.len()/(.5*E.len()),R=0;do{var C=(x=1/(1+(k-=R)*w))*x,I=(P=1/(1+k*S))*P,L=(M=1/(1+k*T))*M,N=C*x,D=I*P,z=L*M,U=d*N*w+v*D*S+m*z*T,B=-2*U;R=(A=d*C+v*I+m*L-1)/B}while(Math.abs(A)>c.a.EPSILON12);return b.scale([x,P,M]).to(n)}}(e,this,t)}},{key:"scaleToGeocentricSurface",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];C.from(e);var n=C.x,r=C.y,i=C.z,a=this.oneOverRadiiSquared,o=1/Math.sqrt(n*n*a.x+r*r*a.y+i*i*a.z);return C.multiplyScalar(o).to(t)}},{key:"transformPositionToScaledSpace",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return C.from(e).scale(this.oneOverRadii).to(t)}},{key:"transformPositionFromScaledSpace",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return C.from(e).scale(this.radii).to(t)}},{key:"getSurfaceNormalIntersectionWithZAxis",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0,0];Object(s.a)(Object(l.d)(this.radii.x,this.radii.y,c.a.EPSILON15)),Object(s.a)(this.radii.z>0),C.from(e);var r=C.z*(1-this.squaredXOverSquaredZ);if(!(Math.abs(r)>=this.radii.z-t))return C.set(0,0,r).to(n)}}]),e}()},O6hP:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"e",(function(){return i})),n.d(t,"f",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c}));var r={UNLOADED:0,LOADING:1,PROCESSING:2,READY:3,EXPIRED:4,FAILED:5},i={ADD:1,REPLACE:2},a={EMPTY:"empty",SCENEGRAPH:"scenegraph",POINTCLOUD:"pointcloud",MESH:"mesh"},o={I3S:"I3S",TILES3D:"TILES3D"},s={GEOMETRIC_ERROR:"geometricError",MAX_SCREEN_THRESHOLD:"maxScreenThreshold"},c={NOT_COMPUTED:-1,USE_OPTIMIZATION:1,SKIP_OPTIMIZATION:0}},OyGM:function(e,t,n){"use strict";(function(e){function r(){var t;if("undefined"!=typeof window&&window.performance)t=window.performance.now();else if(void 0!==e&&e.hrtime){var n=e.hrtime();t=1e3*n[0]+n[1]/1e6}else t=Date.now();return t}n.d(t,"a",(function(){return r}))}).call(this,n("8oxB"))},UP1k:function(e,t,n){"use strict";function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}n.d(t,"a",(function(){return ze}));var i=n("1OyB"),a=n("JX7q"),o=n("vuIU"),s=n("Ji7U"),c=n("md7G"),u=n("foSv"),l=n("rePB"),h=n("q1tI"),f=n("17x9"),p=n.n(f);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,a=!0,o=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){o=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(o)throw i}}}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var b=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function y(e){if(!e)return null;if("string"==typeof e)return e;e.toJS&&(e=e.toJS());var t,n={},r=m(e.layers);try{for(r.s();!(t=r.n()).done;){var i=t.value;n[i.id]=i}}catch(o){r.e(o)}finally{r.f()}var a=e.layers.map((function(e){var t=n[e.ref],r=null;if("interactive"in e&&delete(r=v({},e)).interactive,t){delete(r=r||v({},e)).ref;var i,a=m(b);try{for(a.s();!(i=a.n()).done;){var s=i.value;s in t&&(r[s]=t[s])}}catch(o){a.e(o)}finally{a.f()}}return r||e}));return v(v({},e),{},{layers:a})}var _=n("KQm4"),O=n("ODXe"),j=n("bl9R");function w(e,t){var n=j.n([],t,e);return j.k(n,n,1/n[3]),n}function S(e,t){var n=e%t;return n<0?t+n:n}function T(e,t,n){return n*t+(1-n)*e}var E=n("ZaHm"),x=n("ZxFD"),P=n("n+fv");function M(e,t){if(!e)throw new Error(t||"@math.gl/web-mercator: assertion failed.")}var A=Math.PI,k=A/4,R=A/180,C=180/A;function I(e){return Math.pow(2,e)}function L(e){return Math.log2(e)}function N(e){var t=Object(O.a)(e,2),n=t[0],r=t[1];M(Number.isFinite(n)),M(Number.isFinite(r)&&r>=-90&&r<=90,"invalid latitude");var i=r*R;return[512*(n*R+A)/(2*A),512*(A+Math.log(Math.tan(k+.5*i)))/(2*A)]}function D(e){var t=Object(O.a)(e,2),n=t[0],r=t[1],i=n/512*(2*A)-A,a=2*(Math.atan(Math.exp(r/512*(2*A)-A))-k);return[i*C,a*C]}function z(e){var t=e.latitude,n=e.longitude,r=e.highPrecision,i=void 0!==r&&r;M(Number.isFinite(t)&&Number.isFinite(n));var a={},o=Math.cos(t*R),s=512/360/o,c=512/4003e4/o;if(a.unitsPerMeter=[c,c,c],a.metersPerUnit=[1/c,1/c,1/c],a.unitsPerDegree=[512/360,s,c],a.degreesPerUnit=[.703125,1/s,1/c],i){var u=R*Math.tan(t*R)/o,l=512/360*u/2,h=512/4003e4*u,f=h/s*c;a.unitsPerDegree2=[0,l,h],a.unitsPerMeter2=[f,0,f]}return a}function U(e){var t=e.height,n=e.pitch,r=e.bearing,i=e.altitude,a=e.scale,o=e.center,s=void 0===o?null:o,c=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return E.p(c,c,[0,0,-i]),E.l(c,c,-n*R),E.n(c,c,r*R),a/=t,E.o(c,c,[a,a,a]),s&&E.p(c,c,P.h([],s)),c}function B(e){var t=e.width,n=e.height,r=e.pitch,i=function(e){var t=e.width,n=e.height,r=e.altitude,i=void 0===r?1.5:r,a=e.pitch,o=void 0===a?0:a,s=e.nearZMultiplier,c=void 0===s?1:s,u=e.farZMultiplier,l=void 0===u?1:u,h=o*R,f=Math.atan(.5/i),p=Math.sin(f)*i/Math.sin(Math.min(Math.max(Math.PI/2-h-f,.01),Math.PI-.01));return{fov:2*f,aspect:t/n,focalDistance:i,near:c,far:(Math.sin(h)*p+i)*l}}({width:t,height:n,altitude:e.altitude,pitch:r,nearZMultiplier:e.nearZMultiplier,farZMultiplier:e.farZMultiplier}),a=i.fov,o=i.aspect,s=i.near,c=i.far;return E.j([],a,o,s,c)}function V(e,t){var n=Object(O.a)(e,3),r=n[0],i=n[1],a=n[2],o=void 0===a?0:a;return M(Number.isFinite(r)&&Number.isFinite(i)&&Number.isFinite(o)),w(t,[r,i,o,1])}function F(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=Object(O.a)(e,3),i=r[0],a=r[1],o=r[2];if(M(Number.isFinite(i)&&Number.isFinite(a),"invalid pixel coordinate"),Number.isFinite(o)){var s=w(t,[i,a,o,1]);return s}var c=w(t,[i,a,0,1]),u=w(t,[i,a,1,1]),l=c[2],h=u[2],f=l===h?0:((n||0)-l)/(h-l);return x.c([],c,u,f)}function G(e){var t=e.width,n=e.height,r=e.bounds,i=e.minExtent,a=void 0===i?0:i,o=e.maxZoom,s=void 0===o?24:o,c=e.padding,u=void 0===c?0:c,l=e.offset,h=void 0===l?[0,0]:l,f=Object(O.a)(r,2),p=Object(O.a)(f[0],2),d=p[0],v=p[1],m=Object(O.a)(f[1],2),g=m[0],b=m[1];if(Number.isFinite(u)){u={top:u,bottom:u,left:u,right:u}}else M(Number.isFinite(u.top)&&Number.isFinite(u.bottom)&&Number.isFinite(u.left)&&Number.isFinite(u.right));var y=new W({width:t,height:n,longitude:0,latitude:0,zoom:0}),_=y.project([d,b]),j=y.project([g,v]),w=[Math.max(Math.abs(j[0]-_[0]),a),Math.max(Math.abs(j[1]-_[1]),a)],S=[t-u.left-u.right-2*Math.abs(h[0]),n-u.top-u.bottom-2*Math.abs(h[1])];M(S[0]>0&&S[1]>0);var T=S[0]/w[0],E=S[1]/w[1],x=(u.right-u.left)/2/T,P=(u.bottom-u.top)/2/E,A=[(j[0]+_[0])/2+x,(j[1]+_[1])/2+P],k=y.unproject(A),R=Math.min(s,y.zoom+Math.log2(Math.abs(Math.min(T,E))));return M(Number.isFinite(R)),{longitude:k[0],latitude:k[1],zoom:R}}var q=Math.PI/180;function H(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=e.width,a=e.height,o=e.unproject,s={targetZ:r},c=o([0,a],s),u=o([i,a],s),l=Math.atan(.5/e.altitude),h=(90-e.pitch)*q;return l>h-.01?(t=Z(e,0,r),n=Z(e,i,r)):(t=o([0,0],s),n=o([i,0],s)),[c,u,n,t]}function Z(e,t,n){var r=e.pixelUnprojectionMatrix,i=w(r,[t,0,1,1]),a=w(r,[t,e.height,1,1]),o=(n*e.distanceScales.unitsPerMeter[2]-i[2])/(a[2]-i[2]),s=D(x.c([],i,a,o));return s[2]=n,s}var W=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{width:1,height:1},n=t.width,r=t.height,a=t.latitude,o=void 0===a?0:a,s=t.longitude,c=void 0===s?0:s,u=t.zoom,l=void 0===u?0:u,h=t.pitch,f=void 0===h?0:h,p=t.bearing,d=void 0===p?0:p,v=t.altitude,m=void 0===v?1.5:v,g=t.nearZMultiplier,b=void 0===g?.02:g,y=t.farZMultiplier,_=void 0===y?1.01:y;Object(i.a)(this,e),n=n||1,r=r||1;var O=I(l);m=Math.max(.75,m);var j=N([c,o]);j[2]=0,this.projectionMatrix=B({width:n,height:r,pitch:f,altitude:m,nearZMultiplier:b,farZMultiplier:_}),this.viewMatrix=U({height:r,scale:O,center:j,pitch:f,bearing:d,altitude:m}),this.width=n,this.height=r,this.scale=O,this.latitude=o,this.longitude=c,this.zoom=l,this.pitch=f,this.bearing=d,this.altitude=m,this.center=j,this.distanceScales=z(this),this._initMatrices(),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),Object.freeze(this)}return Object(o.a)(e,[{key:"_initMatrices",value:function(){var e=this.width,t=this.height,n=this.projectionMatrix,r=this.viewMatrix,i=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];E.h(i,i,n),E.h(i,i,r),this.viewProjectionMatrix=i;var a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];E.o(a,a,[e/2,-t/2,1]),E.p(a,a,[1,-1,0]),E.h(a,a,i);var o=E.f([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],a);if(!o)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=a,this.pixelUnprojectionMatrix=o}},{key:"equals",value:function(t){return t instanceof e&&(t.width===this.width&&t.height===this.height&&E.b(t.projectionMatrix,this.projectionMatrix)&&E.b(t.viewMatrix,this.viewMatrix))}},{key:"project",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.topLeft,r=void 0===n||n,i=this.projectPosition(e),a=V(i,this.pixelProjectionMatrix),o=Object(O.a)(a,2),s=o[0],c=o[1],u=r?c:this.height-c;return 2===e.length?[s,u]:[s,u,a[2]]}},{key:"unproject",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.topLeft,r=void 0===n||n,i=t.targetZ,a=void 0===i?void 0:i,o=Object(O.a)(e,3),s=o[0],c=o[1],u=o[2],l=r?c:this.height-c,h=a&&a*this.distanceScales.unitsPerMeter[2],f=F([s,l,u],this.pixelUnprojectionMatrix,h),p=this.unprojectPosition(f),d=Object(O.a)(p,3),v=d[0],m=d[1],g=d[2];return Number.isFinite(u)?[v,m,g]:Number.isFinite(a)?[v,m,a]:[v,m]}},{key:"projectPosition",value:function(e){var t=N(e),n=Object(O.a)(t,2);return[n[0],n[1],(e[2]||0)*this.distanceScales.unitsPerMeter[2]]}},{key:"unprojectPosition",value:function(e){var t=D(e),n=Object(O.a)(t,2);return[n[0],n[1],(e[2]||0)*this.distanceScales.metersPerUnit[2]]}},{key:"projectFlat",value:function(e){return N(e)}},{key:"unprojectFlat",value:function(e){return D(e)}},{key:"getMapCenterByLngLatPosition",value:function(e){var t=e.lngLat,n=F(e.pos,this.pixelUnprojectionMatrix),r=N(t),i=x.a([],r,x.d([],n));return D(x.a([],this.center,i))}},{key:"getLocationAtPoint",value:function(e){var t=e.lngLat,n=e.pos;return this.getMapCenterByLngLatPosition({lngLat:t,pos:n})}},{key:"fitBounds",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.width,i=this.height,a=G(Object.assign({width:r,height:i,bounds:t},n)),o=a.longitude,s=a.latitude,c=a.zoom;return new e({width:r,height:i,longitude:o,latitude:s,zoom:c})}},{key:"getBounds",value:function(e){var t=this.getBoundingRegion(e),n=Math.min.apply(Math,Object(_.a)(t.map((function(e){return e[0]})))),r=Math.max.apply(Math,Object(_.a)(t.map((function(e){return e[0]}))));return[[n,Math.min.apply(Math,Object(_.a)(t.map((function(e){return e[1]}))))],[r,Math.max.apply(Math,Object(_.a)(t.map((function(e){return e[1]}))))]]}},{key:"getBoundingRegion",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return H(this,e.z||0)}}]),e}();var K=["longitude","latitude","zoom"],X={curve:1.414,speed:1.2};function Y(e,t,n){var r=(n=Object.assign({},X,n)).curve,i=e.zoom,a=[e.longitude,e.latitude],o=I(i),s=t.zoom,c=[t.longitude,t.latitude],u=I(s-i),l=N(a),h=N(c),f=x.f([],h,l),p=Math.max(e.width,e.height),d=p/u,v=x.b(f)*o,m=Math.max(v,.01),g=r*r,b=(d*d-p*p+g*g*m*m)/(2*p*g*m),y=(d*d-p*p-g*g*m*m)/(2*d*g*m),_=Math.log(Math.sqrt(b*b+1)-b),O=Math.log(Math.sqrt(y*y+1)-y);return{startZoom:i,startCenterXY:l,uDelta:f,w0:p,u1:v,S:(O-_)/r,rho:r,rho2:g,r0:_,r1:O}}var Q=n("jYz7"),J=n("6pOq"),$=n("4ZJM"),ee=n.n($);function te(e){return Array.isArray(e)||ArrayBuffer.isView(e)}function ne(e,t){if(e===t)return!0;if(te(e)&&te(t)){if(e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(!ne(e[n],t[n]))return!1;return!0}return Math.abs(e-t)<=1e-7}function re(e,t,n){return Math.max(t,Math.min(n,e))}function ie(e,t,n){return te(e)?e.map((function(e,r){return ie(e,t[r],n)})):n*t+(1-n)*e}function ae(e,t){if(!e)throw new Error(t||"react-map-gl: assertion failed.")}function oe(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return se(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return se(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,a=!0,o=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){o=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(o)throw i}}}}function se(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ce=function(){function e(){Object(i.a)(this,e),Object(l.a)(this,"propNames",[])}return Object(o.a)(e,[{key:"arePropsEqual",value:function(e,t){var n,r=oe(this.propNames||[]);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!ne(e[i],t[i]))return!1}}catch(a){r.e(a)}finally{r.f()}return!0}},{key:"initializeProps",value:function(e,t){return{start:e,end:t}}},{key:"interpolateProps",value:function(e,t,n){ae(!1,"interpolateProps is not implemented")}},{key:"getDuration",value:function(e,t){return t.transitionDuration}}]),e}(),ue={longitude:1,bearing:1};function le(e){return Number.isFinite(e)||Array.isArray(e)}function he(e,t,n){return function(e){return e in ue}(e)&&Math.abs(n-t)>180&&(n=n<0?n+360:n-360),n}function fe(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return pe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return pe(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,a=!0,o=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){o=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(o)throw i}}}}function pe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function de(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var i=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var ve=["longitude","latitude","zoom","bearing","pitch"],me=["latitude","longitude","zoom","width","height"],ge=["bearing","pitch"],be={speed:1.2,curve:1.414};!function(e){Object(s.a)(n,e);var t=de(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i.a)(this,n),e=t.call(this),Object(l.a)(Object(a.a)(e),"speed",void 0),Object(l.a)(Object(a.a)(e),"propNames",ve),Object(l.a)(Object(a.a)(e),"props",void 0),e.props=Object.assign({},be,r),e}Object(o.a)(n,[{key:"initializeProps",value:function(e,t){var n,r={},i={},a=fe(me);try{for(a.s();!(n=a.n()).done;){var o=n.value,s=e[o],c=t[o];ae(le(s)&&le(c),"".concat(o," must be supplied for transition")),r[o]=s,i[o]=he(o,s,c)}}catch(d){a.e(d)}finally{a.f()}var u,l=fe(ge);try{for(l.s();!(u=l.n()).done;){var h=u.value,f=e[h]||0,p=t[h]||0;r[h]=f,i[h]=he(h,f,p)}}catch(d){l.e(d)}finally{l.f()}return{start:r,end:i}}},{key:"interpolateProps",value:function(e,t,n){var r,i=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i={},a=Y(e,t,r),o=a.startZoom,s=a.startCenterXY,c=a.uDelta,u=a.w0,l=a.u1,h=a.S,f=a.rho,p=a.rho2,d=a.r0;if(l<.01){var v=!0,m=!1,g=void 0;try{for(var b,y=K[Symbol.iterator]();!(v=(b=y.next()).done);v=!0){var _=b.value,O=e[_],j=t[_];i[_]=T(O,j,n)}}catch(R){m=!0,g=R}finally{try{v||null==y.return||y.return()}finally{if(m)throw g}}return i}var w=n*h,S=Math.cosh(d)/Math.cosh(d+f*w),E=u*((Math.cosh(d)*Math.tanh(d+f*w)-Math.sinh(d))/p)/l,P=1/S,M=o+L(P),A=x.e([],c,E);x.a(A,A,s);var k=D(A);return i.longitude=k[0],i.latitude=k[1],i.zoom=M,i}(e,t,n,this.props),a=fe(ge);try{for(a.s();!(r=a.n()).done;){var o=r.value;i[o]=ie(e[o],t[o],n)}}catch(s){a.e(s)}finally{a.f()}return i}},{key:"getDuration",value:function(e,t){var n=t.transitionDuration;return"auto"===n&&(n=function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=r=Object.assign({},X,r),a=i.screenSpeed,o=i.speed,s=i.maxDuration,c=Y(e,t,r),u=c.S,l=c.rho,h=1e3*u;return n=Number.isFinite(a)?h/(a/l):h/o,Number.isFinite(s)&&n>s?0:n}(e,t,this.props)),n}}])}(ce);function ye(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return _e(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _e(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,a=!0,o=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){o=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(o)throw i}}}}function _e(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Oe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var i=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var je=["longitude","latitude","zoom","bearing","pitch"],we=function(e){Object(s.a)(n,e);var t=Oe(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i.a)(this,n),e=t.call(this),Object(l.a)(Object(a.a)(e),"around",void 0),Array.isArray(r)&&(r={transitionProps:r}),e.propNames=r.transitionProps||je,r.around&&(e.around=r.around),e}return Object(o.a)(n,[{key:"initializeProps",value:function(e,t){var n={},r={};if(this.around){n.around=this.around;var i=new W(e).unproject(this.around);Object.assign(r,t,{around:new W(t).project(i),aroundLngLat:i})}var a,o=ye(this.propNames);try{for(o.s();!(a=o.n()).done;){var s=a.value,c=e[s],u=t[s];ae(le(c)&&le(u),"".concat(s," must be supplied for transition")),n[s]=c,r[s]=he(s,c,u)}}catch(l){o.e(l)}finally{o.f()}return{start:n,end:r}}},{key:"interpolateProps",value:function(e,t,n){var r,i={},a=ye(this.propNames);try{for(a.s();!(r=a.n()).done;){var o=r.value;i[o]=ie(e[o],t[o],n)}}catch(h){a.e(h)}finally{a.f()}if(t.around){var s=new W(Object.assign({},t,i)).getMapCenterByLngLatPosition({lngLat:t.aroundLngLat,pos:ie(e.around,t.around,n)}),c=Object(O.a)(s,2),u=c[0],l=c[1];i.longitude=u,i.latitude=l}return i}}]),n}(ce),Se={minZoom:0,maxZoom:24,minPitch:0,maxPitch:60},Te=0,Ee=0,xe=1.5,Pe=function(){function e(t){var n=t.width,r=t.height,a=t.latitude,o=t.longitude,s=t.zoom,c=t.bearing,u=void 0===c?Ee:c,h=t.pitch,f=void 0===h?Te:h,p=t.altitude,d=void 0===p?xe:p,v=t.maxZoom,m=void 0===v?Se.maxZoom:v,g=t.minZoom,b=void 0===g?Se.minZoom:g,y=t.maxPitch,_=void 0===y?Se.maxPitch:y,O=t.minPitch,j=void 0===O?Se.minPitch:O,w=t.transitionDuration,S=t.transitionEasing,T=t.transitionInterpolator,E=t.transitionInterruption,x=t.startPanLngLat,P=t.startZoomLngLat,M=t.startBearing,A=t.startPitch,k=t.startZoom;Object(i.a)(this,e),Object(l.a)(this,"_viewportProps",void 0),Object(l.a)(this,"_interactiveState",void 0),ae(Number.isFinite(n),"`width` must be supplied"),ae(Number.isFinite(r),"`height` must be supplied"),ae(Number.isFinite(o),"`longitude` must be supplied"),ae(Number.isFinite(a),"`latitude` must be supplied"),ae(Number.isFinite(s),"`zoom` must be supplied"),this._viewportProps=this._applyConstraints({width:n,height:r,latitude:a,longitude:o,zoom:s,bearing:u,pitch:f,altitude:d,maxZoom:m,minZoom:b,maxPitch:_,minPitch:j,transitionDuration:w,transitionEasing:S,transitionInterpolator:T,transitionInterruption:E}),this._interactiveState={startPanLngLat:x,startZoomLngLat:P,startBearing:M,startPitch:A,startZoom:k}}return Object(o.a)(e,[{key:"getViewportProps",value:function(){return this._viewportProps}},{key:"getInteractiveState",value:function(){return this._interactiveState}},{key:"panStart",value:function(e){var t=e.pos;return this._getUpdatedMapState({startPanLngLat:this._unproject(t)})}},{key:"pan",value:function(e){var t=e.pos,n=e.startPos,r=this._interactiveState.startPanLngLat||this._unproject(n);if(!r)return this;var i=this._calculateNewLngLat({startPanLngLat:r,pos:t}),a=Object(O.a)(i,2),o=a[0],s=a[1];return this._getUpdatedMapState({longitude:o,latitude:s})}},{key:"panEnd",value:function(){return this._getUpdatedMapState({startPanLngLat:null})}},{key:"rotateStart",value:function(e){e.pos;return this._getUpdatedMapState({startBearing:this._viewportProps.bearing,startPitch:this._viewportProps.pitch})}},{key:"rotate",value:function(e){var t=e.deltaScaleX,n=void 0===t?0:t,r=e.deltaScaleY,i=void 0===r?0:r,a=this._interactiveState,o=a.startBearing,s=a.startPitch;if(!Number.isFinite(o)||!Number.isFinite(s))return this;var c=this._calculateNewPitchAndBearing({deltaScaleX:n,deltaScaleY:i,startBearing:o||0,startPitch:s||0}),u=c.pitch,l=c.bearing;return this._getUpdatedMapState({bearing:l,pitch:u})}},{key:"rotateEnd",value:function(){return this._getUpdatedMapState({startBearing:null,startPitch:null})}},{key:"zoomStart",value:function(e){var t=e.pos;return this._getUpdatedMapState({startZoomLngLat:this._unproject(t),startZoom:this._viewportProps.zoom})}},{key:"zoom",value:function(e){var t=e.pos,n=e.startPos,r=e.scale;ae(r>0,"`scale` must be a positive number");var i=this._interactiveState,a=i.startZoom,o=i.startZoomLngLat;Number.isFinite(a)||(a=this._viewportProps.zoom,o=this._unproject(n)||this._unproject(t)),ae(o,"`startZoomLngLat` prop is required for zoom behavior to calculate where to position the map.");var s=this._calculateNewZoom({scale:r,startZoom:a||0}),c=new W(Object.assign({},this._viewportProps,{zoom:s})).getMapCenterByLngLatPosition({lngLat:o,pos:t}),u=Object(O.a)(c,2),l=u[0],h=u[1];return this._getUpdatedMapState({zoom:s,longitude:l,latitude:h})}},{key:"zoomEnd",value:function(){return this._getUpdatedMapState({startZoomLngLat:null,startZoom:null})}},{key:"_getUpdatedMapState",value:function(t){return new e(Object.assign({},this._viewportProps,this._interactiveState,t))}},{key:"_applyConstraints",value:function(e){var t=e.maxZoom,n=e.minZoom,r=e.zoom;e.zoom=re(r,n,t);var i=e.maxPitch,a=e.minPitch,o=e.pitch;return e.pitch=re(o,a,i),Object.assign(e,function(e){var t=e.width,n=e.height,r=e.longitude,i=e.latitude,a=e.zoom,o=e.pitch,s=void 0===o?0:o,c=e.bearing,u=void 0===c?0:c;(r<-180||r>180)&&(r=S(r+180,360)-180),(u<-180||u>180)&&(u=S(u+180,360)-180);var l=new W({width:t,height:n,longitude:r,latitude:i,zoom:a}),h=l.project([r,85.05113])[1],f=l.project([r,-85.05113])[1],p=0;return f-h<n&&(a+=Math.log2(n/(f-h)),h=(l=new W({width:t,height:n,longitude:r,latitude:i,zoom:a})).project([r,85.05113])[1],f=l.project([r,-85.05113])[1]),h>0?p=h:f<n&&(p=f-n),p&&(i=l.unproject([t/2,n/2+p])[1]),{width:t,height:n,longitude:r,latitude:i,zoom:a,pitch:s,bearing:u}}(e)),e}},{key:"_unproject",value:function(e){var t=new W(this._viewportProps);return e&&t.unproject(e)}},{key:"_calculateNewLngLat",value:function(e){var t=e.startPanLngLat,n=e.pos;return new W(this._viewportProps).getMapCenterByLngLatPosition({lngLat:t,pos:n})}},{key:"_calculateNewZoom",value:function(e){var t=e.scale,n=e.startZoom,r=this._viewportProps,i=r.maxZoom,a=r.minZoom;return re(n+Math.log2(t),a,i)}},{key:"_calculateNewPitchAndBearing",value:function(e){var t=e.deltaScaleX,n=e.deltaScaleY,r=e.startBearing,i=e.startPitch;n=re(n,-1,1);var a=this._viewportProps,o=a.minPitch,s=a.maxPitch,c=i;return n>0?c=i+n*(s-i):n<0&&(c=i-n*(o-i)),{pitch:c,bearing:r+180*t}}}]),e}();function Me(e){return e[0].toLowerCase()+e.slice(1)}var Ae=Object(h.createContext)({viewport:null,map:null,mapContainer:null,onViewportChange:null,onViewStateChange:null,eventManager:null,isDragging:!1});function ke(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ke(Object(n),!0).forEach((function(t){Object(l.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ke(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ce(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var i=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var Ie="A valid API access token is required to use Mapbox data";var Le={position:"absolute",width:"100%",height:"100%",overflow:"hidden"},Ne=Object.assign({},J.a.propTypes,{width:p.a.oneOfType([p.a.number,p.a.string]),height:p.a.oneOfType([p.a.number,p.a.string]),onResize:p.a.func,preventStyleDiffing:p.a.bool,disableTokenWarning:p.a.bool,visible:p.a.bool,className:p.a.string,style:p.a.object,visibilityConstraints:p.a.object}),De=Object.assign({},J.a.defaultProps,{preventStyleDiffing:!1,disableTokenWarning:!1,visible:!0,onResize:function(){},className:"",style:null,visibilityConstraints:Se}),ze=function(e){Object(s.a)(n,e);var t=Ce(n);function n(){var e;Object(i.a)(this,n);for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return e=t.call.apply(t,[this].concat(o)),Object(l.a)(Object(a.a)(e),"state",{accessTokenInvalid:!1}),Object(l.a)(Object(a.a)(e),"_mapbox",null),Object(l.a)(Object(a.a)(e),"_map",null),Object(l.a)(Object(a.a)(e),"_mapboxMapRef",Object(h.createRef)()),Object(l.a)(Object(a.a)(e),"_mapContainerRef",Object(h.createRef)()),Object(l.a)(Object(a.a)(e),"_queryParams",{}),Object(l.a)(Object(a.a)(e),"_width",0),Object(l.a)(Object(a.a)(e),"_height",0),Object(l.a)(Object(a.a)(e),"getMap",(function(){return e._map})),Object(l.a)(Object(a.a)(e),"queryRenderedFeatures",(function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e._map.queryRenderedFeatures(t,n)})),Object(l.a)(Object(a.a)(e),"_mapboxMapError",(function(t){401!==(t.error&&t.error.status||t.status)||e.state.accessTokenInvalid||(console.error(Ie),e.setState({accessTokenInvalid:!0})),e.props.onError(t)})),e}return Object(o.a)(n,[{key:"componentDidMount",value:function(){if(n.supported()){var e=this.props.mapStyle;this._mapbox=new J.a(Object.assign({},this.props,{mapboxgl:ee.a,width:this._width,height:this._height,container:this._mapboxMapRef.current,onError:this._mapboxMapError,mapStyle:y(e)})),this._map=this._mapbox.getMap()}}},{key:"componentDidUpdate",value:function(e){this._mapbox&&(this._updateMapStyle(e,this.props),this._updateMapProps(this.props))}},{key:"componentWillUnmount",value:function(){this._mapbox&&(this._mapbox.finalize(),this._mapbox=null,this._map=null)}},{key:"_updateMapSize",value:function(e,t){this._width===e&&this._height===t||(this._width=e,this._height=t,this._updateMapProps(this.props))}},{key:"_updateMapStyle",value:function(e,t){var n=t.mapStyle;n!==e.mapStyle&&n&&this._map.setStyle(y(n),{diff:!this.props.preventStyleDiffing})}},{key:"_updateMapProps",value:function(e){this._mapbox&&this._mapbox.setProps(Object.assign({},e,{width:this._width,height:this._height}))}},{key:"_renderNoTokenWarning",value:function(){if(this.state.accessTokenInvalid&&!this.props.disableTokenWarning){return h.createElement("div",{key:"warning",id:"no-token-warning",style:{position:"absolute",left:0,top:0}},h.createElement("h3",{key:"header"},"NO_TOKEN_WARNING"),h.createElement("div",{key:"text"},"For information on setting up your basemap, read"),h.createElement("a",{key:"link",href:"https://visgl.github.io/react-map-gl/docs/get-started/mapbox-tokens"},"Note on Map Tokens"))}return null}},{key:"_renderOverlays",value:function(e){var t=this,n=e.width,r=void 0===n?Number(this.props.width):n,i=e.height,a=void 0===i?Number(this.props.height):i;return this._updateMapSize(r,a),h.createElement(Ae.Consumer,null,(function(e){var n=Re(Re({},e),{},{viewport:new W(Re(Re(Re({},t.props),t.props.viewState),{},{width:r,height:a})),map:t._map,mapContainer:e.mapContainer||t._mapContainerRef.current});return h.createElement(Ae.Provider,{value:n},h.createElement("div",{key:"map-overlays",className:"overlays",style:Le},t.props.children))}))}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.width,r=e.height,i=e.style,a=e.visibilityConstraints,o=Object.assign({position:"relative"},i,{width:n,height:r}),s=this.props.visible&&function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Se;for(var n in t){var r=n.slice(0,3),i=Me(n.slice(3));if("min"===r&&e[i]<t[n])return!1;if("max"===r&&e[i]>t[n])return!1}return!0}(this.props.viewState||this.props,a),c=Object.assign({},Le,{visibility:s?"inherit":"hidden"});return h.createElement("div",{key:"map-container",style:o,ref:this._mapContainerRef},h.createElement("div",{key:"map-mapbox",ref:this._mapboxMapRef,style:c,className:t}),h.createElement(Q.a,{key:"autosizer",disableWidth:Number.isFinite(n),disableHeight:Number.isFinite(r),onResize:this.props.onResize},this._renderOverlays.bind(this)),this._renderNoTokenWarning())}}],[{key:"supported",value:function(){return ee.a&&ee.a.supported()}}]),n}(h.PureComponent);Object(l.a)(ze,"propTypes",Ne),Object(l.a)(ze,"defaultProps",De);var Ue=function(){};var Be=1,Ve=2,Fe=3,Ge=4,qe={transitionDuration:0,transitionEasing:function(e){return e},transitionInterpolator:new we,transitionInterruption:Be,onTransitionStart:Ue,onTransitionInterrupt:Ue,onTransitionEnd:Ue,onViewportChange:Ue,onStateChange:Ue},He=function(){function e(t,n){var r=this;Object(i.a)(this,e),Object(l.a)(this,"props",void 0),Object(l.a)(this,"state",void 0),Object(l.a)(this,"time",void 0),Object(l.a)(this,"_animationFrame",null),Object(l.a)(this,"_onTransitionFrame",(function(){r._animationFrame=requestAnimationFrame(r._onTransitionFrame),r._updateViewport()})),t&&(this.props=t),this.time=n||Date.now}return Object(o.a)(e,[{key:"getViewportInTransition",value:function(){return this._animationFrame?this.state.propsInTransition:null}},{key:"processViewportChange",value:function(e){var t=this.props;if(this.props=e,this._shouldIgnoreViewportChange(t,e))return!1;if(this._isTransitionEnabled(e)){var n=Object.assign({},t),r=Object.assign({},e);if(this._isTransitionInProgress()&&(t.onTransitionInterrupt(),this.state.interruption===Ve?Object.assign(n,this.state.endProps):Object.assign(n,this.state.propsInTransition),this.state.interruption===Ge)){var i=this.time(),a=(i-this.state.startTime)/this.state.duration;r.transitionDuration=this.state.duration-(i-this.state.startTime),r.transitionEasing=function(e,t){var n=e(t);return function(r){return 1/(1-n)*(e(r*(1-t)+t)-n)}}(this.state.easing,a),r.transitionInterpolator=n.transitionInterpolator}return r.onTransitionStart(),this._triggerTransition(n,r),!0}return this._isTransitionInProgress()&&(t.onTransitionInterrupt(),this._endTransition()),!1}},{key:"_isTransitionInProgress",value:function(){return Boolean(this._animationFrame)}},{key:"_isTransitionEnabled",value:function(e){var t=e.transitionDuration,n=e.transitionInterpolator;return(t>0||"auto"===t)&&Boolean(n)}},{key:"_isUpdateDueToCurrentTransition",value:function(e){return!!this.state.propsInTransition&&this.state.interpolator.arePropsEqual(e,this.state.propsInTransition)}},{key:"_shouldIgnoreViewportChange",value:function(e,t){return!e||(this._isTransitionInProgress()?this.state.interruption===Fe||this._isUpdateDueToCurrentTransition(t):!this._isTransitionEnabled(t)||t.transitionInterpolator.arePropsEqual(e,t))}},{key:"_triggerTransition",value:function(e,t){ae(this._isTransitionEnabled(t)),this._animationFrame&&cancelAnimationFrame(this._animationFrame);var n=t.transitionInterpolator,r=n.getDuration?n.getDuration(e,t):t.transitionDuration;if(0!==r){var i=t.transitionInterpolator.initializeProps(e,t),a={inTransition:!0,isZooming:e.zoom!==t.zoom,isPanning:e.longitude!==t.longitude||e.latitude!==t.latitude,isRotating:e.bearing!==t.bearing||e.pitch!==t.pitch};this.state={duration:r,easing:t.transitionEasing,interpolator:t.transitionInterpolator,interruption:t.transitionInterruption,startTime:this.time(),startProps:i.start,endProps:i.end,animation:null,propsInTransition:{},interactionState:a},this._onTransitionFrame(),this.props.onStateChange(a)}}},{key:"_endTransition",value:function(){this._animationFrame&&(cancelAnimationFrame(this._animationFrame),this._animationFrame=null),this.props.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1})}},{key:"_updateViewport",value:function(){var e=this.time(),t=this.state,n=t.startTime,r=t.duration,i=t.easing,a=t.interpolator,o=t.startProps,s=t.endProps,c=!1,u=(e-n)/r;u>=1&&(u=1,c=!0),u=i(u);var l=a.interpolateProps(o,s,u),h=new Pe(Object.assign({},this.props,l));this.state.propsInTransition=h.getViewportProps(),this.props.onViewportChange(this.state.propsInTransition,this.state.interactionState,this.props),c&&(this._endTransition(),this.props.onTransitionEnd())}}]),e}();Object(l.a)(He,"defaultProps",qe);var Ze,We,Ke=n("yLV6"),Xe=n.n(Ke),Ye={mousedown:1,mousemove:2,mouseup:4};Ze=Xe.a.PointerEventInput,We=Ze.prototype.handler,Ze.prototype.handler=function(e){var t=this.store;e.button>0&&(function(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return!0;return!1}(t,(function(t){return t.pointerId===e.pointerId}))||t.push(e)),We.call(this,e)},Xe.a.MouseInput.prototype.handler=function(e){var t=Ye[e.type];1&t&&e.button>=0&&(this.pressed=!0),2&t&&0===e.which&&(t=4),this.pressed&&(4&t&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:"mouse",srcEvent:e}))};var Qe=Xe.a.Manager,Je=Xe.a,$e=Je?[[Je.Rotate,{enable:!1}],[Je.Pinch,{enable:!1}],[Je.Swipe,{enable:!1}],[Je.Pan,{threshold:0,enable:!1}],[Je.Press,{enable:!1}],[Je.Tap,{event:"doubletap",taps:2,enable:!1}],[Je.Tap,{event:"anytap",enable:!1}],[Je.Tap,{enable:!1}]]:null,et={rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},tt={doubletap:["tap"]},nt={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},rt=["keydown","keyup"],it=["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],at=["wheel","mousewheel","DOMMouseScroll"],ot={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},st={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},ct=n("Vame"),ut=-1!==ct.b.indexOf("firefox"),lt=at,ht=function(){function e(t,n){var r=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(i.a)(this,e),this.element=t,this.callback=n,this.options=Object.assign({enable:!0},a),this.events=lt.concat(a.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach((function(e){return t.addEventListener(e,r.handleEvent,!!ct.a&&{passive:!1})}))}return Object(o.a)(e,[{key:"destroy",value:function(){var e=this;this.events.forEach((function(t){return e.element.removeEventListener(t,e.handleEvent)}))}},{key:"enableEventType",value:function(e,t){"wheel"===e&&(this.options.enable=t)}},{key:"handleEvent",value:function(e){if(this.options.enable){var t=e.deltaY;ct.c.WheelEvent&&(ut&&e.deltaMode===ct.c.WheelEvent.DOM_DELTA_PIXEL&&(t/=ct.c.devicePixelRatio),e.deltaMode===ct.c.WheelEvent.DOM_DELTA_LINE&&(t*=40));var n={x:e.clientX,y:e.clientY};0!==t&&t%4.000244140625==0&&(t=Math.floor(t/4.000244140625)),e.shiftKey&&t&&(t*=.25),this._onWheel(e,-t,n)}}},{key:"_onWheel",value:function(e,t,n){this.callback({type:"wheel",center:n,delta:t,srcEvent:e,pointerType:"mouse",target:e.target})}}]),e}(),ft=it,pt=function(){function e(t,n){var r=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(i.a)(this,e),this.element=t,this.callback=n,this.pressed=!1,this.options=Object.assign({enable:!0},a),this.enableMoveEvent=this.options.enable,this.enableLeaveEvent=this.options.enable,this.enableOutEvent=this.options.enable,this.enableOverEvent=this.options.enable,this.events=ft.concat(a.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach((function(e){return t.addEventListener(e,r.handleEvent)}))}return Object(o.a)(e,[{key:"destroy",value:function(){var e=this;this.events.forEach((function(t){return e.element.removeEventListener(t,e.handleEvent)}))}},{key:"enableEventType",value:function(e,t){"pointermove"===e&&(this.enableMoveEvent=t),"pointerover"===e&&(this.enableOverEvent=t),"pointerout"===e&&(this.enableOutEvent=t),"pointerleave"===e&&(this.enableLeaveEvent=t)}},{key:"handleEvent",value:function(e){this.handleOverEvent(e),this.handleOutEvent(e),this.handleLeaveEvent(e),this.handleMoveEvent(e)}},{key:"handleOverEvent",value:function(e){this.enableOverEvent&&"mouseover"===e.type&&this.callback({type:"pointerover",srcEvent:e,pointerType:"mouse",target:e.target})}},{key:"handleOutEvent",value:function(e){this.enableOutEvent&&"mouseout"===e.type&&this.callback({type:"pointerout",srcEvent:e,pointerType:"mouse",target:e.target})}},{key:"handleLeaveEvent",value:function(e){this.enableLeaveEvent&&"mouseleave"===e.type&&this.callback({type:"pointerleave",srcEvent:e,pointerType:"mouse",target:e.target})}},{key:"handleMoveEvent",value:function(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":0===e.which&&(this.pressed=!1),this.pressed||this.callback({type:"pointermove",srcEvent:e,pointerType:"mouse",target:e.target});break;case"mouseup":this.pressed=!1}}}]),e}(),dt=rt,vt=function(){function e(t,n){var r=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(i.a)(this,e),this.element=t,this.callback=n,this.options=Object.assign({enable:!0},a),this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=dt.concat(a.events||[]),this.handleEvent=this.handleEvent.bind(this),t.tabIndex=a.tabIndex||0,t.style.outline="none",this.events.forEach((function(e){return t.addEventListener(e,r.handleEvent)}))}return Object(o.a)(e,[{key:"destroy",value:function(){var e=this;this.events.forEach((function(t){return e.element.removeEventListener(t,e.handleEvent)}))}},{key:"enableEventType",value:function(e,t){"keydown"===e&&(this.enableDownEvent=t),"keyup"===e&&(this.enableUpEvent=t)}},{key:"handleEvent",value:function(e){var t=e.target||e.srcElement;"INPUT"===t.tagName&&"text"===t.type||"TEXTAREA"===t.tagName||(this.enableDownEvent&&"keydown"===e.type&&this.callback({type:"keydown",srcEvent:e,key:e.key,target:e.target}),this.enableUpEvent&&"keyup"===e.type&&this.callback({type:"keyup",srcEvent:e,key:e.key,target:e.target}))}}]),e}(),mt=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(i.a)(this,e),this.element=t,this.callback=n,this.options=Object.assign({enable:!0},r),this.handleEvent=this.handleEvent.bind(this),t.addEventListener("contextmenu",this.handleEvent)}return Object(o.a)(e,[{key:"destroy",value:function(){this.element.removeEventListener("contextmenu",this.handleEvent)}},{key:"enableEventType",value:function(e,t){"contextmenu"===e&&(this.options.enable=t)}},{key:"handleEvent",value:function(e){this.options.enable&&this.callback({type:"contextmenu",center:{x:e.clientX,y:e.clientY},srcEvent:e,pointerType:"mouse",target:e.target})}}]),e}(),gt=n("U8pU"),bt={pointerdown:1,pointermove:2,pointerup:4,mousedown:1,mousemove:2,mouseup:4};var yt={srcElement:"root",priority:0},_t=function(){function e(t){Object(i.a)(this,e),this.eventManager=t,this.handlers=[],this.handlersByElement=new Map,this.handleEvent=this.handleEvent.bind(this),this._active=!1}return Object(o.a)(e,[{key:"isEmpty",value:function(){return!this._active}},{key:"add",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=this.handlers,o=this.handlersByElement;n&&("object"!==Object(gt.a)(n)||n.addEventListener)&&(n={srcElement:n}),n=n?Object.assign({},yt,n):yt;var s=o.get(n.srcElement);s||(s=[],o.set(n.srcElement,s));var c={type:e,handler:t,srcElement:n.srcElement,priority:n.priority};r&&(c.once=!0),i&&(c.passive=!0),a.push(c),this._active=this._active||!c.passive;for(var u=s.length-1;u>=0&&!(s[u].priority>=c.priority);)u--;s.splice(u+1,0,c)}},{key:"remove",value:function(e,t){for(var n=this.handlers,r=this.handlersByElement,i=n.length-1;i>=0;i--){var a=n[i];if(a.type===e&&a.handler===t){n.splice(i,1);var o=r.get(a.srcElement);o.splice(o.indexOf(a),1),0===o.length&&r.delete(a.srcElement)}}this._active=n.some((function(e){return!e.passive}))}},{key:"handleEvent",value:function(e){if(!this.isEmpty()){for(var t=this._normalizeEvent(e),n=e.srcEvent.target;n&&n!==t.rootElement;){if(this._emit(t,n),t.handled)return;n=n.parentNode}this._emit(t,"root")}}},{key:"_emit",value:function(e,t){var n=this.handlersByElement.get(t);if(n){for(var r=!1,i=function(){e.handled=!0},a=function(){e.handled=!0,r=!0},o=[],s=0;s<n.length;s++){var c=n[s],u=c.type,l=c.handler,h=c.once;if(l(Object.assign({},e,{type:u,stopPropagation:i,stopImmediatePropagation:a})),h&&o.push(n[s]),r)break}for(var f=0;f<o.length;f++){var p=o[f];u=p.type,l=p.handler;this.remove(u,l)}}}},{key:"_normalizeEvent",value:function(e){var t=this.eventManager.element;return Object.assign({},e,function(e){var t=bt[e.srcEvent.type];if(!t)return null;var n=e.srcEvent,r=n.buttons,i=n.button,a=n.which,o=!1,s=!1,c=!1;return 4===t||2===t&&!Number.isFinite(r)?(o=1===a,s=2===a,c=3===a):2===t?(o=Boolean(1&r),s=Boolean(4&r),c=Boolean(2&r)):1===t&&(o=0===i,s=1===i,c=2===i),{leftButton:o,middleButton:s,rightButton:c}}(e),function(e,t){var n=e.srcEvent;if(!e.center&&!Number.isFinite(n.clientX))return null;var r=e.center||{x:n.clientX,y:n.clientY},i=t.getBoundingClientRect(),a=i.width/t.offsetWidth,o=i.height/t.offsetHeight;return{center:r,offsetCenter:{x:(r.x-i.left-t.clientLeft)/a,y:(r.y-i.top-t.clientTop)/o}}}(e,t),{handled:!1,rootElement:t})}}]),e}(),Ot={events:null,recognizers:null,recognizerOptions:{},Manager:Qe,touchAction:"none",tabIndex:0},jt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(i.a)(this,e),this.options=Object.assign({},Ot,n),this.events=new Map,this._onBasicInput=this._onBasicInput.bind(this),this._onOtherEvent=this._onOtherEvent.bind(this),this.setElement(t);var r=n.events;r&&this.on(r)}return Object(o.a)(e,[{key:"setElement",value:function(e){var t=this;if(this.element&&this.destroy(),this.element=e,e){var n=this.options,r=n.Manager;for(var i in this.manager=new r(e,{touchAction:n.touchAction,recognizers:n.recognizers||$e}).on("hammer.input",this._onBasicInput),n.recognizers||Object.keys(et).forEach((function(e){var n=t.manager.get(e);n&&et[e].forEach((function(e){n.recognizeWith(e)}))})),n.recognizerOptions){var a=this.manager.get(i);if(a){var o=n.recognizerOptions[i];delete o.enable,a.set(o)}}this.wheelInput=new ht(e,this._onOtherEvent,{enable:!1}),this.moveInput=new pt(e,this._onOtherEvent,{enable:!1}),this.keyInput=new vt(e,this._onOtherEvent,{enable:!1,tabIndex:n.tabIndex}),this.contextmenuInput=new mt(e,this._onOtherEvent,{enable:!1});var s=!0,c=!1,u=void 0;try{for(var l,h=this.events[Symbol.iterator]();!(s=(l=h.next()).done);s=!0){var f=Object(O.a)(l.value,2),p=f[0],d=f[1];d.isEmpty()||(this._toggleRecognizer(d.recognizerName,!0),this.manager.on(p,d.handleEvent))}}catch(v){c=!0,u=v}finally{try{s||null==h.return||h.return()}finally{if(c)throw u}}}}},{key:"destroy",value:function(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}},{key:"on",value:function(e,t,n){this._addEventHandler(e,t,n,!1)}},{key:"once",value:function(e,t,n){this._addEventHandler(e,t,n,!0)}},{key:"watch",value:function(e,t,n){this._addEventHandler(e,t,n,!1,!0)}},{key:"off",value:function(e,t){this._removeEventHandler(e,t)}},{key:"_toggleRecognizer",value:function(e,t){var n=this.manager;if(n){var r=n.get(e);if(r&&r.options.enable!==t){r.set({enable:t});var i=tt[e];i&&!this.options.recognizers&&i.forEach((function(i){var a=n.get(i);t?(a.requireFailure(e),r.dropRequireFailure(i)):a.dropRequireFailure(e)}))}this.wheelInput.enableEventType(e,t),this.moveInput.enableEventType(e,t),this.keyInput.enableEventType(e,t),this.contextmenuInput.enableEventType(e,t)}}},{key:"_addEventHandler",value:function(e,t,n,r,i){if("string"==typeof e){var a=this.manager,o=this.events,s=st[e]||e,c=o.get(s);c||(c=new _t(this),o.set(s,c),c.recognizerName=ot[s]||s,a&&a.on(s,c.handleEvent)),c.add(e,t,n,r,i),c.isEmpty()||this._toggleRecognizer(c.recognizerName,!0)}else for(var u in n=t,e)this._addEventHandler(u,e[u],n,r,i)}},{key:"_removeEventHandler",value:function(e,t){if("string"==typeof e){var n=this.events,r=st[e]||e,i=n.get(r);if(i&&(i.remove(e,t),i.isEmpty())){var a=i.recognizerName,o=!1,s=!0,c=!1,u=void 0;try{for(var l,h=n.values()[Symbol.iterator]();!(s=(l=h.next()).done);s=!0){var f=l.value;if(f.recognizerName===a&&!f.isEmpty()){o=!0;break}}}catch(d){c=!0,u=d}finally{try{s||null==h.return||h.return()}finally{if(c)throw u}}o||this._toggleRecognizer(a,!1)}}else for(var p in e)this._removeEventHandler(p,e[p])}},{key:"_onBasicInput",value:function(e){var t=e.srcEvent,n=nt[t.type];n&&this.manager.emit(n,e)}},{key:"_onOtherEvent",value:function(e){this.manager.emit(e.type,e)}}]),e}();var wt={transitionDuration:0},St={transitionDuration:300,transitionEasing:function(e){return e},transitionInterpolator:new we,transitionInterruption:Be},Tt=["wheel"],Et=["panstart","panmove","panend"],xt=["pinchstart","pinchmove","pinchend","pinchcancel"],Pt=["doubletap"],Mt=["keydown"],At=function(){function e(){var t=this;Object(i.a)(this,e),Object(l.a)(this,"events",[]),Object(l.a)(this,"mapState",void 0),Object(l.a)(this,"onViewportChange",void 0),Object(l.a)(this,"onStateChange",void 0),Object(l.a)(this,"mapStateProps",void 0),Object(l.a)(this,"eventManager",void 0),Object(l.a)(this,"scrollZoom",!0),Object(l.a)(this,"dragPan",!0),Object(l.a)(this,"dragRotate",!0),Object(l.a)(this,"doubleClickZoom",!0),Object(l.a)(this,"touchZoom",!0),Object(l.a)(this,"touchRotate",!1),Object(l.a)(this,"keyboard",!0),Object(l.a)(this,"_state",{isDragging:!1}),Object(l.a)(this,"_events",{}),Object(l.a)(this,"_transitionManager",new He),Object(l.a)(this,"setState",(function(e){Object.assign(t._state,e),t.onStateChange&&t.onStateChange(t._state)})),this.handleEvent=this.handleEvent.bind(this),this._onWheelEnd=function(e,t){var n,r,i,a=function(){return i=null,e.apply(n,r)};return function(){n=this,r=arguments,i&&clearTimeout(i),i=setTimeout(a,t)}}(this._onWheelEnd,100)}return Object(o.a)(e,[{key:"handleEvent",value:function(e){switch(this.mapState=this.getMapState(),e.type){case"panstart":return this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchcancel":case"pinchend":return this._onPinchEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}},{key:"getCenter",value:function(e){var t=e.offsetCenter;return[t.x,t.y]}},{key:"isFunctionKeyPressed",value:function(e){var t=e.srcEvent;return Boolean(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}},{key:"updateViewport",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=this.mapState?this.mapState.getViewportProps():{},i=Object.assign({},e.getViewportProps(),t),a=Object.keys(i).some((function(e){return r[e]!==i[e]}));a&&this.onViewportChange(i,n,r),this.setState(Object.assign({},e.getInteractiveState(),n))}},{key:"getMapState",value:function(e){return new Pe(Object.assign({},this.mapStateProps,this._state,e))}},{key:"setOptions",value:function(e){var t=e.onViewportChange,n=e.onStateChange,r=e.eventManager,i=void 0===r?this.eventManager:r,a=e.isInteractive,o=void 0===a||a,s=e.scrollZoom,c=void 0===s?this.scrollZoom:s,u=e.dragPan,l=void 0===u?this.dragPan:u,h=e.dragRotate,f=void 0===h?this.dragRotate:h,p=e.doubleClickZoom,d=void 0===p?this.doubleClickZoom:p,v=e.touchZoom,m=void 0===v?this.touchZoom:v,g=e.touchRotate,b=void 0===g?this.touchRotate:g,y=e.keyboard,_=void 0===y?this.keyboard:y;this.onViewportChange=t,this.onStateChange=n;var O=!this.mapStateProps||this.mapStateProps.height!==e.height;this.mapStateProps=e,O&&this.updateViewport(new Pe(e)),this._transitionManager.processViewportChange(Object.assign({},e,{onStateChange:this.setState})),this.eventManager!==i&&(this.eventManager=i,this._events={},this.toggleEvents(this.events,!0)),this.toggleEvents(Tt,o&&c),this.toggleEvents(Et,o&&(l||f)),this.toggleEvents(xt,o&&(m||b)),this.toggleEvents(Pt,o&&d),this.toggleEvents(Mt,o&&_),this.scrollZoom=c,this.dragPan=l,this.dragRotate=f,this.doubleClickZoom=d,this.touchZoom=m,this.touchRotate=b,this.keyboard=_}},{key:"toggleEvents",value:function(e,t){var n=this;this.eventManager&&e.forEach((function(e){n._events[e]!==t&&(n._events[e]=t,t?n.eventManager.on(e,n.handleEvent):n.eventManager.off(e,n.handleEvent))}))}},{key:"_onPanStart",value:function(e){var t=this.getCenter(e),n=this.mapState.panStart({pos:t}).rotateStart({pos:t});return this.updateViewport(n,wt,{isDragging:!0}),!0}},{key:"_onPan",value:function(e){return this.isFunctionKeyPressed(e)||e.rightButton?this._onPanRotate(e):this._onPanMove(e)}},{key:"_onPanEnd",value:function(e){var t=this.mapState.panEnd().rotateEnd();return this.updateViewport(t,null,{isDragging:!1,isPanning:!1,isRotating:!1}),!0}},{key:"_onPanMove",value:function(e){if(!this.dragPan)return!1;var t=this.getCenter(e),n=this.mapState.pan({pos:t});return this.updateViewport(n,wt,{isPanning:!0}),!0}},{key:"_onPanRotate",value:function(e){if(!this.dragRotate)return!1;var t=e.deltaX,n=e.deltaY,r=this.getCenter(e),i=Object(O.a)(r,2)[1],a=i-n,o=this.mapState.getViewportProps(),s=o.width,c=o.height,u=t/s,l=0;n>0?Math.abs(c-a)>5&&(l=n/(a-c)*1.2):n<0&&a>5&&(l=1-i/a),l=Math.min(1,Math.max(-1,l));var h=this.mapState.rotate({deltaScaleX:u,deltaScaleY:l});return this.updateViewport(h,wt,{isRotating:!0}),!0}},{key:"_onWheel",value:function(e){if(!this.scrollZoom)return!1;e.preventDefault();var t=this.getCenter(e),n=e.delta,r=2/(1+Math.exp(-Math.abs(.01*n)));n<0&&0!==r&&(r=1/r);var i=this.mapState.zoom({pos:t,scale:r});return this.updateViewport(i,wt,{isZooming:!0}),this._onWheelEnd(),!0}},{key:"_onWheelEnd",value:function(){this.setState({isZooming:!1})}},{key:"_onPinchStart",value:function(e){var t=this.getCenter(e),n=this.mapState.zoomStart({pos:t}).rotateStart({pos:t});return this._state.startPinchRotation=e.rotation,this.updateViewport(n,wt,{isDragging:!0}),!0}},{key:"_onPinch",value:function(e){if(!this.touchZoom&&!this.touchRotate)return!1;var t=this.mapState;if(this.touchZoom){var n=e.scale,r=this.getCenter(e);t=t.zoom({pos:r,scale:n})}if(this.touchRotate){var i=e.rotation,a=this._state.startPinchRotation;t=t.rotate({deltaScaleX:-(i-a)/180})}return this.updateViewport(t,wt,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),!0}},{key:"_onPinchEnd",value:function(e){var t=this.mapState.zoomEnd().rotateEnd();return this._state.startPinchRotation=0,this.updateViewport(t,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1}),!0}},{key:"_onDoubleTap",value:function(e){if(!this.doubleClickZoom)return!1;var t=this.getCenter(e),n=this.isFunctionKeyPressed(e),r=this.mapState.zoom({pos:t,scale:n?.5:2});return this.updateViewport(r,Object.assign({},St,{transitionInterpolator:new we({around:t})}),{isZooming:!0}),!0}},{key:"_onKeyDown",value:function(e){if(!this.keyboard)return!1;var t,n=this.isFunctionKeyPressed(e),r=this.mapStateProps;switch(e.srcEvent.keyCode){case 189:t=n?this.getMapState({zoom:r.zoom-2}):this.getMapState({zoom:r.zoom-1});break;case 187:t=n?this.getMapState({zoom:r.zoom+2}):this.getMapState({zoom:r.zoom+1});break;case 37:t=n?this.getMapState({bearing:r.bearing-15}):this.mapState.pan({pos:[100,0],startPos:[0,0]});break;case 39:t=n?this.getMapState({bearing:r.bearing+15}):this.mapState.pan({pos:[-100,0],startPos:[0,0]});break;case 38:t=n?this.getMapState({pitch:r.pitch+10}):this.mapState.pan({pos:[0,100],startPos:[0,0]});break;case 40:t=n?this.getMapState({pitch:r.pitch-10}):this.mapState.pan({pos:[0,-100],startPos:[0,0]});break;default:return!1}return this.updateViewport(t,St)}}]),e}(),kt=[{old:"onChangeViewport",new:"onViewportChange"},{old:"perspectiveEnabled",new:"dragRotate"},{old:"onHoverFeatures",new:"onHover"},{old:"onClickFeatures",new:"onClick"},{old:"touchZoomRotate",new:"touchZoom, touchRotate"},{old:"mapControls",new:"controller"}];function Rt(e){return"react-map-gl: `".concat(e,"` is removed.")}function Ct(e){return"Use `".concat(e,"` instead.")}function It(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};kt.forEach((function(t){if(e.hasOwnProperty(t.old)){var n=Rt(t.old);t.new&&(n="".concat(n," ").concat(Ct(t.new))),console.warn(n)}}))}function Lt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var i=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var Nt=Object.assign({},ze.propTypes,{maxZoom:p.a.number,minZoom:p.a.number,maxPitch:p.a.number,minPitch:p.a.number,onViewStateChange:p.a.func,onViewportChange:p.a.func,onInteractionStateChange:p.a.func,transitionDuration:p.a.oneOfType([p.a.number,p.a.string]),transitionInterpolator:p.a.object,transitionInterruption:p.a.number,transitionEasing:p.a.func,onTransitionStart:p.a.func,onTransitionInterrupt:p.a.func,onTransitionEnd:p.a.func,scrollZoom:p.a.bool,dragPan:p.a.bool,dragRotate:p.a.bool,doubleClickZoom:p.a.bool,touchZoom:p.a.bool,touchRotate:p.a.bool,keyboard:p.a.bool,onHover:p.a.func,onClick:p.a.func,onDblClick:p.a.func,onContextMenu:p.a.func,onMouseDown:p.a.func,onMouseMove:p.a.func,onMouseUp:p.a.func,onTouchStart:p.a.func,onTouchMove:p.a.func,onTouchEnd:p.a.func,onMouseEnter:p.a.func,onMouseLeave:p.a.func,onMouseOut:p.a.func,onWheel:p.a.func,touchAction:p.a.string,clickRadius:p.a.number,interactiveLayerIds:p.a.array,getCursor:p.a.func,controller:p.a.instanceOf(At)}),Dt=Object.assign({},ze.defaultProps,Se,He.defaultProps,{onViewStateChange:null,onViewportChange:null,onClick:null,onNativeClick:null,onHover:null,onContextMenu:function(e){return e.preventDefault()},scrollZoom:!0,dragPan:!0,dragRotate:!0,doubleClickZoom:!0,touchZoom:!0,touchRotate:!1,keyboard:!0,touchAction:"none",clickRadius:0,getCursor:function(e){var t=e.isDragging,n=e.isHovering;return t?"grabbing":n?"pointer":"grab"}}),zt=function(e){Object(s.a)(n,e);var t=Lt(n);function n(e){var r;return Object(i.a)(this,n),r=t.call(this,e),Object(l.a)(Object(a.a)(r),"state",{isLoaded:!1,isDragging:!1,isHovering:!1}),Object(l.a)(Object(a.a)(r),"_controller",void 0),Object(l.a)(Object(a.a)(r),"_eventManager",void 0),Object(l.a)(Object(a.a)(r),"_interactiveContext",void 0),Object(l.a)(Object(a.a)(r),"_width",0),Object(l.a)(Object(a.a)(r),"_height",0),Object(l.a)(Object(a.a)(r),"_eventCanvasRef",Object(h.createRef)()),Object(l.a)(Object(a.a)(r),"_staticMapRef",Object(h.createRef)()),Object(l.a)(Object(a.a)(r),"getMap",(function(){return r._staticMapRef.current?r._staticMapRef.current.getMap():null})),Object(l.a)(Object(a.a)(r),"queryRenderedFeatures",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.getMap();return n&&n.queryRenderedFeatures(e,t)})),Object(l.a)(Object(a.a)(r),"_onInteractionStateChange",(function(e){var t=e.isDragging,n=void 0!==t&&t;n!==r.state.isDragging&&(r._updateInteractiveContext({isDragging:n}),r.setState({isDragging:n}));var i=r.props.onInteractionStateChange;i&&i(e)})),Object(l.a)(Object(a.a)(r),"_onResize",(function(e){var t=e.width,n=e.height;r._width=t,r._height=n,r._setControllerProps(r.props),r.props.onResize({width:t,height:n})})),Object(l.a)(Object(a.a)(r),"_onViewportChange",(function(e,t,n){var i=r.props,a=i.onViewStateChange,o=i.onViewportChange;a&&a({viewState:e,interactionState:t,oldViewState:n}),o&&o(e,t,n)})),Object(l.a)(Object(a.a)(r),"_onLoad",(function(e){r.setState({isLoaded:!0}),r.props.onLoad(e)})),Object(l.a)(Object(a.a)(r),"_onEvent",(function(e,t){var n=r.props[e];n&&n(r._normalizeEvent(t))})),Object(l.a)(Object(a.a)(r),"_onPointerDown",(function(e){switch(e.pointerType){case"touch":r._onEvent("onTouchStart",e);break;default:r._onEvent("onMouseDown",e)}})),Object(l.a)(Object(a.a)(r),"_onPointerUp",(function(e){switch(e.pointerType){case"touch":r._onEvent("onTouchEnd",e);break;default:r._onEvent("onMouseUp",e)}})),Object(l.a)(Object(a.a)(r),"_onPointerMove",(function(e){switch(e.pointerType){case"touch":r._onEvent("onTouchMove",e);break;default:r._onEvent("onMouseMove",e)}if(!r.state.isDragging){var t,n=r.props,i=n.onHover,a=n.interactiveLayerIds;e=r._normalizeEvent(e),r.state.isLoaded&&(a||i)&&(t=r._getFeatures({pos:e.point,radius:r.props.clickRadius})),i&&(e.features=t,i(e));var o=Boolean(a&&t&&t.length>0),s=o&&!r.state.isHovering,c=!o&&r.state.isHovering;s&&r._onEvent("onMouseEnter",e),c&&r._onEvent("onMouseLeave",e),(s||c)&&r.setState({isHovering:o})}})),Object(l.a)(Object(a.a)(r),"_onClick",(function(e){var t=r.props,n=t.onClick,i=t.onNativeClick,a=t.onDblClick,o=t.doubleClickZoom,s=[],c=a||o;switch(e.type){case"anyclick":s.push(i),c||s.push(n);break;case"click":c&&s.push(n)}(s=s.filter(Boolean)).length&&((e=r._normalizeEvent(e)).features=r._getFeatures({pos:e.point,radius:r.props.clickRadius}),s.forEach((function(t){return t(e)})))})),It(e),r._controller=e.controller||new At,r._eventManager=new jt(null,{touchAction:e.touchAction}),r._updateInteractiveContext({isDragging:!1,eventManager:r._eventManager}),r}return Object(o.a)(n,null,[{key:"supported",value:function(){return ze.supported()}}]),Object(o.a)(n,[{key:"componentDidMount",value:function(){var e=this._eventManager,t=this._eventCanvasRef.current;e.setElement(t),e.on({pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerup:this._onPointerUp,pointerleave:this._onEvent.bind(this,"onMouseOut"),click:this._onClick,anyclick:this._onClick,dblclick:this._onEvent.bind(this,"onDblClick"),wheel:this._onEvent.bind(this,"onWheel"),contextmenu:this._onEvent.bind(this,"onContextMenu")}),this._setControllerProps(this.props),this._updateInteractiveContext({mapContainer:t})}},{key:"componentDidUpdate",value:function(){this._setControllerProps(this.props)}},{key:"componentWillUnmount",value:function(){this._eventManager.destroy()}},{key:"_setControllerProps",value:function(e){e=Object.assign({},e,e.viewState,{isInteractive:Boolean(e.onViewStateChange||e.onViewportChange),onViewportChange:this._onViewportChange,onStateChange:this._onInteractionStateChange,eventManager:this._eventManager,width:this._width,height:this._height}),this._controller.setOptions(e);var t=this._interactiveContext;t.onViewportChange=e.onViewportChange,t.onViewStateChange=e.onViewStateChange}},{key:"_getFeatures",value:function(e){var t,n=e.pos,r=e.radius,i={},a=this.getMap();if(this.props.interactiveLayerIds&&(i.layers=this.props.interactiveLayerIds),r){var o=r,s=[[n[0]-o,n[1]+o],[n[0]+o,n[1]-o]];t=a&&a.queryRenderedFeatures(s,i)}else t=a&&a.queryRenderedFeatures(n,i);return t}},{key:"_updateInteractiveContext",value:function(e){this._interactiveContext=Object.assign({},this._interactiveContext,e)}},{key:"_normalizeEvent",value:function(e){if(e.lngLat)return e;var t=e.offsetCenter,n=[t.x,t.y],r=new W(Object.assign({},this.props,{width:this._width,height:this._height}));return e.point=n,e.lngLat=r.unproject(n),e}},{key:"render",value:function(){var e=this.props,t=e.width,n=e.height,i=e.style,a=e.getCursor,o=Object.assign({position:"relative"},i,{width:t,height:n,cursor:a(this.state)});return h.createElement(Ae.Provider,{value:this._interactiveContext},h.createElement("div",{key:"event-canvas",ref:this._eventCanvasRef,style:o},h.createElement(ze,r({},this.props,{width:"100%",height:"100%",style:null,onResize:this._onResize,onLoad:this._onLoad,ref:this._staticMapRef}),this.props.children)))}}]),n}(h.PureComponent);function Ut(e,t){if(e===t)return!0;if(!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!Ut(e[n],t[n]))return!1;return!0}if(Array.isArray(t))return!1;if("object"===Object(gt.a)(e)&&"object"===Object(gt.a)(t)){var r=Object.keys(e),i=Object.keys(t);if(r.length!==i.length)return!1;for(var a=0,o=r;a<o.length;a++){var s=o[a];if(!t.hasOwnProperty(s))return!1;if(!Ut(e[s],t[s]))return!1}return!0}return!1}function Bt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var i=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}Object(l.a)(zt,"propTypes",Nt),Object(l.a)(zt,"defaultProps",Dt);var Vt={type:p.a.string.isRequired,id:p.a.string},Ft=0,Gt=function(e){Object(s.a)(n,e);var t=Bt(n);function n(e){var r;return Object(i.a)(this,n),r=t.call(this,e),Object(l.a)(Object(a.a)(r),"id",void 0),Object(l.a)(Object(a.a)(r),"type",void 0),Object(l.a)(Object(a.a)(r),"_map",null),Object(l.a)(Object(a.a)(r),"_sourceOptions",{}),Object(l.a)(Object(a.a)(r),"_updateSource",(function(){var e=Object(a.a)(r),t=e.type;if(e._map){var n=Object(a.a)(r),i=n._sourceOptions,o=n.props;ae(!o.id||o.id===r.id,"source id changed"),ae(o.type===t,"source type changed");var s="",c=0;for(var u in o)"children"===u||"id"===u||Ut(i[u],o[u])||(i[u]=o[u],s=u,c++);var l=r.getSource();l?c&&("geojson"===t?l.setData(i.data):"image"===t?l.updateImage({url:i.url,coordinates:i.coordinates}):"canvas"!==t&&"video"!==t||1!==c||"coordinates"!==s?console.warn("Unable to update <Source> prop: ".concat(s)):l.setCoordinates(i.coordinates)):r._createSource(i)}})),r.id=e.id||"jsx-source-".concat(Ft++),r.type=e.type,r}return Object(o.a)(n,[{key:"componentWillUnmount",value:function(){var e=this,t=this._map;t&&(t.off("styledata",this._updateSource),requestAnimationFrame((function(){t.style&&t.style._loaded&&t.removeSource(e.id)})))}},{key:"getSource",value:function(){var e=this._map;return e&&e.style&&e.getSource(this.id)}},{key:"_createSource",value:function(e){var t=this._map;t.style&&t.style._loaded&&t.addSource(this.id,e)}},{key:"_render",value:function(e){var t=this;return!this._map&&e.map&&(this._map=e.map,this._map.on("styledata",this._updateSource)),this._updateSource(),h.Children.map(this.props.children,(function(e){return Object(h.cloneElement)(e,{source:t.id})}))}},{key:"render",value:function(){return h.createElement(Ae.Consumer,null,this._render.bind(this))}}]),n}(h.PureComponent);Object(l.a)(Gt,"propTypes",Vt);var qt=n("zLVn");function Ht(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var i=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var Zt={type:p.a.string.isRequired,id:p.a.string,source:p.a.string,beforeId:p.a.string};function Wt(e,t,n,r){var i=n.layout,a=void 0===i?{}:i,o=n.paint,s=void 0===o?{}:o,c=n.filter,u=n.minzoom,l=n.maxzoom,h=n.beforeId,f=function(e,t){if(null==e)return{};var n,r,i=Object(qt.a)(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(n,["layout","paint","filter","minzoom","maxzoom","beforeId"]);if(h!==r.beforeId&&e.moveLayer(t,h),a!==r.layout)for(var p in a)Ut(a[p],r.layout[p])||e.setLayoutProperty(t,p,a[p]);if(s!==r.paint)for(var d in s)Ut(s[d],r.paint[d])||e.setPaintProperty(t,d,s[d]);for(var v in Ut(c,r.filter)||e.setFilter(t,c),u===r.minzoom&&l===r.maxzoom||e.setLayerZoomRange(t,u,l),f)Ut(f[v],r[v])||e.setLayerProperty(t,v,f[v])}var Kt=0,Xt=function(e){Object(s.a)(n,e);var t=Ht(n);function n(e){var r;return Object(i.a)(this,n),r=t.call(this,e),Object(l.a)(Object(a.a)(r),"id",void 0),Object(l.a)(Object(a.a)(r),"type",void 0),Object(l.a)(Object(a.a)(r),"_map",null),Object(l.a)(Object(a.a)(r),"_layerOptions",{}),Object(l.a)(Object(a.a)(r),"_updateLayer",(function(){var e=r._map;if(e){var t=Object(a.a)(r),n=t.props,i=t._layerOptions;if(ae(!n.id||n.id===r.id,"layer id changed"),ae(n.type===r.type,"layer type changed"),r.getLayer())try{Wt(e,r.id,n,i),Object.assign(i,n)}catch(o){console.warn(o)}else r._createLayer()}})),r.id=e.id||"jsx-layer-".concat(Kt++),r.type=e.type,r}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this._updateLayer()}},{key:"componentDidUpdate",value:function(){this._updateLayer()}},{key:"componentWillUnmount",value:function(){var e=this._map;e&&(e.off("styledata",this._updateLayer),e.style&&e.style._loaded&&e.removeLayer(this.id))}},{key:"getLayer",value:function(){var e=this._map;return e&&e.style&&e.getLayer(this.id)}},{key:"_createLayer",value:function(){var e=this._map;if(e.style&&e.style._loaded){var t=Object.assign({},this.props);t.id=this.id,delete t.beforeId,e.addLayer(t,this.props.beforeId),this._layerOptions=t}}},{key:"_render",value:function(e){return!this._map&&e.map&&(this._map=e.map,this._map.on("styledata",this._updateLayer)),null}},{key:"render",value:function(){return h.createElement(Ae.Consumer,null,this._render.bind(this))}}]),n}(h.PureComponent);function Yt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var i=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}Object(l.a)(Xt,"propTypes",Zt);var Qt={captureScroll:p.a.bool,captureDrag:p.a.bool,captureClick:p.a.bool,captureDoubleClick:p.a.bool},Jt=function(e){Object(s.a)(n,e);var t=Yt(n);function n(){var e;Object(i.a)(this,n);for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return e=t.call.apply(t,[this].concat(o)),Object(l.a)(Object(a.a)(e),"_context",{}),Object(l.a)(Object(a.a)(e),"_events",null),Object(l.a)(Object(a.a)(e),"_containerRef",Object(h.createRef)()),Object(l.a)(Object(a.a)(e),"_onScroll",(function(t){e.props.captureScroll&&t.stopPropagation()})),Object(l.a)(Object(a.a)(e),"_onDragStart",(function(t){e.props.captureDrag&&t.stopPropagation()})),Object(l.a)(Object(a.a)(e),"_onDblClick",(function(t){e.props.captureDoubleClick&&t.stopPropagation()})),Object(l.a)(Object(a.a)(e),"_onClick",(function(t){e.props.captureClick&&t.stopPropagation()})),e}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var e=this._containerRef.current;if(e){var t=this._context.eventManager;t&&(this._events={wheel:this._onScroll,panstart:this._onDragStart,anyclick:this._onClick,click:this._onClick,dblclick:this._onDblClick},t.watch(this._events,e))}}},{key:"componentWillUnmount",value:function(){var e=this._context.eventManager;e&&this._events&&e.off(this._events)}},{key:"_render",value:function(){throw new Error("_render() not implemented")}},{key:"render",value:function(){var e=this;return h.createElement(Ae.Consumer,null,(function(t){return e._context=t,e._render()}))}}]),n}(h.PureComponent);Object(l.a)(Jt,"propTypes",Qt),Object(l.a)(Jt,"defaultProps",{captureScroll:!1,captureDrag:!0,captureClick:!0,captureDoubleClick:!0});var $t=n("ReuC");function en(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var i=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var tn=Object.assign({},Jt.propTypes,{draggable:p.a.bool,onDrag:p.a.func,onDragEnd:p.a.func,onDragStart:p.a.func,offsetLeft:p.a.number,offsetTop:p.a.number}),nn=Object.assign({},Jt.defaultProps,{draggable:!1,offsetLeft:0,offsetTop:0}),rn=function(e){Object(s.a)(n,e);var t=en(n);function n(){var e;Object(i.a)(this,n);for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return e=t.call.apply(t,[this].concat(o)),Object(l.a)(Object(a.a)(e),"state",{dragPos:null,dragOffset:null}),Object(l.a)(Object(a.a)(e),"_dragEvents",null),Object(l.a)(Object(a.a)(e),"_onDragStart",(function(t){var n=e.props,r=n.draggable,i=n.captureDrag;if((r||i)&&t.stopPropagation(),r){var a=e._getDragEventPosition(t),o=e._getDragEventOffset(t);e.setState({dragPos:a,dragOffset:o}),e._setupDragEvents();var s=e.props.onDragStart;if(s&&o){var c=Object.assign({},t);c.lngLat=e._getDragLngLat(a,o),s(c)}}})),Object(l.a)(Object(a.a)(e),"_onDrag",(function(t){t.stopPropagation();var n=e._getDragEventPosition(t);e.setState({dragPos:n});var r=e.props.onDrag,i=e.state.dragOffset;if(r&&i){var a=Object.assign({},t);a.lngLat=e._getDragLngLat(n,i),r(a)}})),Object(l.a)(Object(a.a)(e),"_onDragEnd",(function(t){var n=e.state,r=n.dragPos,i=n.dragOffset;t.stopPropagation(),e.setState({dragPos:null,dragOffset:null}),e._removeDragEvents();var a=e.props.onDragEnd;if(a&&r&&i){var o=Object.assign({},t);o.lngLat=e._getDragLngLat(r,i),a(o)}})),Object(l.a)(Object(a.a)(e),"_onDragCancel",(function(t){t.stopPropagation(),e.setState({dragPos:null,dragOffset:null}),e._removeDragEvents()})),e}return Object(o.a)(n,[{key:"componentWillUnmount",value:function(){Object($t.a)(Object(u.a)(n.prototype),"componentWillUnmount",this).call(this),this._removeDragEvents()}},{key:"_setupDragEvents",value:function(){var e=this._context.eventManager;e&&(this._dragEvents={panmove:this._onDrag,panend:this._onDragEnd,pancancel:this._onDragCancel},e.on(this._dragEvents))}},{key:"_removeDragEvents",value:function(){var e=this._context.eventManager;e&&this._dragEvents&&(e.off(this._dragEvents),this._dragEvents=null)}},{key:"_getDragEventPosition",value:function(e){var t=e.offsetCenter;return[t.x,t.y]}},{key:"_getDragEventOffset",value:function(e){var t=e.center,n=t.x,r=t.y,i=this._containerRef.current;if(i){var a=i.getBoundingClientRect();return[a.left-n,a.top-r]}return null}},{key:"_getDraggedPosition",value:function(e,t){return[e[0]+t[0],e[1]+t[1]]}},{key:"_getDragLngLat",value:function(e,t){var n=this.props,r=n.offsetLeft,i=n.offsetTop,a=this._getDraggedPosition(e,t),o=Object(O.a)(a,2),s=o[0],c=o[1];return this._context.viewport.unproject([s-r,c-i])}}]),n}(Jt);Object(l.a)(rn,"propTypes",tn),Object(l.a)(rn,"defaultProps",nn);var an="undefined"!=typeof window&&window.devicePixelRatio||1,on=function(e){return Math.round(e*an)/an},sn=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"x";if(null===e)return t;var r="x"===n?e.offsetWidth:e.offsetHeight;return on(t/100*r)/r*100};function cn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var i=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var un=Object.assign({},rn.propTypes,{className:p.a.string,longitude:p.a.number.isRequired,latitude:p.a.number.isRequired}),ln=Object.assign({},rn.defaultProps,{className:""}),hn=function(e){Object(s.a)(n,e);var t=cn(n);function n(){var e;Object(i.a)(this,n);for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return e=t.call.apply(t,[this].concat(o)),Object(l.a)(Object(a.a)(e),"_control",null),e}return Object(o.a)(n,[{key:"_getPosition",value:function(){var e=this.props,t=e.longitude,n=e.latitude,r=e.offsetLeft,i=e.offsetTop,a=this.state,o=a.dragPos,s=a.dragOffset;if(o&&s)return this._getDraggedPosition(o,s);var c=this._context.viewport.project([t,n]),u=Object(O.a)(c,2),l=u[0],h=u[1];return[l+=r,h+=i]}},{key:"_render",value:function(){var e=this._getPosition(),t=Object(O.a)(e,2),n=t[0],r=t[1],i="translate(".concat(on(n),"px, ").concat(on(r),"px)"),a=this._containerRef.current;if(this._control&&a)a.style.transform=i;else{var o=this.props,s=o.className,c=o.draggable,u=this.state.dragPos,l={position:"absolute",left:0,top:0,transform:i,cursor:c?u?"grabbing":"grab":"auto"};this._control=h.createElement("div",{className:"mapboxgl-marker ".concat(s),ref:this._containerRef,style:l},this.props.children)}return this._control}},{key:"render",value:function(){return this._control=null,Object($t.a)(Object(u.a)(n.prototype),"render",this).call(this)}}]),n}(rn);Object(l.a)(hn,"propTypes",un),Object(l.a)(hn,"defaultProps",ln);var fn={top:{x:.5,y:0},"top-left":{x:0,y:0},"top-right":{x:1,y:0},bottom:{x:.5,y:1},"bottom-left":{x:0,y:1},"bottom-right":{x:1,y:1},left:{x:0,y:.5},right:{x:1,y:.5}},pn=Object.keys(fn);function dn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var i=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var vn=Object.assign({},Jt.propTypes,{className:p.a.string,longitude:p.a.number.isRequired,latitude:p.a.number.isRequired,altitude:p.a.number,offsetLeft:p.a.number,offsetTop:p.a.number,tipSize:p.a.number,closeButton:p.a.bool,closeOnClick:p.a.bool,anchor:p.a.oneOf(Object.keys(fn)),dynamicPosition:p.a.bool,sortByDepth:p.a.bool,onClose:p.a.func}),mn=Object.assign({},Jt.defaultProps,{className:"",altitude:0,offsetLeft:0,offsetTop:0,tipSize:10,anchor:"bottom",dynamicPosition:!0,sortByDepth:!1,closeButton:!0,closeOnClick:!0,onClose:function(){}}),gn=function(e){Object(s.a)(n,e);var t=dn(n);function n(){var e;Object(i.a)(this,n);for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return e=t.call.apply(t,[this].concat(o)),Object(l.a)(Object(a.a)(e),"_closeOnClick",!1),Object(l.a)(Object(a.a)(e),"_contentRef",Object(h.createRef)()),Object(l.a)(Object(a.a)(e),"_onClick",(function(t){if(e.props.captureClick&&t.stopPropagation(),e.props.closeOnClick||"mapboxgl-popup-close-button"===t.target.className){e.props.onClose();var n=e._context.eventManager;n&&n.once("click",(function(e){return e.stopPropagation()}),t.target)}})),e}return Object(o.a)(n,[{key:"componentDidMount",value:function(){Object($t.a)(Object(u.a)(n.prototype),"componentDidMount",this).call(this),this.forceUpdate()}},{key:"_getPosition",value:function(e,t){var n=this._context.viewport,r=this.props,i=r.anchor,a=r.dynamicPosition,o=r.tipSize,s=this._contentRef.current;return s&&a?function(e){var t=e.x,n=e.y,r=e.width,i=e.height,a=e.selfWidth,o=e.selfHeight,s=e.anchor,c=e.padding,u=void 0===c?0:c,l=fn[s],h=l.x,f=l.y,p=n-f*o,d=p+o;if(p<u)for(;p<u&&f>=.5;)f-=.5,p+=.5*o;else if(d>i-u)for(;d>i-u&&f<=.5;)f+=.5,d-=.5*o;var v=t-h*a,m=v+a,g=.5;if(.5===f&&(h=Math.floor(h),g=1),v<u)for(;v<u&&h>=g;)h-=g,v+=g*a;else if(m>r-u)for(;m>r-u&&h<=1-g;)h+=g,m-=g*a;return pn.find((function(e){var t=fn[e];return t.x===h&&t.y===f}))||s}({x:e,y:t,anchor:i,padding:o,width:n.width,height:n.height,selfWidth:s.clientWidth,selfHeight:s.clientHeight}):i}},{key:"_getContainerStyle",value:function(e,t,n,r){var i=this._context.viewport,a=this.props,o=a.offsetLeft,s=a.offsetTop,c=a.sortByDepth,u=fn[r],l=e+o,h=t+s,f=this._containerRef.current,p=sn(f,100*-u.x),d=sn(f,100*-u.y,"y"),v={position:"absolute",transform:"\n        translate(".concat(p,"%, ").concat(d,"%)\n        translate(").concat(on(l),"px, ").concat(on(h),"px)\n      "),display:void 0,zIndex:void 0};return c?(n>1||n<-1||e<0||e>i.width||t<0||t>i.height?v.display="none":v.zIndex=Math.floor((1-n)/2*1e5),v):v}},{key:"_renderTip",value:function(e){var t=this.props.tipSize;return h.createElement("div",{key:"tip",className:"mapboxgl-popup-tip",style:{borderWidth:t}})}},{key:"_renderContent",value:function(){var e=this.props,t=e.closeButton,n=e.children,r=this._context.eventManager?null:this._onClick;return h.createElement("div",{key:"content",ref:this._contentRef,className:"mapboxgl-popup-content",onClick:r},t&&h.createElement("button",{key:"close-button",className:"mapboxgl-popup-close-button",type:"button"},""),n)}},{key:"_render",value:function(){var e=this.props,t=e.className,n=e.longitude,r=e.latitude,i=e.altitude,a=this._context.viewport.project([n,r,i]),o=Object(O.a)(a,3),s=o[0],c=o[1],u=o[2],l=this._getPosition(s,c),f=this._getContainerStyle(s,c,u,l);return h.createElement("div",{className:"mapboxgl-popup mapboxgl-popup-anchor-".concat(l," ").concat(t),style:f,ref:this._containerRef},this._renderTip(l),this._renderContent())}}]),n}(Jt);Object(l.a)(gn,"propTypes",vn),Object(l.a)(gn,"defaultProps",mn);var bn=n("2lZV");function yn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var i=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var _n,On=Object.assign({},Jt.propTypes,{className:p.a.string,container:p.a.object}),jn=Object.assign({},Jt.defaultProps,{className:"",container:null}),wn=function(e){Object(s.a)(n,e);var t=yn(n);function n(){var e;Object(i.a)(this,n);for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return e=t.call.apply(t,[this].concat(o)),Object(l.a)(Object(a.a)(e),"state",{isFullscreen:!1,showButton:!1}),Object(l.a)(Object(a.a)(e),"_mapboxFullscreenControl",null),Object(l.a)(Object(a.a)(e),"_onFullscreenChange",(function(){var t=!e._mapboxFullscreenControl._fullscreen;e._mapboxFullscreenControl._fullscreen=t,e.setState({isFullscreen:t})})),Object(l.a)(Object(a.a)(e),"_onClickFullscreen",(function(){e._mapboxFullscreenControl._onClickFullscreen()})),e}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var e=this.props.container||this._context.mapContainer;this._mapboxFullscreenControl=new ee.a.FullscreenControl({container:e}),this.setState({showButton:this._mapboxFullscreenControl._checkFullscreenSupport()}),bn.a.addEventListener(this._mapboxFullscreenControl._fullscreenchange,this._onFullscreenChange)}},{key:"componentWillUnmount",value:function(){bn.a.removeEventListener(this._mapboxFullscreenControl._fullscreenchange,this._onFullscreenChange)}},{key:"_renderButton",value:function(e,t,n){return h.createElement("button",{key:e,className:"mapboxgl-ctrl-icon mapboxgl-ctrl-".concat(e),type:"button",title:t,onClick:n},h.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true"}))}},{key:"_render",value:function(){if(!this.state.showButton)return null;var e=this.props.className,t=this.state.isFullscreen?"shrink":"fullscreen";return h.createElement("div",{className:"mapboxgl-ctrl mapboxgl-ctrl-group ".concat(e),ref:this._containerRef},this._renderButton(t,"Toggle fullscreen",this._onClickFullscreen))}}]),n}(Jt);function Sn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var i=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}Object(l.a)(wn,"propTypes",On),Object(l.a)(wn,"defaultProps",jn);var Tn=Object.assign({},He.defaultProps,{transitionDuration:500}),En=function(){},xn=Object.assign({},Jt.propTypes,{className:p.a.string,style:p.a.object,label:p.a.string,auto:p.a.bool,positionOptions:p.a.object,fitBoundsOptions:p.a.object,trackUserLocation:p.a.bool,showUserLocation:p.a.bool,onViewStateChange:p.a.func,onViewportChange:p.a.func,onGeolocate:p.a.func}),Pn=Object.assign({},Jt.defaultProps,{className:"",style:{},label:"Geolocate",auto:!1,positionOptions:null,fitBoundsOptions:null,trackUserLocation:!1,showUserLocation:!0,onGeolocate:function(){}}),Mn=function(e){Object(s.a)(n,e);var t=Sn(n);function n(){var e;Object(i.a)(this,n);for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return e=t.call.apply(t,[this].concat(o)),Object(l.a)(Object(a.a)(e),"state",{supportsGeolocation:!1,markerPosition:null}),Object(l.a)(Object(a.a)(e),"_mapboxGeolocateControl",null),Object(l.a)(Object(a.a)(e),"_geolocateButtonRef",Object(h.createRef)()),Object(l.a)(Object(a.a)(e),"_setupMapboxGeolocateControl",(function(t){if(t){var n={showUserLocation:!1};["positionOptions","fitBoundsOptions","trackUserLocation"].forEach((function(t){t in e.props&&null!==e.props[t]&&(n[t]=e.props[t])}));var r=new ee.a.GeolocateControl(n);e._mapboxGeolocateControl=r,r._watchState="OFF",r._geolocateButton=e._geolocateButtonRef.current,r.options.trackUserLocation&&r._geolocateButton&&r._geolocateButton.setAttribute("aria-pressed","false"),r._updateMarker=e._updateMarker,r._updateCamera=e._updateCamera,r._setup=!0;var i=e._context.eventManager;r.options.trackUserLocation&&i&&i.on("panstart",(function(){"ACTIVE_LOCK"===r._watchState&&(r._watchState="BACKGROUND",r._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),r._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"))})),r.on("geolocate",e.props.onGeolocate)}else console.warn("Geolocation support is not available, the GeolocateControl will not be visible.")})),Object(l.a)(Object(a.a)(e),"_triggerGeolocate",(function(){var t=e._mapboxGeolocateControl;return t._map=e._context.map,e.props.showUserLocation&&(t.on("geolocate",e._updateMarker),t.on("trackuserlocationend",e._updateMarker)),e._mapboxGeolocateControl.trigger()})),Object(l.a)(Object(a.a)(e),"_updateMarker",(function(t){t&&e.setState({markerPosition:t.coords})})),Object(l.a)(Object(a.a)(e),"_getBounds",(function(e){var t=new ee.a.LngLat(e.coords.longitude,e.coords.latitude),n=e.coords.accuracy,r=t.toBounds(n);return[[r._ne.lng,r._ne.lat],[r._sw.lng,r._sw.lat]]})),Object(l.a)(Object(a.a)(e),"_updateCamera",(function(t){var n=e._context.viewport,r=e._getBounds(t),i=new W(n).fitBounds(r),a=i.longitude,o=i.latitude,s=i.zoom,c=Object.assign({},n,{longitude:a,latitude:o,zoom:s}),u=new Pe(c),l=Object.assign({},u.getViewportProps(),Tn),h=e.props.onViewportChange||e._context.onViewportChange||En;(e.props.onViewStateChange||e._context.onViewStateChange||En)({viewState:l}),h(l)})),Object(l.a)(Object(a.a)(e),"_renderButton",(function(t,n,r){return h.createElement("button",{key:t,className:"mapboxgl-ctrl-icon mapboxgl-ctrl-".concat(t),ref:e._geolocateButtonRef,type:"button",title:n,onClick:r},h.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true"}))})),Object(l.a)(Object(a.a)(e),"_renderMarker",(function(){var t=e.state.markerPosition,n=e.props.showUserLocation;return t&&n?h.createElement(hn,{key:"location-maker",className:"mapboxgl-user-location-dot",longitude:t.longitude,latitude:t.latitude,onContextMenu:function(e){return e.preventDefault()},captureDrag:!1,captureDoubleClick:!1}):null})),e}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var e=this;(void 0!==_n?Promise.resolve(_n):void 0!==window.navigator.permissions?window.navigator.permissions.query({name:"geolocation"}).then((function(e){return _n="denied"!==e.state})):(_n=Boolean(window.navigator.geolocation),Promise.resolve(_n))).then((function(t){e.setState({supportsGeolocation:t}),e._setupMapboxGeolocateControl(t),t&&e.props.auto&&e._triggerGeolocate()}))}},{key:"componentDidUpdate",value:function(e){this.state.supportsGeolocation&&!e.auto&&this.props.auto&&this._triggerGeolocate()}},{key:"componentWillUnmount",value:function(){if(this._mapboxGeolocateControl){var e=this._mapboxGeolocateControl._geolocationWatchID;void 0!==e&&(window.navigator.geolocation.clearWatch(e),this._mapboxGeolocateControl._geolocationWatchID=void 0)}}},{key:"_render",value:function(){if(!this.state.supportsGeolocation)return null;var e=this.props,t=e.className,n=e.style,r=e.label;return h.createElement("div",null,this._renderMarker(),h.createElement("div",{key:"geolocate-control",className:"mapboxgl-ctrl mapboxgl-ctrl-group ".concat(t),ref:this._containerRef,style:n,onContextMenu:function(e){return e.preventDefault()}},this._renderButton("geolocate",r,this._triggerGeolocate)))}}]),n}(Jt);function An(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var i=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}Object(l.a)(Mn,"propTypes",xn),Object(l.a)(Mn,"defaultProps",Pn);var kn=function(){},Rn=Object.assign({},Jt.propTypes,{className:p.a.string,onViewStateChange:p.a.func,onViewportChange:p.a.func,showCompass:p.a.bool,showZoom:p.a.bool,zoomInLabel:p.a.string,zoomOutLabel:p.a.string,compassLabel:p.a.string}),Cn=Object.assign({},Jt.defaultProps,{className:"",showCompass:!0,showZoom:!0,zoomInLabel:"Zoom In",zoomOutLabel:"Zoom Out",compassLabel:"Reset North"});function In(e){return function(e,t){for(var n=(e||"").split(".").map(Number),r=(t||"").split(".").map(Number),i=0;i<3;i++){var a=n[i]||0,o=r[i]||0;if(a<o)return-1;if(a>o)return 1}return 0}(e,"1.6.0")>=0?2:1}var Ln=function(e){Object(s.a)(n,e);var t=An(n);function n(e){var r;return Object(i.a)(this,n),r=t.call(this,e),Object(l.a)(Object(a.a)(r),"_uiVersion",void 0),Object(l.a)(Object(a.a)(r),"_onZoomIn",(function(){r._updateViewport({zoom:r._context.viewport.zoom+1})})),Object(l.a)(Object(a.a)(r),"_onZoomOut",(function(){r._updateViewport({zoom:r._context.viewport.zoom-1})})),Object(l.a)(Object(a.a)(r),"_onResetNorth",(function(){r._updateViewport({bearing:0,pitch:0})})),It(e),r}return Object(o.a)(n,[{key:"_updateViewport",value:function(e){var t=this._context.viewport,n=new Pe(Object.assign({},t,e)),r=Object.assign({},n.getViewportProps(),St),i=this.props.onViewportChange||this._context.onViewportChange||kn;(this.props.onViewStateChange||this._context.onViewStateChange||kn)({viewState:r}),i(r)}},{key:"_renderCompass",value:function(){var e=this._context.viewport.bearing,t={transform:"rotate(".concat(-e,"deg)")};return 2===this._uiVersion?h.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true",style:t}):h.createElement("span",{className:"mapboxgl-ctrl-compass-arrow",style:t})}},{key:"_renderButton",value:function(e,t,n,r){return h.createElement("button",{key:e,className:"mapboxgl-ctrl-icon mapboxgl-ctrl-".concat(e),type:"button",title:t,onClick:n},r||h.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true"}))}},{key:"_render",value:function(){var e=this.props,t=e.className,n=e.showCompass,r=e.showZoom,i=e.zoomInLabel,a=e.zoomOutLabel,o=e.compassLabel;if(!this._uiVersion){var s=this._context.map;this._uiVersion=s?In(s.version):2}return h.createElement("div",{className:"mapboxgl-ctrl mapboxgl-ctrl-group ".concat(t),ref:this._containerRef},r&&this._renderButton("zoom-in",i,this._onZoomIn),r&&this._renderButton("zoom-out",a,this._onZoomOut),n&&this._renderButton("compass",o,this._onResetNorth,this._renderCompass()))}}]),n}(Jt);function Nn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var i=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}Object(l.a)(Ln,"propTypes",Rn),Object(l.a)(Ln,"defaultProps",Cn);var Dn=Object.assign({},Jt.propTypes,{maxWidth:p.a.number,unit:p.a.oneOf(["imperial","metric","nautical"])}),zn=Object.assign({},Jt.defaultProps,{maxWidth:100,unit:"metric"}),Un=function(e){Object(s.a)(n,e);var t=Nn(n);function n(){var e;Object(i.a)(this,n);for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return e=t.call.apply(t,[this].concat(o)),Object(l.a)(Object(a.a)(e),"_control",null),Object(l.a)(Object(a.a)(e),"_mapboxScaleControl",null),e}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var e=new ee.a.ScaleControl;e._map=this._context.map,e._container=this._containerRef.current,this._mapboxScaleControl=e,this._update()}},{key:"_update",value:function(){var e=this._mapboxScaleControl;e&&(e.options=this.props,e._onMove())}},{key:"_render",value:function(){return this._control=this._control||h.createElement("div",{ref:this._containerRef,className:"mapboxgl-ctrl mapboxgl-ctrl-scale"}),this._update(),this._control}}]),n}(Jt);function Bn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var i=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}Object(l.a)(Un,"propTypes",Dn),Object(l.a)(Un,"defaultProps",zn);var Vn=Object.assign({},Jt.propTypes,{redraw:p.a.func.isRequired}),Fn=function(e){Object(s.a)(n,e);var t=Bn(n);function n(){var e;Object(i.a)(this,n);for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return e=t.call.apply(t,[this].concat(o)),Object(l.a)(Object(a.a)(e),"_canvas",void 0),Object(l.a)(Object(a.a)(e),"_ctx",void 0),Object(l.a)(Object(a.a)(e),"_redraw",(function(){var t=e._ctx;if(t){var n=bn.b.devicePixelRatio||1;t.save(),t.scale(n,n);var r=e._context,i=r.viewport,a=r.isDragging;e.props.redraw({width:i.width,height:i.height,ctx:t,isDragging:a,project:i.project.bind(i),unproject:i.unproject.bind(i)}),t.restore()}})),e}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var e=this._containerRef.current;e&&(this._canvas=e,this._ctx=e.getContext("2d")),this._redraw()}},{key:"_render",value:function(){var e=bn.b.devicePixelRatio||1,t=this._context.viewport,n=t.width,r=t.height;return this._redraw(),h.createElement("canvas",{ref:this._containerRef,width:n*e,height:r*e,style:{width:"".concat(n,"px"),height:"".concat(r,"px"),position:"absolute",left:0,top:0}})}}]),n}(Jt);function Gn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var i=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}Object(l.a)(Fn,"propTypes",Vn),Object(l.a)(Fn,"defaultProps",{captureScroll:!1,captureDrag:!1,captureClick:!1,captureDoubleClick:!1});var qn=Object.assign({},Jt.propTypes,{redraw:p.a.func.isRequired,style:p.a.object}),Hn=function(e){Object(s.a)(n,e);var t=Gn(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"_render",value:function(){var e=this._context,t=e.viewport,n=e.isDragging,r=Object.assign({position:"absolute",left:0,top:0,width:t.width,height:t.height},this.props.style);return h.createElement("div",{ref:this._containerRef,style:r},this.props.redraw({width:t.width,height:t.height,isDragging:n,project:t.project.bind(t),unproject:t.unproject.bind(t)}))}}]),n}(Jt);function Zn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var i=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}Object(l.a)(Hn,"propTypes",qn),Object(l.a)(Hn,"defaultProps",{captureScroll:!1,captureDrag:!1,captureClick:!1,captureDoubleClick:!1});var Wn=Object.assign({},Jt.propTypes,{redraw:p.a.func.isRequired,style:p.a.object}),Kn=function(e){Object(s.a)(n,e);var t=Zn(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"_render",value:function(){var e=this._context,t=e.viewport,n=e.isDragging,r=Object.assign({position:"absolute",left:0,top:0},this.props.style);return h.createElement("svg",{width:t.width,height:t.height,ref:this._containerRef,style:r},this.props.redraw({width:t.width,height:t.height,isDragging:n,project:t.project.bind(t),unproject:t.unproject.bind(t)}))}}]),n}(Jt);Object(l.a)(Kn,"propTypes",Wn),Object(l.a)(Kn,"defaultProps",{captureScroll:!1,captureDrag:!1,captureClick:!1,captureDoubleClick:!1});ee.a&&ee.a.setRTLTextPlugin},Vame:function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return a}));var r="undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",i="undefined"!=typeof window?window:e,a=(void 0!==e||window,"undefined"!=typeof document&&document,!1);try{var o={get passive(){return a=!0,!0}};i.addEventListener("test",o,o),i.removeEventListener("test",o,o)}catch(s){}}).call(this,n("yLpj"))},Vmat:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("rePB"),i=n("G+eI");function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var s={id:"request-scheduler",throttleRequests:!0,maxRequests:6},c=function(){function e(e){void 0===e&&(e={}),this.props=o(o({},s),e),this.requestQueue=[],this.activeRequestCount=0,this.requestMap=new Map,this.stats=new i.a({id:e.id}),this.stats.get("Queued Requests"),this.stats.get("Active Requests"),this.stats.get("Cancelled Requests"),this.stats.get("Queued Requests Ever"),this.stats.get("Active Requests Ever"),this._deferredUpdate=null}var t=e.prototype;return t.scheduleRequest=function(e,t){if(void 0===t&&(t=function(){return 0}),!this.props.throttleRequests)return Promise.resolve({done:function(){}});if(this.requestMap.has(e))return this.requestMap.get(e);var n={handle:e,getPriority:t},r=new Promise((function(e){return n.resolve=e,n}));return this.requestQueue.push(n),this.requestMap.set(e,r),this._issueNewRequests(),r},t._issueRequest=function(e){var t=this,n=e.handle,r=e.resolve,i=!1,a=function(){i||(i=!0,t.requestMap.delete(n),t.activeRequestCount--,t._issueNewRequests())};return this.activeRequestCount++,r?r({done:a}):Promise.resolve({done:a})},t._issueNewRequests=function(){var e=this;this._deferredUpdate||(this._deferredUpdate=setTimeout((function(){return e._issueNewRequestsAsync()}),0))},t._issueNewRequestsAsync=function(){this._deferredUpdate=null;var e=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(0!==e){this._updateAllRequests();for(var t=0;t<e;++t)if(this.requestQueue.length>0){var n=this.requestQueue.shift();this._issueRequest(n)}}},t._updateAllRequests=function(){for(var e=this.requestQueue,t=0;t<e.length;++t){var n=e[t];this._updateRequest(n)||(e.splice(t,1),this.requestMap.delete(n.handle),t--)}e.sort((function(e,t){return e.priority-t.priority}))},t._updateRequest=function(e){return e.priority=e.getPriority(e.handle),!(e.priority<0)||(e.resolve(null),!1)},e}()},Wium:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n("1OyB"),i=n("vuIU"),a=n("Ji7U"),o=n("md7G"),s=n("foSv"),c=n("wldP"),u=n("c9N0"),l=n("v88f");function h(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var i=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var d=["bearing","pitch"],v={speed:1.2,curve:1.414},m=function(e){Object(a.a)(n,e);var t=p(n);function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r.a)(this,n),(e=t.call(this,{compare:["longitude","latitude","zoom","bearing","pitch"],extract:["width","height","longitude","latitude","zoom","bearing","pitch"],required:["width","height","latitude","longitude","zoom"]})).props=Object.assign({},v,i),e}return Object(i.a)(n,[{key:"interpolateProps",value:function(e,t,n){var r,i=Object(l.c)(e,t,n,this.props),a=h(d);try{for(a.s();!(r=a.n()).done;){var o=r.value;i[o]=Object(u.f)(e[o]||0,t[o]||0,n)}}catch(s){a.e(s)}finally{a.f()}return i}},{key:"getDuration",value:function(e,t){var n=t.transitionDuration;return"auto"===n&&(n=Object(l.f)(e,t,this.props)),n}}]),n}(c.a)},WraG:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("lC2f");function i(e){try{return JSON.parse(e)}catch(t){throw new Error('Failed to parse JSON from data starting with "'+Object(r.a)(e)+'"')}}},Xjzu:function(e,t,n){"use strict";n.d(t,"a",(function(){return N}));var r=n("1OyB"),i=n("vuIU"),a=n("Ji7U"),o=n("md7G"),s=n("foSv"),c=n("41X0"),u=n("+H0l"),l=n("tS8E"),h=n("yU0y"),f=n("HwUG"),p=n("n+fv"),d=n("bl9R");function v(){var e=new h.a(4);return h.a!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function m(e,t,n){n*=.5;var r=Math.sin(n);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n),e}function g(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3],s=n[0],c=n[1],u=n[2],l=n[3];return e[0]=r*l+o*s+i*u-a*c,e[1]=i*l+o*c+a*s-r*u,e[2]=a*l+o*u+r*c-i*s,e[3]=o*l-r*s-i*c-a*u,e}function b(e,t,n,r){var i,a,o,s,c,u=t[0],l=t[1],f=t[2],p=t[3],d=n[0],v=n[1],m=n[2],g=n[3];return(a=u*d+l*v+f*m+p*g)<0&&(a=-a,d=-d,v=-v,m=-m,g=-g),1-a>h.b?(i=Math.acos(a),o=Math.sin(i),s=Math.sin((1-r)*i)/o,c=Math.sin(r*i)/o):(s=1-r,c=r),e[0]=s*u+c*d,e[1]=s*l+c*v,e[2]=s*f+c*m,e[3]=s*p+c*g,e}function y(e,t){var n,r=t[0]+t[4]+t[8];if(r>0)n=Math.sqrt(r+1),e[3]=.5*n,n=.5/n,e[0]=(t[5]-t[7])*n,e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[3*i+i]&&(i=2);var a=(i+1)%3,o=(i+2)%3;n=Math.sqrt(t[3*i+i]-t[3*a+a]-t[3*o+o]+1),e[i]=.5*n,n=.5/n,e[3]=(t[3*a+o]-t[3*o+a])*n,e[a]=(t[3*a+i]+t[3*i+a])*n,e[o]=(t[3*o+i]+t[3*i+o])*n}return e}d.b,d.g,d.c,d.l;var _,O,j,w,S,T,E=d.a,x=d.k,P=d.d,M=d.i,A=d.h,k=d.m,R=d.j,C=(d.f,d.e,_=p.b(),O=p.e(1,0,0),j=p.e(0,1,0),function(e,t,n){var r=p.d(t,n);return r<-.999999?(p.c(_,O,t),p.f(_)<1e-6&&p.c(_,j,t),p.i(_,_),m(e,_,Math.PI),e):r>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(p.c(_,t,n),e[0]=_[0],e[1]=_[1],e[2]=_[2],e[3]=1+r,R(e,e))});w=v(),S=v(),T=f.a();function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var i=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var L=[0,0,0,1],N=function(e){Object(a.a)(n,e);var t=I(n);function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return Object(r.a)(this,n),e=t.call(this,-0,-0,-0,-0),Array.isArray(i)&&1===arguments.length?e.copy(i):e.set(i,a,o,s),e}return Object(i.a)(n,[{key:"copy",value:function(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}},{key:"set",value:function(e,t,n,r){return this[0]=e,this[1]=t,this[2]=n,this[3]=r,this.check()}},{key:"fromMatrix3",value:function(e){return y(this,e),this.check()}},{key:"identity",value:function(){var e;return(e=this)[0]=0,e[1]=0,e[2]=0,e[3]=1,this.check()}},{key:"fromAxisRotation",value:function(e,t){return m(this,e,t),this.check()}},{key:"setAxisAngle",value:function(e,t){return this.fromAxisRotation(e,t)}},{key:"len",value:function(){return A(this)}},{key:"lengthSquared",value:function(){return k(this)}},{key:"dot",value:function(e,t){if(void 0!==t)throw new Error("Quaternion.dot only takes one argument");return P(this,e)}},{key:"rotationTo",value:function(e,t){return C(this,e,t),this.check()}},{key:"add",value:function(e,t){if(void 0!==t)throw new Error("Quaternion.add only takes one argument");return E(this,this,e),this.check()}},{key:"calculateW",value:function(){var e,t,n,r,i;return e=this,n=(t=this)[0],r=t[1],i=t[2],e[0]=n,e[1]=r,e[2]=i,e[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),this.check()}},{key:"conjugate",value:function(){var e,t;return t=this,(e=this)[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],this.check()}},{key:"invert",value:function(){var e,t,n,r,i,a,o,s;return e=this,n=(t=this)[0],r=t[1],i=t[2],a=t[3],s=(o=n*n+r*r+i*i+a*a)?1/o:0,e[0]=-n*s,e[1]=-r*s,e[2]=-i*s,e[3]=a*s,this.check()}},{key:"lerp",value:function(e,t,n){return M(this,e,t,n),this.check()}},{key:"multiplyRight",value:function(e,t){return Object(l.a)(!t),g(this,this,e),this.check()}},{key:"multiplyLeft",value:function(e,t){return Object(l.a)(!t),g(this,e,this),this.check()}},{key:"normalize",value:function(){var e=this.len(),t=e>0?1/e:0;return this[0]=this[0]*t,this[1]=this[1]*t,this[2]=this[2]*t,this[3]=this[3]*t,0===e&&(this[3]=1),this.check()}},{key:"rotateX",value:function(e){return function(e,t,n){n*=.5;var r=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(n),c=Math.cos(n);e[0]=r*c+o*s,e[1]=i*c+a*s,e[2]=a*c-i*s,e[3]=o*c-r*s}(this,this,e),this.check()}},{key:"rotateY",value:function(e){return function(e,t,n){n*=.5;var r=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(n),c=Math.cos(n);e[0]=r*c-a*s,e[1]=i*c+o*s,e[2]=a*c+r*s,e[3]=o*c-i*s}(this,this,e),this.check()}},{key:"rotateZ",value:function(e){return function(e,t,n){n*=.5;var r=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(n),c=Math.cos(n);e[0]=r*c+i*s,e[1]=i*c-r*s,e[2]=a*c+o*s,e[3]=o*c-a*s}(this,this,e),this.check()}},{key:"scale",value:function(e){return x(this,this,e),this.check()}},{key:"slerp",value:function(e,t,n){switch(arguments.length){case 1:var r=arguments[0],i=r.start;e=void 0===i?L:i,t=r.target,n=r.ratio;break;case 2:var a=Array.prototype.slice.call(arguments);t=a[0],n=a[1],e=this}return b(this,e,t,n),this.check()}},{key:"transformVector4",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return d.o(t,e,this),Object(u.b)(t,4)}},{key:"lengthSq",value:function(){return this.lengthSquared()}},{key:"setFromAxisAngle",value:function(e,t){return this.setAxisAngle(e,t)}},{key:"premultiply",value:function(e,t){return this.multiplyLeft(e,t)}},{key:"multiply",value:function(e,t){return this.multiplyRight(e,t)}},{key:"ELEMENTS",get:function(){return 4}},{key:"x",get:function(){return this[0]},set:function(e){this[0]=Object(u.a)(e)}},{key:"y",get:function(){return this[1]},set:function(e){this[1]=Object(u.a)(e)}},{key:"z",get:function(){return this[2]},set:function(e){this[2]=Object(u.a)(e)}},{key:"w",get:function(){return this[3]},set:function(e){this[3]=Object(u.a)(e)}}]),n}(c.a)},gOKY:function(e,t,n){"use strict";t.a={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,PI_OVER_TWO:Math.PI/2,PI_OVER_FOUR:Math.PI/4,PI_OVER_SIX:Math.PI/6,TWO_PI:2*Math.PI}},jYz7:function(e,t,n){"use strict";(function(e){var r=n("q1tI");function i(t){var n;n="undefined"!=typeof window?window:"undefined"!=typeof self?self:e;var r,i,a="undefined"!=typeof document&&document.attachEvent;if(!a){var o=(i=n.requestAnimationFrame||n.mozRequestAnimationFrame||n.webkitRequestAnimationFrame||function(e){return n.setTimeout(e,20)},function(e){return i(e)}),s=(r=n.cancelAnimationFrame||n.mozCancelAnimationFrame||n.webkitCancelAnimationFrame||n.clearTimeout,function(e){return r(e)}),c=function(e){var t=e.__resizeTriggers__,n=t.firstElementChild,r=t.lastElementChild,i=n.firstElementChild;r.scrollLeft=r.scrollWidth,r.scrollTop=r.scrollHeight,i.style.width=n.offsetWidth+1+"px",i.style.height=n.offsetHeight+1+"px",n.scrollLeft=n.scrollWidth,n.scrollTop=n.scrollHeight},u=function(e){if(!(e.target.className.indexOf("contract-trigger")<0&&e.target.className.indexOf("expand-trigger")<0)){var t=this;c(this),this.__resizeRAF__&&s(this.__resizeRAF__),this.__resizeRAF__=o((function(){(function(e){return e.offsetWidth!=e.__resizeLast__.width||e.offsetHeight!=e.__resizeLast__.height})(t)&&(t.__resizeLast__.width=t.offsetWidth,t.__resizeLast__.height=t.offsetHeight,t.__resizeListeners__.forEach((function(n){n.call(t,e)})))}))}},l=!1,h="",f="animationstart",p="Webkit Moz O ms".split(" "),d="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),v=document.createElement("fakeelement");if(void 0!==v.style.animationName&&(l=!0),!1===l)for(var m=0;m<p.length;m++)if(void 0!==v.style[p[m]+"AnimationName"]){h="-"+p[m].toLowerCase()+"-",f=d[m],l=!0;break}var g="resizeanim",b="@"+h+"keyframes "+g+" { from { opacity: 0; } to { opacity: 0; } } ",y=h+"animation: 1ms "+g+"; "}return{addResizeListener:function(e,r){if(a)e.attachEvent("onresize",r);else{if(!e.__resizeTriggers__){var i=e.ownerDocument,o=n.getComputedStyle(e);o&&"static"==o.position&&(e.style.position="relative"),function(e){if(!e.getElementById("detectElementResize")){var n=(b||"")+".resize-triggers { "+(y||"")+'visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; z-index: -1; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',r=e.head||e.getElementsByTagName("head")[0],i=e.createElement("style");i.id="detectElementResize",i.type="text/css",null!=t&&i.setAttribute("nonce",t),i.styleSheet?i.styleSheet.cssText=n:i.appendChild(e.createTextNode(n)),r.appendChild(i)}}(i),e.__resizeLast__={},e.__resizeListeners__=[],(e.__resizeTriggers__=i.createElement("div")).className="resize-triggers",e.__resizeTriggers__.innerHTML='<div class="expand-trigger"><div></div></div><div class="contract-trigger"></div>',e.appendChild(e.__resizeTriggers__),c(e),e.addEventListener("scroll",u,!0),f&&(e.__resizeTriggers__.__animationListener__=function(t){t.animationName==g&&c(e)},e.__resizeTriggers__.addEventListener(f,e.__resizeTriggers__.__animationListener__))}e.__resizeListeners__.push(r)}},removeResizeListener:function(e,t){if(a)e.detachEvent("onresize",t);else if(e.__resizeListeners__.splice(e.__resizeListeners__.indexOf(t),1),!e.__resizeListeners__.length){e.removeEventListener("scroll",u,!0),e.__resizeTriggers__.__animationListener__&&(e.__resizeTriggers__.removeEventListener(f,e.__resizeTriggers__.__animationListener__),e.__resizeTriggers__.__animationListener__=null);try{e.__resizeTriggers__=!e.removeChild(e.__resizeTriggers__)}catch(n){}}}}}var a=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},u=function(e){function t(){var e,n,r;a(this,t);for(var i=arguments.length,o=Array(i),s=0;s<i;s++)o[s]=arguments[s];return n=r=c(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),r.state={height:r.props.defaultHeight||0,width:r.props.defaultWidth||0},r._onResize=function(){var e=r.props,t=e.disableHeight,n=e.disableWidth,i=e.onResize;if(r._parentNode){var a=r._parentNode.offsetHeight||0,o=r._parentNode.offsetWidth||0,s=window.getComputedStyle(r._parentNode)||{},c=parseInt(s.paddingLeft,10)||0,u=parseInt(s.paddingRight,10)||0,l=parseInt(s.paddingTop,10)||0,h=parseInt(s.paddingBottom,10)||0,f=a-l-h,p=o-c-u;(!t&&r.state.height!==f||!n&&r.state.width!==p)&&(r.setState({height:a-l-h,width:o-c-u}),i({height:a,width:o}))}},r._setRef=function(e){r._autoSizer=e},c(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"componentDidMount",value:function(){var e=this.props.nonce;this._autoSizer&&this._autoSizer.parentNode&&this._autoSizer.parentNode.ownerDocument&&this._autoSizer.parentNode.ownerDocument.defaultView&&this._autoSizer.parentNode instanceof this._autoSizer.parentNode.ownerDocument.defaultView.HTMLElement&&(this._parentNode=this._autoSizer.parentNode,this._detectElementResize=i(e),this._detectElementResize.addResizeListener(this._parentNode,this._onResize),this._onResize())}},{key:"componentWillUnmount",value:function(){this._detectElementResize&&this._parentNode&&this._detectElementResize.removeResizeListener(this._parentNode,this._onResize)}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.className,i=e.disableHeight,a=e.disableWidth,o=e.style,c=this.state,u=c.height,l=c.width,h={overflow:"visible"},f={},p=!1;return i||(0===u&&(p=!0),h.height=0,f.height=u),a||(0===l&&(p=!0),h.width=0,f.width=l),Object(r.createElement)("div",{className:n,ref:this._setRef,style:s({},h,o)},!p&&t(f))}}]),t}(r.PureComponent);u.defaultProps={onResize:function(){},disableHeight:!1,disableWidth:!1,style:{}},t.a=u}).call(this,n("yLpj"))},lC2f:function(e,t,n){"use strict";function r(e,t){if(void 0===t&&(t=5),"string"==typeof e)return e.slice(0,t);if(ArrayBuffer.isView(e))return i(e.buffer,e.byteOffset,t);if(e instanceof ArrayBuffer){return i(e,0,t)}return""}function i(e,t,n){if(e.byteLength<=t+n)return"";for(var r=new DataView(e),i="",a=0;a<n;a++)i+=String.fromCharCode(r.getUint8(t+a));return i}n.d(t,"a",(function(){return r}))},ngZ5:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s}));var r=n("P+ME"),i=n("itLl");function a(e,t){return Object(r.a)(e>=0),Object(r.a)(t>0),e+(t-1)&~(t-1)}function o(e,t,n){return Object(i.c)(e,t,n)}function s(e,t,n){var r;if(e instanceof ArrayBuffer)r=new Uint8Array(e);else{var i=e.byteOffset,o=e.byteLength;r=new Uint8Array(e.buffer||e.arrayBuffer,i,o)}return t.set(r,n),n+a(r.byteLength,4)}},rOwd:function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"c",(function(){return L})),n.d(t,"b",(function(){return Z})),n.d(t,"d",(function(){return B}));var r=Object.freeze({OUTSIDE:-1,INTERSECTING:0,INSIDE:1}),i=n("1OyB"),a=n("vuIU"),o=n("zXfU"),s=new o.a,c=new o.a,u=(function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Object(i.a)(this,e),r=r||s.copy(t).add(n).scale(.5),this.center=new o.a(r),this.halfDiagonal=new o.a(n).subtract(this.center),this.minimum=new o.a(t),this.maximum=new o.a(n)}Object(a.a)(e,[{key:"clone",value:function(){return new e(this.minimum,this.maximum,this.center)}},{key:"equals",value:function(e){return this===e||Boolean(e)&&this.minimum.equals(e.minimum)&&this.maximum.equals(e.maximum)}},{key:"intersectPlane",value:function(e){var t=this.halfDiagonal,n=c.from(e.normal),i=t.x*Math.abs(n.x)+t.y*Math.abs(n.y)+t.z*Math.abs(n.z),a=this.center.dot(n)+e.distance;return a-i>0?r.INSIDE:a+i<0?r.OUTSIDE:r.INTERSECTING}},{key:"distanceTo",value:function(e){return Math.sqrt(this.distanceSquaredTo(e))}},{key:"distanceSquaredTo",value:function(e){var t,n=s.from(e).subtract(this.center),r=this.halfDiagonal,i=0;return(t=Math.abs(n.x)-r.x)>0&&(i+=t*t),(t=Math.abs(n.y)-r.y)>0&&(i+=t*t),(t=Math.abs(n.z)-r.z)>0&&(i+=t*t),i}}])}(),n("ZaHm")),l=new o.a,h=new o.a,f=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(i.a)(this,e),this.radius=-0,this.center=new o.a,this.fromCenterRadius(t,n)}return Object(a.a)(e,[{key:"fromCenterRadius",value:function(e,t){return this.center.from(e),this.radius=t,this}},{key:"fromCornerPoints",value:function(e,t){return t=l.from(t),this.center=(new o.a).from(e).add(t).scale(.5),this.radius=this.center.distance(t),this}},{key:"equals",value:function(e){return this===e||Boolean(e)&&this.center.equals(e.center)&&this.radius===e.radius}},{key:"clone",value:function(){return new e(this.center,this.radius)}},{key:"union",value:function(e){var t=this.center,n=this.radius,r=e.center,i=e.radius,a=l.copy(r).subtract(t),o=a.magnitude();if(n>=o+i)return this.clone();if(i>=o+n)return e.clone();var s=.5*(n+o+i);return h.copy(a).scale((-n+s)/o).add(t),this.center.copy(h),this.radius=s,this}},{key:"expand",value:function(e){var t=(e=l.from(e)).subtract(this.center).magnitude();return t>this.radius&&(this.radius=t),this}},{key:"intersectPlane",value:function(e){var t=this.center,n=this.radius,i=e.normal.dot(t)+e.distance;return i<-n?r.OUTSIDE:i<n?r.INTERSECTING:r.INSIDE}},{key:"transform",value:function(e){this.center.transform(e);var t=u.e(l,e);return this.radius=Math.max(t[0],Math.max(t[1],t[2]))*this.radius,this}},{key:"distanceSquaredTo",value:function(e){return(e=l.from(e)).subtract(this.center).lengthSquared()-this.radius*this.radius}},{key:"distanceTo",value:function(e){return Math.sqrt(this.distanceSquaredTo(e))}}]),e}(),p=n("KQm4"),d=n("GA6j"),v=n("Xjzu"),m=new o.a,g=new o.a,b=new o.a,y=new o.a,_=new o.a,O=new o.a,j=new o.a,w=new o.a,S=new o.a,T=new o.a,E=0,x=1,P=2,M=3,A=4,k=5,R=6,C=7,I=8,L=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0,0,0,0,0,0,0];Object(i.a)(this,e),this.center=(new o.a).from(t),this.halfAxes=new d.a(n)}return Object(a.a)(e,[{key:"fromCenterHalfSizeQuaternion",value:function(e,t,n){var r=new v.a(n),i=(new d.a).fromQuaternion(r);return i[0]=i[0]*t[0],i[1]=i[1]*t[0],i[2]=i[2]*t[0],i[3]=i[3]*t[1],i[4]=i[4]*t[1],i[5]=i[5]*t[1],i[6]=i[6]*t[2],i[7]=i[7]*t[2],i[8]=i[8]*t[2],this.center=(new o.a).from(e),this.halfAxes=i,this}},{key:"clone",value:function(){return new e(this.center,this.halfAxes)}},{key:"equals",value:function(e){return this===e||Boolean(e)&&this.center.equals(e.center)&&this.halfAxes.equals(e.halfAxes)}},{key:"getBoundingSphere",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new f,t=this.halfAxes,n=t.getColumn(0,w),r=t.getColumn(1,S),i=t.getColumn(2,T),a=m.copy(n).add(r).add(i);return e.center.copy(this.center),e.radius=a.magnitude(),e}},{key:"intersectPlane",value:function(e){var t=this.center,n=e.normal,i=this.halfAxes,a=n.x,o=n.y,s=n.z,c=Math.abs(a*i[E]+o*i[x]+s*i[P])+Math.abs(a*i[M]+o*i[A]+s*i[k])+Math.abs(a*i[R]+o*i[C]+s*i[I]),u=n.dot(t)+e.distance;return u<=-c?r.OUTSIDE:u>=c?r.INSIDE:r.INTERSECTING}},{key:"distanceTo",value:function(e){return Math.sqrt(this.distanceSquaredTo(e))}},{key:"distanceSquaredTo",value:function(e){var t=g.from(e).subtract(this.center),n=this.halfAxes,r=n.getColumn(0,b),i=n.getColumn(1,y),a=n.getColumn(2,_),o=r.magnitude(),s=i.magnitude(),c=a.magnitude();r.normalize(),i.normalize(),a.normalize();var u,l=0;return(u=Math.abs(t.dot(r))-o)>0&&(l+=u*u),(u=Math.abs(t.dot(i))-s)>0&&(l+=u*u),(u=Math.abs(t.dot(a))-c)>0&&(l+=u*u),l}},{key:"computePlaneDistances",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[-0,-0],r=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,a=this.center,o=this.halfAxes,s=o.getColumn(0,b),c=o.getColumn(1,y),u=o.getColumn(2,_),l=O.copy(s).add(c).add(u).add(a),h=j.copy(l).subtract(e),f=t.dot(h);return r=Math.min(f,r),i=Math.max(f,i),l.copy(a).add(s).add(c).subtract(u),h.copy(l).subtract(e),f=t.dot(h),r=Math.min(f,r),i=Math.max(f,i),l.copy(a).add(s).subtract(c).add(u),h.copy(l).subtract(e),f=t.dot(h),r=Math.min(f,r),i=Math.max(f,i),l.copy(a).add(s).subtract(c).subtract(u),h.copy(l).subtract(e),f=t.dot(h),r=Math.min(f,r),i=Math.max(f,i),a.copy(l).subtract(s).add(c).add(u),h.copy(l).subtract(e),f=t.dot(h),r=Math.min(f,r),i=Math.max(f,i),a.copy(l).subtract(s).add(c).subtract(u),h.copy(l).subtract(e),f=t.dot(h),r=Math.min(f,r),i=Math.max(f,i),a.copy(l).subtract(s).subtract(c).add(u),h.copy(l).subtract(e),f=t.dot(h),r=Math.min(f,r),i=Math.max(f,i),a.copy(l).subtract(s).subtract(c).subtract(u),h.copy(l).subtract(e),f=t.dot(h),r=Math.min(f,r),i=Math.max(f,i),n[0]=r,n[1]=i,n}},{key:"getTransform",value:function(){}},{key:"halfSize",get:function(){var e=this.halfAxes.getColumn(0),t=this.halfAxes.getColumn(1),n=this.halfAxes.getColumn(2);return[new o.a(e).len(),new o.a(t).len(),new o.a(n).len()]}},{key:"quaternion",get:function(){var e=this.halfAxes.getColumn(0),t=this.halfAxes.getColumn(1),n=this.halfAxes.getColumn(2),r=new o.a(e).normalize(),i=new o.a(t).normalize(),a=new o.a(n).normalize();return(new v.a).fromMatrix3(new d.a([].concat(Object(p.a)(r),Object(p.a)(i),Object(p.a)(a))))}}]),e}(),N=n("tS8E"),D=n("a3TU"),z=new o.a,U=new o.a,B=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,1],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(i.a)(this,e),this.normal=new o.a,this.distance=-0,this.fromNormalDistance(t,n)}return Object(a.a)(e,[{key:"fromNormalDistance",value:function(e,t){return Object(N.a)(Number.isFinite(t)),this.normal.from(e).normalize(),this.distance=t,this}},{key:"fromPointNormal",value:function(e,t){e=z.from(e),this.normal.from(t).normalize();var n=-this.normal.dot(e);return this.distance=n,this}},{key:"fromCoefficients",value:function(e,t,n,r){return this.normal.set(e,t,n),Object(N.a)(Object(D.d)(this.normal.len(),1)),this.distance=r,this}},{key:"clone",value:function(t){return new e(this.normal,this.distance)}},{key:"equals",value:function(e){return Object(D.d)(this.distance,e.distance)&&Object(D.d)(this.normal,e.normal)}},{key:"getPointDistance",value:function(e){return this.normal.dot(e)+this.distance}},{key:"transform",value:function(e){var t=U.copy(this.normal).transformAsVector(e).normalize(),n=this.normal.scale(-this.distance).transform(e);return this.fromPointNormal(n,t)}},{key:"projectPointOntoPlane",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];e=z.from(e);var n=this.getPointDistance(e),r=U.copy(this.normal).scale(n);return e.subtract(r).to(t)}}]),e}();function V(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return F(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return F(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var G=[new o.a([1,0,0]),new o.a([0,1,0]),new o.a([0,0,1])],q=new o.a,H=new o.a,Z=(new B(new o.a(1,0,0),0),function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Object(i.a)(this,e),this.planes=t,Object(N.a)(this.planes.every((function(e){return e instanceof B})))}return Object(a.a)(e,null,[{key:"MASK_OUTSIDE",get:function(){return 4294967295}},{key:"MASK_INSIDE",get:function(){return 0}},{key:"MASK_INDETERMINATE",get:function(){return 2147483647}}]),Object(a.a)(e,[{key:"fromBoundingSphere",value:function(e){this.planes.length=2*G.length;var t,n=e.center,r=e.radius,i=0,a=V(G);try{for(a.s();!(t=a.n()).done;){var o=t.value,s=this.planes[i],c=this.planes[i+1];s||(s=this.planes[i]=new B),c||(c=this.planes[i+1]=new B);var u=q.copy(o).scale(-r).add(n);o.dot(u);s.fromPointNormal(u,o);var l=q.copy(o).scale(r).add(n),h=H.copy(o).negate();h.dot(l);c.fromPointNormal(l,h),i+=2}}catch(f){a.e(f)}finally{a.f()}return this}},{key:"computeVisibility",value:function(e){Object(N.a)(e);var t,n=r.INSIDE,i=V(this.planes);try{for(i.s();!(t=i.n()).done;){var a=t.value;switch(e.intersectPlane(a)){case r.OUTSIDE:return r.OUTSIDE;case r.INTERSECTING:n=r.INTERSECTING}}}catch(o){i.e(o)}finally{i.f()}return n}},{key:"computeVisibilityWithPlaneMask",value:function(t,n){if(Object(N.a)(t,"boundingVolume is required."),Object(N.a)(Number.isFinite(n),"parentPlaneMask is required."),n===e.MASK_OUTSIDE||n===e.MASK_INSIDE)return n;for(var i=e.MASK_INSIDE,a=this.planes,o=0;o<this.planes.length;++o){var s=o<31?1<<o:0;if(!(o<31&&0==(n&s))){var c=a[o],u=t.intersectPlane(c);if(u===r.OUTSIDE)return e.MASK_OUTSIDE;u===r.INTERSECTING&&(i|=s)}}return i}}]),e}()),W=n("rePB"),K=n("Nw31");function X(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?X(Object(n),!0).forEach((function(t){Object(W.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Q=new o.a,J=new o.a,$=new o.a,ee=new o.a,te=new o.a,ne=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(i.a)(this,e),t=Y({near:1,far:5e8},t),this.left=t.left,this._left=void 0,this.right=t.right,this._right=void 0,this.top=t.top,this._top=void 0,this.bottom=t.bottom,this._bottom=void 0,this.near=t.near,this._near=this.near,this.far=t.far,this._far=this.far,this._cullingVolume=new Z([new B,new B,new B,new B,new B,new B]),this._perspectiveMatrix=new K.a,this._infinitePerspective=new K.a}return Object(a.a)(e,[{key:"clone",value:function(){return new e({right:this.right,left:this.left,top:this.top,bottom:this.bottom,near:this.near,far:this.far})}},{key:"equals",value:function(t){return t&&t instanceof e&&this.right===t.right&&this.left===t.left&&this.top===t.top&&this.bottom===t.bottom&&this.near===t.near&&this.far===t.far}},{key:"computeCullingVolume",value:function(e,t,n){Object(N.a)(e,"position is required."),Object(N.a)(t,"direction is required."),Object(N.a)(n,"up is required.");var r=this._cullingVolume.planes;n=Q.copy(n).normalize();var i=J.copy(t).cross(n).normalize(),a=$.copy(t).multiplyByScalar(this.near).add(e),s=ee.copy(t).multiplyByScalar(this.far).add(e),c=te;return c.copy(i).multiplyByScalar(this.left).add(a).subtract(e).cross(n),r[0].fromPointNormal(e,c),c.copy(i).multiplyByScalar(this.right).add(a).subtract(e).cross(n).negate(),r[1].fromPointNormal(e,c),c.copy(n).multiplyByScalar(this.bottom).add(a).subtract(e).cross(i).negate(),r[2].fromPointNormal(e,c),c.copy(n).multiplyByScalar(this.top).add(a).subtract(e).cross(i),r[3].fromPointNormal(e,c),c=(new o.a).copy(t),r[4].fromPointNormal(a,c),c.negate(),r[5].fromPointNormal(s,c),this._cullingVolume}},{key:"getPixelDimensions",value:function(e,t,n,r){re(this),Object(N.a)(Number.isFinite(e)&&Number.isFinite(t)),Object(N.a)(e>0),Object(N.a)(t>0),Object(N.a)(n>0),Object(N.a)(r);var i=1/this.near,a=this.top*i,o=2*n*a/t,s=2*n*(a=this.right*i)/e;return r.x=s,r.y=o,r}},{key:"projectionMatrix",get:function(){return re(this),this._perspectiveMatrix}},{key:"infiniteProjectionMatrix",get:function(){return re(this),this._infinitePerspective}}]),e}();function re(e){Object(N.a)(Number.isFinite(e.right)&&Number.isFinite(e.left)&&Number.isFinite(e.top)&&Number.isFinite(e.bottom)&&Number.isFinite(e.near)&&Number.isFinite(e.far));var t=e.top,n=e.bottom,r=e.right,i=e.left,a=e.near,o=e.far;t===e._top&&n===e._bottom&&i===e._left&&r===e._right&&a===e._near&&o===e._far||(Object(N.a)(e.near>0&&e.near<e.far,"near must be greater than zero and less than far."),e._left=i,e._right=r,e._top=t,e._bottom=n,e._near=a,e._far=o,e._perspectiveMatrix=(new K.a).frustum({left:i,right:r,bottom:n,top:t,near:a,far:o}),e._infinitePerspective=(new K.a).frustum({left:i,right:r,bottom:n,top:t,near:a,far:1/0}))}function ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ae(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ie(Object(n),!0).forEach((function(t){Object(W.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}!function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(i.a)(this,e),t=ae({near:1,far:5e8,xOffset:0,yOffset:0},t),this._offCenterFrustum=new ne,this.fov=t.fov,this._fov=void 0,this._fovy=void 0,this._sseDenominator=void 0,this.aspectRatio=t.aspectRatio,this._aspectRatio=void 0,this.near=t.near,this._near=this.near,this.far=t.far,this._far=this.far,this.xOffset=t.xOffset,this._xOffset=this.xOffset,this.yOffset=t.yOffset,this._yOffset=this.yOffset}Object(a.a)(e,[{key:"clone",value:function(){return new e({aspectRatio:this.aspectRatio,fov:this.fov,near:this.near,far:this.far})}},{key:"equals",value:function(t){return null!=t&&t instanceof e&&(oe(this),oe(t),this.fov===t.fov&&this.aspectRatio===t.aspectRatio&&this.near===t.near&&this.far===t.far&&this._offCenterFrustum.equals(t._offCenterFrustum))}},{key:"computeCullingVolume",value:function(e,t,n){return oe(this),this._offCenterFrustum.computeCullingVolume(e,t,n)}},{key:"getPixelDimensions",value:function(e,t,n,r){return oe(this),this._offCenterFrustum.getPixelDimensions(e,t,n,r)}},{key:"projectionMatrix",get:function(){return oe(this),this._offCenterFrustum.projectionMatrix}},{key:"infiniteProjectionMatrix",get:function(){return oe(this),this._offCenterFrustum.infiniteProjectionMatrix}},{key:"fovy",get:function(){return oe(this),this._fovy}},{key:"sseDenominator",get:function(){return oe(this),this._sseDenominator}}])}();function oe(e){Object(N.a)(Number.isFinite(e.fov)&&Number.isFinite(e.aspectRatio)&&Number.isFinite(e.near)&&Number.isFinite(e.far));var t=e._offCenterFrustum;e.fov===e._fov&&e.aspectRatio===e._aspectRatio&&e.near===e._near&&e.far===e._far&&e.xOffset===e._xOffset&&e.yOffset===e._yOffset||(Object(N.a)(e.fov>=0&&e.fov<Math.PI),Object(N.a)(e.aspectRatio>0),Object(N.a)(e.near>=0&&e.near<e.far),e._aspectRatio=e.aspectRatio,e._fov=e.fov,e._fovy=e.aspectRatio<=1?e.fov:2*Math.atan(Math.tan(.5*e.fov)/e.aspectRatio),e._near=e.near,e._far=e.far,e._sseDenominator=2*Math.tan(.5*e._fovy),e._xOffset=e.xOffset,e._yOffset=e.yOffset,t.top=e.near*Math.tan(.5*e._fovy),t.bottom=-t.top,t.right=e.aspectRatio*t.top,t.left=-t.right,t.near=e.near,t.far=e.far,t.right+=e.xOffset,t.left+=e.xOffset,t.top+=e.yOffset,t.bottom+=e.yOffset)}new o.a,new o.a,new o.a,new o.a,new o.a,new o.a,new o.a,new o.a,new o.a,new o.a,new o.a,new o.a,Math.PI;n("gOKY"),new d.a,new d.a,new d.a,new d.a,new d.a;new o.a,new o.a,new o.a,new o.a,new o.a,new d.a,new d.a,new d.a},"yx+g":function(e,t,n){"use strict";var r={};n.r(r),n.d(r,"decode",(function(){return z})),n.d(r,"encode",(function(){return B}));var i={};n.r(i),n.d(i,"decode",(function(){return K})),n.d(i,"encode",(function(){return X}));var a={};n.r(a),n.d(a,"decode",(function(){return J})),n.d(a,"encode",(function(){return $}));var o={};n.r(o),n.d(o,"decode",(function(){return ne})),n.d(o,"encode",(function(){return re}));var s=n("o0o1"),c=n.n(s),u=n("rePB"),l=(n("wcNg"),n("HaE+")),h=n("gQyj"),f=n("WraG"),p=n("ngZ5");function d(e,t){if(!e)throw new Error(t||"assert failed: gltf")}function v(e,t){if(e.startsWith("data:")||e.startsWith("http:")||e.startsWith("https:"))return e;var n=t.baseUri||t.uri;if(!n)throw new Error("'baseUri' must be provided to resolve relative url "+e);return n.substr(0,n.lastIndexOf("/")+1)+e}function m(e,t,n){var r=e.bufferViews[n];d(r);var i=t[r.buffer];d(i);var a=(r.byteOffset||0)+i.byteOffset;return new Uint8Array(i.arrayBuffer,a,r.byteLength)}var g=n("1Nab"),b=n("vuIU"),y=n("9upa");var _=["SCALAR","VEC2","VEC3","VEC4"],O=new Map([[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126],[Float64Array,5130]]),j={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},w={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},S={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function T(e){return _[e-1]||_[0]}function E(e){var t=O.get(e.constructor);if(!t)throw new Error("Illegal typed array");return t}function x(e,t){var n=S[e.componentType],r=j[e.type],i=w[e.componentType],a=e.count*r,o=e.count*r*i;return d(o>=0&&o<=t.byteLength),{ArrayType:n,length:a,byteLength:o}}function P(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return M(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return M(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var A=function(){function e(t){if(t instanceof e)return t;t||(t={json:{asset:{version:"2.0",generator:"loaders.gl"},buffers:[]},buffers:[]}),this.sourceBuffers=[],this.byteLength=0,t.buffers&&t.buffers[0]&&(this.byteLength=t.buffers[0].byteLength,this.sourceBuffers=[t.buffers[0]]),this.gltf=t,d(this.gltf.json)}var t=e.prototype;return t.getApplicationData=function(e){return this.json[e]},t.getExtraData=function(e){return(this.json.extras||{})[e]},t.getExtension=function(e){var t=this.getUsedExtensions().find((function(t){return t===e})),n=this.json.extensions||{};return t?n[e]||!0:null},t.getRequiredExtension=function(e){return this.getRequiredExtensions().find((function(t){return t===e}))?this.getExtension(e):null},t.getRequiredExtensions=function(){return this.json.extensionsRequired||[]},t.getUsedExtensions=function(){return this.json.extensionsUsed||[]},t.getObjectExtension=function(e,t){return(e.extensions||{})[t]},t.getScene=function(e){return this.getObject("scenes",e)},t.getNode=function(e){return this.getObject("nodes",e)},t.getSkin=function(e){return this.getObject("skins",e)},t.getMesh=function(e){return this.getObject("meshes",e)},t.getMaterial=function(e){return this.getObject("materials",e)},t.getAccessor=function(e){return this.getObject("accessors",e)},t.getCamera=function(e){return null},t.getTexture=function(e){return this.getObject("textures",e)},t.getSampler=function(e){return this.getObject("samplers",e)},t.getImage=function(e){return this.getObject("images",e)},t.getBufferView=function(e){return this.getObject("bufferViews",e)},t.getBuffer=function(e){return this.getObject("buffers",e)},t.getObject=function(e,t){if("object"==typeof t)return t;var n=this.json[e]&&this.json[e][t];if(!n)throw new Error("glTF file error: Could not find "+e+"["+t+"]");return n},t.getTypedArrayForBufferView=function(e){var t=(e=this.getBufferView(e)).buffer,n=this.gltf.buffers[t];d(n);var r=(e.byteOffset||0)+n.byteOffset;return new Uint8Array(n.arrayBuffer,r,e.byteLength)},t.getTypedArrayForAccessor=function(e){e=this.getAccessor(e);var t=this.getBufferView(e.bufferView),n=this.getBuffer(t.buffer).data,r=x(e,t),i=r.ArrayType,a=r.length;return new i(n,t.byteOffset+e.byteOffset,a)},t.getTypedArrayForImageData=function(e){e=this.getAccessor(e);var t=this.getBufferView(e.bufferView),n=this.getBuffer(t.buffer).data,r=t.byteOffset||0;return new Uint8Array(n,r,t.byteLength)},t.addApplicationData=function(e,t){return this.json[e]=t,this},t.addExtraData=function(e,t){return this.json.extras=this.json.extras||{},this.json.extras[e]=t,this},t.addObjectExtension=function(e,t,n){return d(n),e.extensions=e.extensions||{},e.extensions[t]=n,this.registerUsedExtension(t),this},t.setObjectExtension=function(e,t,n){(e.extensions||{})[t]=n},t.removeObjectExtension=function(e,t){var n=e.extensions||{},r=n[t];return delete n[t],r},t.addExtension=function(e,t){return void 0===t&&(t={}),d(t),this.json.extensions=this.json.extensions||{},this.json.extensions[e]=t,this.registerUsedExtension(e),t},t.addRequiredExtension=function(e,t){return void 0===t&&(t={}),d(t),this.addExtension(e,t),this.registerRequiredExtension(e),t},t.registerUsedExtension=function(e){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find((function(t){return t===e}))||this.json.extensionsUsed.push(e)},t.registerRequiredExtension=function(e){this.registerUsedExtension(e),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find((function(t){return t===e}))||this.json.extensionsRequired.push(e)},t.removeExtension=function(e){this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,e),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,e),this.json.extensions&&delete this.json.extensions[e]},t.setDefaultScene=function(e){this.json.scene=e},t.addScene=function(e){var t=e.nodeIndices;return this.json.scenes=this.json.scenes||[],this.json.scenes.push({nodes:t}),this.json.scenes.length-1},t.addNode=function(e){var t=e.meshIndex,n=e.matrix,r=void 0===n?null:n;this.json.nodes=this.json.nodes||[];var i={mesh:t};return r&&(i.matrix=r),this.json.nodes.push(i),this.json.nodes.length-1},t.addMesh=function(e){var t=e.attributes,n=e.indices,r=e.material,i=e.mode,a=void 0===i?4:i,o={primitives:[{attributes:this._addAttributes(t),mode:a}]};if(n){var s=this._addIndices(n);o.primitives[0].indices=s}return Number.isFinite(r)&&(o.primitives[0].material=r),this.json.meshes=this.json.meshes||[],this.json.meshes.push(o),this.json.meshes.length-1},t.addPointCloud=function(e){var t={primitives:[{attributes:this._addAttributes(e),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(t),this.json.meshes.length-1},t.addImage=function(e,t){var n,r;t=t||(n=e,(r=Object(y.a)(n))?r.mimeType:null);var i={bufferView:this.addBufferView(e),mimeType:t};return this.json.images=this.json.images||[],this.json.images.push(i),this.json.images.length-1},t.addBufferView=function(e){var t=e.byteLength;d(Number.isFinite(t)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(e);var n={buffer:0,byteOffset:this.byteLength,byteLength:t};return this.byteLength+=Object(p.c)(t,4),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(n),this.json.bufferViews.length-1},t.addAccessor=function(e,t){var n={bufferView:e,type:T(t.size),componentType:t.componentType,count:t.count,max:t.max,min:t.min};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(n),this.json.accessors.length-1},t.addBinaryBuffer=function(e,t){void 0===t&&(t={size:3});var n=this.addBufferView(e),r={min:t.min,max:t.max};r.min&&r.max||(r=this._getAccessorMinMax(e,t.size));var i={size:t.size,componentType:E(e),count:Math.round(e.length/t.size),min:r.min,max:r.max};return this.addAccessor(n,Object.assign(i,t))},t.addTexture=function(e){var t={source:e.imageIndex};return this.json.textures=this.json.textures||[],this.json.textures.push(t),this.json.textures.length-1},t.addMaterial=function(e){return this.json.materials=this.json.materials||[],this.json.materials.push(e),this.json.materials.length-1},t.createBinaryChunk=function(){this.gltf.buffers=[];for(var e=this.byteLength,t=new ArrayBuffer(e),n=new Uint8Array(t),r=0,i=0;i<this.sourceBuffers.length;i++){var a=this.sourceBuffers[i];r=Object(p.a)(a,n,r)}this.json.buffers[0]=this.json.buffers[0]||{},this.json.buffers[0].byteLength=e,this.gltf.binary=t,this.sourceBuffers=[t]},t._removeStringFromArray=function(e,t){for(var n=!0;n;){var r=e.indexOf(t);r>-1?e.splice(r,1):n=!1}},t._addAttributes=function(e){void 0===e&&(e={});var t={};for(var n in e){var r=e[n],i=this._getGltfAttributeName(n),a=this.addBinaryBuffer(r.value,r);t[i]=a}return t},t._addIndices=function(e){return this.addBinaryBuffer(e,{size:1})},t._getGltfAttributeName=function(e){switch(e.toLowerCase()){case"position":case"positions":case"vertices":return"POSITION";case"normal":case"normals":return"NORMAL";case"color":case"colors":return"COLOR_0";case"texcoord":case"texcoords":return"TEXCOORD_0";default:return e}},t._getAccessorMinMax=function(e,t){var n={min:null,max:null};if(e.length<t)return n;n.min=[],n.max=[];for(var r,i=P(e.subarray(0,t));!(r=i()).done;){var a=r.value;n.min.push(a),n.max.push(a)}for(var o=t;o<e.length;o+=t)for(var s=0;s<t;s++)n.min[0+s]=Math.min(n.min[0+s],e[o+s]),n.max[0+s]=Math.max(n.max[0+s],e[o+s]);return n},Object(b.a)(e,[{key:"json",get:function(){return this.gltf.json}}]),e}();function k(e){var t={};for(var n in e){var r=e[n];if("indices"!==n){var i=R(r);t[n]=i}}return t}function R(e,t){var n=function(e,t){var n=e,r=1,i=0;e&&e.value&&(n=e.value,r=e.size||1);n&&(ArrayBuffer.isView(n)||(n=function(e,t,n){void 0===n&&(n=!1);if(!e)return null;if(Array.isArray(e))return new t(e);if(n&&!(e instanceof t))return new t(e);return e}(n,Float32Array)),i=n.length/r);return{buffer:n,size:r,count:i}}(e),r=n.buffer,i=n.size;return{value:r,size:i,bufferView:null,byteOffset:0,count:n.count,type:T(i),componentType:E(r)}}function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){Object(u.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var L=c.a.mark(H);function N(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return D(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return D(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function z(e,t,n){return U.apply(this,arguments)}function U(){return(U=Object(l.a)(c.a.mark((function e(t,n,r){var i,a,o,s,u;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.gltf.decompressMeshes){e.next=2;break}return e.abrupt("return");case 2:for(i=new A(t),a=[],o=N(H(i));!(s=o()).done;)u=s.value,i.getObjectExtension(u,"KHR_draco_mesh_compression")&&a.push(V(u,i,n,r));return e.next=7,Promise.all(a);case 7:i.removeExtension("KHR_draco_mesh_compression");case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function B(e,t){void 0===t&&(t={});for(var n,r=new A(e),i=N(r.json.meshes||[]);!(n=i()).done;){G(n.value,t),r.addRequiredExtension("KHR_draco_mesh_compression")}}function V(e,t,n,r){return F.apply(this,arguments)}function F(){return(F=Object(l.a)(c.a.mark((function e(t,n,r,i){var a,o,s,u,l,h;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.getObjectExtension(t,"KHR_draco_mesh_compression"),o=n.getTypedArrayForBufferView(a.bufferView),s=Object(p.b)(o.buffer,o.byteOffset),u=i.parse,delete(l=I({},r))["3d-tiles"],e.next=8,u(s,g.a,l,i);case 8:h=e.sent,t.attributes=k(h.attributes),h.indices&&(t.indices=R(h.indices)),q(t);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function G(e,t,n,r,i){var a;if(void 0===n&&(n=4),!r.DracoWriter||!r.DracoLoader)throw new Error("DracoWriter/DracoLoader not available");var o=r.DracoWriter.encodeSync({attributes:e}),s=(0,i.parseSync)({attributes:e}),c=r._addFauxAttributes(s.attributes),u=r.addBufferView(o);return{primitives:[{attributes:c,mode:n,extensions:(a={},a.KHR_draco_mesh_compression={bufferView:u,attributes:c},a)}]}}function q(e){if(!e.attributes&&Object.keys(e.attributes).length>0)throw new Error("Empty glTF primitive detected: Draco decompression failure?")}function H(e){var t,n,r,i,a,o;return c.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:t=N(e.json.meshes||[]);case 1:if((n=t()).done){s.next=12;break}r=n.value,i=N(r.primitives);case 4:if((a=i()).done){s.next=10;break}return o=a.value,s.next=8,o;case 8:s.next=4;break;case 10:s.next=1;break;case 12:case"end":return s.stop()}}),L)}function Z(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return W(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return W(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function W(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function K(e,t){var n=new A(e),r=n.json,i=n.getExtension("KHR_lights_punctual");i&&(n.json.lights=i.lights,n.removeExtension("KHR_lights_punctual"));for(var a,o=Z(r.nodes||[]);!(a=o()).done;){var s=a.value,c=n.getObjectExtension(s,"KHR_lights_punctual");c&&(s.light=c.light),n.removeObjectExtension(s,"KHR_lights_punctual")}}function X(e,t){var n=new A(e),r=n.json;if(r.lights){var i=n.addExtension("KHR_lights_punctual");d(!i.lights),i.lights=r.lights,delete r.lights}if(n.json.lights){for(var a,o=Z(n.json.lights);!(a=o()).done;){var s=a.value,c=s.node;n.addObjectExtension(c,"KHR_lights_punctual",s)}delete n.json.lights}}function Y(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Q(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Q(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function Q(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function J(e,t){var n=new A(e),r=n.json;n.removeExtension("KHR_materials_unlit");for(var i,a=Y(r.materials||[]);!(i=a()).done;){var o=i.value;o.extensions&&o.extensions.KHR_materials_unlit&&(o.unlit=!0),n.removeObjectExtension(o,"KHR_materials_unlit")}}function $(e,t){var n=new A(e),r=n.json;if(n.materials)for(var i,a=Y(r.materials);!(i=a()).done;){var o=i.value;o.unlit&&(delete o.unlit,n.addObjectExtension(o,"KHR_materials_unlit",{}),n.addExtension("KHR_materials_unlit"))}}function ee(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return te(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return te(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function te(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ne(e,t){var n=new A(e),r=n.json,i=n.getExtension("KHR_techniques_webgl");if(i){for(var a,o=function(e,t){var n=e.programs,r=void 0===n?[]:n,i=e.shaders,a=void 0===i?[]:i,o=e.techniques,s=void 0===o?[]:o,c=new TextDecoder;return a.forEach((function(e){if(!Number.isFinite(e.bufferView))throw new Error("KHR_techniques_webgl: no shader code");e.code=c.decode(t.getTypedArrayForBufferView(e.bufferView))})),r.forEach((function(e){e.fragmentShader=a[e.fragmentShader],e.vertexShader=a[e.vertexShader]})),s.forEach((function(e){e.program=r[e.program]})),s}(i,n),s=ee(r.materials||[]);!(a=s()).done;){var c=a.value,u=n.getObjectExtension(c,"KHR_techniques_webgl");u&&(c.technique=Object.assign({},u,o[u.technique]),c.technique.values=ie(c.technique,n)),n.removeObjectExtension(c,"KHR_techniques_webgl")}n.removeExtension("KHR_techniques_webgl")}}function re(e,t){}function ie(e,t){var n=Object.assign({},e.values);return Object.keys(e.uniforms||{}).forEach((function(t){e.uniforms[t].value&&!(t in n)&&(n[t]=e.uniforms[t].value)})),Object.keys(n).forEach((function(e){"object"==typeof n[e]&&void 0!==n[e].index&&(n[e].texture=t.getTexture(n[e].index))})),n}var ae={KHR_draco_mesh_compression:r,KHR_lights_punctual:i,KHR_materials_unlit:a,KHR_techniques_webgl:o};function oe(e,t,n){return se.apply(this,arguments)}function se(){return(se=Object(l.a)(c.a.mark((function e(t,n,r){var i,a,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0===n&&(n={}),n.gltf=n.gltf||{},e.t0=c.a.keys(ae);case 3:if((e.t1=e.t0()).done){e.next=13;break}if(i=e.t1.value,a=n.gltf.excludeExtensions||{},i in a&&!a[i]){e.next=11;break}return o=ae[i],e.next=11,o.decode(t,n,r);case 11:e.next=3;break;case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ce=n("P+ME");function ue(e,t,n){void 0===t&&(t=0),void 0===n&&(n={});var r=new DataView(e),i=n.magic,a=void 0===i?1735152710:i,o=r.getUint32(t,!1);return o===a||1735152710===o}function le(e,t,n,r){void 0===n&&(n=0),void 0===r&&(r={});var i=new DataView(t);e.type=function(e,t){return void 0===t&&(t=0),""+String.fromCharCode(e.getUint8(t+0))+String.fromCharCode(e.getUint8(t+1))+String.fromCharCode(e.getUint8(t+2))+String.fromCharCode(e.getUint8(t+3))}(i,n+0),e.version=i.getUint32(n+4,!0);var a=i.getUint32(n+8,!0);switch(e.header={byteOffset:n,byteLength:a},e.json={},e.binChunks=[],n+=12,e.version){case 1:return function(e,t,n,r){Object(ce.a)(e.header.byteLength>20);var i=t.getUint32(n+0,!0),a=t.getUint32(n+4,!0);return n+=8,Object(ce.a)(0===a),he(e,t,n,i,r),n+=i,n+=fe(e,t,n,e.header.byteLength,r)}(e,i,n,r={});case 2:return function(e,t,n,r){return Object(ce.a)(e.header.byteLength>20),function(e,t,n,r){for(;n+8<=e.header.byteLength;){var i=t.getUint32(n+0,!0),a=t.getUint32(n+4,!0);switch(n+=8,a){case 1313821514:he(e,t,n,i,r);break;case 5130562:fe(e,t,n,i,r);break;case 0:r.glb.strict||he(e,t,n,i,r);break;case 1:r.glb.strict||fe(e,t,n,i,r)}n+=Object(p.c)(i,4)}}(e,t,n,r),n+e.header.byteLength}(e,i,n,r={});default:throw new Error("Invalid GLB version "+e.version+". Only supports v1 and v2.")}}function he(e,t,n,r,i){var a=new Uint8Array(t.buffer,n,r),o=new TextDecoder("utf8").decode(a);return e.json=JSON.parse(o),Object(p.c)(r,4)}function fe(e,t,n,r,i){return e.header.hasBinChunk=!0,e.binChunks.push({byteOffset:n,byteLength:r,arrayBuffer:t.buffer}),Object(p.c)(r,4)}function pe(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return de(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return de(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function de(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ve(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return me(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return me(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function me(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ge,be={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},ye={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"},_e=function(){function e(e){this.idToIndexMap={animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}}}var t=e.prototype;return t.normalize=function(e,t){this.json=e.json;var n=e.json;switch(n.asset&&n.asset.version){case"2.0":return;case void 0:case"1.0":break;default:return void console.warn("glTF: Unknown version "+n.asset.version)}if(!t.normalize)throw new Error("glTF v1 is not supported.");console.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(n),this._convertTopLevelObjectsToArrays(n),function(e,t){for(var n,r=new A(e),i=r.json,a=pe(i.images||[]);!(n=a()).done;){var o=n.value,s=r.removeObjectExtension(o,"KHR_binary_glTF");s&&Object.assign(o,s)}i.buffers&&i.buffers[0]&&delete i.buffers[0].uri,r.removeExtension("KHR_binary_glTF")}(e),this._convertObjectIdsToArrayIndices(n),this._updateObjects(n),this._updateMaterial(n)},t._addAsset=function(e){e.asset=e.asset||{},e.asset.version="2.0",e.asset.generator=e.asset.generator||"Normalized to glTF 2.0 by loaders.gl"},t._convertTopLevelObjectsToArrays=function(e){for(var t in be)this._convertTopLevelObjectToArray(e,t)},t._convertTopLevelObjectToArray=function(e,t){var n=e[t];if(n&&!Array.isArray(n))for(var r in e[t]=[],n){var i=n[r];i.id=i.id||r;var a=e[t].length;e[t].push(i),this.idToIndexMap[t][r]=a}},t._convertObjectIdsToArrayIndices=function(e){for(var t in be)this._convertIdsToIndices(e,t);"scene"in e&&(e.scene=this._convertIdToIndex(e.scene,"scene"));for(var n,r=ve(e.textures);!(n=r()).done;){var i=n.value;this._convertTextureIds(i)}for(var a,o=ve(e.meshes);!(a=o()).done;){var s=a.value;this._convertMeshIds(s)}for(var c,u=ve(e.nodes);!(c=u()).done;){var l=c.value;this._convertNodeIds(l)}for(var h,f=ve(e.scenes);!(h=f()).done;){var p=h.value;this._convertSceneIds(p)}},t._convertTextureIds=function(e){e.source&&(e.source=this._convertIdToIndex(e.source,"image"))},t._convertMeshIds=function(e){for(var t,n=ve(e.primitives);!(t=n()).done;){var r=t.value,i=r.attributes,a=r.indices,o=r.material;for(var s in i)i[s]=this._convertIdToIndex(i[s],"accessor");a&&(r.indices=this._convertIdToIndex(a,"accessor")),o&&(r.material=this._convertIdToIndex(o,"material"))}},t._convertNodeIds=function(e){var t=this;e.children&&(e.children=e.children.map((function(e){return t._convertIdToIndex(e,"node")}))),e.meshes&&(e.meshes=e.meshes.map((function(e){return t._convertIdToIndex(e,"mesh")})))},t._convertSceneIds=function(e){var t=this;e.nodes&&(e.nodes=e.nodes.map((function(e){return t._convertIdToIndex(e,"node")})))},t._convertIdsToIndices=function(e,t){e[t]||(console.warn("gltf v1: json doesn't contain attribute "+t),e[t]=[]);for(var n,r=ve(e[t]);!(n=r()).done;){var i=n.value;for(var a in i){var o=i[a],s=this._convertIdToIndex(o,a);i[a]=s}}},t._convertIdToIndex=function(e,t){var n=ye[t];if(n in this.idToIndexMap){var r=this.idToIndexMap[n][e];if(!Number.isFinite(r))throw new Error("gltf v1: failed to resolve "+t+" with id "+e);return r}return e},t._updateObjects=function(e){for(var t,n=ve(this.json.buffers);!(t=n()).done;){delete t.value.type}},t._updateMaterial=function(e){for(var t,n=function(){var n=t.value;n.pbrMetallicRoughness={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1};var r=n.values&&n.values.tex,i=e.textures.findIndex((function(e){return e.id===r}));-1!==i&&(n.pbrMetallicRoughness.baseColorTexture={index:i})},r=ve(e.materials);!(t=r()).done;)n()},e}();function Oe(e,t){return void 0===t&&(t={}),(new _e).normalize(e,t)}function je(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function we(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?je(Object(n),!0).forEach((function(t){Object(u.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):je(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Se={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Te={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},Ee={TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,REPEAT:10497,LINEAR:9729,NEAREST_MIPMAP_LINEAR:9986},xe={magFilter:Ee.TEXTURE_MAG_FILTER,minFilter:Ee.TEXTURE_MIN_FILTER,wrapS:Ee.TEXTURE_WRAP_S,wrapT:Ee.TEXTURE_WRAP_T},Pe=((ge={})[Ee.TEXTURE_MAG_FILTER]=Ee.LINEAR,ge[Ee.TEXTURE_MIN_FILTER]=Ee.NEAREST_MIPMAP_LINEAR,ge[Ee.TEXTURE_WRAP_S]=Ee.REPEAT,ge[Ee.TEXTURE_WRAP_]=Ee.REPEAT,ge);var Me=function(){function e(){}var t=e.prototype;return t.postProcess=function(e,t){void 0===t&&(t={});var n=e.json,r=e.buffers,i=void 0===r?[]:r,a=e.images,o=void 0===a?[]:a,s=e.baseUri,c=void 0===s?"":s;return d(n),this.baseUri=c,this.json=n,this.buffers=i,this.images=o,this._resolveTree(this.json,t),this.json},t._resolveTree=function(e,t){var n=this;void 0===t&&(t={}),e.bufferViews&&(e.bufferViews=e.bufferViews.map((function(e,t){return n._resolveBufferView(e,t)}))),e.images&&(e.images=e.images.map((function(e,t){return n._resolveImage(e,t)}))),e.samplers&&(e.samplers=e.samplers.map((function(e,t){return n._resolveSampler(e,t)}))),e.textures&&(e.textures=e.textures.map((function(e,t){return n._resolveTexture(e,t)}))),e.accessors&&(e.accessors=e.accessors.map((function(e,t){return n._resolveAccessor(e,t)}))),e.materials&&(e.materials=e.materials.map((function(e,t){return n._resolveMaterial(e,t)}))),e.meshes&&(e.meshes=e.meshes.map((function(e,t){return n._resolveMesh(e,t)}))),e.nodes&&(e.nodes=e.nodes.map((function(e,t){return n._resolveNode(e,t)}))),e.skins&&(e.skins=e.skins.map((function(e,t){return n._resolveSkin(e,t)}))),e.scenes&&(e.scenes=e.scenes.map((function(e,t){return n._resolveScene(e,t)}))),void 0!==e.scene&&(e.scene=e.scenes[this.json.scene])},t.getScene=function(e){return this._get("scenes",e)},t.getNode=function(e){return this._get("nodes",e)},t.getSkin=function(e){return this._get("skins",e)},t.getMesh=function(e){return this._get("meshes",e)},t.getMaterial=function(e){return this._get("materials",e)},t.getAccessor=function(e){return this._get("accessors",e)},t.getCamera=function(e){return null},t.getTexture=function(e){return this._get("textures",e)},t.getSampler=function(e){return this._get("samplers",e)},t.getImage=function(e){return this._get("images",e)},t.getBufferView=function(e){return this._get("bufferViews",e)},t.getBuffer=function(e){return this._get("buffers",e)},t._get=function(e,t){if("object"==typeof t)return t;var n=this.json[e]&&this.json[e][t];return n||console.warn("glTF file error: Could not find "+e+"["+t+"]"),n},t._resolveScene=function(e,t){var n=this;return e.id=e.id||"scene-"+t,e.nodes=(e.nodes||[]).map((function(e){return n.getNode(e)})),e},t._resolveNode=function(e,t){var n=this;return e.id=e.id||"node-"+t,e.children&&(e.children=e.children.map((function(e){return n.getNode(e)}))),void 0!==e.mesh?e.mesh=this.getMesh(e.mesh):void 0!==e.meshes&&e.meshes.length&&(e.mesh=e.meshes.reduce((function(e,t){var r=n.getMesh(t);return e.id=r.id,e.primitives=e.primitives.concat(r.primitives),e}),{primitives:[]})),void 0!==e.camera&&(e.camera=this.getCamera(e.camera)),void 0!==e.skin&&(e.skin=this.getSkin(e.skin)),e},t._resolveSkin=function(e,t){return e.id=e.id||"skin-"+t,e.inverseBindMatrices=this.getAccessor(e.inverseBindMatrices),e},t._resolveMesh=function(e,t){var n=this;return e.id=e.id||"mesh-"+t,e.primitives&&(e.primitives=e.primitives.map((function(e){var t=(e=we({},e)).attributes;for(var r in e.attributes={},t)e.attributes[r]=n.getAccessor(t[r]);return void 0!==e.indices&&(e.indices=n.getAccessor(e.indices)),void 0!==e.material&&(e.material=n.getMaterial(e.material)),e}))),e},t._resolveMaterial=function(e,t){if(e.id=e.id||"material-"+t,e.normalTexture&&(e.normalTexture=we({},e.normalTexture),e.normalTexture.texture=this.getTexture(e.normalTexture.index)),e.occlusionTexture&&(e.occlustionTexture=we({},e.occlustionTexture),e.occlusionTexture.texture=this.getTexture(e.occlusionTexture.index)),e.emissiveTexture&&(e.emmisiveTexture=we({},e.emmisiveTexture),e.emissiveTexture.texture=this.getTexture(e.emissiveTexture.index)),e.emissiveFactor||(e.emissiveFactor=e.emmisiveTexture?[1,1,1]:[0,0,0]),e.pbrMetallicRoughness){e.pbrMetallicRoughness=we({},e.pbrMetallicRoughness);var n=e.pbrMetallicRoughness;n.baseColorTexture&&(n.baseColorTexture=we({},n.baseColorTexture),n.baseColorTexture.texture=this.getTexture(n.baseColorTexture.index)),n.metallicRoughnessTexture&&(n.metallicRoughnessTexture=we({},n.metallicRoughnessTexture),n.metallicRoughnessTexture.texture=this.getTexture(n.metallicRoughnessTexture.index))}return e},t._resolveAccessor=function(e,t){var n,r;if(e.id=e.id||"accessor-"+t,void 0!==e.bufferView&&(e.bufferView=this.getBufferView(e.bufferView)),e.bytesPerComponent=(n=e.componentType,Te[n]),e.components=(r=e.type,Se[r]),e.bytesPerElement=e.bytesPerComponent*e.components,e.bufferView){var i=e.bufferView.buffer,a=x(e,e.bufferView),o=a.ArrayType,s=a.byteLength,c=(e.bufferView.byteOffset||0)+i.byteOffset,u=i.arrayBuffer.slice(c,c+s);e.value=new o(u)}return e},t._resolveTexture=function(e,t){return e.id=e.id||"texture-"+t,e.sampler="sampler"in e?this.getSampler(e.sampler):Pe,e.source=this.getImage(e.source),e},t._resolveSampler=function(e,t){for(var n in e.id=e.id||"sampler-"+t,e.parameters={},e){var r=this._enumSamplerParameter(n);void 0!==r&&(e.parameters[r]=e[n])}return e},t._enumSamplerParameter=function(e){return xe[e]},t._resolveImage=function(e,t){e.id=e.id||"image-"+t,void 0!==e.bufferView&&(e.bufferView=this.getBufferView(e.bufferView));var n=this.images[t];return n&&(e.image=n),e},t._resolveBufferView=function(e,t){e.id=e.id||"bufferView-"+t;var n=e.buffer;e.buffer=this.buffers[n];var r=this.buffers[n].arrayBuffer,i=this.buffers[n].byteOffset||0;return"byteOffset"in e&&(i+=e.byteOffset),e.data=new Uint8Array(r,i,e.byteLength),e},t._resolveCamera=function(e,t){return e.id=e.id||"camera-"+t,e.perspective,e.orthographic,e},e}();function Ae(e,t){return(new Me).postProcess(e,t)}function ke(e,t,n,r,i){return Re.apply(this,arguments)}function Re(){return(Re=Object(l.a)(c.a.mark((function e(t,n,r,i,a){var o,s,u;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===r&&(r=0),Ce(t,n,r,i),Oe(t,{normalize:i.gltf.normalize}),o=[],!i.gltf.loadBuffers||!t.json.buffers){e.next=7;break}return e.next=7,Ie(t,i,a);case 7:return i.gltf.loadImages&&(s=Ne(t,i,a),o.push(s)),u=oe(t,i,a),o.push(u),e.next=12,Promise.all(o);case 12:return e.abrupt("return",i.gltf.postProcess?Ae(t,i):t);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ce(e,t,n,r){(r.uri&&(e.baseUri=r.uri),t instanceof ArrayBuffer&&!ue(t,n,r))&&(t=(new TextDecoder).decode(t));if("string"==typeof t)e.json=Object(f.a)(t);else if(t instanceof ArrayBuffer){var i={};n=le(i,t,n,r),d("glTF"===i.type,"Invalid GLB magic string "+i.type),e._glb=i,e.json=i.json}else d(!1,"GLTF: must be ArrayBuffer or string");var a=e.json.buffers||[];if(e.buffers=new Array(a.length).fill(null),e._glb&&e._glb.header.hasBinChunk){var o=e._glb.binChunks;e.buffers[0]={arrayBuffer:o[0].arrayBuffer,byteOffset:o[0].byteOffset,byteLength:o[0].byteLength}}var s=e.json.images||[];e.images=new Array(s.length).fill({})}function Ie(e,t,n){return Le.apply(this,arguments)}function Le(){return(Le=Object(l.a)(c.a.mark((function e(t,n,r){var i,a,o,s,u,l;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=0;case 1:if(!(i<t.json.buffers.length)){e.next=18;break}if(!(a=t.json.buffers[i]).uri){e.next=15;break}return d(o=r.fetch),s=v(a.uri,n),e.next=9,o(s);case 9:return u=e.sent,e.next=12,u.arrayBuffer();case 12:l=e.sent,t.buffers[i]={arrayBuffer:l,byteOffset:0,byteLength:l.byteLength},delete a.uri;case 15:++i,e.next=1;break;case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ne(e,t,n){return De.apply(this,arguments)}function De(){return(De=Object(l.a)(c.a.mark((function e(t,n,r){var i,a,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(i=t.json.images||[],a=[],o=0;o<i.length;++o)a.push(ze(t,i[o],o,n,r));return e.next=5,Promise.all(a);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ze(e,t,n,r,i){return Ue.apply(this,arguments)}function Ue(){return(Ue=Object(l.a)(c.a.mark((function e(t,n,r,i,a){var o,s,u,l,f,g,b;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=a.fetch,s=a.parse,!n.uri){e.next=9;break}return l=v(n.uri,i),e.next=5,o(l);case 5:return f=e.sent,e.next=8,f.arrayBuffer();case 8:u=e.sent;case 9:return Number.isFinite(n.bufferView)&&(g=m(t.json,t.buffers,n.bufferView),u=Object(p.b)(g.buffer,g.byteOffset,g.byteLength)),d(u,"glTF image has no data"),e.next=13,s(u,h.a,{},a);case 13:b=e.sent,t.images[r]=b;case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ve(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Be(Object(n),!0).forEach((function(t){Object(u.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Fe={id:"gltf",name:"glTF",version:"undefined"!=typeof __VERSION__?__VERSION__:"latest",extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:function(e,t,n){return Ge.apply(this,arguments)},options:{gltf:{normalize:!0,loadBuffers:!0,loadImages:!0,decompressMeshes:!0,postProcess:!0},uri:"",log:console},deprecatedOptions:{fetchImages:"gltf.loadImages",createImages:"gltf.loadImages",decompress:"gltf.decompressMeshes",postProcess:"gltf.postProcess",gltf:{decompress:"gltf.decompressMeshes"}}};t.a=Fe;function Ge(){return(Ge=Object(l.a)(c.a.mark((function e(t,n,r){var i,a,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===n&&(n={}),(n=Ve(Ve({},Fe.options),n)).gltf=Ve(Ve({},Fe.options.gltf),n.gltf),qe(n),i=n.byteOffset,a=void 0===i?0:i,o={},e.next=8,ke(o,t,a,n,r);case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function qe(e){"fetchImages"in e&&(e.gltf.loadImages=e.fetchImages),"createImages"in e&&(e.gltf.loadImages=e.createImages),"fetchLinkedResources"in e&&(e.gltf.fetchBuffers=e.fetchLinkedResources),"decompress"in e&&(e.gltf.decompressMeshes=e.decompress),"decompress"in e.gltf&&(e.gltf.decompressMeshes=e.gltf.decompress),"postProcess"in e&&(e.gltf.postProcess=e.postProcess)}},zLVn:function(e,t,n){"use strict";function r(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}n.d(t,"a",(function(){return r}))}}]);