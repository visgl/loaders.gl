(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"+w+S":function(e,t,n){"use strict";n.d(t,"a",(function(){return I}));var r=n("rePB"),i=n("1OyB"),a=n("vuIU"),o=n("ReuC"),s=n("Ji7U"),c=n("md7G"),u=n("foSv"),l=n("Jh/b"),f=n("K4gp"),p=n("DAeo"),h=n("BQ9P"),d=n("K7jV"),b=n("0i8A"),v=n("DvX1"),m=n("f5Sf"),g=n("ykdB"),y=n("d3kR"),O=n("tMmZ"),_=n("HIr8");function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var i=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}function x(e,t){(e.COLOR_0||e.colors)&&t||(e.colors={constant:!0,value:new Float32Array([1,1,1])}),l.a.assert(e.positions||e.POSITION,'no "postions" or "POSITION" attribute in mesh')}function T(e,t){if(e.attributes)return x(e.attributes,t),e instanceof b.a?e:new b.a(e);if(e.positions||e.POSITION)return x(e,t),new b.a({attributes:e});throw Error("Invalid mesh")}var E={mesh:{value:null,type:"object",async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_useMeshColors:{type:"boolean",value:!1},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:function(e){return e.position}},getColor:{type:"accessor",value:[0,0,0,255]},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]}},I=function(e){Object(s.a)(n,e);var t=S(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"getShaders",value:function(){var e=!Object(v.e)(this.context.gl),t={};return Object(y.b)(this.context.gl,O.a.GLSL_DERIVATIVES)&&(t.DERIVATIVES_AVAILABLE=1),Object(o.a)(Object(u.a)(n.prototype),"getShaders",this).call(this,{vs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-vs\nuniform float sizeScale;\nuniform bool composeModelMatrix;\nin vec3 positions;\nin vec3 normals;\nin vec3 colors;\nin vec2 texCoords;\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\nout vec2 vTexCoord;\nout vec3 cameraPosition;\nout vec3 normals_commonspace;\nout vec4 position_commonspace;\nout vec4 vColor;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = texCoords;\n  geometry.pickingColor = instancePickingColors;\n\n  vTexCoord = texCoords;\n  cameraPosition = project_uCameraPosition;\n  normals_commonspace = project_normal(instanceModelMatrix * normals);\n  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);\n  geometry.normal = normals_commonspace;\n\n  vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;\n\n  if (composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);\n  }\n\n  geometry.position = position_commonspace;\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-fs\n\nprecision highp float;\n\nuniform bool hasTexture;\nuniform sampler2D sampler;\nuniform bool flatShading;\nuniform float opacity;\n\nin vec2 vTexCoord;\nin vec3 cameraPosition;\nin vec3 normals_commonspace;\nin vec4 position_commonspace;\nin vec4 vColor;\n\nout vec4 fragColor;\n\nvoid main(void) {\n  geometry.uv = vTexCoord;\n\n  vec3 normal;\n  if (flatShading) {\n#ifdef DERIVATIVES_AVAILABLE\n    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));\n#else\n    normal = vec3(0.0, 0.0, 1.0);\n#endif\n  } else {\n    normal = normals_commonspace;\n  }\n\n  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;\n  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);\n  fragColor = vec4(lightColor, color.a * opacity);\n\n  DECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",modules:[f.a,p.b,h.a],transpileToGLSL100:e,defines:t})}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:5130,fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:5121,transition:!0,size:this.props.colorFormat.length,normalized:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:_.a}),this.setState({emptyTexture:new m.a(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}},{key:"updateState",value:function(e){var t=e.props,r=e.oldProps,i=e.changeFlags;if(Object(o.a)(Object(u.a)(n.prototype),"updateState",this).call(this,{props:t,oldProps:r,changeFlags:i}),t.mesh!==r.mesh||i.extensionsChanged){var a;if(null===(a=this.state.model)||void 0===a||a.delete(),t.mesh){this.state.model=this.getModel(t.mesh);var s=t.mesh.attributes||t.mesh;this.setState({hasNormals:Boolean(s.NORMAL||s.normals)})}this.getAttributeManager().invalidateAll()}t.texture!==r.texture&&this.setTexture(t.texture),this.state.model&&this.state.model.setDrawMode(this.props.wireframe?3:4)}},{key:"finalizeState",value:function(){Object(o.a)(Object(u.a)(n.prototype),"finalizeState",this).call(this),this.state.emptyTexture.delete()}},{key:"draw",value:function(e){var t=e.uniforms;if(this.state.model){var n=this.context.viewport,r=this.props,i=r.sizeScale,a=r.coordinateSystem,o=r._instanced;this.state.model.setUniforms(t).setUniforms({sizeScale:i,composeModelMatrix:!o||Object(_.b)(n,a),flatShading:!this.state.hasNormals}).draw()}}},{key:"getModel",value:function(e){var t=new g.a(this.context.gl,A(A({},this.getShaders()),{},{id:this.props.id,geometry:T(e,this.props._useMeshColors),isInstanced:!0})),n=this.props.texture,r=this.state.emptyTexture;return t.setUniforms({sampler:n||r,hasTexture:Boolean(n)}),t}},{key:"setTexture",value:function(e){var t=this.state,n=t.emptyTexture,r=t.model;null==r||r.setUniforms({sampler:e||n,hasTexture:Boolean(e)})}}]),n}(d.a);I.layerName="SimpleMeshLayer",I.defaultProps=E},"3SJd":function(e,t,n){"use strict";function r(e){for(var t in e)return!1;return!0}function i(e,t){if(e===t)return!0;var n=Array.isArray(e)||ArrayBuffer.isView(e),r=Array.isArray(t)||ArrayBuffer.isView(t);if(n&&r&&e.length===t.length){for(var i=0;i<e.length;++i)if(e[i]!==t[i])return!1;return!0}return!1}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}))},"9Q0L":function(e,t,n){"use strict";(function(e){n.d(t,"c",(function(){return h})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return b}));var r=n("1OyB"),i=n("vuIU"),a=n("rp2x"),o=n("gXd2"),s=n("Vyni"),c=n("3SJd");function u(e,t){var n=e[t].bind(e);e[t]=function(){var t=arguments.length<=0?void 0:arguments[0];return t in e.state.cache||(e.state.cache[t]=n.apply(void 0,arguments)),e.state.enable?e.state.cache[t]:n.apply(void 0,arguments)},Object.defineProperty(e[t],"name",{value:"".concat(t,"-from-cache"),configurable:!1})}function l(e,t,n){var r=e[t].bind(e);e[t]=function(){for(var t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];var o=n.apply(void 0,[e.state._updateCache].concat(i)),s=o.valueChanged,c=o.oldValue;return s&&r.apply(void 0,i),c},Object.defineProperty(e[t],"name",{value:"".concat(t,"-to-cache"),configurable:!1})}function f(e){var t=e.useProgram.bind(e);e.useProgram=function(n){e.state.program!==n&&(t(n),e.state.program=n)}}var p=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.copyState,s=void 0!==i&&i,c=n.log,u=void 0===c?function(){}:c;Object(r.a)(this,e),this.gl=t,this.program=null,this.stateStack=[],this.enable=!0,this.cache=s?Object(o.a)(t):Object.assign({},a.c),this.log=u,this._updateCache=this._updateCache.bind(this),Object.seal(this)}return Object(i.a)(e,[{key:"push",value:function(){this.stateStack.push({})}},{key:"pop",value:function(){Object(s.a)(this.stateStack.length>0);var e=this.stateStack[this.stateStack.length-1];Object(o.b)(this.gl,e),this.stateStack.pop()}},{key:"_updateCache",value:function(e){var t,n=!1,r=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(var i in e){Object(s.a)(void 0!==i);var a=e[i],o=this.cache[i];Object(c.a)(a,o)||(n=!0,t=o,r&&!(i in r)&&(r[i]=o),this.cache[i]=a)}return{valueChanged:n,oldValue:t}}}]),e}();function h(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.enable,i=void 0===r||r,o=n.copyState;if(Object(s.a)(void 0!==o),!t.state){var c=void 0!==e?e:window,h=c.polyfillContext;for(var d in h&&h(t),t.state=new p(t,{copyState:o}),f(t),a.b){var b=a.b[d];l(t,d,b)}u(t,"getParameter"),u(t,"isEnabled")}return t.state.enable=i,t}function d(e){e.state||h(e,{copyState:!1}),e.state.push()}function b(e){Object(s.a)(e.state),e.state.pop()}}).call(this,n("yLpj"))},FR1t:function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var r=n("rePB"),i=n("1OyB"),a=n("vuIU"),o=n("ReuC"),s=n("Ji7U"),c=n("md7G"),u=n("foSv"),l=n("K4gp"),f=n("DAeo"),p=n("BQ9P"),h=n("K7jV"),d=n("ykdB"),b=n("0i8A");function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(u.a)(e);if(t){var i=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var y=[0,0,0,255],O=[0,0,1],_={sizeUnits:"pixels",pointSize:{type:"number",min:0,value:10},getPosition:{type:"accessor",value:function(e){return e.position}},getNormal:{type:"accessor",value:O},getColor:{type:"accessor",value:y},material:!0,radiusPixels:{deprecatedFor:"pointSize"}};var j=function(e){Object(s.a)(n,e);var t=g(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"getShaders",value:function(){return Object(o.a)(Object(u.a)(n.prototype),"getShaders",this).call(this,{vs:"#define SHADER_NAME point-cloud-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 instanceNormals;\nattribute vec4 instanceColors;\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute vec3 instancePickingColors;\n\nuniform float opacity;\nuniform float radiusPixels;\n\nvarying vec4 vColor;\nvarying vec2 unitPosition;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.normal = project_normal(instanceNormals);\n  unitPosition = positions.xy;\n  geometry.uv = unitPosition;\n  geometry.pickingColor = instancePickingColors;\n  vec3 offset = vec3(positions.xy * radiusPixels, 0.0);\n  DECKGL_FILTER_SIZE(offset, geometry);\n\n  gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.), geometry.position);\n  gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  vec3 lightColor = lighting_getLightColor(instanceColors.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);\n  vColor = vec4(lightColor, instanceColors.a * opacity);\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME point-cloud-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\nvarying vec2 unitPosition;\n\nvoid main(void) {\n  geometry.uv = unitPosition;\n\n  float distToCenter = length(unitPosition);\n\n  if (distToCenter > 1.0) {\n    discard;\n  }\n\n  gl_FragColor = vColor;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[l.a,f.a,p.a]})}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceNormals:{size:3,transition:!0,accessor:"getNormal",defaultValue:O},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:y}})}},{key:"updateState",value:function(e){var t,r,i,a=e.props,s=e.oldProps,c=e.changeFlags;if(Object(o.a)(Object(u.a)(n.prototype),"updateState",this).call(this,{props:a,oldProps:s,changeFlags:c}),c.extensionsChanged){var l,f=this.context.gl;null===(l=this.state.model)||void 0===l||l.delete(),this.state.model=this._getModel(f),this.getAttributeManager().invalidateAll()}c.dataChanged&&(t=a.data,r=t.header,i=t.attributes,r&&i&&(t.length=r.vertexCount,i.POSITION&&(i.instancePositions=i.POSITION),i.NORMAL&&(i.instanceNormals=i.NORMAL),i.COLOR_0&&(i.instanceColors=i.COLOR_0)))}},{key:"draw",value:function(e){var t=e.uniforms,n=this.context.viewport,r=this.props,i=r.pointSize,a="meters"===r.sizeUnits?1/n.metersPerPixel:1;this.state.model.setUniforms(t).setUniforms({radiusPixels:i*a}).draw()}},{key:"_getModel",value:function(e){for(var t=[],n=0;n<3;n++){var r=n/3*Math.PI*2;t.push(2*Math.cos(r),2*Math.sin(r),0)}return new d.a(e,m(m({},this.getShaders()),{},{id:this.props.id,geometry:new b.a({drawMode:4,attributes:{positions:new Float32Array(t)}}),isInstanced:!0}))}}]),n}(h.a);j.layerName="PointCloudLayer",j.defaultProps=_},G8qk:function(e,t,n){"use strict";n.d(t,"a",(function(){return ke}));var r=n("o0o1"),i=n.n(r),a=n("rePB"),o=(n("ls82"),n("HaE+")),s=n("1OyB"),c=n("vuIU"),u=n("Ji7U"),l=n("md7G"),f=n("foSv"),p=n("0i8A"),h=n("V3d6"),d=n("5lV4"),b=n("FR1t"),v=n("ReuC"),m=n("K4gp"),g=n("BQ9P"),y=n("Jh/b"),O=n("K7jV"),_=n("DvX1"),j="#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))\n\nstruct AmbientLight {\n vec3 color;\n};\n\nstruct PointLight {\n vec3 color;\n vec3 position;\n vec3 attenuation;\n};\n\nstruct DirectionalLight {\n  vec3 color;\n  vec3 direction;\n};\n\nuniform AmbientLight lighting_uAmbientLight;\nuniform PointLight lighting_uPointLight[MAX_LIGHTS];\nuniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];\nuniform int lighting_uPointLightCount;\nuniform int lighting_uDirectionalLightCount;\n\nuniform bool lighting_uEnabled;\n\nfloat getPointLightAttenuation(PointLight pointLight, float distance) {\n  return pointLight.attenuation.x\n       + pointLight.attenuation.y * distance\n       + pointLight.attenuation.z * distance * distance;\n}\n\n#endif\n";function A(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return S(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var x={lightSources:{}};function T(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.color,n=void 0===t?[0,0,0]:t,r=e.intensity,i=void 0===r?1:r;return n.map((function(e){return e*i/255}))}function E(e){var t=e.ambientLight,n=e.pointLights,r=void 0===n?[]:n,i=e.directionalLights,a=void 0===i?[]:i,o={};return o["lighting_uAmbientLight.color"]=t?T(t):[0,0,0],r.forEach((function(e,t){o["lighting_uPointLight[".concat(t,"].color")]=T(e),o["lighting_uPointLight[".concat(t,"].position")]=e.position,o["lighting_uPointLight[".concat(t,"].attenuation")]=e.attenuation||[1,0,0]})),o.lighting_uPointLightCount=r.length,a.forEach((function(e,t){o["lighting_uDirectionalLight[".concat(t,"].color")]=T(e),o["lighting_uDirectionalLight[".concat(t,"].direction")]=e.direction})),o.lighting_uDirectionalLightCount=a.length,o}var I={name:"pbr",vs:"uniform mat4 u_MVPMatrix;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_NormalMatrix;\n\nvarying vec3 pbr_vPosition;\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n# ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n# else\nvarying vec3 pbr_vNormal;\n# endif\n#endif\n\nvoid pbr_setPositionNormalTangentUV(vec4 position, vec4 normal, vec4 tangent, vec2 uv)\n{\n  vec4 pos = u_ModelMatrix * position;\n  pbr_vPosition = vec3(pos.xyz) / pos.w;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\n  vec3 normalW = normalize(vec3(u_NormalMatrix * vec4(normal.xyz, 0.0)));\n  vec3 tangentW = normalize(vec3(u_ModelMatrix * vec4(tangent.xyz, 0.0)));\n  vec3 bitangentW = cross(normalW, tangentW) * tangent.w;\n  pbr_vTBN = mat3(tangentW, bitangentW, normalW);\n#else\n  pbr_vNormal = normalize(vec3(u_ModelMatrix * vec4(normal.xyz, 0.0)));\n#endif\n#endif\n\n#ifdef HAS_UV\n  pbr_vUV = uv;\n#else\n  pbr_vUV = vec2(0.,0.);\n#endif\n}\n",fs:"#if defined(USE_TEX_LOD) && !defined(FEATURE_GLSL_TEXTURE_LOD)\n# error PBR fragment shader: Texture LOD is not available\n#endif\n\n#if !defined(HAS_TANGENTS) && !defined(FEATURE_GLSL_DERIVATIVES)\n# error PBR fragment shader: Derivatives are not available\n#endif\n\n\n#if (__VERSION__ < 300)\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL1COND; INCR)\n#else\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL2COND; INCR)\n#endif\n\nprecision highp float;\n\nuniform bool pbr_uUnlit;\n\n#ifdef USE_IBL\nuniform samplerCube u_DiffuseEnvSampler;\nuniform samplerCube u_SpecularEnvSampler;\nuniform sampler2D u_brdfLUT;\nuniform vec2 u_ScaleIBLAmbient;\n#endif\n\n#ifdef HAS_BASECOLORMAP\nuniform sampler2D u_BaseColorSampler;\n#endif\n#ifdef HAS_NORMALMAP\nuniform sampler2D u_NormalSampler;\nuniform float u_NormalScale;\n#endif\n#ifdef HAS_EMISSIVEMAP\nuniform sampler2D u_EmissiveSampler;\nuniform vec3 u_EmissiveFactor;\n#endif\n#ifdef HAS_METALROUGHNESSMAP\nuniform sampler2D u_MetallicRoughnessSampler;\n#endif\n#ifdef HAS_OCCLUSIONMAP\nuniform sampler2D u_OcclusionSampler;\nuniform float u_OcclusionStrength;\n#endif\n\n#ifdef ALPHA_CUTOFF\nuniform float u_AlphaCutoff;\n#endif\n\nuniform vec2 u_MetallicRoughnessValues;\nuniform vec4 u_BaseColorFactor;\n\nuniform vec3 u_Camera;\n#ifdef PBR_DEBUG\nuniform vec4 u_ScaleDiffBaseMR;\nuniform vec4 u_ScaleFGDSpec;\n#endif\n\nvarying vec3 pbr_vPosition;\n\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n#else\nvarying vec3 pbr_vNormal;\n#endif\n#endif\n\n\nstruct PBRInfo\n{\n  float NdotL;\n  float NdotV;\n  float NdotH;\n  float LdotH;\n  float VdotH;\n  float perceptualRoughness;\n  float metalness;\n  vec3 reflectance0;\n  vec3 reflectance90;\n  float alphaRoughness;\n  vec3 diffuseColor;\n  vec3 specularColor;\n  vec3 n;\n  vec3 v;\n};\n\nconst float M_PI = 3.141592653589793;\nconst float c_MinRoughness = 0.04;\n\nvec4 SRGBtoLINEAR(vec4 srgbIn)\n{\n#ifdef MANUAL_SRGB\n#ifdef SRGB_FAST_APPROXIMATION\n  vec3 linOut = pow(srgbIn.xyz,vec3(2.2));\n#else\n  vec3 bLess = step(vec3(0.04045),srgbIn.xyz);\n  vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );\n#endif\n  return vec4(linOut,srgbIn.w);;\n#else\n  return srgbIn;\n#endif\n}\n\nvec3 getNormal()\n{\n#ifndef HAS_TANGENTS\n  vec3 pos_dx = dFdx(pbr_vPosition);\n  vec3 pos_dy = dFdy(pbr_vPosition);\n  vec3 tex_dx = dFdx(vec3(pbr_vUV, 0.0));\n  vec3 tex_dy = dFdy(vec3(pbr_vUV, 0.0));\n  vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\n\n#ifdef HAS_NORMALS\n  vec3 ng = normalize(pbr_vNormal);\n#else\n  vec3 ng = cross(pos_dx, pos_dy);\n#endif\n\n  t = normalize(t - ng * dot(ng, t));\n  vec3 b = normalize(cross(ng, t));\n  mat3 tbn = mat3(t, b, ng);\n#else\n  mat3 tbn = pbr_vTBN;\n#endif\n\n#ifdef HAS_NORMALMAP\n  vec3 n = texture2D(u_NormalSampler, pbr_vUV).rgb;\n  n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_NormalScale, u_NormalScale, 1.0)));\n#else\n  vec3 n = normalize(tbn[2].xyz);\n#endif\n\n  return n;\n}\n\n\n#ifdef USE_IBL\nvec3 getIBLContribution(PBRInfo pbrInputs, vec3 n, vec3 reflection)\n{\n  float mipCount = 9.0;\n  float lod = (pbrInputs.perceptualRoughness * mipCount);\n  vec3 brdf = SRGBtoLINEAR(texture2D(u_brdfLUT,\n    vec2(pbrInputs.NdotV, 1.0 - pbrInputs.perceptualRoughness))).rgb;\n  vec3 diffuseLight = SRGBtoLINEAR(textureCube(u_DiffuseEnvSampler, n)).rgb;\n\n#ifdef USE_TEX_LOD\n  vec3 specularLight = SRGBtoLINEAR(textureCubeLod(u_SpecularEnvSampler, reflection, lod)).rgb;\n#else\n  vec3 specularLight = SRGBtoLINEAR(textureCube(u_SpecularEnvSampler, reflection)).rgb;\n#endif\n\n  vec3 diffuse = diffuseLight * pbrInputs.diffuseColor;\n  vec3 specular = specularLight * (pbrInputs.specularColor * brdf.x + brdf.y);\n  diffuse *= u_ScaleIBLAmbient.x;\n  specular *= u_ScaleIBLAmbient.y;\n\n  return diffuse + specular;\n}\n#endif\n\n\nvec3 diffuse(PBRInfo pbrInputs)\n{\n  return pbrInputs.diffuseColor / M_PI;\n}\n\nvec3 specularReflection(PBRInfo pbrInputs)\n{\n  return pbrInputs.reflectance0 +\n    (pbrInputs.reflectance90 - pbrInputs.reflectance0) *\n    pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);\n}\n\n\n\nfloat geometricOcclusion(PBRInfo pbrInputs)\n{\n  float NdotL = pbrInputs.NdotL;\n  float NdotV = pbrInputs.NdotV;\n  float r = pbrInputs.alphaRoughness;\n\n  float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));\n  float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));\n  return attenuationL * attenuationV;\n}\n\n\n\n\n\nfloat microfacetDistribution(PBRInfo pbrInputs)\n{\n  float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;\n  float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;\n  return roughnessSq / (M_PI * f * f);\n}\n\nvoid PBRInfo_setAmbientLight(inout PBRInfo pbrInputs) {\n  pbrInputs.NdotL = 1.0;\n  pbrInputs.NdotH = 0.0;\n  pbrInputs.LdotH = 0.0;\n  pbrInputs.VdotH = 1.0;\n}\n\nvoid PBRInfo_setDirectionalLight(inout PBRInfo pbrInputs, vec3 lightDirection) {\n  vec3 n = pbrInputs.n;\n  vec3 v = pbrInputs.v;\n  vec3 l = normalize(lightDirection);\n  vec3 h = normalize(l+v);\n\n  pbrInputs.NdotL = clamp(dot(n, l), 0.001, 1.0);\n  pbrInputs.NdotH = clamp(dot(n, h), 0.0, 1.0);\n  pbrInputs.LdotH = clamp(dot(l, h), 0.0, 1.0);\n  pbrInputs.VdotH = clamp(dot(v, h), 0.0, 1.0);\n}\n\nvoid PBRInfo_setPointLight(inout PBRInfo pbrInputs, PointLight pointLight) {\n  vec3 light_direction = normalize(pointLight.position - pbr_vPosition);\n  PBRInfo_setDirectionalLight(pbrInputs, light_direction);\n}\n\nvec3 calculateFinalColor(PBRInfo pbrInputs, vec3 lightColor) {\n  vec3 F = specularReflection(pbrInputs);\n  float G = geometricOcclusion(pbrInputs);\n  float D = microfacetDistribution(pbrInputs);\n  vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);\n  vec3 specContrib = F * G * D / (4.0 * pbrInputs.NdotL * pbrInputs.NdotV);\n  return pbrInputs.NdotL * lightColor * (diffuseContrib + specContrib);\n}\n\nvec4 pbr_filterColor(vec4 colorUnused)\n{\n#ifdef HAS_BASECOLORMAP\n  vec4 baseColor = SRGBtoLINEAR(texture2D(u_BaseColorSampler, pbr_vUV)) * u_BaseColorFactor;\n#else\n  vec4 baseColor = u_BaseColorFactor;\n#endif\n\n#ifdef ALPHA_CUTOFF\n  if (baseColor.a < u_AlphaCutoff) {\n    discard;\n  }\n#endif\n\n  vec3 color = vec3(0, 0, 0);\n\n  if(pbr_uUnlit){\n    color.rgb = baseColor.rgb;\n  }\n  else{\n\n\n    float perceptualRoughness = u_MetallicRoughnessValues.y;\n    float metallic = u_MetallicRoughnessValues.x;\n#ifdef HAS_METALROUGHNESSMAP\n\n    vec4 mrSample = texture2D(u_MetallicRoughnessSampler, pbr_vUV);\n    perceptualRoughness = mrSample.g * perceptualRoughness;\n    metallic = mrSample.b * metallic;\n#endif\n    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);\n    metallic = clamp(metallic, 0.0, 1.0);\n\n    float alphaRoughness = perceptualRoughness * perceptualRoughness;\n\n    vec3 f0 = vec3(0.04);\n    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);\n    diffuseColor *= 1.0 - metallic;\n    vec3 specularColor = mix(f0, baseColor.rgb, metallic);\n    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\n\n\n\n    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);\n    vec3 specularEnvironmentR0 = specularColor.rgb;\n    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;\n\n    vec3 n = getNormal();\n    vec3 v = normalize(u_Camera - pbr_vPosition);\n\n    float NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);\n    vec3 reflection = -normalize(reflect(v, n));\n\n    PBRInfo pbrInputs = PBRInfo(\n      0.0,\n      NdotV,\n      0.0,\n      0.0,\n      0.0,\n      perceptualRoughness,\n      metallic,\n      specularEnvironmentR0,\n      specularEnvironmentR90,\n      alphaRoughness,\n      diffuseColor,\n      specularColor,\n      n,\n      v\n    );\n\n#ifdef USE_LIGHTS\n    PBRInfo_setAmbientLight(pbrInputs);\n    color += calculateFinalColor(pbrInputs, lighting_uAmbientLight.color);\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uDirectionalLightCount, i++) {\n      if (i < lighting_uDirectionalLightCount) {\n        PBRInfo_setDirectionalLight(pbrInputs, lighting_uDirectionalLight[i].direction);\n        color += calculateFinalColor(pbrInputs, lighting_uDirectionalLight[i].color);\n      }\n    }\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uPointLightCount, i++) {\n      if (i < lighting_uPointLightCount) {\n        PBRInfo_setPointLight(pbrInputs, lighting_uPointLight[i]);\n        float attenuation = getPointLightAttenuation(lighting_uPointLight[i], distance(lighting_uPointLight[i].position, pbr_vPosition));\n        color += calculateFinalColor(pbrInputs, lighting_uPointLight[i].color / attenuation);\n      }\n    }\n#endif\n#ifdef USE_IBL\n    color += getIBLContribution(pbrInputs, n, reflection);\n#endif\n#ifdef HAS_OCCLUSIONMAP\n    float ao = texture2D(u_OcclusionSampler, pbr_vUV).r;\n    color = mix(color, color * ao, u_OcclusionStrength);\n#endif\n\n#ifdef HAS_EMISSIVEMAP\n    vec3 emissive = SRGBtoLINEAR(texture2D(u_EmissiveSampler, pbr_vUV)).rgb * u_EmissiveFactor;\n    color += emissive;\n#endif\n\n#ifdef PBR_DEBUG\n\n\n\n\n\n    color = mix(color, baseColor.rgb, u_ScaleDiffBaseMR.y);\n    color = mix(color, vec3(metallic), u_ScaleDiffBaseMR.z);\n    color = mix(color, vec3(perceptualRoughness), u_ScaleDiffBaseMR.w);\n#endif\n\n  }\n\n  return vec4(pow(color,vec3(1.0/2.2)), baseColor.a);\n}\n",defines:{LIGHTING_FRAGMENT:1},dependencies:[{name:"lights",vs:j,fs:j,getUniforms:function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x;if("lightSources"in t){var n=t.lightSources||{},r=n.ambientLight,i=n.pointLights,a=n.directionalLights,o=r||i&&i.length>0||a&&a.length>0;return o?Object.assign({},E({ambientLight:r,pointLights:i,directionalLights:a}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in t){var s,c={pointLights:[],directionalLights:[]},u=A(t.lights||[]);try{for(u.s();!(s=u.n()).done;){var l=s.value;switch(l.type){case"ambient":c.ambientLight=l;break;case"directional":c.directionalLights.push(l);break;case"point":c.pointLights.push(l)}}}catch(f){u.e(f)}finally{u.f()}return e({lightSources:c})}return{}},defines:{MAX_LIGHTS:3}}]},P=n("zXfU"),w=n("Nw31"),R=n("VdrS"),L=n("CxzY"),C=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(s.a)(this,e);var n=t.id;this.id=n||Object(R.c)(this.constructor.name),this.display=!0,this.position=new P.a,this.rotation=new P.a,this.scale=new P.a(1,1,1),this.matrix=new w.a,this.userData={},this.props={},this._setScenegraphNodeProps(t)}return Object(c.a)(e,[{key:"delete",value:function(){}},{key:"setProps",value:function(e){return this._setScenegraphNodeProps(e),this}},{key:"toString",value:function(){return"{type: ScenegraphNode, id: ".concat(this.id,")}")}},{key:"setPosition",value:function(e){return Object(L.a)(3===e.length,"setPosition requires vector argument"),this.position=e,this}},{key:"setRotation",value:function(e){return Object(L.a)(3===e.length,"setRotation requires vector argument"),this.rotation=e,this}},{key:"setScale",value:function(e){return Object(L.a)(3===e.length,"setScale requires vector argument"),this.scale=e,this}},{key:"setMatrix",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t?this.matrix.copy(e):this.matrix=e}},{key:"setMatrixComponents",value:function(e){var t=e.position,n=e.rotation,r=e.scale,i=e.update,a=void 0===i||i;return t&&this.setPosition(t),n&&this.setRotation(n),r&&this.setScale(r),a&&this.updateMatrix(),this}},{key:"updateMatrix",value:function(){var e=this.position,t=this.rotation,n=this.scale;return this.matrix.identity(),this.matrix.translate(e),this.matrix.rotateXYZ(t),this.matrix.scale(n),this}},{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.position,n=e.rotation,r=e.scale;return t&&this.setPosition(t),n&&this.setRotation(n),r&&this.setScale(r),this.updateMatrix(),this}},{key:"getCoordinateUniforms",value:function(e,t){Object(L.a)(e),t=t||this.matrix;var n=new w.a(e).multiplyRight(t),r=n.invert(),i=r.transpose();return{viewMatrix:e,modelMatrix:t,objectMatrix:t,worldMatrix:n,worldInverseMatrix:r,worldInverseTransposeMatrix:i}}},{key:"_setScenegraphNodeProps",value:function(e){"display"in e&&(this.display=e.display),"position"in e&&this.setPosition(e.position),"rotation"in e&&this.setRotation(e.rotation),"scale"in e&&this.setScale(e.scale),"matrix"in e&&this.setMatrix(e.matrix),Object.assign(this.props,e)}}]),e}(),N=n("LNPn"),M=n("sc/6"),B=n("T2Hy"),D=n("KQm4");function U(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return k(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function V(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var i=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var F=function(e){Object(u.a)(n,e);var t=V(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(s.a)(this,n);var i=r=Array.isArray(r)?{children:r}:r,a=i.children,o=void 0===a?[]:a;return N.e.assert(o.every((function(e){return e instanceof C})),"every child must an instance of ScenegraphNode"),(e=t.call(this,r)).children=o,e}return Object(c.a)(n,[{key:"add",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0,i=t;r<i.length;r++){var a=i[r];Array.isArray(a)?this.add.apply(this,Object(D.a)(a)):this.children.push(a)}return this}},{key:"remove",value:function(e){var t=this.children,n=t.indexOf(e);return n>-1&&t.splice(n,1),this}},{key:"removeAll",value:function(){return this.children=[],this}},{key:"delete",value:function(){this.children.forEach((function(e){return e.delete()})),this.removeAll(),Object(v.a)(Object(f.a)(n.prototype),"delete",this).call(this)}},{key:"traverse",value:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=r.worldMatrix,a=void 0===i?new w.a:i,o=new w.a(a).multiplyRight(this.matrix),s=U(this.children);try{for(s.s();!(t=s.n()).done;){var c=t.value;c instanceof n?c.traverse(e,{worldMatrix:o}):e(c,{worldMatrix:o})}}catch(u){s.e(u)}finally{s.f()}}}]),n}(C),G=n("Xjzu"),z={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},H={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function q(e){if(!e._animation){var t=H[e.componentType],n=z[e.type],r=n*e.count,i=e.bufferView.data,a=new t(i.buffer,i.byteOffset+(e.byteOffset||0),r);if(1===n)e._animation=Array.from(a);else{for(var o=[],s=0;s<a.length;s+=n)o.push(Array.from(a.slice(s,s+n)));e._animation=o}}return e._animation}var X=new w.a;var W=new G.a;function K(e,t,n,r){var i=t.input,a=t.interpolation,o=t.output,s=e%i[i.length-1],c=i.findIndex((function(e){return e>=s})),u=Math.max(0,c-1);if(!Array.isArray(n[r]))switch(r){case"translation":n[r]=[0,0,0];break;case"rotation":n[r]=[0,0,0,1];break;case"scale":n[r]=[1,1,1];break;default:N.e.warn("Bad animation path ".concat(r))()}Object(L.a)(n[r].length===o[u].length);var l=i[u],f=i[c];switch(a){case"STEP":!function(e,t,n){for(var r=0;r<n.length;r++)e[t][r]=n[r]}(n,r,o[u]);break;case"LINEAR":if(f>l){var p=(s-l)/(f-l);!function(e,t,n,r,i){if("rotation"===t){W.slerp({start:n,target:r,ratio:i});for(var a=0;a<W.length;a++)e[t][a]=W[a]}else for(var o=0;o<n.length;o++)e[t][o]=i*r[o]+(1-i)*n[o]}(n,r,o[u],o[c],p)}break;case"CUBICSPLINE":if(f>l){var h=(s-l)/(f-l),d=f-l;!function(e,t,n){for(var r=n.p0,i=n.outTangent0,a=n.inTangent1,o=n.p1,s=n.tDiff,c=n.ratio,u=0;u<e[t].length;u++){var l=i[u]*s,f=a[u]*s;e[t][u]=(2*Math.pow(c,3)-3*Math.pow(c,2)+1)*r[u]+(Math.pow(c,3)-2*Math.pow(c,2)+c)*l+(-2*Math.pow(c,3)+3*Math.pow(c,2))*o[u]+(Math.pow(c,3)-Math.pow(c,2))*f}}(n,r,{p0:o[3*u+1],outTangent0:o[3*u+2],inTangent1:o[3*c+0],p1:o[3*c+1],tDiff:d,ratio:h})}break;default:N.e.warn("Interpolation ".concat(a," not supported"))()}}var J=function(){function e(t){Object(s.a)(this,e),this.startTime=0,this.playing=!0,this.speed=1,this.channels=[],Object.assign(this,t)}return Object(c.a)(e,[{key:"animate",value:function(e){if(this.playing){var t=(e/1e3-this.startTime)*this.speed;this.channels.forEach((function(e){var n=e.sampler,r=e.target,i=e.path;K(t,n,r,i),function(e,t){if(t.matrix.identity(),e.translation&&t.matrix.translate(e.translation),e.rotation){var n=X.fromQuaternion(e.rotation);t.matrix.multiplyRight(n)}e.scale&&t.matrix.scale(e.scale)}(r,r._node)}))}}}]),e}(),Q=function(){function e(t){Object(s.a)(this,e),this.animations=t.animations.map((function(e,n){var r=e.name||"Animation-".concat(n),i=e.samplers.map((function(e){var n=e.input,r=e.interpolation,i=void 0===r?"LINEAR":r,a=e.output;return{input:q(t.accessors[n]),interpolation:i,output:q(t.accessors[a])}})),a=e.channels.map((function(e){var n=e.sampler,r=e.target;return{sampler:i[n],target:t.nodes[r.node],path:r.path}}));return new J({name:r,channels:a})}))}return Object(c.a)(e,[{key:"animate",value:function(e){this.setTime(e)}},{key:"setTime",value:function(e){this.animations.forEach((function(t){return t.animate(e)}))}},{key:"getAnimations",value:function(){return this.animations}}]),e}(),Y=(new(n("d3wX").a)({id:"luma.gl"}),n("oJMS")),Z=(n("Hogv"),n("gXd2"),n("9Q0L"),n("xSaR"));n("Vyni");var $=Object(Z.isBrowser)();var ee=n("ykdB");function te(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var i=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var ne=function(e){Object(u.a)(n,e);var t=te(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(s.a)(this,n),(r=t.call(this,i)).onBeforeRender=null,r.AfterRender=null,e instanceof ee.a?(r.model=e,r._setModelNodeProps(i)):r.model=new ee.a(e,i),r.managedResources=i.managedResources||[],r}return Object(c.a)(n,[{key:"setProps",value:function(e){return Object(v.a)(Object(f.a)(n.prototype),"setProps",this).call(this,e),this._setModelNodeProps(e),this}},{key:"delete",value:function(){this.model&&(this.model.delete(),this.model=null),this.managedResources.forEach((function(e){return e.delete()})),this.managedResources=[]}},{key:"draw",value:function(){var e;return(e=this.model).draw.apply(e,arguments)}},{key:"setUniforms",value:function(){var e;return(e=this.model).setUniforms.apply(e,arguments),this}},{key:"setAttributes",value:function(){var e;return(e=this.model).setAttributes.apply(e,arguments),this}},{key:"updateModuleSettings",value:function(){var e;return(e=this.model).updateModuleSettings.apply(e,arguments),this}},{key:"_setModelNodeProps",value:function(e){this.model.setProps(e)}}]),n}(C),re=n("d3kR"),ie=n("tMmZ"),ae=n("f5Sf");function oe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(n),!0).forEach((function(t){Object(a.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ce=function(){function e(t,n){var r=n.attributes,i=n.material,a=n.pbrDebug,o=n.imageBasedLightingEnvironment,c=n.lights,u=n.useTangents;Object(s.a)(this,e),this.gl=t,this.defines={MANUAL_SRGB:1,SRGB_FAST_APPROXIMATION:1},Object(re.b)(t,ie.a.GLSL_TEXTURE_LOD)&&(this.defines.USE_TEX_LOD=1),this.uniforms={u_Camera:[0,0,0],u_MetallicRoughnessValues:[1,1]},this.parameters={},this.generatedTextures=[],o&&(this.uniforms.u_DiffuseEnvSampler=o.getDiffuseEnvSampler(),this.uniforms.u_SpecularEnvSampler=o.getSpecularEnvSampler(),this.uniforms.u_brdfLUT=o.getBrdfTexture(),this.uniforms.u_ScaleIBLAmbient=[1,1]),a&&(this.uniforms.u_ScaleDiffBaseMR=[0,0,0,0],this.uniforms.u_ScaleFGDSpec=[0,0,0,0]),this.defineIfPresent(r.NORMAL,"HAS_NORMALS"),this.defineIfPresent(r.TANGENT&&u,"HAS_TANGENTS"),this.defineIfPresent(r.TEXCOORD_0,"HAS_UV"),this.defineIfPresent(o,"USE_IBL"),this.defineIfPresent(c,"USE_LIGHTS"),this.defineIfPresent(a,"PBR_DEBUG"),i&&this.parseMaterial(i)}return Object(c.a)(e,[{key:"defineIfPresent",value:function(e,t){e&&(this.defines[t]=1)}},{key:"parseTexture",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=e.texture&&e.texture.sampler&&e.texture.sampler.parameters||{},o=e.texture.source.image,s={};o.compressed?(n=o,s=Object(a.a)({},this.gl.TEXTURE_MIN_FILTER,o.data.length>1?this.gl.LINEAR_MIPMAP_NEAREST:this.gl.LINEAR)):n={data:o};var c=new ae.a(this.gl,se({id:e.name||e.id,parameters:se(se({},i),s),pixelStore:Object(a.a)({},this.gl.UNPACK_FLIP_Y_WEBGL,!1)},n));this.uniforms[t]=c,this.defineIfPresent(r,r),this.generatedTextures.push(c)}},{key:"parsePbrMetallicRoughness",value:function(e){e.baseColorTexture&&this.parseTexture(e.baseColorTexture,"u_BaseColorSampler","HAS_BASECOLORMAP"),this.uniforms.u_BaseColorFactor=e.baseColorFactor||[1,1,1,1],e.metallicRoughnessTexture&&this.parseTexture(e.metallicRoughnessTexture,"u_MetallicRoughnessSampler","HAS_METALROUGHNESSMAP");var t=e.metallicFactor,n=void 0===t?1:t,r=e.roughnessFactor,i=void 0===r?1:r;this.uniforms.u_MetallicRoughnessValues=[n,i]}},{key:"parseMaterial",value:function(e){if(this.uniforms.pbr_uUnlit=Boolean(e.unlit),e.pbrMetallicRoughness&&this.parsePbrMetallicRoughness(e.pbrMetallicRoughness),e.normalTexture){this.parseTexture(e.normalTexture,"u_NormalSampler","HAS_NORMALMAP");var t=e.normalTexture.scale,n=void 0===t?1:t;this.uniforms.u_NormalScale=n}if(e.occlusionTexture){this.parseTexture(e.occlusionTexture,"u_OcclusionSampler","HAS_OCCLUSIONMAP");var r=e.occlusionTexture.strength,i=void 0===r?1:r;this.uniforms.u_OcclusionStrength=i}if(e.emissiveTexture&&(this.parseTexture(e.emissiveTexture,"u_EmissiveSampler","HAS_EMISSIVEMAP"),this.uniforms.u_EmissiveFactor=e.emissiveFactor||[0,0,0]),"MASK"===e.alphaMode){var a=e.alphaCutoff,o=void 0===a?.5:a;this.defines.ALPHA_CUTOFF=1,this.uniforms.u_AlphaCutoff=o}else"BLEND"===e.alphaMode&&(N.e.warn("BLEND alphaMode might not work well because it requires mesh sorting")(),Object.assign(this.parameters,{blend:!0,blendEquation:this.gl.FUNC_ADD,blendFunc:[this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA]}))}}]),e}();function ue(e,t){return Object(Y.b)(e)?"#version 300 es\n".concat(t):t}var le={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},fe={modelOptions:{},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1},pe=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(s.a)(this,e),this.gl=t,this.options=Object.assign({},fe,n)}return Object(c.a)(e,[{key:"instantiate",value:function(e){var t=this;return this.gltf=e,(e.scenes||[]).map((function(e){return t.createScene(e)}))}},{key:"createAnimator",value:function(){return Array.isArray(this.gltf.animations)?new Q(this.gltf):null}},{key:"createScene",value:function(e){var t=this,n=(e.nodes||[]).map((function(e){return t.createNode(e)}));return new F({id:e.name||e.id,children:n})}},{key:"createNode",value:function(e){var t=this;if(!e._node){var n=(e.children||[]).map((function(e){return t.createNode(e)}));e.mesh&&n.push(this.createMesh(e.mesh));var r=new F({id:e.name||e.id,children:n});if(e.matrix)r.setMatrix(e.matrix);else{if(r.matrix.identity(),e.translation&&r.matrix.translate(e.translation),e.rotation){var i=(new w.a).fromQuaternion(e.rotation);r.matrix.multiplyRight(i)}e.scale&&r.matrix.scale(e.scale)}e._node=r}return e._node}},{key:"createMesh",value:function(e){var t=this;if(!e._mesh){var n=(e.primitives||[]).map((function(n,r){return t.createPrimitive(n,r,e)})),r=new F({id:e.name||e.id,children:n});e._mesh=r}return e._mesh}},{key:"getVertexCount",value:function(e){N.e.warn("getVertexCount() not found")()}},{key:"createPrimitive",value:function(e,t,n){return function(e,t){var n=t.id,r=t.drawMode,i=t.vertexCount,a=t.attributes,o=t.modelOptions,s=new ce(e,t);N.e.info(4,"createGLTFModel defines: ",s.defines)();var c=[];c.push.apply(c,Object(D.a)(s.generatedTextures)),c.push.apply(c,Object(D.a)(Object.values(a).map((function(e){return e.buffer}))));var u=new ne(e,Object.assign({id:n,drawMode:r,vertexCount:i,modules:[I],defines:s.defines,parameters:s.parameters,vs:ue(e,"\n#if (__VERSION__ < 300)\n  #define _attr attribute\n#else\n  #define _attr in\n#endif\n\n  _attr vec4 POSITION;\n\n  #ifdef HAS_NORMALS\n    _attr vec4 NORMAL;\n  #endif\n\n  #ifdef HAS_TANGENTS\n    _attr vec4 TANGENT;\n  #endif\n\n  #ifdef HAS_UV\n    _attr vec2 TEXCOORD_0;\n  #endif\n\n  void main(void) {\n    vec4 _NORMAL = vec4(0.);\n    vec4 _TANGENT = vec4(0.);\n    vec2 _TEXCOORD_0 = vec2(0.);\n\n    #ifdef HAS_NORMALS\n      _NORMAL = NORMAL;\n    #endif\n\n    #ifdef HAS_TANGENTS\n      _TANGENT = TANGENT;\n    #endif\n\n    #ifdef HAS_UV\n      _TEXCOORD_0 = TEXCOORD_0;\n    #endif\n\n    pbr_setPositionNormalTangentUV(POSITION, _NORMAL, _TANGENT, _TEXCOORD_0);\n    gl_Position = u_MVPMatrix * POSITION;\n  }\n"),fs:ue(e,"\n#if (__VERSION__ < 300)\n  #define fragmentColor gl_FragColor\n#else\n  out vec4 fragmentColor;\n#endif\n\n  void main(void) {\n    fragmentColor = pbr_filterColor(vec4(0));\n  }\n"),managedResources:c},o));return u.setProps({attributes:a}),u.setUniforms(s.uniforms),u}(this.gl,Object.assign({id:e.name||"".concat(n.name||n.id,"-primitive-").concat(t),drawMode:e.mode||4,vertexCount:e.indices?e.indices.count:this.getVertexCount(e.attributes),attributes:this.createAttributes(e.attributes,e.indices),material:e.material},this.options))}},{key:"createAttributes",value:function(e,t){var n=this,r={};return Object.keys(e).forEach((function(t){r[t]=n.createAccessor(e[t],n.createBuffer(e[t],n.gl.ARRAY_BUFFER))})),t&&(r.indices=this.createAccessor(t,this.createBuffer(t,this.gl.ELEMENT_ARRAY_BUFFER))),N.e.info(4,"glTF Attributes",{attributes:e,indices:t,generated:r})(),r}},{key:"createBuffer",value:function(e,t){e.bufferView||(e.bufferView={});var n=e.bufferView;return n.lumaBuffers||(n.lumaBuffers={}),n.lumaBuffers[t]||(n.lumaBuffers[t]=new M.a(this.gl,{id:"from-".concat(n.id),data:n.data||e.value,target:t})),n.lumaBuffers[t]}},{key:"createAccessor",value:function(e,t){return new B.a({buffer:t,offset:e.byteOffset||0,stride:e.bufferView.byteStride||0,type:e.componentType,size:le[e.type]})}},{key:"createSampler",value:function(e){return e}},{key:"needsPOT",value:function(){return!1}}]),e}();var he=n("p/I1");function de(){return(de=Object(o.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],t.scenes.forEach((function(e){e.traverse((function(e){Object.values(e.model.getUniforms()).forEach((function(e){!1===e.loaded&&n.push(e)}))}))})),e.next=4,be((function(){return n.some((function(e){return!e.loaded}))}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function be(e){return ve.apply(this,arguments)}function ve(){return(ve=Object(o.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t()){e.next=5;break}return e.next=3,new Promise((function(e){return requestAnimationFrame(e)}));case 3:e.next=0;break;case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var me=n("HIr8");function ge(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ye(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ge(Object(n),!0).forEach((function(t){Object(a.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ge(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Oe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var i=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var _e=[255,255,255,255],je={scenegraph:{type:"object",value:null,async:!0},getScene:function(e){return e&&e.scenes?"object"==typeof e.scene?e.scene:e.scenes[e.scene||0]:e},getAnimator:function(e){return e&&e.animator},_animations:null,sizeScale:{type:"number",value:1,min:0},sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},getPosition:{type:"accessor",value:function(e){return e.position}},getColor:{type:"accessor",value:_e},_lighting:"flat",_imageBasedLightingEnvironment:null,getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},loaders:[he.a]},Ae=function(e){Object(u.a)(n,e);var t=Oe(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"getShaders",value:function(){var e=[m.a,g.a];return"pbr"===this.props._lighting&&e.push(I),{vs:"#version 300 es\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform mat4 sceneModelMatrix;\nuniform bool composeModelMatrix;\nin vec4 POSITION;\n\n#ifdef HAS_UV\n  in vec2 TEXCOORD_0;\n#endif\n\n#ifdef MODULE_PBR\n  #ifdef HAS_NORMALS\n    in vec4 NORMAL;\n  #endif\n#endif\nout vec4 vColor;\n#ifndef MODULE_PBR\n  #ifdef HAS_UV\n    out vec2 vTEXCOORD_0;\n  #endif\n#endif\nvoid main(void) {\n  #if defined(HAS_UV) && !defined(MODULE_PBR)\n    vTEXCOORD_0 = TEXCOORD_0;\n    geometry.uv = vTEXCOORD_0;\n  #endif\n\n  geometry.worldPosition = instancePositions;\n  geometry.pickingColor = instancePickingColors;\n\n  #ifdef MODULE_PBR\n    #ifdef HAS_NORMALS\n      pbr_vNormal = project_normal(instanceModelMatrix * (sceneModelMatrix * vec4(NORMAL.xyz, 0.0)).xyz);\n      geometry.normal = pbr_vNormal;\n    #endif\n\n    #ifdef HAS_UV\n      pbr_vUV = TEXCOORD_0;\n    #else\n      pbr_vUV = vec2(0., 0.);\n    #endif\n    geometry.uv = pbr_vUV;\n  #endif\n\n  float originalSize = project_size_to_pixel(sizeScale);\n  float clampedSize = clamp(originalSize, sizeMinPixels, sizeMaxPixels);\n\n  vec3 pos = (instanceModelMatrix * (sceneModelMatrix * POSITION).xyz) * sizeScale * (clampedSize / originalSize) + instanceTranslation;\n  if(composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, geometry.position);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  #ifdef MODULE_PBR\n    pbr_vPosition = geometry.position.xyz;\n  #endif\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\nuniform float opacity;\nin vec4 vColor;\n\nout vec4 fragmentColor;\n#ifndef MODULE_PBR\n  #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n    in vec2 vTEXCOORD_0;\n    uniform sampler2D u_BaseColorSampler;\n  #endif\n#endif\n\nvoid main(void) {\n  #ifdef MODULE_PBR\n    fragmentColor = vColor * pbr_filterColor(vec4(0));\n    geometry.uv = pbr_vUV;\n  #else\n    #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n      fragmentColor = vColor * texture2D(u_BaseColorSampler, vTEXCOORD_0);\n      geometry.uv = vTEXCOORD_0;\n    #else\n      fragmentColor = vColor;\n    #endif\n  #endif\n\n  fragmentColor.a *= opacity;\n  DECKGL_FILTER_COLOR(fragmentColor, geometry);\n}\n",modules:e}}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),accessor:"getPosition",transition:!0},instanceColors:{type:5121,size:this.props.colorFormat.length,accessor:"getColor",normalized:!0,defaultValue:_e,transition:!0},instanceModelMatrix:me.a})}},{key:"updateState",value:function(e){Object(v.a)(Object(f.a)(n.prototype),"updateState",this).call(this,e);var t=e.props,r=e.oldProps;t.scenegraph!==r.scenegraph?this._updateScenegraph(t):t._animations!==r._animations&&this._applyAnimationsProp(this.state.scenegraph,this.state.animator,t._animations)}},{key:"finalizeState",value:function(){Object(v.a)(Object(f.a)(n.prototype),"finalizeState",this).call(this),this._deleteScenegraph()}},{key:"_updateScenegraph",value:function(e){var t=this,n=this.context.gl,r=null;if(e.scenegraph instanceof C)r={scenes:[e.scenegraph]};else if(e.scenegraph&&!e.scenegraph.gltf){var i=e.scenegraph,a=function(e,t,n){var r=new pe(e,n);return{scenes:r.instantiate(t),animator:r.createAnimator()}}(n,i,this._getModelOptions());r=ye({gltf:i},a),function(e){return de.apply(this,arguments)}(a).then((function(){return t.setNeedsRedraw()}))}else e.scenegraph&&(y.a.deprecated("ScenegraphLayer.props.scenegraph","Use GLTFLoader instead of GLTFScenegraphLoader")(),r=e.scenegraph);var o={layer:this,gl:n},s=e.getScene(r,o),c=e.getAnimator(r,o);s instanceof C?(this._deleteScenegraph(),this._applyAllAttributes(s),this._applyAnimationsProp(s,c,e._animations),this.setState({scenegraph:s,animator:c})):null!==s&&y.a.warn("invalid scenegraph:",s)()}},{key:"_applyAllAttributes",value:function(e){var t=this;if(this.state.attributesAvailable){var n=this.getAttributeManager().getAttributes();e.traverse((function(e){t._setModelAttributes(e.model,n)}))}}},{key:"_applyAnimationsProp",value:function(e,t,n){if(e&&t&&n){var r=t.getAnimations();Object.keys(n).sort().forEach((function(e){var t=n[e];if("*"===e)r.forEach((function(e){Object.assign(e,t)}));else if(Number.isFinite(Number(e))){var i=Number(e);i>=0&&i<r.length?Object.assign(r[i],t):y.a.warn("animation ".concat(e," not found"))()}else{var a=r.find((function(t){return t.name===e}));a?Object.assign(a,t):y.a.warn("animation ".concat(e," not found"))()}}))}}},{key:"_deleteScenegraph",value:function(){var e=this.state.scenegraph;e instanceof C&&e.delete()}},{key:"_getModelOptions",value:function(){var e=this.props._imageBasedLightingEnvironment,t=null;return e&&(t="function"==typeof e?e({gl:this.context.gl,layer:this}):e),{gl:this.context.gl,waitForFullLoad:!0,imageBasedLightingEnvironment:t,modelOptions:ye({isInstanced:!0,transpileToGLSL100:!Object(_.e)(this.context.gl)},this.getShaders()),useTangents:!1}}},{key:"updateAttributes",value:function(e){var t=this;this.setState({attributesAvailable:!0}),this.state.scenegraph&&this.state.scenegraph.traverse((function(n){t._setModelAttributes(n.model,e)}))}},{key:"draw",value:function(e){var t=e.moduleParameters,n=void 0===t?null:t,r=e.parameters,i=void 0===r?{}:r,a=e.context;if(this.state.scenegraph){this.props._animations&&this.state.animator&&(this.state.animator.animate(a.timeline.getTime()),this.setNeedsRedraw());var o=this.context.viewport,s=this.props,c=s.sizeScale,u=s.sizeMinPixels,l=s.sizeMaxPixels,f=s.opacity,p=s.coordinateSystem,h=this.getNumInstances();this.state.scenegraph.traverse((function(e,t){var r=t.worldMatrix;e.model.setInstanceCount(h),e.updateModuleSettings(n),e.draw({parameters:i,uniforms:{sizeScale:c,opacity:f,sizeMinPixels:u,sizeMaxPixels:l,composeModelMatrix:Object(me.b)(o,p),sceneModelMatrix:r,u_Camera:e.model.getUniforms().project_uCameraPosition}})}))}}}]),n}(O.a);Ae.layerName="ScenegraphLayer",Ae.defaultProps=je;var Se={name:"pbr",vs:"uniform mat4 u_MVPMatrix;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_NormalMatrix;\n\nvarying vec3 pbr_vPosition;\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n# ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n# else\nvarying vec3 pbr_vNormal;\n# endif\n#endif\n\nvoid pbr_setPositionNormalTangentUV(vec4 position, vec4 normal, vec4 tangent, vec2 uv)\n{\n  vec4 pos = u_ModelMatrix * position;\n  pbr_vPosition = vec3(pos.xyz) / pos.w;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\n  vec3 normalW = normalize(vec3(u_NormalMatrix * vec4(normal.xyz, 0.0)));\n  vec3 tangentW = normalize(vec3(u_ModelMatrix * vec4(tangent.xyz, 0.0)));\n  vec3 bitangentW = cross(normalW, tangentW) * tangent.w;\n  pbr_vTBN = mat3(tangentW, bitangentW, normalW);\n#else\n  pbr_vNormal = normalize(vec3(u_ModelMatrix * vec4(normal.xyz, 0.0)));\n#endif\n#endif\n\n#ifdef HAS_UV\n  pbr_vUV = uv;\n#else\n  pbr_vUV = vec2(0.,0.);\n#endif\n}\n",fs:"#if defined(USE_TEX_LOD) && !defined(FEATURE_GLSL_TEXTURE_LOD)\n# error PBR fragment shader: Texture LOD is not available\n#endif\n\n#if !defined(HAS_TANGENTS) && !defined(FEATURE_GLSL_DERIVATIVES)\n# error PBR fragment shader: Derivatives are not available\n#endif\n\n\n#if (__VERSION__ < 300)\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL1COND; INCR)\n#else\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL2COND; INCR)\n#endif\n\nprecision highp float;\n\nuniform bool pbr_uUnlit;\n\n#ifdef USE_IBL\nuniform samplerCube u_DiffuseEnvSampler;\nuniform samplerCube u_SpecularEnvSampler;\nuniform sampler2D u_brdfLUT;\nuniform vec2 u_ScaleIBLAmbient;\n#endif\n\n#ifdef HAS_BASECOLORMAP\nuniform sampler2D u_BaseColorSampler;\n#endif\n#ifdef HAS_NORMALMAP\nuniform sampler2D u_NormalSampler;\nuniform float u_NormalScale;\n#endif\n#ifdef HAS_EMISSIVEMAP\nuniform sampler2D u_EmissiveSampler;\nuniform vec3 u_EmissiveFactor;\n#endif\n#ifdef HAS_METALROUGHNESSMAP\nuniform sampler2D u_MetallicRoughnessSampler;\n#endif\n#ifdef HAS_OCCLUSIONMAP\nuniform sampler2D u_OcclusionSampler;\nuniform float u_OcclusionStrength;\n#endif\n\n#ifdef ALPHA_CUTOFF\nuniform float u_AlphaCutoff;\n#endif\n\nuniform vec2 u_MetallicRoughnessValues;\nuniform vec4 u_BaseColorFactor;\n\nuniform vec3 u_Camera;\n#ifdef PBR_DEBUG\nuniform vec4 u_ScaleDiffBaseMR;\nuniform vec4 u_ScaleFGDSpec;\n#endif\n\nvarying vec3 pbr_vPosition;\n\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n#else\nvarying vec3 pbr_vNormal;\n#endif\n#endif\n\n\nstruct PBRInfo\n{\n  float NdotL;\n  float NdotV;\n  float NdotH;\n  float LdotH;\n  float VdotH;\n  float perceptualRoughness;\n  float metalness;\n  vec3 reflectance0;\n  vec3 reflectance90;\n  float alphaRoughness;\n  vec3 diffuseColor;\n  vec3 specularColor;\n  vec3 n;\n  vec3 v;\n};\n\nconst float M_PI = 3.141592653589793;\nconst float c_MinRoughness = 0.04;\n\nvec4 SRGBtoLINEAR(vec4 srgbIn)\n{\n#ifdef MANUAL_SRGB\n#ifdef SRGB_FAST_APPROXIMATION\n  vec3 linOut = pow(srgbIn.xyz,vec3(2.2));\n#else\n  vec3 bLess = step(vec3(0.04045),srgbIn.xyz);\n  vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );\n#endif\n  return vec4(linOut,srgbIn.w);;\n#else\n  return srgbIn;\n#endif\n}\n\nvec3 getNormal()\n{\n#ifndef HAS_TANGENTS\n  vec3 pos_dx = dFdx(pbr_vPosition);\n  vec3 pos_dy = dFdy(pbr_vPosition);\n  vec3 tex_dx = dFdx(vec3(pbr_vUV, 0.0));\n  vec3 tex_dy = dFdy(vec3(pbr_vUV, 0.0));\n  vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\n\n#ifdef HAS_NORMALS\n  vec3 ng = normalize(pbr_vNormal);\n#else\n  vec3 ng = cross(pos_dx, pos_dy);\n#endif\n\n  t = normalize(t - ng * dot(ng, t));\n  vec3 b = normalize(cross(ng, t));\n  mat3 tbn = mat3(t, b, ng);\n#else\n  mat3 tbn = pbr_vTBN;\n#endif\n\n#ifdef HAS_NORMALMAP\n  vec3 n = texture2D(u_NormalSampler, pbr_vUV).rgb;\n  n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_NormalScale, u_NormalScale, 1.0)));\n#else\n  vec3 n = normalize(tbn[2].xyz);\n#endif\n\n  return n;\n}\n\n\n#ifdef USE_IBL\nvec3 getIBLContribution(PBRInfo pbrInputs, vec3 n, vec3 reflection)\n{\n  float mipCount = 9.0;\n  float lod = (pbrInputs.perceptualRoughness * mipCount);\n  vec3 brdf = SRGBtoLINEAR(texture2D(u_brdfLUT,\n    vec2(pbrInputs.NdotV, 1.0 - pbrInputs.perceptualRoughness))).rgb;\n  vec3 diffuseLight = SRGBtoLINEAR(textureCube(u_DiffuseEnvSampler, n)).rgb;\n\n#ifdef USE_TEX_LOD\n  vec3 specularLight = SRGBtoLINEAR(textureCubeLod(u_SpecularEnvSampler, reflection, lod)).rgb;\n#else\n  vec3 specularLight = SRGBtoLINEAR(textureCube(u_SpecularEnvSampler, reflection)).rgb;\n#endif\n\n  vec3 diffuse = diffuseLight * pbrInputs.diffuseColor;\n  vec3 specular = specularLight * (pbrInputs.specularColor * brdf.x + brdf.y);\n  diffuse *= u_ScaleIBLAmbient.x;\n  specular *= u_ScaleIBLAmbient.y;\n\n  return diffuse + specular;\n}\n#endif\n\n\nvec3 diffuse(PBRInfo pbrInputs)\n{\n  return pbrInputs.diffuseColor / M_PI;\n}\n\nvec3 specularReflection(PBRInfo pbrInputs)\n{\n  return pbrInputs.reflectance0 +\n    (pbrInputs.reflectance90 - pbrInputs.reflectance0) *\n    pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);\n}\n\n\n\nfloat geometricOcclusion(PBRInfo pbrInputs)\n{\n  float NdotL = pbrInputs.NdotL;\n  float NdotV = pbrInputs.NdotV;\n  float r = pbrInputs.alphaRoughness;\n\n  float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));\n  float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));\n  return attenuationL * attenuationV;\n}\n\n\n\n\n\nfloat microfacetDistribution(PBRInfo pbrInputs)\n{\n  float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;\n  float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;\n  return roughnessSq / (M_PI * f * f);\n}\n\nvoid PBRInfo_setAmbientLight(inout PBRInfo pbrInputs) {\n  pbrInputs.NdotL = 1.0;\n  pbrInputs.NdotH = 0.0;\n  pbrInputs.LdotH = 0.0;\n  pbrInputs.VdotH = 1.0;\n}\n\nvoid PBRInfo_setDirectionalLight(inout PBRInfo pbrInputs, vec3 lightDirection) {\n  vec3 n = pbrInputs.n;\n  vec3 v = pbrInputs.v;\n  vec3 l = normalize(lightDirection);\n  vec3 h = normalize(l+v);\n\n  pbrInputs.NdotL = clamp(dot(n, l), 0.001, 1.0);\n  pbrInputs.NdotH = clamp(dot(n, h), 0.0, 1.0);\n  pbrInputs.LdotH = clamp(dot(l, h), 0.0, 1.0);\n  pbrInputs.VdotH = clamp(dot(v, h), 0.0, 1.0);\n}\n\nvoid PBRInfo_setPointLight(inout PBRInfo pbrInputs, PointLight pointLight) {\n  vec3 light_direction = normalize(pointLight.position - pbr_vPosition);\n  PBRInfo_setDirectionalLight(pbrInputs, light_direction);\n}\n\nvec3 calculateFinalColor(PBRInfo pbrInputs, vec3 lightColor) {\n  vec3 F = specularReflection(pbrInputs);\n  float G = geometricOcclusion(pbrInputs);\n  float D = microfacetDistribution(pbrInputs);\n  vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);\n  vec3 specContrib = F * G * D / (4.0 * pbrInputs.NdotL * pbrInputs.NdotV);\n  return pbrInputs.NdotL * lightColor * (diffuseContrib + specContrib);\n}\n\nvec4 pbr_filterColor(vec4 colorUnused)\n{\n#ifdef HAS_BASECOLORMAP\n  vec4 baseColor = SRGBtoLINEAR(texture2D(u_BaseColorSampler, pbr_vUV)) * u_BaseColorFactor;\n#else\n  vec4 baseColor = u_BaseColorFactor;\n#endif\n\n#ifdef ALPHA_CUTOFF\n  if (baseColor.a < u_AlphaCutoff) {\n    discard;\n  }\n#endif\n\n  vec3 color = vec3(0, 0, 0);\n\n  if(pbr_uUnlit){\n    color.rgb = baseColor.rgb;\n  }\n  else{\n\n\n    float perceptualRoughness = u_MetallicRoughnessValues.y;\n    float metallic = u_MetallicRoughnessValues.x;\n#ifdef HAS_METALROUGHNESSMAP\n\n    vec4 mrSample = texture2D(u_MetallicRoughnessSampler, pbr_vUV);\n    perceptualRoughness = mrSample.g * perceptualRoughness;\n    metallic = mrSample.b * metallic;\n#endif\n    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);\n    metallic = clamp(metallic, 0.0, 1.0);\n\n    float alphaRoughness = perceptualRoughness * perceptualRoughness;\n\n    vec3 f0 = vec3(0.04);\n    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);\n    diffuseColor *= 1.0 - metallic;\n    vec3 specularColor = mix(f0, baseColor.rgb, metallic);\n    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\n\n\n\n    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);\n    vec3 specularEnvironmentR0 = specularColor.rgb;\n    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;\n\n    vec3 n = getNormal();\n    vec3 v = normalize(u_Camera - pbr_vPosition);\n\n    float NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);\n    vec3 reflection = -normalize(reflect(v, n));\n\n    PBRInfo pbrInputs = PBRInfo(\n      0.0,\n      NdotV,\n      0.0,\n      0.0,\n      0.0,\n      perceptualRoughness,\n      metallic,\n      specularEnvironmentR0,\n      specularEnvironmentR90,\n      alphaRoughness,\n      diffuseColor,\n      specularColor,\n      n,\n      v\n    );\n\n#ifdef USE_LIGHTS\n    PBRInfo_setAmbientLight(pbrInputs);\n    color += calculateFinalColor(pbrInputs, lighting_uAmbientLight.color);\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uDirectionalLightCount, i++) {\n      if (i < lighting_uDirectionalLightCount) {\n        PBRInfo_setDirectionalLight(pbrInputs, lighting_uDirectionalLight[i].direction);\n        color += calculateFinalColor(pbrInputs, lighting_uDirectionalLight[i].color);\n      }\n    }\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uPointLightCount, i++) {\n      if (i < lighting_uPointLightCount) {\n        PBRInfo_setPointLight(pbrInputs, lighting_uPointLight[i]);\n        float attenuation = getPointLightAttenuation(lighting_uPointLight[i], distance(lighting_uPointLight[i].position, pbr_vPosition));\n        color += calculateFinalColor(pbrInputs, lighting_uPointLight[i].color / attenuation);\n      }\n    }\n#endif\n#ifdef USE_IBL\n    color += getIBLContribution(pbrInputs, n, reflection);\n#endif\n#ifdef HAS_OCCLUSIONMAP\n    float ao = texture2D(u_OcclusionSampler, pbr_vUV).r;\n    color = mix(color, color * ao, u_OcclusionStrength);\n#endif\n\n#ifdef HAS_EMISSIVEMAP\n    vec3 emissive = SRGBtoLINEAR(texture2D(u_EmissiveSampler, pbr_vUV)).rgb * u_EmissiveFactor;\n    color += emissive;\n#endif\n\n#ifdef PBR_DEBUG\n\n\n\n\n\n    color = mix(color, baseColor.rgb, u_ScaleDiffBaseMR.y);\n    color = mix(color, vec3(metallic), u_ScaleDiffBaseMR.z);\n    color = mix(color, vec3(perceptualRoughness), u_ScaleDiffBaseMR.w);\n#endif\n\n  }\n\n  return vec4(pow(color,vec3(1.0/2.2)), baseColor.a);\n}\n",defines:{LIGHTING_FRAGMENT:1},dependencies:[n("SfzV").a]},xe=n("+w+S");function Te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Te(Object(n),!0).forEach((function(t){Object(a.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Te(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ie(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var i=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var Pe=function(e){Object(u.a)(n,e);var t=Ie(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"getShaders",value:function(){var e=Object(v.a)(Object(f.a)(n.prototype),"getShaders",this).call(this);return e.modules.push(Se),Ee(Ee({},e),{},{vs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-vs\nuniform float sizeScale;\nuniform bool composeModelMatrix;\nuniform bool u_pickFeatureIds;\nin vec3 positions;\nin vec3 normals;\nin vec3 colors;\nin vec2 texCoords;\nin vec4 uvRegions;\nin vec3 featureIdsPickingColors;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nout vec2 vTexCoord;\nout vec3 cameraPosition;\nout vec3 normals_commonspace;\nout vec4 position_commonspace;\nout vec4 vColor;\n\nvoid main(void) {\n  vec2 uv = fract(texCoords) * (uvRegions.zw - uvRegions.xy) + uvRegions.xy;\n\n  geometry.uv = uv;\n  geometry.uv = texCoords;\n\n  if (u_pickFeatureIds) {\n    geometry.pickingColor = featureIdsPickingColors;\n  } else {\n    geometry.pickingColor = instancePickingColors;\n  }\n\n  #ifdef MODULE_PBR\n    #ifdef HAS_NORMALS\n      pbr_vNormal = project_normal(instanceModelMatrix * normals);\n      geometry.normal = pbr_vNormal;\n    #endif\n\n    #ifdef HAS_UV\n      pbr_vUV = uv;\n    #else\n      pbr_vUV = vec2(0., 0.);\n    #endif\n    geometry.uv = pbr_vUV;\n  #endif\n\n  vTexCoord = uv;\n  cameraPosition = project_uCameraPosition;\n  normals_commonspace = project_normal(instanceModelMatrix * normals);\n  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);\n  geometry.normal = normals_commonspace;\n\n  vec3 pos = (instanceModelMatrix * positions) * sizeScale;\n  vec3 projectedPosition = project_position(positions);\n  position_commonspace = vec4(projectedPosition, 1.0);\n  gl_Position = project_common_position_to_clipspace(position_commonspace);\n\n  geometry.position = position_commonspace;\n\n  #ifdef MODULE_PBR\n    pbr_vPosition = geometry.position.xyz;\n  #endif\n\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-fs\n\nprecision highp float;\n\nuniform bool hasTexture;\nuniform sampler2D sampler;\nuniform bool flatShading;\nuniform float opacity;\n\nin vec2 vTexCoord;\nin vec3 cameraPosition;\nin vec3 normals_commonspace;\nin vec4 position_commonspace;\nin vec4 vColor;\n\nout vec4 fragColor;\n\nvoid main(void) {\n  \n#ifdef MODULE_PBR\n\n  fragColor = vColor * pbr_filterColor(vec4(0));\n  geometry.uv = pbr_vUV;\n  fragColor.a *= opacity;\n\n#else\n\n  geometry.uv = vTexCoord;\n\n  vec3 normal;\n  if (flatShading) {\n#ifdef DERIVATIVES_AVAILABLE\n    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));\n#else\n    normal = vec3(0.0, 0.0, 1.0);\n#endif\n  } else {\n    normal = normals_commonspace;\n  }\n\n  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;\n  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);\n  fragColor = vec4(lightColor, color.a * opacity);\n\n#endif\n\n  DECKGL_FILTER_COLOR(fragColor, geometry);\n}\n"})}},{key:"initializeState",value:function(){var e=this.props.featureIds;Object(v.a)(Object(f.a)(n.prototype),"initializeState",this).call(this),e&&this.state.attributeManager.add({featureIdsPickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateFeatureIdsPickingColors}})}},{key:"updateState",value:function(e){var t=e.props,r=e.oldProps,i=e.changeFlags;Object(v.a)(Object(f.a)(n.prototype),"updateState",this).call(this,{props:t,oldProps:r,changeFlags:i}),t.pbrMaterial!==r.pbrMaterial&&this.updatePbrMaterialUniforms(t.pbrMaterial)}},{key:"draw",value:function(e){var t=this.props.featureIds;this.state.model&&(this.state.model.setUniforms({u_Camera:this.state.model.getUniforms().project_uCameraPosition,u_pickFeatureIds:Boolean(t)}),Object(v.a)(Object(f.a)(n.prototype),"draw",this).call(this,e))}},{key:"getModel",value:function(e){var t,n=this.props,r=n.id,i=n.pbrMaterial,a=this.parseMaterial(i,e),o=this.getShaders();return(t=e.attributes).COLOR_0||t.colors||(t.colors={constant:!0,value:new Float32Array([1,1,1])}),t.uvRegions||(t.uvRegions={constant:!0,value:new Float32Array([0,0,1,1])}),new ee.a(this.context.gl,Ee(Ee({},this.getShaders()),{},{id:r,geometry:e,defines:Ee(Ee({},o.defines),null==a?void 0:a.defines),parameters:null==a?void 0:a.parameters,isInstanced:!0}))}},{key:"updatePbrMaterialUniforms",value:function(e){var t=this.state.model;if(t){var n=this.props.mesh,r=this.parseMaterial(e,n);t.setUniforms(r.uniforms)}}},{key:"parseMaterial",value:function(e,t){var n=Boolean(e.pbrMetallicRoughness&&e.pbrMetallicRoughness.baseColorTexture);return new ce(this.context.gl,{attributes:{NORMAL:t.attributes.normals,TEXCOORD_0:t.attributes.texCoords},material:Ee({unlit:n},e),pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1})}},{key:"calculateFeatureIdsPickingColors",value:function(e){for(var t=this.props.featureIds,n=new Uint8ClampedArray(t.length*e.size),r=[],i=0;i<t.length;i++)this.encodePickingColor(t[i],r),n[3*i]=r[0],n[3*i+1]=r[1],n[3*i+2]=r[2];e.value=n}}]),n}(xe.a);Pe.layerName="_MeshLayer",Pe.defaultProps={pbrMaterial:{type:"object",value:null},featureIds:{type:"array",value:null,optional:!0}};var we=n("xszv"),Re=n("Fqdk"),Le=n("FJ6+"),Ce=n("q1ac");function Ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ne(Object(n),!0).forEach((function(t){Object(a.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Be(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var i=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var De=[0],Ue={getPointColor:{type:"accessor",value:[0,0,0,255]},pointSize:1,data:null,loader:Ce.a,onTilesetLoad:{type:"function",value:function(e){},compare:!1},onTileLoad:{type:"function",value:function(e){},compare:!1},onTileUnload:{type:"function",value:function(e){},compare:!1},onTileError:{type:"function",value:function(e,t,n){},compare:!1},_getMeshColor:{type:"function",value:function(e){return[255,255,255]},compare:!1}},ke=function(e){Object(u.a)(r,e);var t,n=Be(r);function r(){return Object(s.a)(this,r),n.apply(this,arguments)}return Object(c.a)(r,[{key:"initializeState",value:function(){"onTileLoadFail"in this.props&&y.a.removed("onTileLoadFail","onTileError")(),this.state={layerMap:{},tileset3d:null,activeViewports:{},lastUpdatedViewports:null}}},{key:"isLoaded",get:function(){var e=this.state.tileset3d;return e&&e.isLoaded()}},{key:"shouldUpdateState",value:function(e){return e.changeFlags.somethingChanged}},{key:"updateState",value:function(e){var t=e.props,n=e.oldProps,r=e.changeFlags;if(t.data&&t.data!==n.data&&this._loadTileset(t.data),r.viewportChanged){var i=this.state.activeViewports;Object.keys(i).length&&(this._updateTileset(i),this.state.lastUpdatedViewports=i,this.state.activeViewports={})}if(r.propsChanged){var a=this.state.layerMap;for(var o in a)a[o].needsUpdate=!0}}},{key:"activateViewport",value:function(e){var t=this.state,n=t.activeViewports,r=t.lastUpdatedViewports;this.internalState.viewport=e,n[e.id]=e;var i=null==r?void 0:r[e.id];i&&e.equals(i)||(this.setChangeFlags({viewportChanged:!0}),this.setNeedsUpdate())}},{key:"getPickingInfo",value:function(e){var t=e.info,n=e.sourceLayer,r=this.state.layerMap,i=n&&n.id;if(i){var a=i.substring(this.id.length+1),o=a.substring(a.indexOf("-")+1);t.object=r[o]&&r[o].tile}return t}},{key:"filterSubLayer",value:function(e){var t=e.layer,n=e.viewport,r=t.props.tile,i=n.id;return r.viewportIds.includes(i)}},{key:"_updateAutoHighlight",value:function(e){e.sourceLayer&&e.sourceLayer.updateAutoHighlight(e)}},{key:"_loadTileset",value:(t=Object(o.a)(i.a.mark((function e(t){var n,r,a,o,s,c,u;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.props.loadOptions,r=void 0===n?{}:n,a=this.props.loader||this.props.loaders,Array.isArray(a)&&(a=a[0]),o={loadOptions:Me({},r)},!a.preload){e.next=10;break}return e.next=7,a.preload(t,r);case 7:(s=e.sent).headers&&(o.loadOptions.fetch=Me(Me({},o.loadOptions.fetch),{},{headers:s.headers})),Object.assign(o,s);case 10:return e.next=12,Object(we.a)(t,a,o.loadOptions);case 12:c=e.sent,u=new Re.a(c,Me({onTileLoad:this._onTileLoad.bind(this),onTileUnload:this._onTileUnload.bind(this),onTileLoadFail:this.props.onTileError},o)),this.setState({tileset3d:u,layerMap:{}}),this._updateTileset(this.state.activeViewports),this.props.onTilesetLoad(u);case 17:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"_onTileLoad",value:function(e){var t=this.state.lastUpdatedViewports;this.props.onTileLoad(e),this._updateTileset(t),this.setNeedsUpdate()}},{key:"_onTileUnload",value:function(e){delete this.state.layerMap[e.id],this.props.onTileUnload(e)}},{key:"_updateTileset",value:function(e){var t=this.state.tileset3d,n=this.context.timeline,r=Object.keys(e).length;if(n&&r&&t){var i=t.update(Object.values(e));this.state.frameNumber!==i&&this.setState({frameNumber:i})}}},{key:"_getSubLayer",value:function(e,t){if(!e.content)return null;switch(e.type){case Le.f.POINTCLOUD:return this._makePointCloudLayer(e,t);case Le.f.SCENEGRAPH:return this._make3DModelLayer(e,t);case Le.f.MESH:return this._makeSimpleMeshLayer(e,t);default:throw new Error("Tile3DLayer: Failed to render layer of type ".concat(e.content.type))}}},{key:"_makePointCloudLayer",value:function(e,t){var n=e.content,r=n.attributes,i=n.pointCount,a=n.constantRGBA,o=n.cartographicOrigin,s=n.modelMatrix,c=r.positions,u=r.normals,l=r.colors;if(!c)return null;var f=t&&t.props.data||{header:{vertexCount:i},attributes:{POSITION:c,NORMAL:u,COLOR_0:l}},p=this.props,d=p.pointSize,v=p.getPointColor;return new(this.getSubLayerClass("pointcloud",b.a))({pointSize:d},this.getSubLayerProps({id:"pointcloud"}),{id:"".concat(this.id,"-pointcloud-").concat(e.id),tile:e,data:f,coordinateSystem:h.a.METER_OFFSETS,coordinateOrigin:o,modelMatrix:s,getColor:a||v})}},{key:"_make3DModelLayer",value:function(e){var t=e.content,n=t.gltf,r=t.instances,i=t.cartographicOrigin,a=t.modelMatrix;return new(this.getSubLayerClass("scenegraph",Ae))({_lighting:"pbr"},this.getSubLayerProps({id:"scenegraph"}),{id:"".concat(this.id,"-scenegraph-").concat(e.id),tile:e,data:r||De,scenegraph:n,coordinateSystem:h.a.METER_OFFSETS,coordinateOrigin:i,modelMatrix:a,getTransformMatrix:function(e){return e.modelMatrix},getPosition:[0,0,0]})}},{key:"_makeSimpleMeshLayer",value:function(e,t){var n=e.content,r=n.attributes,i=n.indices,a=n.modelMatrix,o=n.cartographicOrigin,s=n.material,c=n.featureIds,u=this.props._getMeshColor,l=t&&t.props.mesh||new p.a({drawMode:4,attributes:Ve(r),indices:i});return new(this.getSubLayerClass("mesh",Pe))(this.getSubLayerProps({id:"mesh"}),{id:"".concat(this.id,"-mesh-").concat(e.id),tile:e,mesh:l,data:De,getColor:u(e),pbrMaterial:s,modelMatrix:a,coordinateOrigin:o,coordinateSystem:h.a.METER_OFFSETS,featureIds:c})}},{key:"renderLayers",value:function(){var e=this,t=this.state,n=t.tileset3d,r=t.layerMap;return n?n.tiles.map((function(t){var n=r[t.id]=r[t.id]||{tile:t},i=n.layer;return t.selected?i?n.needsUpdate?(i=e._getSubLayer(t,i),n.needsUpdate=!1):i.props.visible||(i=i.clone({visible:!0})):i=e._getSubLayer(t):i&&i.props.visible&&(i=i.clone({visible:!1})),n.layer=i,i})).filter(Boolean):null}}]),r}(d.a);function Ve(e){var t={};return t.positions=Me(Me({},e.positions),{},{value:new Float32Array(e.positions.value)}),e.normals&&(t.normals=e.normals),e.texCoords&&(t.texCoords=e.texCoords),e.colors&&(t.colors=e.colors),e.uvRegions&&(t.uvRegions=e.uvRegions),t}ke.layerName="Tile3DLayer",ke.defaultProps=Ue},HIr8:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return h}));var r=n("rpwb"),i=n("V3d6");function a(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){c=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw a}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var s=Math.PI/180,c=new Float32Array(16),u=new Float32Array(12);function l(e,t,n){var r=t[0]*s,i=t[1]*s,a=t[2]*s,o=Math.sin(a),c=Math.sin(r),u=Math.sin(i),l=Math.cos(a),f=Math.cos(r),p=Math.cos(i),h=n[0],d=n[1],b=n[2];e[0]=h*p*f,e[1]=h*u*f,e[2]=h*-c,e[3]=d*(-u*l+p*c*o),e[4]=d*(p*l+u*c*o),e[5]=d*f*o,e[6]=b*(u*o+p*c*l),e[7]=b*(-p*o+u*c*l),e[8]=b*f*l}function f(e){return e[0]=e[0],e[1]=e[1],e[2]=e[2],e[3]=e[4],e[4]=e[5],e[5]=e[6],e[6]=e[8],e[7]=e[9],e[8]=e[10],e[9]=e[12],e[10]=e[13],e[11]=e[14],e.subarray(0,12)}var p={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrix__LOCATION_0:{size:3,elementOffset:0},instanceModelMatrix__LOCATION_1:{size:3,elementOffset:3},instanceModelMatrix__LOCATION_2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update:function(e,t){var n=t.startRow,i=t.endRow,o=this.props,s=o.data,p=o.getOrientation,h=o.getScale,d=o.getTranslation,b=o.getTransformMatrix,v=Array.isArray(b),m=v&&16===b.length,g=Array.isArray(h),y=Array.isArray(p),O=Array.isArray(d),_=m||!v&&Boolean(b(s[0]));e.constant=_?m:y&&g&&O;var j=e.value;if(e.constant){var A;if(_)c.set(b),A=f(c);else l(A=u,p,h),A.set(d,9);e.value=new Float32Array(A)}else{var S,x=n*e.size,T=Object(r.a)(s,n,i),E=T.iterable,I=T.objectInfo,P=a(E);try{for(P.s();!(S=P.n()).done;){var w=S.value;I.index++;var R=void 0;if(_)c.set(m?b:b(w,I)),R=f(c);else l(R=u,y?p:p(w,I),g?h:h(w,I)),R.set(O?d:d(w,I),9);j[x++]=R[0],j[x++]=R[1],j[x++]=R[2],j[x++]=R[3],j[x++]=R[4],j[x++]=R[5],j[x++]=R[6],j[x++]=R[7],j[x++]=R[8],j[x++]=R[9],j[x++]=R[10],j[x++]=R[11]}}catch(L){P.e(L)}finally{P.f()}}}};function h(e,t){return t===i.a.CARTESIAN||t===i.a.METER_OFFSETS||t===i.a.DEFAULT&&!e.isGeospatial}},Hogv:function(e,t,n){"use strict";(function(e){var t=n("JrVf"),r=n("Vyni"),i=n("P5C6");function a(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){c=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw a}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function s(e,t){var n=t.extension,a=t.target,o=t.target2,s=i.b[n];Object(r.a)(s);for(var c=s.meta,u=(void 0===c?{}:c).suffix,l=void 0===u?"":u,f=e.getExtension(n),p=function(){var t=d[h],n="".concat(t).concat(l),r=null;"meta"===t||"function"==typeof e[t]||(f&&"function"==typeof f[n]?r=function(){return f[n].apply(f,arguments)}:"function"==typeof s[t]&&(r=s[t].bind(a))),r&&(a[t]=r,o[t]=r)},h=0,d=Object.keys(s);h<d.length;h++)p()}(void 0!==e?e:window).polyfillContext=function(e){e.luma=e.luma||{};var n=e.luma;return n.polyfilled||(Object(t.a)(e),function(e){e.luma.extensions={};var t,n=a(e.getSupportedExtensions()||[]);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.luma[r]=e.getExtension(r)}}catch(i){n.e(i)}finally{n.f()}}(e),function(e,t){var n,r=a(Object.getOwnPropertyNames(t));try{for(r.s();!(n=r.n()).done;){var i=n.value;"overrides"!==i&&s(e,{extension:i,target:e.luma,target2:e})}}catch(o){r.e(o)}finally{r.f()}}(e,i.b),function(e,t){var n=t.target,r=t.target2;Object.keys(i.a).forEach((function(t){if("function"==typeof i.a[t]){var a=e[t]?e[t].bind(e):function(){},o=i.a[t].bind(null,e,a);n[t]=o,r[t]=o}}))}(e,{target:n,target2:e}),n.polyfilled=!0),e}}).call(this,n("yLpj"))},J4mz:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r=n("1OyB"),i=n("vuIU"),a=1048576,o=1024*a;function s(e){var t,n,r;return e<1?(t=1e3*e,n="s",r=0):e<1e3?(t=e,n="ms",r=2):(t=e/1e3,n="s",r=2),"".concat(t.toFixed(r)).concat(n)}var c=n("VwXc"),u=function(){function e(t,n){Object(r.a)(this,e),this.name=t,this.type=n,this.sampleSize=1,this.reset()}return Object(i.a)(e,[{key:"setSampleSize",value:function(e){return this.sampleSize=e,this}},{key:"incrementCount",value:function(){return this.addCount(1),this}},{key:"decrementCount",value:function(){return this.subtractCount(1),this}},{key:"addCount",value:function(e){return this._count+=e,this._samples++,this._checkSampling(),this}},{key:"subtractCount",value:function(e){return this._count-=e,this._samples++,this._checkSampling(),this}},{key:"addTime",value:function(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}},{key:"timeStart",value:function(){return this._startTime=Object(c.a)(),this._timerPending=!0,this}},{key:"timeEnd",value:function(){return this._timerPending?(this.addTime(Object(c.a)()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}},{key:"getSampleAverageCount",value:function(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}},{key:"getSampleAverageTime",value:function(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}},{key:"getSampleHz",value:function(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}},{key:"getAverageCount",value:function(){return this.samples>0?this.count/this.samples:0}},{key:"getAverageTime",value:function(){return this.samples>0?this.time/this.samples:0}},{key:"getHz",value:function(){return this.time>0?this.samples/(this.time/1e3):0}},{key:"reset",value:function(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}},{key:"_checkSampling",value:function(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}]),e}(),l=function(){function e(t){var n=t.id,i=t.stats;Object(r.a)(this,e),this.id=n,this.stats={},this._initializeStats(i),Object.seal(this)}return Object(i.a)(e,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"count";return this._getOrCreate({name:e,type:t})}},{key:"size",get:function(){return Object.keys(this.stats).length}},{key:"reset",value:function(){for(var e in this.stats)this.stats[e].reset();return this}},{key:"forEach",value:function(e){for(var t in this.stats)e(this.stats[t])}},{key:"getTable",value:function(){var e={};return this.forEach((function(t){e[t.name]={time:t.time||0,count:t.count||0,average:t.getAverageTime()||0,hz:t.getHz()||0}})),e}},{key:"_initializeStats",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.forEach((function(t){return e._getOrCreate(t)}))}},{key:"_getOrCreate",value:function(e){if(!e||!e.name)return null;var t=e.name,n=e.type;return this.stats[t]||(this.stats[t]=e instanceof u?e:new u(t,n)),this.stats[t]}}]),e}(),f={position:"fixed",zIndex:1e4,color:"#ccc",background:"#000",fontFamily:"Helvetica,Arial,sans-serif",padding:"8px",fontSize:"12px",lineSpacing:6},p={fontSize:"16px"},h={paddingLeft:"8px"},d={count:function(e){return"".concat(e.name,": ").concat(e.count)},averageTime:function(e){return"".concat(e.name,": ").concat(s(e.getAverageTime()))},totalTime:function(e){return"".concat(e.name,": ").concat(s(e.time))},fps:function(e){return"".concat(e.name,": ").concat(Math.round(e.getHz()),"fps")},memory:function(e){return"".concat(e.name,": ").concat(((t=e.count)<1024?(n=t,r=" bytes",i=0):t<a?(n=t/1024,r="kB",i=2):t<o?(n=t/a,r="MB",i=2):(n=t/o,r="GB",i=2),"".concat(n.toFixed(i)).concat(r)));var t,n,r,i}},b=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(r.a)(this,e),this.stats=t,this.title=n.title,this._framesPerUpdate=Math.round(Math.max(n.framesPerUpdate||1,1)),this._formatters=d,this._resetOnUpdate={},this._counter=0,this._initializeFormatters(n),this._initializeUpdateConfigs(n),this._css=Object.assign({},f,n.css),this._headerCSS=Object.assign({},p,this._css.header),this._itemCSS=Object.assign({},h,this._css.item),delete this._css.header,delete this._css.item,this._container=null,this._header=null,this._items={},this._createDOM(n.container),this._createDOMHeader(),this._createDOMStats()}return Object(i.a)(e,[{key:"setStats",value:function(e){this.stats=e,this._createDOMStats(this._container),this._setHeaderContent(e.id),this.update()}},{key:"update",value:function(){var e=this.stats&&this.stats.stats;e&&0!==Object.keys(e).length&&this._counter++%this._framesPerUpdate==0&&this._update()}},{key:"_update",value:function(){var e=this;this.stats.forEach((function(t){e._createDOMItem(t.name),e._items[t.name].innerHTML=e._getLines(t).join("<BR>"),e._resetOnUpdate[t.name]&&t.reset()}))}},{key:"_initializeFormatters",value:function(e){if(e.formatters)for(var t in e.formatters){var n=e.formatters[t];"string"==typeof n&&(n=d[n]),this._formatters[t]=n}}},{key:"_initializeUpdateConfigs",value:function(e){if(e.resetOnUpdate)for(var t in e.resetOnUpdate)this._resetOnUpdate[t]=e.resetOnUpdate[t]}},{key:"_createDOM",value:function(e){if("undefined"!=typeof document&&document&&(this._container=e,!this._container)){for(var t in this._container=document.createElement("div"),this._css)this._container.style[t]=this._css[t];document.body.appendChild(this._container)}}},{key:"_createDOMHeader",value:function(){if(!this._header){for(var e in this._header=document.createElement("div"),this._headerCSS)this._header.style[e]=this._headerCSS[e];this._container.appendChild(this._header)}this._setHeaderContent()}},{key:"_setHeaderContent",value:function(e){this._header&&(this._header.innerText=e||this.title||this.stats&&this.stats.id||"")}},{key:"_createDOMStats",value:function(){var e=this;this.stats instanceof l&&this.stats.forEach((function(t){e._createDOMItem(t.name)}))}},{key:"_createDOMItem",value:function(e){if(this._container&&!this._items[e]){for(var t in this._items[e]=document.createElement("div"),this._itemCSS)this._items[e].style[t]=this._itemCSS[t];this._container.appendChild(this._items[e])}}},{key:"_getLines",value:function(e){return(this._formatters[e.name]||this._formatters[e.type]||d.count)(this.stats.get(e.name)).split("\n")}}]),e}()},JrVf:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("xSaR"),i={};function a(e,t){var n;i[e]=!0,void 0!==t&&(n=t,r.global.console&&r.global.console.error&&r.global.console.error(n))}var o=function e(t){var n=t.gl;this.ext=t,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(t.maxVertexAttribs);for(var r=0;r<this.attribs.length;r++){var i=new e.VertexAttrib(n);this.attribs[r]=i}this.maxAttrib=0};(o.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()}).prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};var s=function(e){var t=this;this.gl=e,function(e){var t=e.getError;e.getError=function(){var n;do{0!==(n=t.apply(e))&&(i[n]=!0)}while(0!==n);for(n in i)if(i[n])return delete i[n],parseInt(n,10);return 0}}(e);var n=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(e){return e===t.VERTEX_ARRAY_BINDING_OES?t.currentVertexArrayObject===t.defaultVertexArrayObject?null:t.currentVertexArrayObject:n.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(e){var r=t.currentVertexArrayObject;r.maxAttrib=Math.max(r.maxAttrib,e);var i=r.attribs[e];return i.enabled=!0,n.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(e){var r=t.currentVertexArrayObject;r.maxAttrib=Math.max(r.maxAttrib,e);var i=r.attribs[e];return i.enabled=!1,n.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(e,r){switch(e){case 34962:t.currentArrayBuffer=r;break;case 34963:t.currentVertexArrayObject.elementArrayBuffer=r}return n.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(e,r){var i=t.currentVertexArrayObject,a=i.attribs[e];switch(r){case 34975:return a.buffer;case 34338:return a.enabled;case 34339:return a.size;case 34340:return a.stride;case 34341:return a.type;case 34922:return a.normalized;default:return n.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(e,r,i,a,o,s){var c=t.currentVertexArrayObject;c.maxAttrib=Math.max(c.maxAttrib,e);var u=c.attribs[e];return u.buffer=t.currentArrayBuffer,u.size=r,u.type=i,u.normalized=a,u.stride=o,u.offset=s,u.recache(),n.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",(function(){var e;e="OESVertexArrayObject emulation library context restored",r.global.console&&r.global.console.log&&r.global.console.log(e),t.reset_()}),!0),this.reset_()};function c(e){if("function"!=typeof e.createVertexArray){var t=e.getSupportedExtensions;e.getSupportedExtensions=function(){var e=t.call(this)||[];return e.indexOf("OES_vertex_array_object")<0&&e.push("OES_vertex_array_object"),e};var n=e.getExtension;e.getExtension=function(t){var r=n.call(this,t);return r||("OES_vertex_array_object"!==t?null:(e.__OESVertexArrayObject||(this.__OESVertexArrayObject=new s(this)),this.__OESVertexArrayObject))}}}s.prototype.VERTEX_ARRAY_BINDING_OES=34229,s.prototype.reset_=function(){if(void 0!==this.vertexArrayObjects)for(var e=0;e<this.vertexArrayObjects.length;++e)this.vertexArrayObjects.isAlive=!1;var t=this.gl;this.maxVertexAttribs=t.getParameter(34921),this.defaultVertexArrayObject=new o(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)},s.prototype.createVertexArrayOES=function(){var e=new o(this);return this.vertexArrayObjects.push(e),e},s.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)},s.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof o&&e.hasBeenBound&&e.ext===this)},s.prototype.bindVertexArrayOES=function(e){var t=this.gl;if(!e||e.isAlive){var n=this.original,r=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;var i=this.currentVertexArrayObject;if(r!==i){r&&i.elementArrayBuffer===r.elementArrayBuffer||n.bindBuffer.call(t,34963,i.elementArrayBuffer);for(var o=this.currentArrayBuffer,s=Math.max(r?r.maxAttrib:0,i.maxAttrib),c=0;c<=s;c++){var u=i.attribs[c],l=r?r.attribs[c]:null;if(r&&u.enabled===l.enabled||(u.enabled?n.enableVertexAttribArray.call(t,c):n.disableVertexAttribArray.call(t,c)),u.enabled){var f=!1;r&&u.buffer===l.buffer||(o!==u.buffer&&(n.bindBuffer.call(t,34962,u.buffer),o=u.buffer),f=!0),(f||u.cached!==l.cached)&&n.vertexAttribPointer.call(t,c,u.size,u.type,u.normalized,u.stride,u.offset)}}this.currentArrayBuffer!==o&&n.bindBuffer.call(t,34962,this.currentArrayBuffer)}}else a(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject")}},"Oz/4":function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n("1OyB"),i=n("vuIU"),a=n("Ji7U"),o=n("md7G"),s=n("foSv"),c=n("sYR6"),u=n("a3TU"),l=n("+H0l"),f=n("ZxFD"),p=n("sSh/");function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var i=Object(s.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var d=function(e){Object(a.a)(n,e);var t=h(n);function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Object(r.a)(this,n),e=t.call(this,2),Object(u.f)(i)&&1===arguments.length?e.copy(i):(u.b.debug&&(Object(l.a)(i),Object(l.a)(a)),e[0]=i,e[1]=a),e}return Object(i.a)(n,[{key:"set",value:function(e,t){return this[0]=e,this[1]=t,this.check()}},{key:"copy",value:function(e){return this[0]=e[0],this[1]=e[1],this.check()}},{key:"fromObject",value:function(e){return u.b.debug&&(Object(l.a)(e.x),Object(l.a)(e.y)),this[0]=e.x,this[1]=e.y,this.check()}},{key:"toObject",value:function(e){return e.x=this[0],e.y=this[1],e}},{key:"ELEMENTS",get:function(){return 2}},{key:"horizontalAngle",value:function(){return Math.atan2(this.y,this.x)}},{key:"verticalAngle",value:function(){return Math.atan2(this.x,this.y)}},{key:"transform",value:function(e){return this.transformAsPoint(e)}},{key:"transformAsPoint",value:function(e){return f.j(this,this,e),this.check()}},{key:"transformAsVector",value:function(e){return Object(p.a)(this,this,e),this.check()}},{key:"transformByMatrix3",value:function(e){return f.i(this,this,e),this.check()}},{key:"transformByMatrix2x3",value:function(e){return f.h(this,this,e),this.check()}},{key:"transformByMatrix2",value:function(e){return f.g(this,this,e),this.check()}}]),n}(c.a)},P5C6:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return f}));var r,i,a=n("rePB"),o=n("Vyni"),s=n("oJMS"),c=function(e){return Object(s.b)(e)?void 0:0},u=(r={},Object(a.a)(r,3074,(function(e){return Object(s.b)(e)?void 0:36064})),Object(a.a)(r,35723,(function(e){return Object(s.b)(e)?void 0:4352})),Object(a.a)(r,35977,c),Object(a.a)(r,32937,c),Object(a.a)(r,36795,(function(e,t){var n=Object(s.b)(e)?e.getExtension("EXT_disjoint_timer_query_webgl2"):e.getExtension("EXT_disjoint_timer_query");return n&&n.GPU_DISJOINT_EXT?t(n.GPU_DISJOINT_EXT):0})),Object(a.a)(r,37445,(function(e,t){var n=e.getExtension("WEBGL_debug_renderer_info");return t(n&&n.UNMASKED_VENDOR_WEBGL||7936)})),Object(a.a)(r,37446,(function(e,t){var n=e.getExtension("WEBGL_debug_renderer_info");return t(n&&n.UNMASKED_RENDERER_WEBGL||7937)})),Object(a.a)(r,34047,(function(e,t){var n=e.luma.extensions.EXT_texture_filter_anisotropic;return n?t(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1})),Object(a.a)(r,32883,c),Object(a.a)(r,35071,c),Object(a.a)(r,37447,c),Object(a.a)(r,36063,(function(e,t){if(!Object(s.b)(e)){var n=e.getExtension("WEBGL_draw_buffers");return n?t(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}})),Object(a.a)(r,35379,c),Object(a.a)(r,35374,c),Object(a.a)(r,35377,c),Object(a.a)(r,34852,(function(e){if(!Object(s.b)(e)){var t=e.getExtension("WEBGL_draw_buffers");return t?t.MAX_DRAW_BUFFERS_WEBGL:0}})),Object(a.a)(r,36203,(function(e){return e.getExtension("OES_element_index")?2147483647:65535})),Object(a.a)(r,33001,(function(e){return e.getExtension("OES_element_index")?16777216:65535})),Object(a.a)(r,33e3,(function(e){return 16777216})),Object(a.a)(r,37157,c),Object(a.a)(r,35373,c),Object(a.a)(r,35657,c),Object(a.a)(r,36183,c),Object(a.a)(r,37137,c),Object(a.a)(r,34045,c),Object(a.a)(r,35978,c),Object(a.a)(r,35979,c),Object(a.a)(r,35968,c),Object(a.a)(r,35376,c),Object(a.a)(r,35375,c),Object(a.a)(r,35659,c),Object(a.a)(r,37154,c),Object(a.a)(r,35371,c),Object(a.a)(r,35658,c),Object(a.a)(r,35076,c),Object(a.a)(r,35077,c),Object(a.a)(r,35380,c),r);var l=(i={},Object(a.a)(i,"OES_vertex_array_object",{meta:{suffix:"OES"},createVertexArray:function(){Object(o.a)(!1,"VertexArray requires WebGL2 or OES_vertex_array_object extension")},deleteVertexArray:function(){},bindVertexArray:function(){},isVertexArray:function(){return!1}}),Object(a.a)(i,"ANGLE_instanced_arrays",{meta:{suffix:"ANGLE"},vertexAttribDivisor:function(e,t){Object(o.a)(0===t,"WebGL instanced rendering not supported")},drawElementsInstanced:function(){},drawArraysInstanced:function(){}}),Object(a.a)(i,"WEBGL_draw_buffers",{meta:{suffix:"WEBGL"},drawBuffers:function(){Object(o.a)(!1)}}),Object(a.a)(i,"EXT_disjoint_timer_query",{meta:{suffix:"EXT"},createQuery:function(){Object(o.a)(!1)},deleteQuery:function(){Object(o.a)(!1)},beginQuery:function(){Object(o.a)(!1)},endQuery:function(){},getQuery:function(e,t){return this.getQueryObject(e,t)},getQueryParameter:function(e,t){return this.getQueryObject(e,t)},getQueryObject:function(){}}),i),f={readBuffer:function(e,t,n){Object(s.b)(e)&&t(n)},getVertexAttrib:function(e,t,n,r){var i,a=function(e,t){return{webgl2:Object(s.b)(e),ext:e.getExtension(t)}}(e,"ANGLE_instanced_arrays"),o=a.webgl2,c=a.ext;switch(r){case 35069:i=!!o&&void 0;break;case 35070:i=o||c?void 0:0}return void 0!==i?i:t(n,r)},getProgramParameter:function(e,t,n,r){if(!Object(s.b)(e))switch(r){case 35967:return 35981;case 35971:case 35382:return 0}return t(n,r)},getInternalformatParameter:function(e,t,n,r,i){if(!Object(s.b)(e))switch(i){case 32937:return new Int32Array([0])}return e.getInternalformatParameter(n,r,i)},getTexParameter:function(e,t,n,r){switch(r){case 34046:var i=e.luma.extensions.EXT_texture_filter_anisotropic;r=i&&i.TEXTURE_MAX_ANISOTROPY_EXT||34046}return t(n,r)},getParameter:function(e,t,n){var r=u[n],i="function"==typeof r?r(e,t,n):r;return void 0!==i?i:t(n)},hint:function(e,t,n,r){return t(n,r)}}},TYJr:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));var r=n("Qk7e");function i(e,t){return Object(r.a)(e>=0),Object(r.a)(t>0),e+(t-1)&~(t-1)}function a(e,t,n){var r;if(e instanceof ArrayBuffer)r=new Uint8Array(e);else{var a=e.byteOffset,o=e.byteLength;r=new Uint8Array(e.buffer||e.arrayBuffer,a,o)}return t.set(r,n),n+i(r.byteLength,4)}},VwXc:function(e,t,n){"use strict";(function(e){function r(){var t;if("undefined"!=typeof window&&window.performance)t=window.performance.now();else if(void 0!==e&&e.hrtime){var n=e.hrtime();t=1e3*n[0]+n[1]/1e6}else t=Date.now();return t}n.d(t,"a",(function(){return r}))}).call(this,n("8oxB"))},Vyni:function(e,t,n){"use strict";function r(e,t){if(!e)throw new Error(t||"luma.gl: assertion failed.")}n.d(t,"a",(function(){return r}))},Wium:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var r=n("rePB"),i=n("1OyB"),a=n("vuIU"),o=n("Ji7U"),s=n("md7G"),c=n("foSv"),u=n("wldP"),l=n("c9N0"),f=n("v88f");function p(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var i=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(s.a)(this,n)}}var m=["bearing","pitch"],g={speed:1.2,curve:1.414},y=function(e){Object(o.a)(n,e);var t=v(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i.a)(this,n),(e=t.call(this,{compare:["longitude","latitude","zoom","bearing","pitch"],extract:["width","height","longitude","latitude","zoom","bearing","pitch"],required:["width","height","latitude","longitude","zoom"]})).props=b(b({},g),r),e}return Object(a.a)(n,[{key:"interpolateProps",value:function(e,t,n){var r,i=Object(f.c)(e,t,n,this.props),a=p(m);try{for(a.s();!(r=a.n()).done;){var o=r.value;i[o]=Object(l.e)(e[o]||0,t[o]||0,n)}}catch(s){a.e(s)}finally{a.f()}return i}},{key:"getDuration",value:function(e,t){var n=t.transitionDuration;return"auto"===n&&(n=Object(f.f)(e,t,this.props)),n}}]),n}(u.a)},gXd2:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return l}));var r=n("rp2x"),i=(n("9Q0L"),n("Vyni")),a=n("oJMS"),o=n("3SJd");function s(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function u(e,t){if(Object(i.a)(Object(a.a)(e),"setParameters requires a WebGL context"),!Object(o.b)(t)){var n={};for(var s in t){var c=Number(s),u=r.e[s];u&&("string"==typeof u?n[u]=!0:u(e,t[s],c))}var l=e.state&&e.state.cache;if(l)for(var f in n){(0,r.a[f])(e,t,l)}}}function l(e,t){if("number"==typeof(t=t||r.c)){var n=t,i=r.d[n];return i?i(e,n):e.getParameter(n)}var a,o={},c=s(Array.isArray(t)?t:Object.keys(t));try{for(c.s();!(a=c.n()).done;){var u=a.value,l=r.d[u];o[u]=l?l(e,Number(u)):e.getParameter(Number(u))}}catch(f){c.e(f)}finally{c.f()}return o}},ltlc:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("rOaP");function i(e){try{return JSON.parse(e)}catch(t){throw new Error('Failed to parse JSON from data starting with "'+Object(r.a)(e)+'"')}}},oJMS:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));n("Vyni");function r(e){return"undefined"!=typeof WebGLRenderingContext&&e instanceof WebGLRenderingContext||("undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||Boolean(e&&Number.isFinite(e._version)))}function i(e){return"undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||Boolean(e&&2===e._version)}},"p/I1":function(e,t,n){"use strict";n.d(t,"a",(function(){return et}));var r={};n.r(r),n.d(r,"decode",(function(){return H})),n.d(r,"encode",(function(){return X}));var i={};n.r(i),n.d(i,"decode",(function(){return ee})),n.d(i,"encode",(function(){return ne}));var a={};n.r(a),n.d(a,"decode",(function(){return ae})),n.d(a,"encode",(function(){return se}));var o={};n.r(o),n.d(o,"decode",(function(){return fe})),n.d(o,"encode",(function(){return he}));var s=n("o0o1"),c=n.n(s),u=n("rePB"),l=(n("wcNg"),n("HaE+")),f="undefined"!=typeof __VERSION__?__VERSION__:"latest",p=n("j7CB"),h=n("ltlc"),d=n("w0jg");function b(e,t){if(!e)throw new Error(t||"assert failed: gltf")}function v(e,t){if(e.startsWith("data:")||e.startsWith("http:")||e.startsWith("https:"))return e;var n=t.baseUri||t.uri;if(!n)throw new Error("'baseUri' must be provided to resolve relative url "+e);return n.substr(0,n.lastIndexOf("/")+1)+e}function m(e,t,n){var r=e.bufferViews[n];b(r);var i=t[r.buffer];b(i);var a=(r.byteOffset||0)+i.byteOffset;return new Uint8Array(i.arrayBuffer,a,r.byteLength)}var g=n("F2Cy"),y=n("vuIU"),O=n("vbYh"),_=n("TYJr"),j=["SCALAR","VEC2","VEC3","VEC4"],A=[[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126],[Float64Array,5130]],S=new Map(A),x={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},T={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},E={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function I(e){return j[e-1]||j[0]}function P(e){var t=S.get(e.constructor);if(!t)throw new Error("Illegal typed array");return t}function w(e,t){var n=E[e.componentType],r=x[e.type],i=T[e.componentType],a=e.count*r,o=e.count*r*i;return b(o>=0&&o<=t.byteLength),{ArrayType:n,length:a,byteLength:o}}function R(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return L(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return L(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){Object(u.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var M={asset:{version:"2.0",generator:"loaders.gl"},buffers:[]},B=function(){function e(e){this.gltf=e||{json:N({},M),buffers:[]},this.sourceBuffers=[],this.byteLength=0,this.gltf.buffers&&this.gltf.buffers[0]&&(this.byteLength=this.gltf.buffers[0].byteLength,this.sourceBuffers=[this.gltf.buffers[0]])}var t=e.prototype;return t.getApplicationData=function(e){return this.json[e]},t.getExtraData=function(e){return(this.json.extras||{})[e]},t.getExtension=function(e){var t=this.getUsedExtensions().find((function(t){return t===e})),n=this.json.extensions||{};return t?n[e]||!0:null},t.getRequiredExtension=function(e){return this.getRequiredExtensions().find((function(t){return t===e}))?this.getExtension(e):null},t.getRequiredExtensions=function(){return this.json.extensionsRequired||[]},t.getUsedExtensions=function(){return this.json.extensionsUsed||[]},t.getObjectExtension=function(e,t){return(e.extensions||{})[t]},t.getScene=function(e){return this.getObject("scenes",e)},t.getNode=function(e){return this.getObject("nodes",e)},t.getSkin=function(e){return this.getObject("skins",e)},t.getMesh=function(e){return this.getObject("meshes",e)},t.getMaterial=function(e){return this.getObject("materials",e)},t.getAccessor=function(e){return this.getObject("accessors",e)},t.getTexture=function(e){return this.getObject("textures",e)},t.getSampler=function(e){return this.getObject("samplers",e)},t.getImage=function(e){return this.getObject("images",e)},t.getBufferView=function(e){return this.getObject("bufferViews",e)},t.getBuffer=function(e){return this.getObject("buffers",e)},t.getObject=function(e,t){if("object"==typeof t)return t;var n=this.json[e]&&this.json[e][t];if(!n)throw new Error("glTF file error: Could not find "+e+"["+t+"]");return n},t.getTypedArrayForBufferView=function(e){var t=(e=this.getBufferView(e)).buffer,n=this.gltf.buffers[t];b(n);var r=(e.byteOffset||0)+n.byteOffset;return new Uint8Array(n.arrayBuffer,r,e.byteLength)},t.getTypedArrayForAccessor=function(e){e=this.getAccessor(e);var t=this.getBufferView(e.bufferView),n=this.getBuffer(t.buffer).data,r=w(e,t),i=r.ArrayType,a=r.length;return new i(n,t.byteOffset+e.byteOffset,a)},t.getTypedArrayForImageData=function(e){e=this.getAccessor(e);var t=this.getBufferView(e.bufferView),n=this.getBuffer(t.buffer).data,r=t.byteOffset||0;return new Uint8Array(n,r,t.byteLength)},t.addApplicationData=function(e,t){return this.json[e]=t,this},t.addExtraData=function(e,t){return this.json.extras=this.json.extras||{},this.json.extras[e]=t,this},t.addObjectExtension=function(e,t,n){return e.extensions=e.extensions||{},e.extensions[t]=n,this.registerUsedExtension(t),this},t.setObjectExtension=function(e,t,n){(e.extensions||{})[t]=n},t.removeObjectExtension=function(e,t){var n=e.extensions||{},r=n[t];return delete n[t],r},t.addExtension=function(e,t){return void 0===t&&(t={}),b(t),this.json.extensions=this.json.extensions||{},this.json.extensions[e]=t,this.registerUsedExtension(e),t},t.addRequiredExtension=function(e,t){return void 0===t&&(t={}),b(t),this.addExtension(e,t),this.registerRequiredExtension(e),t},t.registerUsedExtension=function(e){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find((function(t){return t===e}))||this.json.extensionsUsed.push(e)},t.registerRequiredExtension=function(e){this.registerUsedExtension(e),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find((function(t){return t===e}))||this.json.extensionsRequired.push(e)},t.removeExtension=function(e){this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,e),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,e),this.json.extensions&&delete this.json.extensions[e]},t.setDefaultScene=function(e){this.json.scene=e},t.addScene=function(e){var t=e.nodeIndices;return this.json.scenes=this.json.scenes||[],this.json.scenes.push({nodes:t}),this.json.scenes.length-1},t.addNode=function(e){var t=e.meshIndex,n=e.matrix;this.json.nodes=this.json.nodes||[];var r={mesh:t};return n&&(r.matrix=n),this.json.nodes.push(r),this.json.nodes.length-1},t.addMesh=function(e){var t=e.attributes,n=e.indices,r=e.material,i=e.mode,a=void 0===i?4:i,o={primitives:[{attributes:this._addAttributes(t),mode:a}]};if(n){var s=this._addIndices(n);o.primitives[0].indices=s}return Number.isFinite(r)&&(o.primitives[0].material=r),this.json.meshes=this.json.meshes||[],this.json.meshes.push(o),this.json.meshes.length-1},t.addPointCloud=function(e){var t={primitives:[{attributes:this._addAttributes(e),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(t),this.json.meshes.length-1},t.addImage=function(e,t){var n=Object(O.a)(e),r=t||(null==n?void 0:n.mimeType),i={bufferView:this.addBufferView(e),mimeType:r};return this.json.images=this.json.images||[],this.json.images.push(i),this.json.images.length-1},t.addBufferView=function(e){var t=e.byteLength;b(Number.isFinite(t)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(e);var n={buffer:0,byteOffset:this.byteLength,byteLength:t};return this.byteLength+=Object(_.b)(t,4),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(n),this.json.bufferViews.length-1},t.addAccessor=function(e,t){var n={bufferView:e,type:I(t.size),componentType:t.componentType,count:t.count,max:t.max,min:t.min};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(n),this.json.accessors.length-1},t.addBinaryBuffer=function(e,t){void 0===t&&(t={size:3});var n=this.addBufferView(e),r={min:t.min,max:t.max};r.min&&r.max||(r=this._getAccessorMinMax(e,t.size));var i={size:t.size,componentType:P(e),count:Math.round(e.length/t.size),min:r.min,max:r.max};return this.addAccessor(n,Object.assign(i,t))},t.addTexture=function(e){var t={source:e.imageIndex};return this.json.textures=this.json.textures||[],this.json.textures.push(t),this.json.textures.length-1},t.addMaterial=function(e){return this.json.materials=this.json.materials||[],this.json.materials.push(e),this.json.materials.length-1},t.createBinaryChunk=function(){var e,t;this.gltf.buffers=[];for(var n,r=this.byteLength,i=new ArrayBuffer(r),a=new Uint8Array(i),o=0,s=R(this.sourceBuffers||[]);!(n=s()).done;){var c=n.value;o=Object(_.a)(c,a,o)}null!==(e=this.json)&&void 0!==e&&null!==(t=e.buffers)&&void 0!==t&&t[0]?this.json.buffers[0].byteLength=r:this.json.buffers=[{byteLength:r}],this.gltf.binary=i,this.sourceBuffers=[i]},t._removeStringFromArray=function(e,t){for(var n=!0;n;){var r=e.indexOf(t);r>-1?e.splice(r,1):n=!1}},t._addAttributes=function(e){void 0===e&&(e={});var t={};for(var n in e){var r=e[n],i=this._getGltfAttributeName(n),a=this.addBinaryBuffer(r.value,r);t[i]=a}return t},t._addIndices=function(e){return this.addBinaryBuffer(e,{size:1})},t._getGltfAttributeName=function(e){switch(e.toLowerCase()){case"position":case"positions":case"vertices":return"POSITION";case"normal":case"normals":return"NORMAL";case"color":case"colors":return"COLOR_0";case"texcoord":case"texcoords":return"TEXCOORD_0";default:return e}},t._getAccessorMinMax=function(e,t){var n={min:null,max:null};if(e.length<t)return n;n.min=[],n.max=[];for(var r,i=R(e.subarray(0,t));!(r=i()).done;){var a=r.value;n.min.push(a),n.max.push(a)}for(var o=t;o<e.length;o+=t)for(var s=0;s<t;s++)n.min[0+s]=Math.min(n.min[0+s],e[o+s]),n.max[0+s]=Math.max(n.max[0+s],e[o+s]);return n},Object(y.a)(e,[{key:"json",get:function(){return this.gltf.json}}]),e}();function D(e){var t={};for(var n in e){var r=e[n];if("indices"!==n){var i=U(r);t[n]=i}}return t}function U(e){var t=function(e){var t=e,n=1,r=0;e&&e.value&&(t=e.value,n=e.size||1);t&&(ArrayBuffer.isView(t)||(t=function(e,t,n){void 0===n&&(n=!1);if(!e)return null;if(Array.isArray(e))return new t(e);if(n&&!(e instanceof t))return new t(e);return e}(t,Float32Array)),r=t.length/n);return{buffer:t,size:n,count:r}}(e),n=t.buffer,r=t.size;return{value:n,size:r,byteOffset:0,count:t.count,type:I(r),componentType:P(n)}}function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){Object(u.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var F=c.a.mark(Y);function G(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return z(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function H(e,t,n){return q.apply(this,arguments)}function q(){return(q=Object(l.a)(c.a.mark((function e(t,n,r){var i,a,o,s,u,l;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=n&&null!==(i=n.gltf)&&void 0!==i&&i.decompressMeshes){e.next=2;break}return e.abrupt("return");case 2:for(a=new B(t),o=[],s=G(Y(a));!(u=s()).done;)l=u.value,a.getObjectExtension(l,"KHR_draco_mesh_compression")&&o.push(W(a,l,n,r));return e.next=7,Promise.all(o);case 7:a.removeExtension("KHR_draco_mesh_compression");case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function X(e,t){void 0===t&&(t={});for(var n,r=new B(e),i=G(r.json.meshes||[]);!(n=i()).done;){J(n.value,t),r.addRequiredExtension("KHR_draco_mesh_compression")}}function W(e,t,n,r){return K.apply(this,arguments)}function K(){return(K=Object(l.a)(c.a.mark((function e(t,n,r,i){var a,o,s,u,l,f,p,h,b,v,m,y,O,_;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.getObjectExtension(n,"KHR_draco_mesh_compression")){e.next=3;break}return e.abrupt("return");case 3:return o=t.getTypedArrayForBufferView(a.bufferView),s=Object(d.c)(o.buffer,o.byteOffset),u=i.parse,delete(l=V({},r))["3d-tiles"],e.next=10,u(s,g.a,l,i);case 10:for(f=e.sent,p=D(f.attributes),h=0,b=Object.entries(p);h<b.length;h++)v=b[h],m=v[0],y=v[1],m in n.attributes&&(O=n.attributes[m],null!=(_=t.getAccessor(O))&&_.min&&null!=_&&_.max&&(y.min=_.min,y.max=_.max));n.attributes=p,f.indices&&(n.indices=U(f.indices)),Q(n);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function J(e,t,n,r,i){var a,o;if(void 0===n&&(n=4),!r.DracoWriter)throw new Error("options.gltf.DracoWriter not provided");var s=r.DracoWriter.encodeSync({attributes:e}),c=null==i||null===(a=i.parseSync)||void 0===a?void 0:a.call(i,{attributes:e}),u=r._addFauxAttributes(c.attributes),l=r.addBufferView(s);return{primitives:[{attributes:u,mode:n,extensions:(o={},o.KHR_draco_mesh_compression={bufferView:l,attributes:u},o)}]}}function Q(e){if(!e.attributes&&Object.keys(e.attributes).length>0)throw new Error("glTF: Empty primitive detected: Draco decompression failure?")}function Y(e){var t,n,r,i,a,o;return c.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:t=G(e.json.meshes||[]);case 1:if((n=t()).done){s.next=12;break}r=n.value,i=G(r.primitives);case 4:if((a=i()).done){s.next=10;break}return o=a.value,s.next=8,o;case 8:s.next=4;break;case 10:s.next=1;break;case 12:case"end":return s.stop()}}),F)}function Z(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return $(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function $(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ee(e){return te.apply(this,arguments)}function te(){return(te=Object(l.a)(c.a.mark((function e(t){var n,r,i,a,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=new B(t),r=n.json,n.removeExtension("KHR_materials_unlit"),i=Z(r.materials||[]);!(a=i()).done;)o=a.value,o.extensions&&o.extensions.KHR_materials_unlit&&(o.unlit=!0),n.removeObjectExtension(o,"KHR_materials_unlit");case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ne(e){var t=new B(e),n=t.json;if(t.materials)for(var r,i=Z(n.materials||[]);!(r=i()).done;){var a=r.value;a.unlit&&(delete a.unlit,t.addObjectExtension(a,"KHR_materials_unlit",{}),t.addExtension("KHR_materials_unlit"))}}function re(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return ie(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ie(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function ie(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ae(e){return oe.apply(this,arguments)}function oe(){return(oe=Object(l.a)(c.a.mark((function e(t){var n,r,i,a,o,s,u;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=new B(t),r=n.json,(i=n.getExtension("KHR_lights_punctual"))&&(n.json.lights=i.lights,n.removeExtension("KHR_lights_punctual")),a=re(r.nodes||[]);!(o=a()).done;)s=o.value,(u=n.getObjectExtension(s,"KHR_lights_punctual"))&&(s.light=u.light),n.removeObjectExtension(s,"KHR_lights_punctual");case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function se(e){return ce.apply(this,arguments)}function ce(){return(ce=Object(l.a)(c.a.mark((function e(t){var n,r,i,a,o,s,u;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=new B(t),(r=n.json).lights&&(b(!(i=n.addExtension("KHR_lights_punctual")).lights),i.lights=r.lights,delete r.lights),n.json.lights){for(a=re(n.json.lights);!(o=a()).done;)s=o.value,u=s.node,n.addObjectExtension(u,"KHR_lights_punctual",s);delete n.json.lights}case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ue(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return le(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return le(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function le(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function fe(e){return pe.apply(this,arguments)}function pe(){return(pe=Object(l.a)(c.a.mark((function e(t){var n,r,i,a,o,s,u,l;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=new B(t),r=n.json,i=n.getExtension("KHR_techniques_webgl")){for(a=be(i,n),o=ue(r.materials||[]);!(s=o()).done;)u=s.value,(l=n.getObjectExtension(u,"KHR_techniques_webgl"))&&(u.technique=Object.assign({},l,a[l.technique]),u.technique.values=ve(u.technique,n)),n.removeObjectExtension(u,"KHR_techniques_webgl");n.removeExtension("KHR_techniques_webgl")}case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function he(e,t){return de.apply(this,arguments)}function de(){return(de=Object(l.a)(c.a.mark((function e(t,n){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function be(e,t){var n=e.programs,r=void 0===n?[]:n,i=e.shaders,a=void 0===i?[]:i,o=e.techniques,s=void 0===o?[]:o,c=new TextDecoder;return a.forEach((function(e){if(!Number.isFinite(e.bufferView))throw new Error("KHR_techniques_webgl: no shader code");e.code=c.decode(t.getTypedArrayForBufferView(e.bufferView))})),r.forEach((function(e){e.fragmentShader=a[e.fragmentShader],e.vertexShader=a[e.vertexShader]})),s.forEach((function(e){e.program=r[e.program]})),s}function ve(e,t){var n=Object.assign({},e.values);return Object.keys(e.uniforms||{}).forEach((function(t){e.uniforms[t].value&&!(t in n)&&(n[t]=e.uniforms[t].value)})),Object.keys(n).forEach((function(e){"object"==typeof n[e]&&void 0!==n[e].index&&(n[e].texture=t.getTexture(n[e].index))})),n}var me={KHR_draco_mesh_compression:r,KHR_materials_unlit:i,KHR_lights_punctual:a,KHR_techniques_webgl:o};function ge(e,t,n){return ye.apply(this,arguments)}function ye(){return(ye=Object(l.a)(c.a.mark((function e(t,n,r){var i,a,o,s,u;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0===n&&(n={}),e.t0=c.a.keys(me);case 2:if((e.t1=e.t0()).done){e.next=12;break}if(i=e.t1.value,s=(null===(a=n)||void 0===a||null===(o=a.gltf)||void 0===o?void 0:o.excludeExtensions)||{},i in s&&!s[i]){e.next=10;break}return u=me[i],e.next=10,u.decode(t,n,r);case 10:e.next=2;break;case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Oe(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return _e(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _e(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function _e(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function je(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Ae(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ae(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function Ae(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Se={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},xe={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"},Te=function(){function e(e){this.idToIndexMap={animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}}}var t=e.prototype;return t.normalize=function(e,t){this.json=e.json;var n=e.json;switch(n.asset&&n.asset.version){case"2.0":return;case void 0:case"1.0":break;default:return void console.warn("glTF: Unknown version "+n.asset.version)}if(!t.normalize)throw new Error("glTF v1 is not supported.");console.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(n),this._convertTopLevelObjectsToArrays(n),function(e){for(var t,n=new B(e),r=n.json,i=Oe(r.images||[]);!(t=i()).done;){var a=t.value,o=n.removeObjectExtension(a,"KHR_binary_glTF");o&&Object.assign(a,o)}r.buffers&&r.buffers[0]&&delete r.buffers[0].uri,n.removeExtension("KHR_binary_glTF")}(e),this._convertObjectIdsToArrayIndices(n),this._updateObjects(n),this._updateMaterial(n)},t._addAsset=function(e){e.asset=e.asset||{},e.asset.version="2.0",e.asset.generator=e.asset.generator||"Normalized to glTF 2.0 by loaders.gl"},t._convertTopLevelObjectsToArrays=function(e){for(var t in Se)this._convertTopLevelObjectToArray(e,t)},t._convertTopLevelObjectToArray=function(e,t){var n=e[t];if(n&&!Array.isArray(n))for(var r in e[t]=[],n){var i=n[r];i.id=i.id||r;var a=e[t].length;e[t].push(i),this.idToIndexMap[t][r]=a}},t._convertObjectIdsToArrayIndices=function(e){for(var t in Se)this._convertIdsToIndices(e,t);"scene"in e&&(e.scene=this._convertIdToIndex(e.scene,"scene"));for(var n,r=je(e.textures);!(n=r()).done;){var i=n.value;this._convertTextureIds(i)}for(var a,o=je(e.meshes);!(a=o()).done;){var s=a.value;this._convertMeshIds(s)}for(var c,u=je(e.nodes);!(c=u()).done;){var l=c.value;this._convertNodeIds(l)}for(var f,p=je(e.scenes);!(f=p()).done;){var h=f.value;this._convertSceneIds(h)}},t._convertTextureIds=function(e){e.source&&(e.source=this._convertIdToIndex(e.source,"image"))},t._convertMeshIds=function(e){for(var t,n=je(e.primitives);!(t=n()).done;){var r=t.value,i=r.attributes,a=r.indices,o=r.material;for(var s in i)i[s]=this._convertIdToIndex(i[s],"accessor");a&&(r.indices=this._convertIdToIndex(a,"accessor")),o&&(r.material=this._convertIdToIndex(o,"material"))}},t._convertNodeIds=function(e){var t=this;e.children&&(e.children=e.children.map((function(e){return t._convertIdToIndex(e,"node")}))),e.meshes&&(e.meshes=e.meshes.map((function(e){return t._convertIdToIndex(e,"mesh")})))},t._convertSceneIds=function(e){var t=this;e.nodes&&(e.nodes=e.nodes.map((function(e){return t._convertIdToIndex(e,"node")})))},t._convertIdsToIndices=function(e,t){e[t]||(console.warn("gltf v1: json doesn't contain attribute "+t),e[t]=[]);for(var n,r=je(e[t]);!(n=r()).done;){var i=n.value;for(var a in i){var o=i[a],s=this._convertIdToIndex(o,a);i[a]=s}}},t._convertIdToIndex=function(e,t){var n=xe[t];if(n in this.idToIndexMap){var r=this.idToIndexMap[n][e];if(!Number.isFinite(r))throw new Error("gltf v1: failed to resolve "+t+" with id "+e);return r}return e},t._updateObjects=function(e){for(var t,n=je(this.json.buffers);!(t=n()).done;){delete t.value.type}},t._updateMaterial=function(e){for(var t,n=function(){var n=t.value;n.pbrMetallicRoughness={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1};var r=n.values&&n.values.tex,i=e.textures.findIndex((function(e){return e.id===r}));-1!==i&&(n.pbrMetallicRoughness.baseColorTexture={index:i})},r=je(e.materials);!(t=r()).done;)n()},e}();function Ee(e,t){return void 0===t&&(t={}),(new Te).normalize(e,t)}var Ie;n("E9XD");function Pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function we(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pe(Object(n),!0).forEach((function(t){Object(u.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Re={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Le={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},Ce={TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,REPEAT:10497,LINEAR:9729,NEAREST_MIPMAP_LINEAR:9986},Ne={magFilter:Ce.TEXTURE_MAG_FILTER,minFilter:Ce.TEXTURE_MIN_FILTER,wrapS:Ce.TEXTURE_WRAP_S,wrapT:Ce.TEXTURE_WRAP_T},Me=((Ie={})[Ce.TEXTURE_MAG_FILTER]=Ce.LINEAR,Ie[Ce.TEXTURE_MIN_FILTER]=Ce.NEAREST_MIPMAP_LINEAR,Ie[Ce.TEXTURE_WRAP_S]=Ce.REPEAT,Ie[Ce.TEXTURE_WRAP_]=Ce.REPEAT,Ie);var Be=function(){function e(){}var t=e.prototype;return t.postProcess=function(e,t){void 0===t&&(t={});var n=e.json,r=e.buffers,i=void 0===r?[]:r,a=e.images,o=void 0===a?[]:a,s=e.baseUri,c=void 0===s?"":s;return b(n),this.baseUri=c,this.json=n,this.buffers=i,this.images=o,this._resolveTree(this.json,t),this.json},t._resolveTree=function(e,t){var n=this;void 0===t&&(t={}),e.bufferViews&&(e.bufferViews=e.bufferViews.map((function(e,t){return n._resolveBufferView(e,t)}))),e.images&&(e.images=e.images.map((function(e,t){return n._resolveImage(e,t)}))),e.samplers&&(e.samplers=e.samplers.map((function(e,t){return n._resolveSampler(e,t)}))),e.textures&&(e.textures=e.textures.map((function(e,t){return n._resolveTexture(e,t)}))),e.accessors&&(e.accessors=e.accessors.map((function(e,t){return n._resolveAccessor(e,t)}))),e.materials&&(e.materials=e.materials.map((function(e,t){return n._resolveMaterial(e,t)}))),e.meshes&&(e.meshes=e.meshes.map((function(e,t){return n._resolveMesh(e,t)}))),e.nodes&&(e.nodes=e.nodes.map((function(e,t){return n._resolveNode(e,t)}))),e.skins&&(e.skins=e.skins.map((function(e,t){return n._resolveSkin(e,t)}))),e.scenes&&(e.scenes=e.scenes.map((function(e,t){return n._resolveScene(e,t)}))),void 0!==e.scene&&(e.scene=e.scenes[this.json.scene])},t.getScene=function(e){return this._get("scenes",e)},t.getNode=function(e){return this._get("nodes",e)},t.getSkin=function(e){return this._get("skins",e)},t.getMesh=function(e){return this._get("meshes",e)},t.getMaterial=function(e){return this._get("materials",e)},t.getAccessor=function(e){return this._get("accessors",e)},t.getCamera=function(e){return null},t.getTexture=function(e){return this._get("textures",e)},t.getSampler=function(e){return this._get("samplers",e)},t.getImage=function(e){return this._get("images",e)},t.getBufferView=function(e){return this._get("bufferViews",e)},t.getBuffer=function(e){return this._get("buffers",e)},t._get=function(e,t){if("object"==typeof t)return t;var n=this.json[e]&&this.json[e][t];return n||console.warn("glTF file error: Could not find "+e+"["+t+"]"),n},t._resolveScene=function(e,t){var n=this;return e.id=e.id||"scene-"+t,e.nodes=(e.nodes||[]).map((function(e){return n.getNode(e)})),e},t._resolveNode=function(e,t){var n=this;return e.id=e.id||"node-"+t,e.children&&(e.children=e.children.map((function(e){return n.getNode(e)}))),void 0!==e.mesh?e.mesh=this.getMesh(e.mesh):void 0!==e.meshes&&e.meshes.length&&(e.mesh=e.meshes.reduce((function(e,t){var r=n.getMesh(t);return e.id=r.id,e.primitives=e.primitives.concat(r.primitives),e}),{primitives:[]})),void 0!==e.camera&&(e.camera=this.getCamera(e.camera)),void 0!==e.skin&&(e.skin=this.getSkin(e.skin)),e},t._resolveSkin=function(e,t){return e.id=e.id||"skin-"+t,e.inverseBindMatrices=this.getAccessor(e.inverseBindMatrices),e},t._resolveMesh=function(e,t){var n=this;return e.id=e.id||"mesh-"+t,e.primitives&&(e.primitives=e.primitives.map((function(e){var t=(e=we({},e)).attributes;for(var r in e.attributes={},t)e.attributes[r]=n.getAccessor(t[r]);return void 0!==e.indices&&(e.indices=n.getAccessor(e.indices)),void 0!==e.material&&(e.material=n.getMaterial(e.material)),e}))),e},t._resolveMaterial=function(e,t){if(e.id=e.id||"material-"+t,e.normalTexture&&(e.normalTexture=we({},e.normalTexture),e.normalTexture.texture=this.getTexture(e.normalTexture.index)),e.occlusionTexture&&(e.occlustionTexture=we({},e.occlustionTexture),e.occlusionTexture.texture=this.getTexture(e.occlusionTexture.index)),e.emissiveTexture&&(e.emmisiveTexture=we({},e.emmisiveTexture),e.emissiveTexture.texture=this.getTexture(e.emissiveTexture.index)),e.emissiveFactor||(e.emissiveFactor=e.emmisiveTexture?[1,1,1]:[0,0,0]),e.pbrMetallicRoughness){e.pbrMetallicRoughness=we({},e.pbrMetallicRoughness);var n=e.pbrMetallicRoughness;n.baseColorTexture&&(n.baseColorTexture=we({},n.baseColorTexture),n.baseColorTexture.texture=this.getTexture(n.baseColorTexture.index)),n.metallicRoughnessTexture&&(n.metallicRoughnessTexture=we({},n.metallicRoughnessTexture),n.metallicRoughnessTexture.texture=this.getTexture(n.metallicRoughnessTexture.index))}return e},t._resolveAccessor=function(e,t){var n,r;if(e.id=e.id||"accessor-"+t,void 0!==e.bufferView&&(e.bufferView=this.getBufferView(e.bufferView)),e.bytesPerComponent=(n=e.componentType,Le[n]),e.components=(r=e.type,Re[r]),e.bytesPerElement=e.bytesPerComponent*e.components,e.bufferView){var i=e.bufferView.buffer,a=w(e,e.bufferView),o=a.ArrayType,s=a.byteLength,c=(e.bufferView.byteOffset||0)+(e.byteOffset||0)+i.byteOffset,u=i.arrayBuffer.slice(c,c+s);e.value=new o(u)}return e},t._resolveTexture=function(e,t){return e.id=e.id||"texture-"+t,e.sampler="sampler"in e?this.getSampler(e.sampler):Me,e.source=this.getImage(e.source),e},t._resolveSampler=function(e,t){for(var n in e.id=e.id||"sampler-"+t,e.parameters={},e){var r=this._enumSamplerParameter(n);void 0!==r&&(e.parameters[r]=e[n])}return e},t._enumSamplerParameter=function(e){return Ne[e]},t._resolveImage=function(e,t){e.id=e.id||"image-"+t,void 0!==e.bufferView&&(e.bufferView=this.getBufferView(e.bufferView));var n=this.images[t];return n&&(e.image=n),e},t._resolveBufferView=function(e,t){e.id=e.id||"bufferView-"+t;var n=e.buffer;e.buffer=this.buffers[n];var r=this.buffers[n].arrayBuffer,i=this.buffers[n].byteOffset||0;return"byteOffset"in e&&(i+=e.byteOffset),e.data=new Uint8Array(r,i,e.byteLength),e},t._resolveCamera=function(e,t){return e.id=e.id||"camera-"+t,e.perspective,e.orthographic,e},e}();function De(e,t){return(new Be).postProcess(e,t)}var Ue=n("Qk7e");function ke(e,t,n){void 0===t&&(t=0),void 0===n&&(n={});var r=new DataView(e),i=n.magic,a=void 0===i?1735152710:i,o=r.getUint32(t,!1);return o===a||1735152710===o}function Ve(e,t,n,r){void 0===n&&(n=0),void 0===r&&(r={});var i=new DataView(t),a=function(e,t){return void 0===t&&(t=0),""+String.fromCharCode(e.getUint8(t+0))+String.fromCharCode(e.getUint8(t+1))+String.fromCharCode(e.getUint8(t+2))+String.fromCharCode(e.getUint8(t+3))}(i,n+0),o=i.getUint32(n+4,!0),s=i.getUint32(n+8,!0);switch(Object.assign(e,{header:{byteOffset:n,byteLength:s,hasBinChunk:!1},type:a,version:o,json:{},binChunks:[]}),n+=12,e.version){case 1:return function(e,t,n){Object(Ue.a)(e.header.byteLength>20);var r=t.getUint32(n+0,!0),i=t.getUint32(n+4,!0);return n+=8,Object(Ue.a)(0===i),Fe(e,t,n,r),n+=r,n+=Ge(e,t,n,e.header.byteLength)}(e,i,n);case 2:return function(e,t,n,r){return Object(Ue.a)(e.header.byteLength>20),function(e,t,n,r){for(;n+8<=e.header.byteLength;){var i=t.getUint32(n+0,!0),a=t.getUint32(n+4,!0);switch(n+=8,a){case 1313821514:Fe(e,t,n,i);break;case 5130562:Ge(e,t,n,i);break;case 0:r.strict||Fe(e,t,n,i);break;case 1:r.strict||Ge(e,t,n,i)}n+=Object(_.b)(i,4)}}(e,t,n,r),n+e.header.byteLength}(e,i,n,r={});default:throw new Error("Invalid GLB version "+e.version+". Only supports v1 and v2.")}}function Fe(e,t,n,r){var i=new Uint8Array(t.buffer,n,r),a=new TextDecoder("utf8").decode(i);return e.json=JSON.parse(a),Object(_.b)(r,4)}function Ge(e,t,n,r){return e.header.hasBinChunk=!0,e.binChunks.push({byteOffset:n,byteLength:r,arrayBuffer:t.buffer}),Object(_.b)(r,4)}function ze(e,t,n,r,i){return He.apply(this,arguments)}function He(){return(He=Object(l.a)(c.a.mark((function e(t,n,r,i,a){var o,s,u,l,f,p,h;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===r&&(r=0),qe(t,n,r,i),Ee(t,{normalize:null==i||null===(o=i.gltf)||void 0===o?void 0:o.normalize}),f=[],null==i||null===(s=i.gltf)||void 0===s||!s.loadBuffers||!t.json.buffers){e.next=7;break}return e.next=7,Xe(t,i,a);case 7:return null!=i&&null!==(u=i.gltf)&&void 0!==u&&u.loadImages&&(p=Ke(t,i,a),f.push(p)),h=ge(t,i,a),f.push(h),e.next=12,Promise.all(f);case 12:return e.abrupt("return",null!=i&&null!==(l=i.gltf)&&void 0!==l&&l.postProcess?De(t,i):t);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function qe(e,t,n,r){(r.uri&&(e.baseUri=r.uri),t instanceof ArrayBuffer&&!ke(t,n,r))&&(t=(new TextDecoder).decode(t));if("string"==typeof t)e.json=Object(h.a)(t);else if(t instanceof ArrayBuffer){var i={};n=Ve(i,t,n,r.glb),b("glTF"===i.type,"Invalid GLB magic string "+i.type),e._glb=i,e.json=i.json}else b(!1,"GLTF: must be ArrayBuffer or string");var a=e.json.buffers||[];if(e.buffers=new Array(a.length).fill(null),e._glb&&e._glb.header.hasBinChunk){var o=e._glb.binChunks;e.buffers[0]={arrayBuffer:o[0].arrayBuffer,byteOffset:o[0].byteOffset,byteLength:o[0].byteLength}}var s=e.json.images||[];e.images=new Array(s.length).fill({})}function Xe(e,t,n){return We.apply(this,arguments)}function We(){return(We=Object(l.a)(c.a.mark((function e(t,n,r){var i,a,o,s,u,l,f;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=0;case 1:if(!(i<t.json.buffers.length)){e.next=18;break}if(!(a=t.json.buffers[i]).uri){e.next=15;break}return b(r.fetch),u=v(a.uri,n),e.next=9,null==r||null===(o=r.fetch)||void 0===o?void 0:o.call(r,u);case 9:return l=e.sent,e.next=12,null==l||null===(s=l.arrayBuffer)||void 0===s?void 0:s.call(l);case 12:f=e.sent,t.buffers[i]={arrayBuffer:f,byteOffset:0,byteLength:f.byteLength},delete a.uri;case 15:++i,e.next=1;break;case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ke(e,t,n){return Je.apply(this,arguments)}function Je(){return(Je=Object(l.a)(c.a.mark((function e(t,n,r){var i,a,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(i=t.json.images||[],a=[],o=0;o<i.length;++o)a.push(Qe(t,i[o],o,n,r));return e.next=5,Promise.all(a);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Qe(e,t,n,r,i){return Ye.apply(this,arguments)}function Ye(){return(Ye=Object(l.a)(c.a.mark((function e(t,n,r,i,a){var o,s,u,l,f,h,g;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=a.fetch,s=a.parse,!n.uri){e.next=9;break}return l=v(n.uri,i),e.next=5,o(l);case 5:return f=e.sent,e.next=8,f.arrayBuffer();case 8:u=e.sent;case 9:return Number.isFinite(n.bufferView)&&(h=m(t.json,t.buffers,n.bufferView),u=Object(d.c)(h.buffer,h.byteOffset,h.byteLength)),b(u,"glTF image has no data"),e.next=13,s(u,p.a,{},a);case 13:g=e.sent,t.images[r]=g;case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ze(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ze(Object(n),!0).forEach((function(t){Object(u.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ze(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var et={name:"glTF",id:"gltf",module:"gltf",version:f,extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:function(e,t,n){return tt.apply(this,arguments)},options:{gltf:{normalize:!0,loadBuffers:!0,loadImages:!0,decompressMeshes:!0,postProcess:!0},log:console},deprecatedOptions:{fetchImages:"gltf.loadImages",createImages:"gltf.loadImages",decompress:"gltf.decompressMeshes",postProcess:"gltf.postProcess",gltf:{decompress:"gltf.decompressMeshes"}}};function tt(){return(tt=Object(l.a)(c.a.mark((function e(t,n,r){var i,a,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===n&&(n={}),(n=$e($e({},et.options),n)).gltf=$e($e({},et.options.gltf),n.gltf),i=n.byteOffset,a=void 0===i?0:i,o={},e.next=7,ze(o,t,a,n,r);case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},q1ac:function(e,t,n){"use strict";n.d(t,"a",(function(){return Be}));var r=n("o0o1"),i=n.n(r),a=(n("wcNg"),n("HaE+")),o=n("VnMh"),s=n("FJ6+"),c="undefined"!=typeof __VERSION__?__VERSION__:"latest",u={COMPOSITE:"cmpt",POINT_CLOUD:"pnts",BATCHED_3D_MODEL:"b3dm",INSTANCED_3D_MODEL:"i3dm",GEOMETRY:"geom",VECTOR:"vect"},l=(Object.keys(u),n("Qk7e"));function f(e,t,n){Object(l.a)(e instanceof ArrayBuffer);var r=new TextDecoder("utf8"),i=new Uint8Array(e,t,n);return r.decode(i)}function p(e,t){void 0===t&&(t=0);var n=new DataView(e);return""+String.fromCharCode(n.getUint8(t+0))+String.fromCharCode(n.getUint8(t+1))+String.fromCharCode(n.getUint8(t+2))+String.fromCharCode(n.getUint8(t+3))}var h=n("rePB"),d=n("F2Cy");function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){Object(h.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var m,g={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DOUBLE:5130},y=v(v({},{POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6}),g),O=n("zXfU"),_=((m={})[g.DOUBLE]=Float64Array,m[g.FLOAT]=Float32Array,m[g.UNSIGNED_SHORT]=Uint16Array,m[g.UNSIGNED_INT]=Uint32Array,m[g.UNSIGNED_BYTE]=Uint8Array,m[g.BYTE]=Int8Array,m[g.SHORT]=Int16Array,m[g.INT]=Int32Array,m),j={DOUBLE:g.DOUBLE,FLOAT:g.FLOAT,UNSIGNED_SHORT:g.UNSIGNED_SHORT,UNSIGNED_INT:g.UNSIGNED_INT,UNSIGNED_BYTE:g.UNSIGNED_BYTE,BYTE:g.BYTE,SHORT:g.SHORT,INT:g.INT},A=function(){function e(){}return e.fromTypedArray=function(e){for(var t in e=ArrayBuffer.isView(e)?e.constructor:e,_){if(_[t]===e)return t}throw new Error("Failed to convert GL type")},e.fromName=function(e){var t=j[e];if(!t)throw new Error("Failed to convert GL type");return t},e.getArrayType=function(e){switch(e){case g.UNSIGNED_SHORT_5_6_5:case g.UNSIGNED_SHORT_4_4_4_4:case g.UNSIGNED_SHORT_5_5_5_1:return Uint16Array;default:var t=_[e];if(!t)throw new Error("Failed to convert GL type");return t}},e.getByteSize=function(t){return e.getArrayType(t).BYTES_PER_ELEMENT},e.validate=function(t){return Boolean(e.getArrayType(t))},e.createTypedArray=function(t,n,r,i){return void 0===r&&(r=0),void 0===i&&(i=(n.byteLength-r)/e.getByteSize(t)),new(e.getArrayType(t))(n,r,i)},e}(),S=function(){function e(e,t){this.json=e,this.buffer=t,this.featuresLength=0,this._cachedTypedArrays={}}var t=e.prototype;return t.getExtension=function(e){return this.json.extensions&&this.json.extensions[e]},t.hasProperty=function(e){return Boolean(this.json[e])},t.getGlobalProperty=function(e,t,n){void 0===t&&(t=y.UNSIGNED_INT),void 0===n&&(n=1);var r=this.json[e];return r&&Number.isFinite(r.byteOffset)?this._getTypedArrayFromBinary(e,t,n,1,r.byteOffset):r},t.getPropertyArray=function(e,t,n){var r=this.json[e];return r&&Number.isFinite(r.byteOffset)?("componentType"in r&&(t=A.fromName(r.componentType)),this._getTypedArrayFromBinary(e,t,n,this.featuresLength,r.byteOffset)):this._getTypedArrayFromArray(e,t,r)},t.getProperty=function(e,t,n,r,i){var a=this.json[e];if(!a)return a;var o=this.getPropertyArray(e,t,n);if(1===n)return o[r];for(var s=0;s<n;++s)i[s]=o[n*r+s];return i},t._getTypedArrayFromBinary=function(e,t,n,r,i){var a=this._cachedTypedArrays,o=a[e];return o||(o=A.createTypedArray(t,this.buffer.buffer,this.buffer.byteOffset+i,r*n),a[e]=o),o},t._getTypedArrayFromArray=function(e,t,n){var r=this._cachedTypedArrays,i=r[e];return i||(i=A.createTypedArray(t,n),r[e]=i),i},e}(),x=n("KQm4"),T={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},E={SCALAR:function(e,t){return e[t]},VEC2:function(e,t){return[e[2*t+0],e[2*t+1]]},VEC3:function(e,t){return[e[3*t+0],e[3*t+1],e[3*t+2]]},VEC4:function(e,t){return[e[4*t+0],e[4*t+1],e[4*t+2],e[4*t+3]]},MAT2:function(e,t){return[e[4*t+0],e[4*t+1],e[4*t+2],e[4*t+3]]},MAT3:function(e,t){return[e[9*t+0],e[9*t+1],e[9*t+2],e[9*t+3],e[9*t+4],e[9*t+5],e[9*t+6],e[9*t+7],e[9*t+8]]},MAT4:function(e,t){return[e[16*t+0],e[16*t+1],e[16*t+2],e[16*t+3],e[16*t+4],e[16*t+5],e[16*t+6],e[16*t+7],e[16*t+8],e[16*t+9],e[16*t+10],e[16*t+11],e[16*t+12],e[16*t+13],e[16*t+14],e[16*t+15]]}},I={SCALAR:function(e,t,n){t[n]=e},VEC2:function(e,t,n){t[2*n+0]=e[0],t[2*n+1]=e[1]},VEC3:function(e,t,n){t[3*n+0]=e[0],t[3*n+1]=e[1],t[3*n+2]=e[2]},VEC4:function(e,t,n){t[4*n+0]=e[0],t[4*n+1]=e[1],t[4*n+2]=e[2],t[4*n+3]=e[3]},MAT2:function(e,t,n){t[4*n+0]=e[0],t[4*n+1]=e[1],t[4*n+2]=e[2],t[4*n+3]=e[3]},MAT3:function(e,t,n){t[9*n+0]=e[0],t[9*n+1]=e[1],t[9*n+2]=e[2],t[9*n+3]=e[3],t[9*n+4]=e[4],t[9*n+5]=e[5],t[9*n+6]=e[6],t[9*n+7]=e[7],t[9*n+8]=e[8],t[9*n+9]=e[9]},MAT4:function(e,t,n){t[16*n+0]=e[0],t[16*n+1]=e[1],t[16*n+2]=e[2],t[16*n+3]=e[3],t[16*n+4]=e[4],t[16*n+5]=e[5],t[16*n+6]=e[6],t[16*n+7]=e[7],t[16*n+8]=e[8],t[16*n+9]=e[9],t[16*n+10]=e[10],t[16*n+11]=e[11],t[16*n+12]=e[12],t[16*n+13]=e[13],t[16*n+14]=e[14],t[16*n+15]=e[15]}};var P=function(e){return void 0!==e};function w(e,t,n){if(!t)return null;var r=e.getExtension("3DTILES_batch_table_hierarchy"),i=t.HIERARCHY;return i&&(console.warn("3D Tile Parser: HIERARCHY is deprecated. Use 3DTILES_batch_table_hierarchy."),t.extensions=t.extensions||{},t.extensions["3DTILES_batch_table_hierarchy"]=i,r=i),r?function(e,t){var n,r,i,a,o=e.instancesLength,s=e.classes,c=e.classIds,u=e.parentCounts,l=e.parentIds,f=o;P(c.byteOffset)&&(c.componentType=defaultValue(c.componentType,GL.UNSIGNED_SHORT),c.type=AttributeType.SCALAR,i=getBinaryAccessor(c),c=i.createArrayBufferView(t.buffer,t.byteOffset+c.byteOffset,o));if(P(u))for(P(u.byteOffset)&&(u.componentType=defaultValue(u.componentType,GL.UNSIGNED_SHORT),u.type=AttributeType.SCALAR,i=getBinaryAccessor(u),u=i.createArrayBufferView(t.buffer,t.byteOffset+u.byteOffset,o)),a=new Uint16Array(o),f=0,n=0;n<o;++n)a[n]=f,f+=u[n];P(l)&&P(l.byteOffset)&&(l.componentType=defaultValue(l.componentType,GL.UNSIGNED_SHORT),l.type=AttributeType.SCALAR,i=getBinaryAccessor(l),l=i.createArrayBufferView(t.buffer,t.byteOffset+l.byteOffset,f));var p=s.length;for(n=0;n<p;++n){var h=s[n].length,d=s[n].instances,b=getBinaryProperties(h,d,t);s[n].instances=combine(b,d)}var v=new Array(p).fill(0),m=new Uint16Array(o);for(n=0;n<o;++n)r=c[n],m[n]=v[r],++v[r];var g={classes:s,classIds:c,classIndexes:m,parentCounts:u,parentIndexes:a,parentIds:l};return function(e){for(var t=e.classIds.length,n=0;n<t;++n)L(e,n,stack)}(g),g}(r,n):null}function R(e,t,n){if(e){var r=e.parentCounts;return e.parentIds?n(e,t):r>0?function(e,t,n){var r=e.classIds,i=e.parentCounts,a=e.parentIds,o=e.parentIndexes,s=r.length,c=scratchVisited;c.length=Math.max(c.length,s);var u=++marker,l=scratchStack;l.length=0,l.push(t);for(;l.length>0;)if(t=l.pop(),c[t]!==u){c[t]=u;var f=n(e,t);if(P(f))return f;for(var p=i[t],h=o[t],d=0;d<p;++d){var b=a[h+d];b!==t&&l.push(b)}}return null}(e,t,n):function(e,t,n){var r=!0;for(;r;){var i=n(e,t);if(P(i))return i;var a=e.parentIds[t];r=a!==t,t=a}throw new Error("traverseHierarchySingleParent")}(e,t,n)}}function L(e,t,n){var r=e.parentCounts,i=e.parentIds,a=e.parentIndexes,o=e.classIds.length;if(P(i)){assert(t<o,"Parent index "+t+" exceeds the total number of instances: "+o),assert(-1===n.indexOf(t),"Circular dependency detected in the batch table hierarchy."),n.push(t);for(var s=P(r)?r[t]:1,c=P(r)?a[t]:t,u=0;u<s;++u){var l=i[c+u];l!==t&&L(e,l,n)}n.pop(t)}}function C(e){return null!=e}var N=function(e,t){return e},M={HIERARCHY:!0,extensions:!0,extras:!0},B=function(){function e(e,t,n,r){var i;for(var a in void 0===r&&(r={}),Object(l.a)(n>=0),this.json=e||{},this.binary=t,this.featureCount=n,this._extensions=(null===(i=this.json)||void 0===i?void 0:i.extensions)||{},this._properties={},this.json)M[a]||(this._properties[a]=this.json[a]);this._binaryProperties=this._initializeBinaryProperties(),r["3DTILES_batch_table_hierarchy"]&&(this._hierarchy=w(this,this.json,this.binary))}var t=e.prototype;return t.getExtension=function(e){return this.json&&this.json.extensions&&this.json.extensions[e]},t.memorySizeInBytes=function(){return 0},t.isClass=function(e,t){return this._checkBatchId(e),Object(l.a)("string"==typeof t,t),!!this._hierarchy&&C(R(this._hierarchy,e,(function(e,n){var r=e.classIds[n];return e.classes[r].name===t})))},t.isExactClass=function(e,t){return Object(l.a)("string"==typeof t,t),this.getExactClassName(e)===t},t.getExactClassName=function(e){if(this._checkBatchId(e),this._hierarchy){var t=this._hierarchy.classIds[e];return this._hierarchy.classes[t].name}},t.hasProperty=function(e,t){return this._checkBatchId(e),Object(l.a)("string"==typeof t,t),C(this._properties[t])||this._hasPropertyInHierarchy(e,t)},t.getPropertyNames=function(e,t){var n;this._checkBatchId(e),(t=C(t)?t:[]).length=0;var r=Object.keys(this._properties);return(n=t).push.apply(n,Object(x.a)(r)),this._hierarchy&&this._getPropertyNamesInHierarchy(e,t),t},t.getProperty=function(e,t){if(this._checkBatchId(e),Object(l.a)("string"==typeof t,t),this._binaryProperties){var n=this._binaryProperties[t];if(C(n))return this._getBinaryProperty(n,e)}var r=this._properties[t];if(C(r))return N(r[e]);if(this._hierarchy){var i=this._getHierarchyProperty(e,t);if(C(i))return i}},t.setProperty=function(e,t,n){var r=this.featureCount;if(this._checkBatchId(e),Object(l.a)("string"==typeof t,t),this._binaryProperties){var i=this._binaryProperties[t];if(i)return void this._setBinaryProperty(i,e,n)}if(!this._hierarchy||!this._setHierarchyProperty(this,e,t,n)){var a=this._properties[t];C(a)||(this._properties[t]=new Array(r),a=this._properties[t]),a[e]=N(n)}},t._checkBatchId=function(e){if(!(e>=0&&e<this.featureCount))throw new Error("batchId not in range [0, featureCount - 1].")},t._getBinaryProperty=function(e,t){return e.unpack(e.typedArray,t)},t._setBinaryProperty=function(e,t,n){e.pack(n,e.typedArray,t)},t._initializeBinaryProperties=function(){var e=null;for(var t in this._properties){var n=this._properties[t],r=this._initializeBinaryProperty(t,n);r&&((e=e||{})[t]=r)}return e},t._initializeBinaryProperty=function(e,t){if("byteOffset"in t){var n=t;Object(l.a)(this.binary,"Property "+e+" requires a batch table binary."),Object(l.a)(n.type,"Property "+e+" requires a type.");var r=function(e,t,n,r){var i=e.componentType;Object(l.a)(e.componentType);var a="string"==typeof i?A.fromName(i):i,o=T[e.type],s=E[e.type],c=I[e.type];return n+=e.byteOffset,{values:A.createTypedArray(a,t,n,o*r),type:a,size:o,unpacker:s,packer:c}}(n,this.binary.buffer,0|this.binary.byteOffset,this.featureCount);return{typedArray:r.values,componentCount:r.size,unpack:r.unpacker,pack:r.packer}}return null},t._hasPropertyInHierarchy=function(e,t){if(!this._hierarchy)return!1;var n=R(this._hierarchy,e,(function(e,n){var r=e.classIds[n];return C(e.classes[r].instances[t])}));return C(n)},t._getPropertyNamesInHierarchy=function(e,t){R(this._hierarchy,e,(function(e,n){var r=e.classIds[n],i=e.classes[r].instances;for(var a in i)i.hasOwnProperty(a)&&-1===t.indexOf(a)&&t.push(a)}))},t._getHierarchyProperty=function(e,t){var n=this;return R(this._hierarchy,e,(function(e,r){var i=e.classIds[r],a=e.classes[i],o=e.classIndexes[r],s=a.instances[t];return C(s)?C(s.typedArray)?n._getBinaryProperty(s,o):N(s[o]):null}))},t._setHierarchyProperty=function(e,t,n,r){var i=this,a=R(this._hierarchy,t,(function(e,a){var o=e.classIds[a],s=e.classes[o],c=e.classIndexes[a],u=s.instances[n];return!!C(u)&&(Object(l.a)(a===t,'Inherited property "'+n+'" is read-only.'),C(u.typedArray)?i._setBinaryProperty(u,c,r):u[c]=N(r),!0)}));return C(a)},e}();function D(e,t,n){void 0===n&&(n=0);var r=new DataView(t);if(e.magic=r.getUint32(n,!0),n+=4,e.version=r.getUint32(n,!0),n+=4,e.byteLength=r.getUint32(n,!0),n+=4,1!==e.version)throw new Error("3D Tile Version "+e.version+" not supported");return n}function U(e,t,n){var r,i=new DataView(t);e.header=e.header||{};var a=i.getUint32(n,!0);n+=4;var o=i.getUint32(n,!0);n+=4;var s=i.getUint32(n,!0);n+=4;var c=i.getUint32(n,!0);return n+=4,s>=570425344?(n-=8,r=a,s=o,c=0,a=0,o=0,console.warn("b3dm tile in legacy format.")):c>=570425344&&(n-=4,r=s,s=a,c=o,a=0,o=0,console.warn("b3dm tile in legacy format.")),e.header.featureTableJsonByteLength=a,e.header.featureTableBinaryByteLength=o,e.header.batchTableJsonByteLength=s,e.header.batchTableBinaryByteLength=c,e.header.batchLength=r,n}function k(e,t,n,r){return n=function(e,t,n,r){var i=e.header,a=i.featureTableJsonByteLength,o=i.featureTableBinaryByteLength,s=i.batchLength;if(e.featureTableJson={BATCH_LENGTH:s||0},a>0){var c=f(t,n,a);e.featureTableJson=JSON.parse(c)}return n+=a,e.featureTableBinary=new Uint8Array(t,n,o),n+=o}(e,t,n),n=function(e,t,n,r){var i=e.header,a=i.batchTableJsonByteLength,o=i.batchTableBinaryByteLength;if(a>0){var s=f(t,n,a);e.batchTableJson=JSON.parse(s),n+=a,o>0&&(e.batchTableBinary=new Uint8Array(t,n,o),e.batchTableBinary=new Uint8Array(e.batchTableBinary),n+=o)}return n}(e,t,n)}function V(e,t){void 0===t&&(t=[0,0,0]);var n=e>>11&31,r=e>>5&63,i=31&e;return t[0]=n<<3,t[1]=r<<2,t[2]=i<<3,t}function F(e,t,n){if(!(t||e&&e.batchIds&&n))return null;var r=e.batchIds,i=e.isRGB565,a=e.pointCount;if(r&&n){for(var o=new Uint8ClampedArray(3*a),s=0;s<a;s++){var c=r[s],u=n.getProperty(c,"dimensions").map((function(e){return 255*e}));o[3*s]=u[0],o[3*s+1]=u[1],o[3*s+2]=u[2]}return{type:y.UNSIGNED_BYTE,value:o,size:3,normalized:!0}}if(i){for(var l=new Uint8ClampedArray(3*a),f=0;f<a;f++){var p=V(t[f]);l[3*f]=p[0],l[3*f+1]=p[1],l[3*f+2]=p[2]}return{type:y.UNSIGNED_BYTE,value:l,size:3,normalized:!0}}return t&&t.length===3*a?{type:y.UNSIGNED_BYTE,value:t,size:3,normalized:!0}:{type:y.UNSIGNED_BYTE,value:t,size:4,normalized:!0}}var G=n("Oz/4"),z=n("a3TU");n("gOKY");function H(e,t){if(!e)throw new Error("math.gl assertion failed. "+t)}new G.a,new O.a,new G.a,new G.a,new Uint8Array(1);function q(e,t){return void 0===t&&(t=255),Object(z.a)(e,0,t)/t*2-1}function X(e){return e<0?-1:1}function W(e,t,n,r){if(H(r),e<0||e>n||t<0||t>n)throw new Error("x and y must be unsigned normalized integers between 0 and "+n);if(r.x=q(e,n),r.y=q(t,n),r.z=1-(Math.abs(r.x)+Math.abs(r.y)),r.z<0){var i=r.x;r.x=(1-Math.abs(r.y))*X(i),r.y=(1-Math.abs(i))*X(r.y)}return r.normalize()}function K(e,t,n){return W(e,t,255,n)}var J=new O.a;function Q(e,t,n){return e.isQuantized?n["3d-tiles"]&&n["3d-tiles"].decodeQuantizedPositions?(e.isQuantized=!1,function(e,t){for(var n=new O.a,r=new Float32Array(3*e.pointCount),i=0;i<e.pointCount;i++)n.set(t[3*i],t[3*i+1],t[3*i+2]).scale(1/e.quantizedRange).multiply(e.quantizedVolumeScale).add(e.quantizedVolumeOffset).toArray(r,3*i);return r}(e,t)):{type:y.UNSIGNED_SHORT,value:t,size:3,normalized:!0}:t}function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(n),!0).forEach((function(t){Object(h.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function $(e,t,n,r,i){return ee.apply(this,arguments)}function ee(){return(ee=Object(a.a)(i.a.mark((function e(t,n,r,a,o){var s,c,u;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=D(t,n,r),r=U(t,n,r),r=k(t,n,r),te(t),s=ne(t),c=s.featureTable,u=s.batchTable,e.next=7,oe(t,c,u,a,o);case 7:return re(t,c,a),ie(t,c,u),ae(t,c),e.abrupt("return",r);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function te(e){e.attributes={positions:null,colors:null,normals:null,batchIds:null},e.isQuantized=!1,e.isTranslucent=!1,e.isRGB565=!1,e.isOctEncoded16P=!1}function ne(e){var t=new S(e.featureTableJson,e.featureTableBinary),n=t.getGlobalProperty("POINTS_LENGTH");if(!Number.isFinite(n))throw new Error("POINTS_LENGTH must be defined");t.featuresLength=n,e.featuresLength=n,e.pointsLength=n,e.pointCount=n,e.rtcCenter=t.getGlobalProperty("RTC_CENTER",y.FLOAT,3);var r=function(e,t){var n=null;if(!e.batchIds&&t.hasProperty("BATCH_ID")&&(e.batchIds=t.getPropertyArray("BATCH_ID",y.UNSIGNED_SHORT,1),e.batchIds)){var r=t.getGlobalProperty("BATCH_LENGTH");if(!r)throw new Error("Global property: BATCH_LENGTH must be defined when BATCH_ID is defined.");var i=e.batchTableJson,a=e.batchTableBinary;n=new B(i,a,r)}return n}(e,t);return{featureTable:t,batchTable:r}}function re(e,t,n){if(!e.attributes.positions)if(t.hasProperty("POSITION"))e.attributes.positions=t.getPropertyArray("POSITION",y.FLOAT,3);else if(t.hasProperty("POSITION_QUANTIZED")){var r=t.getPropertyArray("POSITION_QUANTIZED",y.UNSIGNED_SHORT,3);if(e.isQuantized=!0,e.quantizedRange=65535,e.quantizedVolumeScale=t.getGlobalProperty("QUANTIZED_VOLUME_SCALE",y.FLOAT,3),!e.quantizedVolumeScale)throw new Error("QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");if(e.quantizedVolumeOffset=t.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",y.FLOAT,3),!e.quantizedVolumeOffset)throw new Error("QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");e.attributes.positions=Q(e,r,n)}if(!e.attributes.positions)throw new Error("Either POSITION or POSITION_QUANTIZED must be defined.")}function ie(e,t,n){if(!e.attributes.colors){var r=null;t.hasProperty("RGBA")?(r=t.getPropertyArray("RGBA",y.UNSIGNED_BYTE,4),e.isTranslucent=!0):t.hasProperty("RGB")?r=t.getPropertyArray("RGB",y.UNSIGNED_BYTE,3):t.hasProperty("RGB565")&&(r=t.getPropertyArray("RGB565",y.UNSIGNED_SHORT,1),e.isRGB565=!0),e.attributes.colors=F(e,r,n)}t.hasProperty("CONSTANT_RGBA")&&(e.constantRGBA=t.getGlobalProperty("CONSTANT_RGBA",y.UNSIGNED_BYTE,4))}function ae(e,t){if(!e.attributes.normals){var n=null;t.hasProperty("NORMAL")?n=t.getPropertyArray("NORMAL",y.FLOAT,3):t.hasProperty("NORMAL_OCT16P")&&(n=t.getPropertyArray("NORMAL_OCT16P",y.UNSIGNED_BYTE,2),e.isOctEncoded16P=!0),e.attributes.normals=function(e,t){if(!t)return null;if(e.isOctEncoded16P){for(var n=new Float32Array(3*e.pointsLength),r=0;r<e.pointsLength;r++)K(t[2*r],t[2*r+1],J),J.toArray(n,3*r);return{type:y.FLOAT,size:2,value:n}}return{type:y.FLOAT,size:2,value:t}}(e,n)}}function oe(e,t,n,r,i){return se.apply(this,arguments)}function se(){return(se=Object(a.a)(i.a.mark((function e(t,n,r,a,o){var s,c,u,l,f,p,h,d;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((l=t.batchTableJson&&t.batchTableJson.extensions&&t.batchTableJson.extensions["3DTILES_draco_point_compression"])&&(u=l.properties),!(f=n.getExtension("3DTILES_draco_point_compression"))){e.next=15;break}if(c=f.properties,p=f.byteOffset,h=f.byteLength,c&&Number.isFinite(p)&&h){e.next=9;break}throw new Error("Draco properties, byteOffset, and byteLength must be defined");case 9:s=t.featureTableBinary.slice(p,p+h),t.hasPositions=Number.isFinite(c.POSITION),t.hasColors=Number.isFinite(c.RGB)||Number.isFinite(c.RGBA),t.hasNormals=Number.isFinite(c.NORMAL),t.hasBatchIds=Number.isFinite(c.BATCH_ID),t.isTranslucent=Number.isFinite(c.RGBA);case 15:if(s){e.next=17;break}return e.abrupt("return",!0);case 17:return d={buffer:s,properties:Z(Z({},c),u),featureTableProperties:c,batchTableProperties:u,dequantizeInShader:!1},e.next=20,ce(t,d,a,o);case 20:return e.abrupt("return",e.sent);case 21:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ce(e,t,n,r){return ue.apply(this,arguments)}function ue(){return(ue=Object(a.a)(i.a.mark((function e(t,n,r,a){var o,s,c,u,l,f,p,h,b,v,m,g,y,_,j;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=a.parse,delete(s=Z(Z({},r),{},{draco:Z(Z({},r.draco),{},{extraAttributes:n.batchTableProperties||{}})}))["3d-tiles"],e.next=5,o(n.buffer,d.a,s);case 5:if(c=e.sent,u=c.attributes.POSITION&&c.attributes.POSITION.value,l=c.attributes.COLOR_0&&c.attributes.COLOR_0.value,f=c.attributes.NORMAL&&c.attributes.NORMAL.value,p=c.attributes.BATCH_ID&&c.attributes.BATCH_ID.value,h=u&&c.attributes.POSITION.value.quantization,b=f&&c.attributes.NORMAL.value.quantization,h&&(v=c.POSITION.data.quantization,m=v.range,t.quantizedVolumeScale=new O.a(m,m,m),t.quantizedVolumeOffset=new O.a(v.minValues),t.quantizedRange=(1<<v.quantizationBits)-1,t.isQuantizedDraco=!0),b&&(t.octEncodedRange=(1<<c.NORMAL.data.quantization.quantizationBits)-1,t.isOctEncodedDraco=!0),g={},n.batchTableProperties)for(y=0,_=Object.keys(n.batchTableProperties);y<_.length;y++)j=_[y],c.attributes[j]&&c.attributes[j].value&&(g[j.toLowerCase()]=c.attributes[j].value);t.attributes=Z({positions:u,colors:F(t,l),normals:f,batchIds:p},g);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var le=n("p/I1"),fe=n("w0jg"),pe=0,he=1;function de(e,t,n,r){e.rotateYtoZ=!0;var i=e.byteOffset+e.byteLength-n;if(0===i)throw new Error("glTF byte length must be greater than 0.");return e.gltfUpAxis=r["3d-tiles"]&&r["3d-tiles"].assetGltfUpAxis?r["3d-tiles"].assetGltfUpAxis:"Y",e.gltfArrayBuffer=Object(fe.c)(t,n,i),e.gltfByteOffset=0,e.gltfByteLength=i,n%4==0||console.warn(e.type+": embedded glb is not aligned to a 4-byte boundary."),e.byteOffset+e.byteLength}function be(e,t,n,r){return ve.apply(this,arguments)}function ve(){return(ve=Object(a.a)(i.a.mark((function e(t,n,r,a){var o,s,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=r["3d-tiles"]||{},me(t,n,r),!o.loadGLTF){e.next=16;break}if(s=a.parse,c=a.fetch,!t.gltfUrl){e.next=9;break}return e.next=7,c(t.gltfUrl,r);case 7:t.gltfArrayBuffer=e.sent,t.gltfByteOffset=0;case 9:if(!t.gltfArrayBuffer){e.next=16;break}return e.next=12,s(t.gltfArrayBuffer,le.a,r,a);case 12:t.gltf=e.sent,delete t.gltfArrayBuffer,delete t.gltfByteOffset,delete t.gltfByteLength;case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function me(e,t,n){switch(t){case pe:var r=new Uint8Array(e.gltfArrayBuffer,e.gltfByteOffset),i=(new TextDecoder).decode(r);e.gltfUrl=i.replace(/[\s\0]+$/,""),delete e.gltfArrayBuffer,delete e.gltfByteOffset,delete e.gltfByteLength;break;case he:break;default:throw new Error("b3dm: Illegal glTF format field")}}function ge(e,t,n,r,i){return ye.apply(this,arguments)}function ye(){return(ye=Object(a.a)(i.a.mark((function e(t,n,r,a,o){var s,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Oe(t,n,r,a,o),e.next=3,be(t,he,a,o);case 3:return(c=null==t||null===(s=t.gltf)||void 0===s?void 0:s.extensions)&&c.CESIUM_RTC&&(t.rtcCenter=c.CESIUM_RTC.center),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Oe(e,t,n,r,i){n=de(e,t,n=k(e,t,n=U(e,t,n=D(e,t,n))),r);var a=new S(e.featureTableJson,e.featureTableBinary);return e.rtcCenter=a.getGlobalProperty("RTC_CENTER",y.FLOAT,3),n}var _e=n("GA6j"),je=n("Xjzu"),Ae=n("Nw31"),Se=n("Ns70");function xe(e,t,n,r,i){return Te.apply(this,arguments)}function Te(){return(Te=Object(a.a)(i.a.mark((function e(t,n,r,a,o){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Ee(t,n,r,a,o),e.next=3,be(t,t.gltfFormat,a,o);case 3:return e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ee(e,t,n,r,i){if(n=D(e,t,n),1!==e.version)throw new Error("Instanced 3D Model version "+e.version+" is not supported");n=U(e,t,n);var a=new DataView(t);if(e.gltfFormat=a.getUint32(n,!0),n=de(e,t,n=k(e,t,n+=4),r),0===e.featureTableJsonByteLength)throw new Error("i3dm parser: featureTableJsonByteLength is zero.");var o=new S(e.featureTableJson,e.featureTableBinary),s=o.getGlobalProperty("INSTANCES_LENGTH");if(o.featuresLength=s,!Number.isFinite(s))throw new Error("i3dm parser: INSTANCES_LENGTH must be defined");e.eastNorthUp=o.getGlobalProperty("EAST_NORTH_UP"),e.rtcCenter=o.getGlobalProperty("RTC_CENTER",y.FLOAT,3);new B(e.batchTableJson,e.batchTableBinary,s);return function(e,t,n,r){for(var i=[new Array(r),e._batchTable][0],a=new O.a,o=(new O.a,new O.a,new O.a,new _e.a),s=new je.a,c=new O.a,u={},l=new Ae.a,f=[],p=[],h=new O.a,d=new O.a,b=0;b<r;b++){var v=void 0;if(t.hasProperty("POSITION"))v=t.getProperty("POSITION",y.FLOAT,3,b,a);else if(t.hasProperty("POSITION_QUANTIZED")){v=t.getProperty("POSITION_QUANTIZED",y.UNSIGNED_SHORT,3,b,a);var m=t.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",y.FLOAT,3,h);if(!m)throw new Error("i3dm parser: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");var g=t.getGlobalProperty("QUANTIZED_VOLUME_SCALE",y.FLOAT,3,d);if(!g)throw new Error("i3dm parser: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");for(var _=0;_<3;_++)v[_]=v[_]/65535*g[_]+m[_]}if(!v)throw new Error("i3dm: POSITION or POSITION_QUANTIZED must be defined for each instance.");a.copy(v),u.translation=a,e.normalUp=t.getProperty("NORMAL_UP",y.FLOAT,3,b,f),e.normalRight=t.getProperty("NORMAL_RIGHT",y.FLOAT,3,b,p);if(e.normalUp){if(!e.normalRight)throw new Error("i3dm: Custom orientation requires both NORMAL_UP and NORMAL_RIGHT.");e.hasCustomOrientation=!0}else{if(e.octNormalUp=t.getProperty("NORMAL_UP_OCT32P",y.UNSIGNED_SHORT,2,f),e.octNormalRight=t.getProperty("NORMAL_RIGHT_OCT32P",y.UNSIGNED_SHORT,2,p),e.octNormalUp){if(!e.octNormalRight)throw new Error("i3dm: oct-encoded orientation requires NORMAL_UP_OCT32P and NORMAL_RIGHT_OCT32P");throw new Error("i3dm: oct-encoded orientation not implemented")}e.eastNorthUp?(Se.a.WGS84.eastNorthUpToFixedFrame(a,l),l.getRotationMatrix3(o)):o.identity()}!1,s.fromMatrix3(o),u.rotation=s,c.set(1,1,1);var j=t.getProperty("SCALE",y.FLOAT,1,b);Number.isFinite(j)&&c.multiplyByScalar(j);var A=t.getProperty("SCALE_NON_UNIFORM",y.FLOAT,3,b,f);A&&c.scale(A),u.scale=c;var S=t.getProperty("BATCH_ID",y.UNSIGNED_SHORT,1,b);void 0===S&&(S=b);var x=(new Ae.a).fromQuaternion(u.rotation);l.identity(),l.translate(u.translation),l.multiplyRight(x),l.scale(u.scale);var T=l.clone();i[b]={modelMatrix:T,batchId:S}}e.instances=i}(e,o,0,s),n}function Ie(e,t,n,r,i,a){return Pe.apply(this,arguments)}function Pe(){return(Pe=Object(a.a)(i.a.mark((function e(t,n,r,a,o,s){var c,u;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=D(t,n,r),c=new DataView(n),t.tilesLength=c.getUint32(r,!0),r+=4,t.tiles=[];case 5:if(!(t.tiles.length<t.tilesLength&&t.byteLength-r>12)){e.next=13;break}return u={},t.tiles.push(u),e.next=10,s(n,r,a,o,u);case 10:r=e.sent,e.next=5;break;case 13:return e.abrupt("return",r);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function we(e,t,n,r,i){return Re.apply(this,arguments)}function Re(){return(Re=Object(a.a)(i.a.mark((function e(t,n,r,a,o){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0===n&&(n=0),void 0===o&&(o={}),o.byteOffset=n,o.type=p(t,n),e.t0=o.type,e.next=e.t0===u.COMPOSITE?7:e.t0===u.BATCHED_3D_MODEL?10:e.t0===u.INSTANCED_3D_MODEL?13:e.t0===u.POINT_CLOUD?16:19;break;case 7:return e.next=9,Ie(o,t,n,r,a,we);case 9:return e.abrupt("return",e.sent);case 10:return e.next=12,ge(o,t,n,r,a);case 12:return e.abrupt("return",e.sent);case 13:return e.next=15,xe(o,t,n,r,a);case 15:return e.abrupt("return",e.sent);case 16:return e.next=18,$(o,t,n,r,a);case 18:return e.abrupt("return",e.sent);case 19:throw new Error("3DTileLoader: unknown type "+o.type);case 20:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Le(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Ce(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ce(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function Ce(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ne(e,t){if(e.content){var n=e.content.uri||e.content.url;e.contentUrl=t.basePath+"/"+n}return e.id=e.contentUrl,e.lodMetricType=s.a.GEOMETRIC_ERROR,e.lodMetricValue=e.geometricError,e.transformMatrix=e.transform,e.type=function(e){if(!e.contentUrl)return s.f.EMPTY;var t=e.contentUrl.split(".").pop();switch(t){case"pnts":return s.f.POINTCLOUD;case"i3dm":case"b3dm":return s.f.SCENEGRAPH;default:return t}}(e),e.refine=function(e){switch(e){case"REPLACE":case"replace":return s.e.REPLACE;case"ADD":case"add":return s.e.ADD;default:return e}}(e.refine),e}function Me(e){var t=e.basePath,n=Ne(e.root,e),r=[];for(r.push(n);r.length>0;)for(var i,a=Le(r.pop().children||[]);!(i=a()).done;){var o=i.value;Ne(o,{basePath:t}),r.push(o)}return n}var Be={id:"3d-tiles",name:"3D Tiles",module:"3d-tiles",version:c,extensions:["cmpt","pnts","b3dm","i3dm"],mimeTypes:["application/octet-stream"],tests:["cmpt","pnts","b3dm","i3dm"],parse:function(e,t,n){return Ge.apply(this,arguments)},options:{"3d-tiles":{loadGLTF:!0,decodeQuantizedPositions:!1,isTileset:"auto",assetGltfUpAxis:null}}};function De(e){return o.b.dirname(e.url)}function Ue(e,t,n){return ke.apply(this,arguments)}function ke(){return(ke=Object(a.a)(i.a.mark((function e(t,n,r){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={content:{featureIds:null}},0,e.next=4,we(t,0,n,r,a.content);case 4:return e.abrupt("return",a.content);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ve(e,t,n){return Fe.apply(this,arguments)}function Fe(){return(Fe=Object(a.a)(i.a.mark((function e(t,n,r){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=JSON.parse((new TextDecoder).decode(t))).loader=n.loader||Be,a.url=r.url,a.basePath=De(a),a.root=Me(a),a.type=s.c.TILES3D,a.lodMetricType=s.a.GEOMETRIC_ERROR,a.lodMetricValue=a.root.lodMetricValue,e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ge(){return(Ge=Object(a.a)(i.a.mark((function e(t,n,r){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n["3d-tiles"]||{},!("auto"===a.isTileset?r.url&&-1!==r.url.indexOf(".json"):a.isTileset)){e.next=8;break}return e.next=5,Ve(t,n,r);case 5:t=e.sent,e.next=11;break;case 8:return e.next=10,Ue(t,n,r);case 10:t=e.sent;case 11:return e.abrupt("return",t);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},rOaP:function(e,t,n){"use strict";function r(e,t){if(void 0===t&&(t=5),"string"==typeof e)return e.slice(0,t);if(ArrayBuffer.isView(e))return i(e.buffer,e.byteOffset,t);if(e instanceof ArrayBuffer){return i(e,0,t)}return""}function i(e,t,n){if(e.byteLength<=t+n)return"";for(var r=new DataView(e),i="",a=0;a<n;a++)i+=String.fromCharCode(r.getUint8(t+a));return i}n.d(t,"a",(function(){return r}))},rp2x:function(e,t,n){"use strict";n.d(t,"c",(function(){return l})),n.d(t,"e",(function(){return b})),n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return g})),n.d(t,"d",(function(){return O}));var r,i,a,o=n("ODXe"),s=n("KQm4"),c=n("rePB"),u=n("oJMS"),l=(r={},Object(c.a)(r,3042,!1),Object(c.a)(r,32773,new Float32Array([0,0,0,0])),Object(c.a)(r,32777,32774),Object(c.a)(r,34877,32774),Object(c.a)(r,32969,1),Object(c.a)(r,32968,0),Object(c.a)(r,32971,1),Object(c.a)(r,32970,0),Object(c.a)(r,3106,new Float32Array([0,0,0,0])),Object(c.a)(r,3107,[!0,!0,!0,!0]),Object(c.a)(r,2884,!1),Object(c.a)(r,2885,1029),Object(c.a)(r,2929,!1),Object(c.a)(r,2931,1),Object(c.a)(r,2932,513),Object(c.a)(r,2928,new Float32Array([0,1])),Object(c.a)(r,2930,!0),Object(c.a)(r,3024,!0),Object(c.a)(r,36006,null),Object(c.a)(r,2886,2305),Object(c.a)(r,33170,4352),Object(c.a)(r,2849,1),Object(c.a)(r,32823,!1),Object(c.a)(r,32824,0),Object(c.a)(r,10752,0),Object(c.a)(r,32938,1),Object(c.a)(r,32939,!1),Object(c.a)(r,3089,!1),Object(c.a)(r,3088,new Int32Array([0,0,1024,1024])),Object(c.a)(r,2960,!1),Object(c.a)(r,2961,0),Object(c.a)(r,2968,4294967295),Object(c.a)(r,36005,4294967295),Object(c.a)(r,2962,519),Object(c.a)(r,2967,0),Object(c.a)(r,2963,4294967295),Object(c.a)(r,34816,519),Object(c.a)(r,36003,0),Object(c.a)(r,36004,4294967295),Object(c.a)(r,2964,7680),Object(c.a)(r,2965,7680),Object(c.a)(r,2966,7680),Object(c.a)(r,34817,7680),Object(c.a)(r,34818,7680),Object(c.a)(r,34819,7680),Object(c.a)(r,2978,[0,0,1024,1024]),Object(c.a)(r,3333,4),Object(c.a)(r,3317,4),Object(c.a)(r,37440,!1),Object(c.a)(r,37441,!1),Object(c.a)(r,37443,37444),Object(c.a)(r,35723,4352),Object(c.a)(r,36010,null),Object(c.a)(r,35977,!1),Object(c.a)(r,3330,0),Object(c.a)(r,3332,0),Object(c.a)(r,3331,0),Object(c.a)(r,3314,0),Object(c.a)(r,32878,0),Object(c.a)(r,3316,0),Object(c.a)(r,3315,0),Object(c.a)(r,32877,0),r),f=function(e,t,n){return t?e.enable(n):e.disable(n)},p=function(e,t,n){return e.hint(n,t)},h=function(e,t,n){return e.pixelStorei(n,t)};function d(e){return Array.isArray(e)||ArrayBuffer.isView(e)}var b=(i={},Object(c.a)(i,3042,f),Object(c.a)(i,32773,(function(e,t){return e.blendColor.apply(e,Object(s.a)(t))})),Object(c.a)(i,32777,"blendEquation"),Object(c.a)(i,34877,"blendEquation"),Object(c.a)(i,32969,"blendFunc"),Object(c.a)(i,32968,"blendFunc"),Object(c.a)(i,32971,"blendFunc"),Object(c.a)(i,32970,"blendFunc"),Object(c.a)(i,3106,(function(e,t){return e.clearColor.apply(e,Object(s.a)(t))})),Object(c.a)(i,3107,(function(e,t){return e.colorMask.apply(e,Object(s.a)(t))})),Object(c.a)(i,2884,f),Object(c.a)(i,2885,(function(e,t){return e.cullFace(t)})),Object(c.a)(i,2929,f),Object(c.a)(i,2931,(function(e,t){return e.clearDepth(t)})),Object(c.a)(i,2932,(function(e,t){return e.depthFunc(t)})),Object(c.a)(i,2928,(function(e,t){return e.depthRange.apply(e,Object(s.a)(t))})),Object(c.a)(i,2930,(function(e,t){return e.depthMask(t)})),Object(c.a)(i,3024,f),Object(c.a)(i,35723,p),Object(c.a)(i,36006,(function(e,t){var n=Object(u.b)(e)?36009:36160;return e.bindFramebuffer(n,t)})),Object(c.a)(i,2886,(function(e,t){return e.frontFace(t)})),Object(c.a)(i,33170,p),Object(c.a)(i,2849,(function(e,t){return e.lineWidth(t)})),Object(c.a)(i,32823,f),Object(c.a)(i,32824,"polygonOffset"),Object(c.a)(i,10752,"polygonOffset"),Object(c.a)(i,35977,f),Object(c.a)(i,32938,"sampleCoverage"),Object(c.a)(i,32939,"sampleCoverage"),Object(c.a)(i,3089,f),Object(c.a)(i,3088,(function(e,t){return e.scissor.apply(e,Object(s.a)(t))})),Object(c.a)(i,2960,f),Object(c.a)(i,2961,(function(e,t){return e.clearStencil(t)})),Object(c.a)(i,2968,(function(e,t){return e.stencilMaskSeparate(1028,t)})),Object(c.a)(i,36005,(function(e,t){return e.stencilMaskSeparate(1029,t)})),Object(c.a)(i,2962,"stencilFuncFront"),Object(c.a)(i,2967,"stencilFuncFront"),Object(c.a)(i,2963,"stencilFuncFront"),Object(c.a)(i,34816,"stencilFuncBack"),Object(c.a)(i,36003,"stencilFuncBack"),Object(c.a)(i,36004,"stencilFuncBack"),Object(c.a)(i,2964,"stencilOpFront"),Object(c.a)(i,2965,"stencilOpFront"),Object(c.a)(i,2966,"stencilOpFront"),Object(c.a)(i,34817,"stencilOpBack"),Object(c.a)(i,34818,"stencilOpBack"),Object(c.a)(i,34819,"stencilOpBack"),Object(c.a)(i,2978,(function(e,t){return e.viewport.apply(e,Object(s.a)(t))})),Object(c.a)(i,3333,h),Object(c.a)(i,3317,h),Object(c.a)(i,37440,h),Object(c.a)(i,37441,h),Object(c.a)(i,37443,h),Object(c.a)(i,3330,h),Object(c.a)(i,3332,h),Object(c.a)(i,3331,h),Object(c.a)(i,36010,(function(e,t){return e.bindFramebuffer(36008,t)})),Object(c.a)(i,3314,h),Object(c.a)(i,32878,h),Object(c.a)(i,3316,h),Object(c.a)(i,3315,h),Object(c.a)(i,32877,h),Object(c.a)(i,"framebuffer",(function(e,t){var n=t&&"handle"in t?t.handle:t;return e.bindFramebuffer(36160,n)})),Object(c.a)(i,"blend",(function(e,t){return t?e.enable(3042):e.disable(3042)})),Object(c.a)(i,"blendColor",(function(e,t){return e.blendColor.apply(e,Object(s.a)(t))})),Object(c.a)(i,"blendEquation",(function(e,t){t=d(t)?t:[t,t],e.blendEquationSeparate.apply(e,Object(s.a)(t))})),Object(c.a)(i,"blendFunc",(function(e,t){t=d(t)&&2===t.length?[].concat(Object(s.a)(t),Object(s.a)(t)):t,e.blendFuncSeparate.apply(e,Object(s.a)(t))})),Object(c.a)(i,"clearColor",(function(e,t){return e.clearColor.apply(e,Object(s.a)(t))})),Object(c.a)(i,"clearDepth",(function(e,t){return e.clearDepth(t)})),Object(c.a)(i,"clearStencil",(function(e,t){return e.clearStencil(t)})),Object(c.a)(i,"colorMask",(function(e,t){return e.colorMask.apply(e,Object(s.a)(t))})),Object(c.a)(i,"cull",(function(e,t){return t?e.enable(2884):e.disable(2884)})),Object(c.a)(i,"cullFace",(function(e,t){return e.cullFace(t)})),Object(c.a)(i,"depthTest",(function(e,t){return t?e.enable(2929):e.disable(2929)})),Object(c.a)(i,"depthFunc",(function(e,t){return e.depthFunc(t)})),Object(c.a)(i,"depthMask",(function(e,t){return e.depthMask(t)})),Object(c.a)(i,"depthRange",(function(e,t){return e.depthRange.apply(e,Object(s.a)(t))})),Object(c.a)(i,"dither",(function(e,t){return t?e.enable(3024):e.disable(3024)})),Object(c.a)(i,"derivativeHint",(function(e,t){e.hint(35723,t)})),Object(c.a)(i,"frontFace",(function(e,t){return e.frontFace(t)})),Object(c.a)(i,"mipmapHint",(function(e,t){return e.hint(33170,t)})),Object(c.a)(i,"lineWidth",(function(e,t){return e.lineWidth(t)})),Object(c.a)(i,"polygonOffsetFill",(function(e,t){return t?e.enable(32823):e.disable(32823)})),Object(c.a)(i,"polygonOffset",(function(e,t){return e.polygonOffset.apply(e,Object(s.a)(t))})),Object(c.a)(i,"sampleCoverage",(function(e,t){return e.sampleCoverage.apply(e,Object(s.a)(t))})),Object(c.a)(i,"scissorTest",(function(e,t){return t?e.enable(3089):e.disable(3089)})),Object(c.a)(i,"scissor",(function(e,t){return e.scissor.apply(e,Object(s.a)(t))})),Object(c.a)(i,"stencilTest",(function(e,t){return t?e.enable(2960):e.disable(2960)})),Object(c.a)(i,"stencilMask",(function(e,t){var n=t=d(t)?t:[t,t],r=Object(o.a)(n,2),i=r[0],a=r[1];e.stencilMaskSeparate(1028,i),e.stencilMaskSeparate(1029,a)})),Object(c.a)(i,"stencilFunc",(function(e,t){var n=t=d(t)&&3===t.length?[].concat(Object(s.a)(t),Object(s.a)(t)):t,r=Object(o.a)(n,6),i=r[0],a=r[1],c=r[2],u=r[3],l=r[4],f=r[5];e.stencilFuncSeparate(1028,i,a,c),e.stencilFuncSeparate(1029,u,l,f)})),Object(c.a)(i,"stencilOp",(function(e,t){var n=t=d(t)&&3===t.length?[].concat(Object(s.a)(t),Object(s.a)(t)):t,r=Object(o.a)(n,6),i=r[0],a=r[1],c=r[2],u=r[3],l=r[4],f=r[5];e.stencilOpSeparate(1028,i,a,c),e.stencilOpSeparate(1029,u,l,f)})),Object(c.a)(i,"viewport",(function(e,t){return e.viewport.apply(e,Object(s.a)(t))})),i);function v(e,t,n){return void 0!==t[e]?t[e]:n[e]}var m={blendEquation:function(e,t,n){return e.blendEquationSeparate(v(32777,t,n),v(34877,t,n))},blendFunc:function(e,t,n){return e.blendFuncSeparate(v(32969,t,n),v(32968,t,n),v(32971,t,n),v(32970,t,n))},polygonOffset:function(e,t,n){return e.polygonOffset(v(32824,t,n),v(10752,t,n))},sampleCoverage:function(e,t,n){return e.sampleCoverage(v(32938,t,n),v(32939,t,n))},stencilFuncFront:function(e,t,n){return e.stencilFuncSeparate(1028,v(2962,t,n),v(2967,t,n),v(2963,t,n))},stencilFuncBack:function(e,t,n){return e.stencilFuncSeparate(1029,v(34816,t,n),v(36003,t,n),v(36004,t,n))},stencilOpFront:function(e,t,n){return e.stencilOpSeparate(1028,v(2964,t,n),v(2965,t,n),v(2966,t,n))},stencilOpBack:function(e,t,n){return e.stencilOpSeparate(1029,v(34817,t,n),v(34818,t,n),v(34819,t,n))}},g={enable:function(e,t){return e(Object(c.a)({},t,!0))},disable:function(e,t){return e(Object(c.a)({},t,!1))},pixelStorei:function(e,t,n){return e(Object(c.a)({},t,n))},hint:function(e,t,n){return e(Object(c.a)({},t,n))},bindFramebuffer:function(e,t,n){var r;switch(t){case 36160:return e((r={},Object(c.a)(r,36006,n),Object(c.a)(r,36010,n),r));case 36009:return e(Object(c.a)({},36006,n));case 36008:return e(Object(c.a)({},36010,n));default:return null}},blendColor:function(e,t,n,r,i){return e(Object(c.a)({},32773,new Float32Array([t,n,r,i])))},blendEquation:function(e,t){var n;return e((n={},Object(c.a)(n,32777,t),Object(c.a)(n,34877,t),n))},blendEquationSeparate:function(e,t,n){var r;return e((r={},Object(c.a)(r,32777,t),Object(c.a)(r,34877,n),r))},blendFunc:function(e,t,n){var r;return e((r={},Object(c.a)(r,32969,t),Object(c.a)(r,32968,n),Object(c.a)(r,32971,t),Object(c.a)(r,32970,n),r))},blendFuncSeparate:function(e,t,n,r,i){var a;return e((a={},Object(c.a)(a,32969,t),Object(c.a)(a,32968,n),Object(c.a)(a,32971,r),Object(c.a)(a,32970,i),a))},clearColor:function(e,t,n,r,i){return e(Object(c.a)({},3106,new Float32Array([t,n,r,i])))},clearDepth:function(e,t){return e(Object(c.a)({},2931,t))},clearStencil:function(e,t){return e(Object(c.a)({},2961,t))},colorMask:function(e,t,n,r,i){return e(Object(c.a)({},3107,[t,n,r,i]))},cullFace:function(e,t){return e(Object(c.a)({},2885,t))},depthFunc:function(e,t){return e(Object(c.a)({},2932,t))},depthRange:function(e,t,n){return e(Object(c.a)({},2928,new Float32Array([t,n])))},depthMask:function(e,t){return e(Object(c.a)({},2930,t))},frontFace:function(e,t){return e(Object(c.a)({},2886,t))},lineWidth:function(e,t){return e(Object(c.a)({},2849,t))},polygonOffset:function(e,t,n){var r;return e((r={},Object(c.a)(r,32824,t),Object(c.a)(r,10752,n),r))},sampleCoverage:function(e,t,n){var r;return e((r={},Object(c.a)(r,32938,t),Object(c.a)(r,32939,n),r))},scissor:function(e,t,n,r,i){return e(Object(c.a)({},3088,new Int32Array([t,n,r,i])))},stencilMask:function(e,t){var n;return e((n={},Object(c.a)(n,2968,t),Object(c.a)(n,36005,t),n))},stencilMaskSeparate:function(e,t,n){return e(Object(c.a)({},1028===t?2968:36005,n))},stencilFunc:function(e,t,n,r){var i;return e((i={},Object(c.a)(i,2962,t),Object(c.a)(i,2967,n),Object(c.a)(i,2963,r),Object(c.a)(i,34816,t),Object(c.a)(i,36003,n),Object(c.a)(i,36004,r),i))},stencilFuncSeparate:function(e,t,n,r,i){var a;return e((a={},Object(c.a)(a,1028===t?2962:34816,n),Object(c.a)(a,1028===t?2967:36003,r),Object(c.a)(a,1028===t?2963:36004,i),a))},stencilOp:function(e,t,n,r){var i;return e((i={},Object(c.a)(i,2964,t),Object(c.a)(i,2965,n),Object(c.a)(i,2966,r),Object(c.a)(i,34817,t),Object(c.a)(i,34818,n),Object(c.a)(i,34819,r),i))},stencilOpSeparate:function(e,t,n,r,i){var a;return e((a={},Object(c.a)(a,1028===t?2964:34817,n),Object(c.a)(a,1028===t?2965:34818,r),Object(c.a)(a,1028===t?2966:34819,i),a))},viewport:function(e,t,n,r,i){return e(Object(c.a)({},2978,[t,n,r,i]))}},y=function(e,t){return e.isEnabled(t)},O=(a={},Object(c.a)(a,3042,y),Object(c.a)(a,2884,y),Object(c.a)(a,2929,y),Object(c.a)(a,3024,y),Object(c.a)(a,32823,y),Object(c.a)(a,32926,y),Object(c.a)(a,32928,y),Object(c.a)(a,3089,y),Object(c.a)(a,2960,y),Object(c.a)(a,35977,y),a)}}]);