(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{"2lZV":function(t,e,n){"use strict";(function(t){n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return i}));var r="undefined"!=typeof window?window:t,i=(void 0!==t||window,"undefined"!=typeof document?document:{})}).call(this,n("yLpj"))},"2plT":function(t,e,n){"use strict";function r(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}n.d(e,"a",(function(){return r}))},"6pOq":function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return f}));var r=n("1OyB"),i=n("vuIU"),a=n("rePB"),o=n("17x9"),s=n.n(o),c=n("2lZV");var u={container:s.a.object,gl:s.a.object,mapboxApiAccessToken:s.a.string,mapboxApiUrl:s.a.string,attributionControl:s.a.bool,preserveDrawingBuffer:s.a.bool,reuseMaps:s.a.bool,transformRequest:s.a.func,mapOptions:s.a.object,mapStyle:s.a.oneOfType([s.a.string,s.a.object]),visible:s.a.bool,asyncRender:s.a.bool,onLoad:s.a.func,onError:s.a.func,width:s.a.number,height:s.a.number,viewState:s.a.object,longitude:s.a.number,latitude:s.a.number,zoom:s.a.number,bearing:s.a.number,pitch:s.a.number,altitude:s.a.number},l={container:c.a.body,mapboxApiAccessToken:function(){var e=null;if("undefined"!=typeof window&&window.location){var n=window.location.search.match(/access_token=([^&\/]*)/);e=n&&n[1]}e||void 0===t||(e=e||"pk.eyJ1IjoiaXNhYWMtdW5mb2xkZWQiLCJhIjoiY2sycWh5M2NmMDAxaTNwbGRuemJkNG43NyJ9.AHOnIM8GJjVKkW66nVFc2w");return e||"no-token"}(),mapboxApiUrl:"https://api.mapbox.com",preserveDrawingBuffer:!1,attributionControl:!0,reuseMaps:!1,mapOptions:{},mapStyle:"mapbox://styles/mapbox/light-v8",visible:!0,asyncRender:!1,onLoad:function(){},onError:function(t){t&&console.error(t.error)},width:0,height:0,longitude:0,latitude:0,zoom:0,bearing:0,pitch:0,altitude:1.5};function h(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"component";t.debug&&s.a.checkPropTypes(u,t,"prop",e)}var f=function(){function t(e){var n=this;if(Object(r.a)(this,t),Object(a.a)(this,"mapboxgl",void 0),Object(a.a)(this,"props",l),Object(a.a)(this,"_map",null),Object(a.a)(this,"width",0),Object(a.a)(this,"height",0),Object(a.a)(this,"_fireLoadEvent",(function(){n.props.onLoad({type:"load",target:n._map})})),!e.mapboxgl)throw new Error("Mapbox not available");this.mapboxgl=e.mapboxgl,t.initialized||(t.initialized=!0,this._checkStyleSheet(this.mapboxgl.version)),this._initialize(e)}return Object(i.a)(t,[{key:"finalize",value:function(){return this._destroy(),this}},{key:"setProps",value:function(t){return this._update(this.props,t),this}},{key:"resize",value:function(){return this._map.resize(),this}},{key:"redraw",value:function(){var t=this._map;t.style&&(t._frame&&(t._frame.cancel(),t._frame=null),t._render())}},{key:"getMap",value:function(){return this._map}},{key:"_reuse",value:function(e){this._map=t.savedMap;var n=this._map.getContainer(),r=e.container;for(r.classList.add("mapboxgl-map");n.childNodes.length>0;)r.appendChild(n.childNodes[0]);this._map._container=r,t.savedMap=null,e.mapStyle&&this._map.setStyle(e.mapStyle,{diff:!1}),this._map.isStyleLoaded()?this._fireLoadEvent():this._map.once("styledata",this._fireLoadEvent)}},{key:"_create",value:function(e){if(e.reuseMaps&&t.savedMap)this._reuse(e);else{if(e.gl){var n=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=function(){return HTMLCanvasElement.prototype.getContext=n,e.gl}}var r={container:e.container,center:[0,0],zoom:8,pitch:0,bearing:0,maxZoom:24,style:e.mapStyle,interactive:!1,trackResize:!1,attributionControl:e.attributionControl,preserveDrawingBuffer:e.preserveDrawingBuffer};e.transformRequest&&(r.transformRequest=e.transformRequest),this._map=new this.mapboxgl.Map(Object.assign({},r,e.mapOptions)),this._map.once("load",e.onLoad),this._map.on("error",e.onError)}return this}},{key:"_destroy",value:function(){this._map&&(t.savedMap?this._map.remove():(t.savedMap=this._map,this._map.off("load",this.props.onLoad),this._map.off("error",this.props.onError),this._map.off("styledata",this._fireLoadEvent)),this._map=null)}},{key:"_initialize",value:function(t){var e=this;h(t=Object.assign({},l,t),"Mapbox"),this.mapboxgl.accessToken=t.mapboxApiAccessToken||l.mapboxApiAccessToken,this.mapboxgl.baseApiUrl=t.mapboxApiUrl,this._create(t);var n=t.container;Object.defineProperty(n,"offsetWidth",{get:function(){return e.width}}),Object.defineProperty(n,"clientWidth",{get:function(){return e.width}}),Object.defineProperty(n,"offsetHeight",{get:function(){return e.height}}),Object.defineProperty(n,"clientHeight",{get:function(){return e.height}});var r=this._map.getCanvas();r&&(r.style.outline="none"),this._updateMapViewport({},t),this._updateMapSize({},t),this.props=t}},{key:"_update",value:function(t,e){if(this._map){h(e=Object.assign({},this.props,e),"Mapbox");var n=this._updateMapViewport(t,e),r=this._updateMapSize(t,e);e.asyncRender||!n&&!r||this.redraw(),this.props=e}}},{key:"_updateMapSize",value:function(t,e){var n=t.width!==e.width||t.height!==e.height;return n&&(this.width=e.width,this.height=e.height,this.resize()),n}},{key:"_updateMapViewport",value:function(t,e){var n=this._getViewState(t),r=this._getViewState(e),i=r.latitude!==n.latitude||r.longitude!==n.longitude||r.zoom!==n.zoom||r.pitch!==n.pitch||r.bearing!==n.bearing||r.altitude!==n.altitude;return i&&(this._map.jumpTo(this._viewStateToMapboxProps(r)),r.altitude!==n.altitude&&(this._map.transform.altitude=r.altitude)),i}},{key:"_getViewState",value:function(t){var e=t.viewState||t,n=e.longitude,r=e.latitude,i=e.zoom,a=e.pitch,o=void 0===a?0:a,s=e.bearing,c=void 0===s?0:s,u=e.altitude;return{longitude:n,latitude:r,zoom:i,pitch:o,bearing:c,altitude:void 0===u?1.5:u}}},{key:"_checkStyleSheet",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"0.47.0";if(void 0!==c.a)try{var e=c.a.createElement("div");e.className="mapboxgl-map",e.style.display="none",c.a.body.append(e);var n="static"!==window.getComputedStyle(e).position;if(!n){var r=c.a.createElement("link");r.setAttribute("rel","stylesheet"),r.setAttribute("type","text/css"),r.setAttribute("href","https://api.tiles.mapbox.com/mapbox-gl-js/v".concat(t,"/mapbox-gl.css")),c.a.head.append(r)}}catch(i){}}},{key:"_viewStateToMapboxProps",value:function(t){return{center:[t.longitude,t.latitude],zoom:t.zoom,bearing:t.bearing,pitch:t.pitch}}}]),t}();Object(a.a)(f,"initialized",!1),Object(a.a)(f,"propTypes",u),Object(a.a)(f,"defaultProps",l),Object(a.a)(f,"savedMap",null)}).call(this,n("8oxB"))},"8CAv":function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));var r=n("1OyB"),i=n("vuIU"),a=n("md7G"),o=n("foSv"),s=n("Ji7U"),c=n("bE5S"),u=n("fOPP"),l=n("yeNo"),h=function(t){function e(){return Object(r.a)(this,e),Object(a.a)(this,Object(o.a)(e).apply(this,arguments))}return Object(s.a)(e,t),Object(i.a)(e,[{key:"toString",value:function(){var t="[";if(l.b.printRowMajor){t+="row-major:";for(var e=0;e<this.RANK;++e)for(var n=0;n<this.RANK;++n)t+=" ".concat(this[n*this.RANK+e])}else{t+="column-major:";for(var r=0;r<this.ELEMENTS;++r)t+=" ".concat(this[r])}return t+="]"}},{key:"getElementIndex",value:function(t,e){return e*this.RANK+t}},{key:"getElement",value:function(t,e){return this[e*this.RANK+t]}},{key:"setElement",value:function(t,e,n){return this[e*this.RANK+t]=Object(u.a)(n),this}},{key:"getColumn",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Array(this.RANK).fill(-0),n=t*this.RANK,r=0;r<this.RANK;++r)e[r]=this[n+r];return e}},{key:"setColumn",value:function(t,e){for(var n=t*this.RANK,r=0;r<this.RANK;++r)this[n+r]=e[r];return this}}]),e}(c.a)},"9h7C":function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r={};function i(t){var e=t&&t.lastIndexOf("/");return e>=0?t.substr(0,e):""}n.r(r),n.d(r,"dirname",(function(){return i}))},ARt4:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"g",(function(){return a})),n.d(e,"c",(function(){return o})),n.d(e,"l",(function(){return s})),n.d(e,"a",(function(){return c})),n.d(e,"k",(function(){return u})),n.d(e,"h",(function(){return l})),n.d(e,"m",(function(){return h})),n.d(e,"j",(function(){return f})),n.d(e,"d",(function(){return p})),n.d(e,"i",(function(){return d})),n.d(e,"n",(function(){return v})),n.d(e,"o",(function(){return y})),n.d(e,"f",(function(){return m})),n.d(e,"e",(function(){return g}));n("QFcT");var r=n("yOd+");function i(t){var e=new r.a(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function a(t,e,n,i){var a=new r.a(4);return a[0]=t,a[1]=e,a[2]=n,a[3]=i,a}function o(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function s(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t}function c(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function u(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function l(t){var e=t[0],n=t[1],r=t[2],i=t[3];return Math.hypot(e,n,r,i)}function h(t){var e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i}function f(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=n*n+r*r+i*i+a*a;return o>0&&(o=1/Math.sqrt(o)),t[0]=n*o,t[1]=r*o,t[2]=i*o,t[3]=a*o,t}function p(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function d(t,e,n,r){var i=e[0],a=e[1],o=e[2],s=e[3];return t[0]=i+r*(n[0]-i),t[1]=a+r*(n[1]-a),t[2]=o+r*(n[2]-o),t[3]=s+r*(n[3]-s),t}function v(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*a+n[12]*o,t[1]=n[1]*r+n[5]*i+n[9]*a+n[13]*o,t[2]=n[2]*r+n[6]*i+n[10]*a+n[14]*o,t[3]=n[3]*r+n[7]*i+n[11]*a+n[15]*o,t}function y(t,e,n){var r=e[0],i=e[1],a=e[2],o=n[0],s=n[1],c=n[2],u=n[3],l=u*r+s*a-c*i,h=u*i+c*r-o*a,f=u*a+o*i-s*r,p=-o*r-s*i-c*a;return t[0]=l*u+p*-o+h*-c-f*-s,t[1]=h*u+p*-s+f*-o-l*-c,t[2]=f*u+p*-c+l*-s-h*-o,t[3]=e[3],t}function m(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function g(t,e){var n=t[0],i=t[1],a=t[2],o=t[3],s=e[0],c=e[1],u=e[2],l=e[3];return Math.abs(n-s)<=r.b*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-c)<=r.b*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(a-u)<=r.b*Math.max(1,Math.abs(a),Math.abs(u))&&Math.abs(o-l)<=r.b*Math.max(1,Math.abs(o),Math.abs(l))}var b,O;b=new r.a(4),r.a!=Float32Array&&(b[0]=0,b[1]=0,b[2]=0,b[3]=0),O=b},Ed8q:function(t,e,n){"use strict";var r=n("o0o1"),i=n.n(r),a=(n("wcNg"),n("HaE+")),o=n("9h7C"),s=n("O6hP"),c={COMPOSITE:"cmpt",POINT_CLOUD:"pnts",BATCHED_3D_MODEL:"b3dm",INSTANCED_3D_MODEL:"i3dm",GEOMETRY:"geom",VECTOR:"vect"},u=(Object.keys(c),n("P+ME"));function l(t,e,n){Object(u.a)(t instanceof ArrayBuffer);var r=new TextDecoder("utf8"),i=new Uint8Array(t,e,n);return r.decode(i)}function h(t,e){void 0===e&&(e=0);var n=new DataView(t);return""+String.fromCharCode(n.getUint8(e+0))+String.fromCharCode(n.getUint8(e+1))+String.fromCharCode(n.getUint8(e+2))+String.fromCharCode(n.getUint8(e+3))}var f=n("rePB"),p=n("1Nab");function d(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?d(Object(n),!0).forEach((function(e){Object(f.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var y,m={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DOUBLE:5130},g=v(v({},{POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6}),m),b=n("SDD5"),O=((y={})[m.DOUBLE]=Float64Array,y[m.FLOAT]=Float32Array,y[m.UNSIGNED_SHORT]=Uint16Array,y[m.UNSIGNED_INT]=Uint32Array,y[m.UNSIGNED_BYTE]=Uint8Array,y[m.BYTE]=Int8Array,y[m.SHORT]=Int16Array,y[m.INT]=Int32Array,y),_={DOUBLE:m.DOUBLE,FLOAT:m.FLOAT,UNSIGNED_SHORT:m.UNSIGNED_SHORT,UNSIGNED_INT:m.UNSIGNED_INT,UNSIGNED_BYTE:m.UNSIGNED_BYTE,BYTE:m.BYTE,SHORT:m.SHORT,INT:m.INT},j=function(){function t(){}return t.fromTypedArray=function(t){for(var e in t=ArrayBuffer.isView(t)?t.constructor:t,O){if(O[e]===t)return e}throw new Error("Failed to convert GL type")},t.fromName=function(t){var e=_[t];if(!e)throw new Error("Failed to convert GL type");return e},t.getArrayType=function(t,e){switch(void 0===e&&(e=!1),t){case m.UNSIGNED_SHORT_5_6_5:case m.UNSIGNED_SHORT_4_4_4_4:case m.UNSIGNED_SHORT_5_5_5_1:return Uint16Array;default:var n=O[t];if(!n)throw new Error("Failed to convert GL type");return n}},t.getByteSize=function(e){return t.getArrayType(e).BYTES_PER_ELEMENT},t.validate=function(e){return Boolean(t.getArrayType(e))},t.createTypedArray=function(e,n,r,i){return void 0===r&&(r=0),void 0===i&&(i=(n.byteLength-r)/t.getByteSize(e)),new(t.getArrayType(e))(n,r,i)},t}(),w=function(){function t(t,e){this.json=t,this.buffer=e,this.featuresLength=0,this._cachedTypedArrays={}}var e=t.prototype;return e.getExtension=function(t){return this.json.extensions&&this.json.extensions[t]},e.hasProperty=function(t){return Boolean(this.json[t])},e.getGlobalProperty=function(t,e,n){void 0===e&&(e=g.UNSIGNED_INT),void 0===n&&(n=1);var r=this.json[t];return r&&Number.isFinite(r.byteOffset)?this._getTypedArrayFromBinary(t,e,n,1,r.byteOffset):r},e.getPropertyArray=function(t,e,n){var r=this.json[t];return r&&Number.isFinite(r.byteOffset)?("componentType"in r&&(e=j.fromName(r.componentType)),this._getTypedArrayFromBinary(t,e,n,this.featuresLength,r.byteOffset)):this._getTypedArrayFromArray(t,e,r)},e.getProperty=function(t,e,n,r,i){var a=this.json[t];if(!a)return a;var o=this.getPropertyArray(t,e,n);if(1===n)return o[r];for(var s=0;s<n;++s)i[s]=o[n*r+s];return i},e._getTypedArrayFromBinary=function(t,e,n,r,i){var a=this._cachedTypedArrays,o=a[t];return o||(o=j.createTypedArray(e,this.buffer.buffer,this.buffer.byteOffset+i,r*n),a[t]=o),o},e._getTypedArrayFromArray=function(t,e,n){var r=this._cachedTypedArrays,i=r[t];return i||(i=j.createTypedArray(e,n),r[t]=i),i},t}(),S=n("KQm4"),T={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},k={SCALAR:function(t,e){return t[e]},VEC2:function(t,e){return[t[2*e+0],t[2*e+1]]},VEC3:function(t,e){return[t[3*e+0],t[3*e+1],t[3*e+2]]},VEC4:function(t,e){return[t[4*e+0],t[4*e+1],t[4*e+2],t[4*e+3]]},MAT2:function(t,e){return[t[4*e+0],t[4*e+1],t[4*e+2],t[4*e+3]]},MAT3:function(t,e){return[t[9*e+0],t[9*e+1],t[9*e+2],t[9*e+3],t[9*e+4],t[9*e+5],t[9*e+6],t[9*e+7],t[9*e+8]]},MAT4:function(t,e){return[t[16*e+0],t[16*e+1],t[16*e+2],t[16*e+3],t[16*e+4],t[16*e+5],t[16*e+6],t[16*e+7],t[16*e+8],t[16*e+9],t[16*e+10],t[16*e+11],t[16*e+12],t[16*e+13],t[16*e+14],t[16*e+15]]}},E={SCALAR:function(t,e,n){e[n]=t},VEC2:function(t,e,n){e[2*n+0]=t[0],e[2*n+1]=t[1]},VEC3:function(t,e,n){e[3*n+0]=t[0],e[3*n+1]=t[1],e[3*n+2]=t[2]},VEC4:function(t,e,n){e[4*n+0]=t[0],e[4*n+1]=t[1],e[4*n+2]=t[2],e[4*n+3]=t[3]},MAT2:function(t,e,n){e[4*n+0]=t[0],e[4*n+1]=t[1],e[4*n+2]=t[2],e[4*n+3]=t[3]},MAT3:function(t,e,n){e[9*n+0]=t[0],e[9*n+1]=t[1],e[9*n+2]=t[2],e[9*n+3]=t[3],e[9*n+4]=t[4],e[9*n+5]=t[5],e[9*n+6]=t[6],e[9*n+7]=t[7],e[9*n+8]=t[8],e[9*n+9]=t[9]},MAT4:function(t,e,n){e[16*n+0]=t[0],e[16*n+1]=t[1],e[16*n+2]=t[2],e[16*n+3]=t[3],e[16*n+4]=t[4],e[16*n+5]=t[5],e[16*n+6]=t[6],e[16*n+7]=t[7],e[16*n+8]=t[8],e[16*n+9]=t[9],e[16*n+10]=t[10],e[16*n+11]=t[11],e[16*n+12]=t[12],e[16*n+13]=t[13],e[16*n+14]=t[14],e[16*n+15]=t[15]}};function P(t){throw new Error('"'+t+'" is read-only')}var M=function(t){return void 0!==t};function x(t,e,n){if(!e)return null;var r=t.getExtension("3DTILES_batch_table_hierarchy"),i=e.HIERARCHY;return i&&(console.warn("3D Tile Parser: HIERARCHY is deprecated. Use 3DTILES_batch_table_hierarchy."),e.extensions=e.extensions||{},e.extensions["3DTILES_batch_table_hierarchy"]=i,r=i),r?function(t,e){var n,r,i,a,o=t.instancesLength,s=t.classes,c=t.classIds,u=t.parentCounts,l=t.parentIds,h=o;M(c.byteOffset)&&(c.componentType=defaultValue(c.componentType,GL.UNSIGNED_SHORT),c.type=AttributeType.SCALAR,i=getBinaryAccessor(c),P("classIds"),c=i.createArrayBufferView(e.buffer,e.byteOffset+c.byteOffset,o));if(M(u))for(M(u.byteOffset)&&(u.componentType=defaultValue(u.componentType,GL.UNSIGNED_SHORT),u.type=AttributeType.SCALAR,i=getBinaryAccessor(u),P("parentCounts"),u=i.createArrayBufferView(e.buffer,e.byteOffset+u.byteOffset,o)),a=new Uint16Array(o),P("parentIdsLength"),h=0,n=0;n<o;++n)a[n]=h,h+=(P("parentIdsLength"),u[n]);M(l)&&M(l.byteOffset)&&(l.componentType=defaultValue(l.componentType,GL.UNSIGNED_SHORT),l.type=AttributeType.SCALAR,i=getBinaryAccessor(l),P("parentIds"),l=i.createArrayBufferView(e.buffer,e.byteOffset+l.byteOffset,h));var f=s.length;for(n=0;n<f;++n){var p=s[n].length,d=s[n].instances,v=getBinaryProperties(p,d,e);s[n].instances=combine(v,d)}var y=new Array(f).fill(0),m=new Uint16Array(o);for(n=0;n<o;++n)r=c[n],m[n]=y[r],++y[r];var g={classes:s,classIds:c,classIndexes:m,parentCounts:u,parentIndexes:a,parentIds:l};return function(t){for(var e=t.classIds.length,n=0;n<e;++n)R(t,n,stack)}(g),g}(r,n):null}function C(t,e,n){if(t){var r=t.parentCounts;return t.parentIds?n(t,e):r>0?function(t,e,n){var r=t.classIds,i=t.parentCounts,a=t.parentIds,o=t.parentIndexes,s=r.length,c=scratchVisited;c.length=Math.max(c.length,s);var u=++marker,l=scratchStack;l.length=0,l.push(e);for(;l.length>0;)if(e=l.pop(),c[e]!==u){c[e]=u;var h=n(t,e);if(M(h))return h;for(var f=i[e],p=o[e],d=0;d<f;++d){var v=a[p+d];v!==e&&l.push(v)}}return null}(t,e,n):function(t,e,n){var r=!0;for(;r;){var i=n(t,e);if(M(i))return i;var a=t.parentIds[e];r=a!==e,e=a}throw new Error("traverseHierarchySingleParent")}(t,e,n)}}function R(t,e,n){var r=t.parentCounts,i=t.parentIds,a=t.parentIndexes,o=t.classIds.length;if(M(i)){assert(e<o,"Parent index "+e+" exceeds the total number of instances: "+o),assert(-1===n.indexOf(e),"Circular dependency detected in the batch table hierarchy."),n.push(e);for(var s=M(r)?r[e]:1,c=M(r)?a[e]:e,u=0;u<s;++u){var l=i[c+u];l!==e&&R(t,l,n)}n.pop(e)}}function L(t){return null!=t}var N=function(t,e){return t},I={HIERARCHY:!0,extensions:!0,extras:!0},A=function(){function t(t,e,n,r){for(var i in void 0===r&&(r={}),Object(u.a)(n>=0),this.json=t||{},this.binary=e,this.featureCount=n,this._extensions=this.json&&this.json.extensions||{},this._properties={},this.json)I[i]||(this._properties[i]=this.json[i]);this._binaryProperties=this._initializeBinaryProperties(),r["3DTILES_batch_table_hierarchy"]&&(this._hierarchy=x(this,this.json,this.binary))}var e=t.prototype;return e.getExtension=function(t){return this.json&&this.json.extensions&&this.json.extensions[t]},e.memorySizeInBytes=function(){return 0},e.isClass=function(t,e){return this._checkBatchId(t),Object(u.a)("string"==typeof e,e),!!this._hierarchy&&L(C(this._hierarchy,t,(function(t,n){var r=t.classIds[n];return t.classes[r].name===e})))},e.isExactClass=function(t,e){return Object(u.a)("string"==typeof e,e),this.getExactClassName(t)===e},e.getExactClassName=function(t){if(this._checkBatchId(t),this._hierarchy){var e=this._hierarchy.classIds[t];return this._hierarchy.classes[e].name}},e.hasProperty=function(t,e){return this._checkBatchId(t),Object(u.a)("string"==typeof e,e),L(this._properties[e])||this._hasPropertyInHierarchy(t,e)},e.getPropertyNames=function(t,e){var n;this._checkBatchId(t),(e=L(e)?e:[]).length=0;var r=Object.keys(this._properties);return(n=e).push.apply(n,Object(S.a)(r)),this._hierarchy&&this._getPropertyNamesInHierarchy(t,e),e},e.getProperty=function(t,e){if(this._checkBatchId(t),Object(u.a)("string"==typeof e,e),this._binaryProperties){var n=this._binaryProperties[e];if(L(n))return this._getBinaryProperty(n,t)}var r=this._properties[e];if(L(r))return N(r[t]);if(this._hierarchy){var i=this._getHierarchyProperty(t,e);if(L(i))return i}},e.setProperty=function(t,e,n){var r=this.featureCount;if(this._checkBatchId(t),Object(u.a)("string"==typeof e,e),this._binaryProperties){var i=this._binaryProperties[e];if(i)return void this._setBinaryProperty(i,t,n)}if(!this._hierarchy||!this._setHierarchyProperty(this,t,e,n)){var a=this._properties[e];L(a)||(this._properties[e]=new Array(r),a=this._properties[e]),a[t]=N(n)}},e._checkBatchId=function(t){if(!(t>=0&&t<this.featureCount))throw new Error("batchId not in range [0, featureCount - 1].")},e._getBinaryProperty=function(t,e){return t.unpack(t.typedArray,e)},e._setBinaryProperty=function(t,e,n){t.pack(n,t.typedArray,e)},e._initializeBinaryProperties=function(){var t=null;for(var e in this._properties){var n=this._properties[e],r=this._initializeBinaryProperty(e,n);r&&((t=t||{})[e]=r)}return t},e._initializeBinaryProperty=function(t,e){if("byteOffset"in e){var n=e;Object(u.a)(this.binary,"Property "+t+" requires a batch table binary."),Object(u.a)(n.type,"Property "+t+" requires a type.");var r=function(t,e,n,r){var i=t.componentType;Object(u.a)(t.componentType);var a="string"==typeof i?j.fromName(i):i,o=T[t.type],s=k[t.type],c=E[t.type];return n+=t.byteOffset,{values:j.createTypedArray(a,e,n,o*r),type:a,size:o,unpacker:s,packer:c}}(n,this.binary.buffer,0|this.binary.byteOffset,this.featureCount);return{typedArray:r.values,componentCount:r.size,unpack:r.unpacker,pack:r.packer}}return null},e._hasPropertyInHierarchy=function(t,e){if(!this._hierarchy)return!1;var n=C(this._hierarchy,t,(function(t,n){var r=t.classIds[n];return L(t.classes[r].instances[e])}));return L(n)},e._getPropertyNamesInHierarchy=function(t,e){C(this._hierarchy,t,(function(t,n){var r=t.classIds[n],i=t.classes[r].instances;for(var a in i)i.hasOwnProperty(a)&&-1===e.indexOf(a)&&e.push(a)}))},e._getHierarchyProperty=function(t,e){var n=this;return C(this._hierarchy,t,(function(t,r){var i=t.classIds[r],a=t.classes[i],o=t.classIndexes[r],s=a.instances[e];return L(s)?L(s.typedArray)?n._getBinaryProperty(s,o):N(s[o]):null}))},e._setHierarchyProperty=function(t,e,n,r){var i=this,a=C(this._hierarchy,e,(function(t,a){var o=t.classIds[a],s=t.classes[o],c=t.classIndexes[a],l=s.instances[n];return!!L(l)&&(Object(u.a)(a===e,'Inherited property "'+n+'" is read-only.'),L(l.typedArray)?i._setBinaryProperty(l,c,r):l[c]=N(r),!0)}));return L(a)},t}();function D(t,e,n){void 0===n&&(n=0);var r=new DataView(e);if(t.magic=r.getUint32(n,!0),n+=4,t.version=r.getUint32(n,!0),n+=4,t.byteLength=r.getUint32(n,!0),n+=4,1!==t.version)throw new Error("3D Tile Version "+t.version+" not supported");return n}function z(t,e,n){var r=new DataView(e);return t.header=t.header||{},t.header.featureTableJsonByteLength=r.getUint32(n,!0),n+=4,t.header.featureTableBinaryByteLength=r.getUint32(n,!0),n+=4,t.header.batchTableJsonByteLength=r.getUint32(n,!0),n+=4,t.header.batchTableBinaryByteLength=r.getUint32(n,!0),n+=4}function U(t,e,n,r){return n=function(t,e,n,r){var i=t.header,a=i.featureTableJsonByteLength,o=i.featureTableBinaryByteLength;if(t.featureTableJson={BATCH_LENGTH:0},a>0){var s=l(e,n,a);t.featureTableJson=JSON.parse(s)}return n+=a,t.featureTableBinary=new Uint8Array(e,n,o),n+=o}(t,e,n),n=function(t,e,n,r){var i=t.header,a=i.batchTableJsonByteLength,o=i.batchTableBinaryByteLength;if(a>0){var s=l(e,n,a);t.batchTableJson=JSON.parse(s),n+=a,o>0&&(t.batchTableBinary=new Uint8Array(e,n,o),t.batchTableBinary=new Uint8Array(t.batchTableBinary),n+=o)}return n}(t,e,n)}function V(t,e){void 0===e&&(e=[0,0,0]);var n=t>>11&31,r=t>>5&63,i=31&t;return e[0]=n<<3,e[1]=r<<2,e[2]=i<<3,e}function B(t,e,n){if(!(e||t&&t.batchIds&&n))return null;var r=t.batchIds,i=t.isRGB565,a=t.pointCount;if(r&&n){for(var o=new Uint8ClampedArray(3*a),s=0;s<a;s++){var c=r[s],u=n.getProperty(c,"dimensions").map((function(t){return 255*t}));o[3*s]=u[0],o[3*s+1]=u[1],o[3*s+2]=u[2]}return{type:g.UNSIGNED_BYTE,value:o,size:3,normalized:!0}}if(i){for(var l=new Uint8ClampedArray(3*a),h=0;h<a;h++){var f=V(e[h]);l[3*h]=f[0],l[3*h+1]=f[1],l[3*h+2]=f[2]}return{type:g.UNSIGNED_BYTE,value:l,size:3,normalized:!0}}return e&&e.length===3*a?{type:g.UNSIGNED_BYTE,value:e,size:3,normalized:!0}:{type:g.UNSIGNED_BYTE,value:e,size:4,normalized:!0}}var F=n("1OyB"),q=n("vuIU"),G=n("md7G"),H=n("foSv"),Z=n("Ji7U"),W=n("HHP4"),Y=n("yeNo"),K=n("fOPP"),Q=n("umh7"),J=n("vtVt"),X=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Object(F.a)(this,e),t=Object(G.a)(this,Object(H.a)(e).call(this,2)),Object(Y.f)(n)&&1===arguments.length?t.copy(n):(Y.b.debug&&(Object(K.a)(n),Object(K.a)(r)),t[0]=n,t[1]=r),t}return Object(Z.a)(e,t),Object(q.a)(e,[{key:"set",value:function(t,e){return this[0]=t,this[1]=e,this.check()}},{key:"copy",value:function(t){return this[0]=t[0],this[1]=t[1],this.check()}},{key:"fromObject",value:function(t){return Y.b.debug&&(Object(K.a)(t.x),Object(K.a)(t.y)),this[0]=t.x,this[1]=t.y,this.check()}},{key:"toObject",value:function(t){return t.x=this[0],t.y=this[1],t}},{key:"horizontalAngle",value:function(){return Math.atan2(this.y,this.x)}},{key:"verticalAngle",value:function(){return Math.atan2(this.x,this.y)}},{key:"transform",value:function(t){return this.transformAsPoint(t)}},{key:"transformAsPoint",value:function(t){return Q.d(this,this,t),this.check()}},{key:"transformAsVector",value:function(t){return Object(J.a)(this,this,t),this.check()}},{key:"transformByMatrix3",value:function(t){return Q.c(this,this,t),this.check()}},{key:"transformByMatrix2x3",value:function(t){return Q.b(this,this,t),this.check()}},{key:"transformByMatrix2",value:function(t){return Q.a(this,this,t),this.check()}},{key:"ELEMENTS",get:function(){return 2}}]),e}(W.a);Math.PI,Math.PI,Math.PI,Math.PI;function $(t,e){if(!t)throw new Error("math.gl assertion failed. "+e)}new X,new b.a,new X,new X,new Uint8Array(1);function tt(t,e){return void 0===e&&(e=255),Object(Y.a)(t,0,e)/e*2-1}function et(t){return t<0?-1:1}function nt(t,e,n,r){if($(r),t<0||t>n||e<0||e>n)throw new Error("x and y must be unsigned normalized integers between 0 and "+n);if(r.x=tt(t,n),r.y=tt(e,n),r.z=1-(Math.abs(r.x)+Math.abs(r.y)),r.z<0){var i=r.x;r.x=(1-Math.abs(r.y))*et(i),r.y=(1-Math.abs(i))*et(r.y)}return r.normalize()}function rt(t,e,n){return nt(t,e,255,n)}var it=new b.a;function at(t,e,n){return t.isQuantized?n["3d-tiles"]&&n["3d-tiles"].decodeQuantizedPositions?(t.isQuantized=!1,function(t,e){for(var n=new b.a,r=new Float32Array(3*t.pointCount),i=0;i<t.pointCount;i++)n.set(e[3*i],e[3*i+1],e[3*i+2]).scale(1/t.quantizedRange).multiply(t.quantizedVolumeScale).add(t.quantizedVolumeOffset).toArray(r,3*i);return r}(t,e)):{type:g.UNSIGNED_SHORT,value:e,size:3,normalized:!0}:e}function ot(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function st(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ot(Object(n),!0).forEach((function(e){Object(f.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ot(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function ct(t,e,n,r,i){return ut.apply(this,arguments)}function ut(){return(ut=Object(a.a)(i.a.mark((function t(e,n,r,a,o){var s,c,u;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=D(e,n,r),r=z(e,n,r),r=U(e,n,r),lt(e),s=ht(e),c=s.featureTable,u=s.batchTable,t.next=7,vt(e,c,u,a,o);case 7:return ft(e,c,a),pt(e,c,u),dt(e,c),t.abrupt("return",r);case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function lt(t){t.attributes={positions:null,colors:null,normals:null,batchIds:null},t.isQuantized=!1,t.isTranslucent=!1,t.isRGB565=!1,t.isOctEncoded16P=!1}function ht(t){var e=new w(t.featureTableJson,t.featureTableBinary),n=e.getGlobalProperty("POINTS_LENGTH");if(!Number.isFinite(n))throw new Error("POINTS_LENGTH must be defined");e.featuresLength=n,t.featuresLength=n,t.pointsLength=n,t.pointCount=n,t.rtcCenter=e.getGlobalProperty("RTC_CENTER",g.FLOAT,3);var r=function(t,e){var n=null;if(!t.batchIds&&e.hasProperty("BATCH_ID")&&(t.batchIds=e.getPropertyArray("BATCH_ID",g.UNSIGNED_SHORT,1),t.batchIds)){var r=e.getGlobalProperty("BATCH_LENGTH");if(!r)throw new Error("Global property: BATCH_LENGTH must be defined when BATCH_ID is defined.");var i=t.batchTableJson,a=t.batchTableBinary;n=new A(i,a,r)}return n}(t,e);return{featureTable:e,batchTable:r}}function ft(t,e,n){if(!t.attributes.positions)if(e.hasProperty("POSITION"))t.attributes.positions=e.getPropertyArray("POSITION",g.FLOAT,3);else if(e.hasProperty("POSITION_QUANTIZED")){var r=e.getPropertyArray("POSITION_QUANTIZED",g.UNSIGNED_SHORT,3);if(t.isQuantized=!0,t.quantizedRange=65535,t.quantizedVolumeScale=e.getGlobalProperty("QUANTIZED_VOLUME_SCALE",g.FLOAT,3),!t.quantizedVolumeScale)throw new Error("QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");if(t.quantizedVolumeOffset=e.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",g.FLOAT,3),!t.quantizedVolumeOffset)throw new Error("QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");t.attributes.positions=at(t,r,n)}if(!t.attributes.positions)throw new Error("Either POSITION or POSITION_QUANTIZED must be defined.")}function pt(t,e,n){if(!t.attributes.colors){var r=null;e.hasProperty("RGBA")?(r=e.getPropertyArray("RGBA",g.UNSIGNED_BYTE,4),t.isTranslucent=!0):e.hasProperty("RGB")?r=e.getPropertyArray("RGB",g.UNSIGNED_BYTE,3):e.hasProperty("RGB565")&&(r=e.getPropertyArray("RGB565",g.UNSIGNED_SHORT,1),t.isRGB565=!0),t.attributes.colors=B(t,r,n)}e.hasProperty("CONSTANT_RGBA")&&(t.constantRGBA=e.getGlobalProperty("CONSTANT_RGBA",g.UNSIGNED_BYTE,4))}function dt(t,e){if(!t.attributes.normals){var n=null;e.hasProperty("NORMAL")?n=e.getPropertyArray("NORMAL",g.FLOAT,3):e.hasProperty("NORMAL_OCT16P")&&(n=e.getPropertyArray("NORMAL_OCT16P",g.UNSIGNED_BYTE,2),t.isOctEncoded16P=!0),t.attributes.normals=function(t,e){if(!e)return null;if(t.isOctEncoded16P){for(var n=new Float32Array(3*t.pointsLength),r=0;r<t.pointsLength;r++)rt(e[2*r],e[2*r+1],it),it.toArray(n,3*r);return{type:g.FLOAT,size:2,value:n}}return{type:g.FLOAT,size:2,value:e}}(t,n)}}function vt(t,e,n,r,i){return yt.apply(this,arguments)}function yt(){return(yt=Object(a.a)(i.a.mark((function t(e,n,r,a,o){var s,c,u,l,h,f,p,d;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((l=r&&r.getExtension("3DTILES_draco_point_compression"))&&(u=l.properties),!(h=n.getExtension("3DTILES_draco_point_compression"))){t.next=15;break}if(c=h.properties,f=h.byteOffset,p=h.byteLength,c&&Number.isFinite(f)&&p){t.next=9;break}throw new Error("Draco properties, byteOffset, and byteLength must be defined");case 9:s=e.featureTableBinary.slice(f,f+p),e.hasPositions=Number.isFinite(c.POSITION),e.hasColors=Number.isFinite(c.RGB)||Number.isFinite(c.RGBA),e.hasNormals=Number.isFinite(c.NORMAL),e.hasBatchIds=Number.isFinite(c.BATCH_ID),e.isTranslucent=Number.isFinite(c.RGBA);case 15:if(s){t.next=17;break}return t.abrupt("return",!0);case 17:return d={buffer:s,properties:st(st({},c),u),featureTableProperties:c,batchTableProperties:u,dequantizeInShader:!1},t.next=20,mt(e,d,a,o);case 20:return t.abrupt("return",t.sent);case 21:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function mt(t,e,n,r){return gt.apply(this,arguments)}function gt(){return(gt=Object(a.a)(i.a.mark((function t(e,n,r,a){var o,s,c,u,l,h,f,d,v,y;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=a.parse,t.next=3,o(n.buffer,p.a,{});case 3:s=t.sent,c=s.attributes.POSITION&&s.attributes.POSITION.value,u=s.attributes.COLOR_0&&s.attributes.COLOR_0.value,l=s.attributes.NORMAL&&s.attributes.NORMAL.value,h=s.attributes.BATCH_ID&&s.attributes.BATCH_ID.value,f=c&&s.attributes.POSITION.value.quantization,d=l&&s.attributes.NORMAL.value.quantization,f&&(v=s.POSITION.data.quantization,y=v.range,e.quantizedVolumeScale=new b.a(y,y,y),e.quantizedVolumeOffset=new b.a(v.minValues),e.quantizedRange=(1<<v.quantizationBits)-1,e.isQuantizedDraco=!0),d&&(e.octEncodedRange=(1<<s.NORMAL.data.quantization.quantizationBits)-1,e.isOctEncodedDraco=!0),e.attributes={positions:c,colors:B(e,u),normals:l,batchIds:h};case 13:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var bt=n("yx+g"),Ot=n("ngZ5"),_t=0,jt=1;function wt(t,e,n){t.rotateYtoZ=!0;var r=t.byteOffset+t.byteLength-n;if(0===r)throw new Error("glTF byte length must be greater than 0.");return t.gltfArrayBuffer=Object(Ot.b)(e,n,r),t.gltfByteOffset=0,t.gltfByteLength=r,n%4==0||console.warn(t.type+": embedded glb is not aligned to a 4-byte boundary."),t.byteOffset+t.byteLength}function St(t,e,n,r){return Tt.apply(this,arguments)}function Tt(){return(Tt=Object(a.a)(i.a.mark((function t(e,n,r,a){var o,s,c;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=r["3d-tiles"]||{},kt(e,n,r),!o.loadGLTF){t.next=16;break}if(s=a.parse,c=a.fetch,!e.gltfUrl){t.next=9;break}return t.next=7,c(e.gltfUrl,r);case 7:e.gltfArrayBuffer=t.sent,e.gltfByteOffset=0;case 9:if(!e.gltfArrayBuffer){t.next=16;break}return t.next=12,s(e.gltfArrayBuffer,bt.a,r,a);case 12:e.gltf=t.sent,delete e.gltfArrayBuffer,delete e.gltfByteOffset,delete e.gltfByteLength;case 16:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function kt(t,e,n){switch(e){case _t:var r=new Uint8Array(t.gltfArrayBuffer,t.gltfByteOffset),i=(new TextDecoder).decode(r);t.gltfUrl=i.replace(/[\s\0]+$/,""),delete t.gltfArrayBuffer,delete t.gltfByteOffset,delete t.gltfByteLength;break;case jt:break;default:throw new Error("b3dm: Illegal glTF format field")}}function Et(t,e,n,r,i){return Pt.apply(this,arguments)}function Pt(){return(Pt=Object(a.a)(i.a.mark((function t(e,n,r,a,o){var s,c;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=Mt(e,n,r,a,o),t.next=3,St(e,jt,a,o);case 3:return s=e.gltf||{},(c=s.extensions)&&c.CESIUM_RTC&&(e.rtcCenter=c.CESIUM_RTC.center),t.abrupt("return",r);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Mt(t,e,n,r,i){n=wt(t,e,n=U(t,e,n=z(t,e,n=D(t,e,n))));var a=new w(t.featureTableJson,t.featureTableBinary);return t.rtcCenter=a.getGlobalProperty("RTC_CENTER",g.FLOAT,3),n}var xt=n("T27a"),Ct=n("bE5S"),Rt=n("2plT"),Lt=n("yOd+"),Nt=n("GSm6"),It=n("MTwu"),At=n("ARt4");function Dt(){var t=new Lt.a(4);return Lt.a!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function zt(t,e,n){n*=.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function Ut(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=n[0],c=n[1],u=n[2],l=n[3];return t[0]=r*l+o*s+i*u-a*c,t[1]=i*l+o*c+a*s-r*u,t[2]=a*l+o*u+r*c-i*s,t[3]=o*l-r*s-i*c-a*u,t}function Vt(t,e,n,r){var i,a,o,s,c,u=e[0],l=e[1],h=e[2],f=e[3],p=n[0],d=n[1],v=n[2],y=n[3];return(a=u*p+l*d+h*v+f*y)<0&&(a=-a,p=-p,d=-d,v=-v,y=-y),1-a>Lt.b?(i=Math.acos(a),o=Math.sin(i),s=Math.sin((1-r)*i)/o,c=Math.sin(r*i)/o):(s=1-r,c=r),t[0]=s*u+c*p,t[1]=s*l+c*d,t[2]=s*h+c*v,t[3]=s*f+c*y,t}function Bt(t,e){var n,r=e[0]+e[4]+e[8];if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);var a=(i+1)%3,o=(i+2)%3;n=Math.sqrt(e[3*i+i]-e[3*a+a]-e[3*o+o]+1),t[i]=.5*n,n=.5/n,t[3]=(e[3*a+o]-e[3*o+a])*n,t[a]=(e[3*a+i]+e[3*i+a])*n,t[o]=(e[3*o+i]+e[3*i+o])*n}return t}At.b,At.g,At.c,At.l;var Ft,qt,Gt,Ht,Zt,Wt,Yt=At.a,Kt=At.k,Qt=At.d,Jt=At.i,Xt=At.h,$t=At.m,te=At.j,ee=(At.f,At.e,Ft=It.b(),qt=It.e(1,0,0),Gt=It.e(0,1,0),function(t,e,n){var r=It.d(e,n);return r<-.999999?(It.c(Ft,qt,e),It.f(Ft)<1e-6&&It.c(Ft,Gt,e),It.g(Ft,Ft),zt(t,Ft,Math.PI),t):r>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(It.c(Ft,e,n),t[0]=Ft[0],t[1]=Ft[1],t[2]=Ft[2],t[3]=1+r,te(t,t))}),ne=(Ht=Dt(),Zt=Dt(),Wt=Nt.a(),[0,0,0,1]),re=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return Object(F.a)(this,e),t=Object(G.a)(this,Object(H.a)(e).call(this,-0,-0,-0,-0)),Array.isArray(n)&&1===arguments.length?t.copy(n):t.set(n,r,i,a),t}return Object(Z.a)(e,t),Object(q.a)(e,[{key:"copy",value:function(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}},{key:"set",value:function(t,e,n,r){return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this.check()}},{key:"fromMatrix3",value:function(t){return Bt(this,t),this.check()}},{key:"identity",value:function(){var t;return(t=this)[0]=0,t[1]=0,t[2]=0,t[3]=1,this.check()}},{key:"fromAxisRotation",value:function(t,e){return zt(this,t,e),this.check()}},{key:"setAxisAngle",value:function(t,e){return this.fromAxisRotation(t,e)}},{key:"len",value:function(){return Xt(this)}},{key:"lengthSquared",value:function(){return $t(this)}},{key:"dot",value:function(t,e){if(void 0!==e)throw new Error("Quaternion.dot only takes one argument");return Qt(this,t)}},{key:"rotationTo",value:function(t,e){return ee(this,t,e),this.check()}},{key:"add",value:function(t,e){if(void 0!==e)throw new Error("Quaternion.add only takes one argument");return Yt(this,this,t),this.check()}},{key:"calculateW",value:function(){var t,e,n,r,i;return t=this,n=(e=this)[0],r=e[1],i=e[2],t[0]=n,t[1]=r,t[2]=i,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),this.check()}},{key:"conjugate",value:function(){var t,e;return e=this,(t=this)[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],this.check()}},{key:"invert",value:function(){var t,e,n,r,i,a,o,s;return t=this,n=(e=this)[0],r=e[1],i=e[2],a=e[3],s=(o=n*n+r*r+i*i+a*a)?1/o:0,t[0]=-n*s,t[1]=-r*s,t[2]=-i*s,t[3]=a*s,this.check()}},{key:"lerp",value:function(t,e,n){return Jt(this,t,e,n),this.check()}},{key:"multiplyRight",value:function(t,e){return Object(Rt.a)(!e),Ut(this,this,t),this.check()}},{key:"multiplyLeft",value:function(t,e){return Object(Rt.a)(!e),Ut(this,t,this),this.check()}},{key:"normalize",value:function(){var t=this.len(),e=t>0?1/t:0;return this[0]=this[0]*e,this[1]=this[1]*e,this[2]=this[2]*e,this[3]=this[3]*e,0===t&&(this[3]=1),this.check()}},{key:"rotateX",value:function(t){return function(t,e,n){n*=.5;var r=e[0],i=e[1],a=e[2],o=e[3],s=Math.sin(n),c=Math.cos(n);t[0]=r*c+o*s,t[1]=i*c+a*s,t[2]=a*c-i*s,t[3]=o*c-r*s}(this,this,t),this.check()}},{key:"rotateY",value:function(t){return function(t,e,n){n*=.5;var r=e[0],i=e[1],a=e[2],o=e[3],s=Math.sin(n),c=Math.cos(n);t[0]=r*c-a*s,t[1]=i*c+o*s,t[2]=a*c+r*s,t[3]=o*c-i*s}(this,this,t),this.check()}},{key:"rotateZ",value:function(t){return function(t,e,n){n*=.5;var r=e[0],i=e[1],a=e[2],o=e[3],s=Math.sin(n),c=Math.cos(n);t[0]=r*c+i*s,t[1]=i*c-r*s,t[2]=a*c+o*s,t[3]=o*c-a*s}(this,this,t),this.check()}},{key:"scale",value:function(t){return Kt(this,this,t),this.check()}},{key:"slerp",value:function(t,e,n){switch(arguments.length){case 1:var r=arguments[0],i=r.start;t=void 0===i?ne:i,e=r.target,n=r.ratio;break;case 2:var a=Array.prototype.slice.call(arguments);e=a[0],n=a[1],t=this}return Vt(this,t,e,n),this.check()}},{key:"transformVector4",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return At.o(e,t,this),Object(K.b)(e,4)}},{key:"lengthSq",value:function(){return this.lengthSquared()}},{key:"setFromAxisAngle",value:function(t,e){return this.setAxisAngle(t,e)}},{key:"premultiply",value:function(t,e){return this.multiplyLeft(t,e)}},{key:"multiply",value:function(t,e){return this.multiplyRight(t,e)}},{key:"ELEMENTS",get:function(){return 4}},{key:"x",get:function(){return this[0]},set:function(t){this[0]=Object(K.a)(t)}},{key:"y",get:function(){return this[1]},set:function(t){this[1]=Object(K.a)(t)}},{key:"z",get:function(){return this[2]},set:function(t){this[2]=Object(K.a)(t)}},{key:"w",get:function(){return this[3]},set:function(t){this[3]=Object(K.a)(t)}}]),e}(Ct.a),ie=n("kh/P"),ae=n("Ns70");function oe(t,e,n,r,i){return se.apply(this,arguments)}function se(){return(se=Object(a.a)(i.a.mark((function t(e,n,r,a,o){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=ce(e,n,r,a,o),t.next=3,St(e,e.gltfFormat,a,o);case 3:return t.abrupt("return",r);case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function ce(t,e,n,r,i){if(n=D(t,e,n),1!==t.version)throw new Error("Instanced 3D Model version "+t.version+" is not supported");n=z(t,e,n);var a=new DataView(e);if(t.gltfFormat=a.getUint32(n,!0),n=wt(t,e,n=U(t,e,n+=4)),0===t.featureTableJsonByteLength)throw new Error("i3dm parser: featureTableJsonByteLength is zero.");var o=new w(t.featureTableJson,t.featureTableBinary),s=o.getGlobalProperty("INSTANCES_LENGTH");if(o.featuresLength=s,!Number.isFinite(s))throw new Error("i3dm parser: INSTANCES_LENGTH must be defined");t.eastNorthUp=o.getGlobalProperty("EAST_NORTH_UP"),t.rtcCenter=o.getGlobalProperty("RTC_CENTER",g.FLOAT,3);new A(t.batchTableJson,t.batchTableBinary,s);return function(t,e,n,r){for(var i=[new Array(r),t._batchTable][0],a=new b.a,o=(new b.a,new b.a,new b.a,new xt.a),s=new re,c=new b.a,u={},l=new ie.a,h=[],f=[],p=new b.a,d=new b.a,v=0;v<r;v++){var y=void 0;if(e.hasProperty("POSITION"))y=e.getProperty("POSITION",g.FLOAT,3,v,a);else if(e.hasProperty("POSITION_QUANTIZED")){y=e.getProperty("POSITION_QUANTIZED",g.UNSIGNED_SHORT,3,v,a);var m=e.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",g.FLOAT,3,p);if(!m)throw new Error("i3dm parser: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");var O=e.getGlobalProperty("QUANTIZED_VOLUME_SCALE",g.FLOAT,3,d);if(!O)throw new Error("i3dm parser: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");for(var _=0;_<3;_++)y[_]=y[_]/65535*O[_]+m[_]}if(!y)throw new Error("i3dm: POSITION or POSITION_QUANTIZED must be defined for each instance.");a.copy(y),u.translation=a,t.normalUp=e.getProperty("NORMAL_UP",g.FLOAT,3,v,h),t.normalRight=e.getProperty("NORMAL_RIGHT",g.FLOAT,3,v,f);if(t.normalUp){if(!t.normalRight)throw new Error("i3dm: Custom orientation requires both NORMAL_UP and NORMAL_RIGHT.");t.hasCustomOrientation=!0}else{if(t.octNormalUp=e.getProperty("NORMAL_UP_OCT32P",g.UNSIGNED_SHORT,2,h),t.octNormalRight=e.getProperty("NORMAL_RIGHT_OCT32P",g.UNSIGNED_SHORT,2,f),t.octNormalUp){if(!t.octNormalRight)throw new Error("i3dm: oct-encoded orientation requires NORMAL_UP_OCT32P and NORMAL_RIGHT_OCT32P");throw new Error("i3dm: oct-encoded orientation not implemented")}t.eastNorthUp?(ae.a.WGS84.eastNorthUpToFixedFrame(a,l),l.getRotationMatrix3(o)):o.identity()}!1,s.fromMatrix3(o),u.rotation=s,c.set(1,1,1);var j=e.getProperty("SCALE",g.FLOAT,1,v);Number.isFinite(j)&&c.multiplyByScalar(j);var w=e.getProperty("SCALE_NON_UNIFORM",g.FLOAT,3,v,h);w&&c.scale(w),u.scale=c;var S=e.getProperty("BATCH_ID",g.UNSIGNED_SHORT,1,v);void 0===S&&(S=v);var T=(new ie.a).fromQuaternion(u.rotation);l.identity(),l.translate(u.translation),l.multiplyRight(T),l.scale(u.scale);var k=l.clone();i[v]={modelMatrix:k,batchId:S}}t.instances=i}(t,o,0,s),n}function ue(t,e,n,r,i,a){return le.apply(this,arguments)}function le(){return(le=Object(a.a)(i.a.mark((function t(e,n,r,a,o,s){var c,u;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=D(e,n,r),c=new DataView(n),e.tilesLength=c.getUint32(r,!0),r+=4,e.tiles=[];case 5:if(!(e.tiles.length<e.tilesLength&&e.byteLength-r>12)){t.next=13;break}return u={},e.tiles.push(u),t.next=10,s(n,r,a,o,u);case 10:r=t.sent,t.next=5;break;case 13:return t.abrupt("return",r);case 14:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function he(t,e,n,r,i){return fe.apply(this,arguments)}function fe(){return(fe=Object(a.a)(i.a.mark((function t(e,n,r,a,o){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:void 0===n&&(n=0),void 0===o&&(o={}),o.byteOffset=n,o.type=h(e,n),t.t0=o.type,t.next=t.t0===c.COMPOSITE?7:t.t0===c.BATCHED_3D_MODEL?10:t.t0===c.INSTANCED_3D_MODEL?13:t.t0===c.POINT_CLOUD?16:19;break;case 7:return t.next=9,ue(o,e,n,r,a,he);case 9:return t.abrupt("return",t.sent);case 10:return t.next=12,Et(o,e,n,r,a);case 12:return t.abrupt("return",t.sent);case 13:return t.next=15,oe(o,e,n,r,a);case 15:return t.abrupt("return",t.sent);case 16:return t.next=18,ct(o,e,n,r,a);case 18:return t.abrupt("return",t.sent);case 19:throw new Error("3DTileLoader: unknown type "+o.type);case 20:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function pe(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return de(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return de(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=t[Symbol.iterator]()).next.bind(n)}function de(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ve(t,e){if(t.content){var n=t.content.uri||t.content.url;t.contentUrl=e.basePath+"/"+n}return t.id=t.contentUrl,t.lodMetricType=s.a.GEOMETRIC_ERROR,t.lodMetricValue=t.geometricError,t.transformMatrix=t.transform,t.type=function(t){if(!t.contentUrl)return s.f.EMPTY;var e=t.contentUrl.split(".").pop();switch(e){case"pnts":return s.f.POINTCLOUD;case"i3dm":case"b3dm":return s.f.SCENEGRAPH;default:return e}}(t),t.refine=function(t){switch(t){case"REPLACE":case"replace":return s.e.REPLACE;case"ADD":case"add":return s.e.ADD;default:return t}}(t.refine),t}function ye(t){var e=t.basePath,n=ve(t.root,t),r=[];for(r.push(n);r.length>0;)for(var i,a=pe(r.pop().children||[]);!(i=a()).done;){var o=i.value;ve(o,{basePath:e}),r.push(o)}return n}function me(t){return o.a.dirname(t.url)}function ge(t,e,n){return be.apply(this,arguments)}function be(){return(be=Object(a.a)(i.a.mark((function t(e,n,r){var a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(a={}).content=a.content||{},0,t.next=5,he(e,0,n,r,a.content);case 5:return t.abrupt("return",a.content);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Oe(t,e,n){return _e.apply(this,arguments)}function _e(){return(_e=Object(a.a)(i.a.mark((function t(e,n,r){var a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(a=JSON.parse((new TextDecoder).decode(e))).loader=n.loader||we,a.url=r.url,a.basePath=me(a),a.root=ye(a),a.type=s.c.TILES3D,a.lodMetricType=s.a.GEOMETRIC_ERROR,a.lodMetricValue=a.root.lodMetricValue,t.abrupt("return",a);case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function je(){return(je=Object(a.a)(i.a.mark((function t(e,n,r,a){var o;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=n["3d-tiles"]||{},!("auto"===o.isTileset?r.url&&-1!==r.url.indexOf(".json"):o.isTileset)){t.next=8;break}return t.next=5,Oe(e,n,r);case 5:e=t.sent,t.next=11;break;case 8:return t.next=10,ge(e,n,r);case 10:e=t.sent;case 11:return t.abrupt("return",e);case 12:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var we={id:"3d-tiles",name:"3D Tiles",version:"undefined"!=typeof __VERSION__?__VERSION__:"latest",extensions:["cmpt","pnts","b3dm","i3dm"],mimeTypes:["application/octet-stream"],tests:["cmpt","pnts","b3dm","i3dm"],parse:function(t,e,n,r){return je.apply(this,arguments)},options:{"3d-tiles":{loadGLTF:!0,decodeQuantizedPositions:!1,isTileset:"auto",tile:null,tileset:null}}};e.a=we},"G+eI":function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n("1OyB"),i=n("vuIU"),a=n("OyGM"),o=function(){function t(e,n){Object(r.a)(this,t),this.name=e,this.type=n,this.sampleSize=1,this.reset()}return Object(i.a)(t,[{key:"setSampleSize",value:function(t){return this.sampleSize=t,this}},{key:"incrementCount",value:function(){return this.addCount(1),this}},{key:"decrementCount",value:function(){return this.subtractCount(1),this}},{key:"addCount",value:function(t){return this._count+=t,this._samples++,this._checkSampling(),this}},{key:"subtractCount",value:function(t){return this._count-=t,this._samples++,this._checkSampling(),this}},{key:"addTime",value:function(t){return this._time+=t,this.lastTiming=t,this._samples++,this._checkSampling(),this}},{key:"timeStart",value:function(){return this._startTime=Object(a.a)(),this._timerPending=!0,this}},{key:"timeEnd",value:function(){return this._timerPending?(this.addTime(Object(a.a)()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}},{key:"getSampleAverageCount",value:function(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}},{key:"getSampleAverageTime",value:function(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}},{key:"getSampleHz",value:function(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}},{key:"getAverageCount",value:function(){return this.samples>0?this.count/this.samples:0}},{key:"getAverageTime",value:function(){return this.samples>0?this.time/this.samples:0}},{key:"getHz",value:function(){return this.time>0?this.samples/(this.time/1e3):0}},{key:"reset",value:function(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}},{key:"_checkSampling",value:function(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}]),t}(),s=function(){function t(e){var n=e.id,i=e.stats;Object(r.a)(this,t),this.id=n,this.stats={},this._initializeStats(i),Object.seal(this)}return Object(i.a)(t,[{key:"get",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"count";return this._getOrCreate({name:t,type:e})}},{key:"reset",value:function(){for(var t in this.stats)this.stats[t].reset();return this}},{key:"forEach",value:function(t){for(var e in this.stats)t(this.stats[e])}},{key:"getTable",value:function(){var t={};return this.forEach((function(e){t[e.name]={time:e.time||0,count:e.count||0,average:e.getAverageTime()||0,hz:e.getHz()||0}})),t}},{key:"_initializeStats",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.forEach((function(e){return t._getOrCreate(e)}))}},{key:"_getOrCreate",value:function(t){if(!t||!t.name)return null;var e=t.name,n=t.type;return this.stats[e]||(this.stats[e]=t instanceof o?t:new o(e,n)),this.stats[e]}},{key:"size",get:function(){return Object.keys(this.stats).length}}]),t}()},G8qk:function(t,e,n){"use strict";n.d(e,"a",(function(){return on}));var r=n("o0o1"),i=n.n(r),a=n("rePB"),o=n("HaE+"),s=n("1OyB"),c=n("vuIU"),u=n("md7G"),l=n("foSv"),h=n("Ji7U"),f=n("c9N0"),p=n("0i8A"),d=n("V3d6"),v=n("ReuC"),y=n("K7jV"),m=n("hZZG"),g=n("Zk56"),b=function(t){function e(){return Object(s.a)(this,e),Object(u.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(h.a)(e,t),Object(c.a)(e,[{key:"getSubLayers",value:function(){return this.internalState&&this.internalState.subLayers||[]}},{key:"initializeState",value:function(){}},{key:"setState",value:function(t){Object(v.a)(Object(l.a)(e.prototype),"setState",this).call(this,t),this.setNeedsUpdate()}},{key:"getPickingInfo",value:function(t){var e=t.info,n=e.object;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id?Object.assign(e,{object:n.__source.object,index:n.__source.index}):e}},{key:"renderLayers",value:function(){return null}},{key:"shouldRenderSubLayer",value:function(t,e){var n=this.props._subLayerProps;return e&&e.length||n&&n[t]}},{key:"getSubLayerClass",value:function(t,e){var n=this.props._subLayerProps;return n&&n[t]&&n[t].type||e}},{key:"getSubLayerRow",value:function(t,e,n){return t.__source={parent:this,object:e,index:n},t}},{key:"getSubLayerAccessor",value:function(t){if("function"==typeof t){var e={data:this.props.data,target:[]};return function(n,r){return n.__source?(e.index=n.__source.index,t(n.__source.object,e)):t(n,r)}}return t}},{key:"getSubLayerProps",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this.props,n=e.opacity,r=e.pickable,i=e.visible,a=e.parameters,o=e.getPolygonOffset,s=e.highlightedObjectIndex,c=e.autoHighlight,u=e.highlightColor,l=e.coordinateSystem,h=e.coordinateOrigin,f=e.wrapLongitude,p=e.positionFormat,d=e.modelMatrix,v=e.extensions,y=e._subLayerProps,m={opacity:n,pickable:r,visible:i,parameters:a,getPolygonOffset:o,highlightedObjectIndex:s,autoHighlight:c,highlightColor:u,coordinateSystem:l,coordinateOrigin:h,wrapLongitude:f,positionFormat:p,modelMatrix:d,extensions:v},g=y&&y[t.id],b=g&&g.updateTriggers,O=t.id||"sublayer";if(g){var _=this.constructor._propTypes;for(var j in g){var w=_[j];w&&"accessor"===w.type&&(g[j]=this.getSubLayerAccessor(g[j]))}}Object.assign(m,t,g,{id:"".concat(this.props.id,"-").concat(O),updateTriggers:Object.assign({all:this.props.updateTriggers.all},t.updateTriggers,b)});var S=!0,T=!1,k=void 0;try{for(var E,P=v[Symbol.iterator]();!(S=(E=P.next()).done);S=!0){var M=E.value,x=M.getSubLayerProps.call(this,M);x&&Object.assign(m,x,{updateTriggers:Object.assign(m.updateTriggers,x.updateTriggers)})}}catch(C){T=!0,k=C}finally{try{S||null==P.return||P.return()}finally{if(T)throw k}}return m}},{key:"_getAttributeManager",value:function(){return null}},{key:"_renderLayers",value:function(){var t=this.internalState.subLayers,e=!t||this.needsUpdate();e&&(t=this.renderLayers(),t=Object(g.b)(t,Boolean),this.internalState.subLayers=t),Object(m.a)("compositeLayer.renderLayers",this,e,t);var n=!0,r=!1,i=void 0;try{for(var a,o=t[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){a.value.parent=this}}catch(s){r=!0,i=s}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}}},{key:"isComposite",get:function(){return!0}},{key:"isLoaded",get:function(){return Object(v.a)(Object(l.a)(e.prototype),"isLoaded",this)&&this.getSubLayers().every((function(t){return t.isLoaded}))}}]),e}(y.a);b.layerName="CompositeLayer";var O=n("FR1t"),_=n("U8pU"),j=n("Jh/b"),w=n("K4gp"),S=n("BQ9P"),T=n("iein"),k=n("+Jdq"),E=n("UhMv"),P=n("NY3r");function M(){return(M=Object(o.a)(i.a.mark((function t(e){var n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=[],e.scenes.forEach((function(t){t.traverse((function(t){Object.values(t.model.getUniforms()).forEach((function(t){!1===t.loaded&&n.push(t)}))}))})),t.next=4,x((function(){return n.some((function(t){return!t.loaded}))}));case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function x(t){return C.apply(this,arguments)}function C(){return(C=Object(o.a)(i.a.mark((function t(e){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e()){t.next=5;break}return t.next=3,new Promise((function(t){return requestAnimationFrame(t)}));case 3:t.next=0;break;case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var R=n("rpwb"),L=Math.PI/180,N=new Float32Array(16),I=new Float32Array(12);function A(t,e,n){var r=e[0]*L,i=e[1]*L,a=e[2]*L,o=Math.sin(a),s=Math.sin(r),c=Math.sin(i),u=Math.cos(a),l=Math.cos(r),h=Math.cos(i),f=n[0],p=n[1],d=n[2];t[0]=f*h*l,t[1]=f*c*l,t[2]=f*-s,t[3]=p*(-c*u+h*s*o),t[4]=p*(h*u+c*s*o),t[5]=p*l*o,t[6]=d*(c*o+h*s*u),t[7]=d*(-h*o+c*s*u),t[8]=d*l*u}function D(t){return t[0]=t[0],t[1]=t[1],t[2]=t[2],t[3]=t[4],t[4]=t[5],t[5]=t[6],t[6]=t[8],t[7]=t[9],t[8]=t[10],t[9]=t[12],t[10]=t[13],t[11]=t[14],t.subarray(0,12)}var z={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrix__LOCATION_0:{size:3,elementOffset:0},instanceModelMatrix__LOCATION_1:{size:3,elementOffset:3},instanceModelMatrix__LOCATION_2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update:function(t,e){var n=e.startRow,r=e.endRow,i=this.props,a=i.data,o=i.getOrientation,s=i.getScale,c=i.getTranslation,u=i.getTransformMatrix,l=Array.isArray(u),h=l&&16===u.length,f=Array.isArray(s),p=Array.isArray(o),d=Array.isArray(c),v=h||!l&&Boolean(u(a[0]));t.constant=v?h:p&&f&&d;var y=t.value;if(t.constant){var m;if(v)N.set(u),m=D(N);else A(m=I,o,s),m.set(c,9);t.value=new Float32Array(m)}else{var g=n*t.size,b=Object(R.a)(a,n,r),O=b.iterable,_=b.objectInfo,j=!0,w=!1,S=void 0;try{for(var T,k=O[Symbol.iterator]();!(j=(T=k.next()).done);j=!0){var E=T.value;_.index++;var P=void 0;if(v)N.set(h?u:u(E,_)),P=D(N);else A(P=I,p?o:o(E,_),f?s:s(E,_)),P.set(d?c:c(E,_),9);y[g++]=P[0],y[g++]=P[1],y[g++]=P[2],y[g++]=P[3],y[g++]=P[4],y[g++]=P[5],y[g++]=P[6],y[g++]=P[7],y[g++]=P[8],y[g++]=P[9],y[g++]=P[10],y[g++]=P[11]}}catch(M){w=!0,S=M}finally{try{j||null==k.return||k.return()}finally{if(w)throw S}}}}};function U(t,e){return e===d.a.CARTESIAN||e===d.a.METER_OFFSETS||e===d.a.DEFAULT&&!t.isGeospatial}var V=[255,255,255,255],B={scenegraph:{type:"object",value:null,async:!0},getScene:function(t){return t&&t.scenes?"object"===Object(_.a)(t.scene)?t.scene:t.scenes[t.scene||0]:t},getAnimator:function(t){return t&&t.animator},_animations:null,sizeScale:{type:"number",value:1,min:0},sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},getPosition:{type:"accessor",value:function(t){return t.position}},getColor:{type:"accessor",value:V},_lighting:"flat",_imageBasedLightingEnvironment:null,getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]}},F=function(t){function e(){return Object(s.a)(this,e),Object(u.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(h.a)(e,t),Object(c.a)(e,[{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),accessor:"getPosition",transition:!0},instanceColors:{type:5121,size:this.props.colorFormat.length,accessor:"getColor",normalized:!0,defaultValue:V,transition:!0},instanceModelMatrix:z})}},{key:"updateState",value:function(t){Object(v.a)(Object(l.a)(e.prototype),"updateState",this).call(this,t);var n=t.props,r=t.oldProps;n.scenegraph!==r.scenegraph?this._updateScenegraph(n):n._animations!==r._animations&&this._applyAnimationsProp(this.state.scenegraph,this.state.animator,n._animations)}},{key:"finalizeState",value:function(){Object(v.a)(Object(l.a)(e.prototype),"finalizeState",this).call(this),this._deleteScenegraph()}},{key:"_updateScenegraph",value:function(t){var e,n=this,r=this.context.gl;if(t.scenegraph instanceof E.a)e={scenes:[t.scenegraph]};else if(t.scenegraph&&!t.scenegraph.gltf){var i=t.scenegraph,a=Object(P.a)(r,i,this.getLoadOptions());e=Object.assign({gltf:i},a),function(t){return M.apply(this,arguments)}(a).then((function(){return n.setNeedsRedraw()}))}else j.a.deprecated("ScenegraphLayer.props.scenegraph","Use GLTFLoader instead of GLTFScenegraphLoader")(),e=t.scenegraph;var o={layer:this,gl:r},s=t.getScene(e,o),c=t.getAnimator(e,o);s instanceof E.a?(this._deleteScenegraph(),this._applyAllAttributes(s),this._applyAnimationsProp(s,c,t._animations),this.setState({scenegraph:s,animator:c})):null!==s&&j.a.warn("invalid scenegraph:",s)()}},{key:"_applyAllAttributes",value:function(t){var e=this;if(this.state.attributesAvailable){var n=this.getAttributeManager().getAttributes();t.traverse((function(t){e._setModelAttributes(t.model,n)}))}}},{key:"_applyAnimationsProp",value:function(t,e,n){if(t&&e&&n){var r=e.getAnimations();Object.keys(n).sort().forEach((function(t){var e=n[t];if("*"===t)r.forEach((function(t){Object.assign(t,e)}));else if(Number.isFinite(Number(t))){var i=Number(t);i>=0&&i<r.length?Object.assign(r[i],e):j.a.warn("animation ".concat(t," not found"))()}else{var a=r.find((function(e){return e.name===t}));a?Object.assign(a,e):j.a.warn("animation ".concat(t," not found"))()}}))}}},{key:"_deleteScenegraph",value:function(){var t=this.state.scenegraph;t instanceof E.a&&t.delete()}},{key:"getLoadOptions",value:function(){var t=[w.a,S.a],e=this.props,n=e._lighting,r=e._imageBasedLightingEnvironment;"pbr"===n&&t.push(k.a);var i=null;return r&&(i="function"==typeof r?r({gl:this.context.gl,layer:this}):r),{gl:this.context.gl,waitForFullLoad:!0,imageBasedLightingEnvironment:i,modelOptions:{vs:"#version 300 es\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform mat4 sceneModelMatrix;\nuniform bool composeModelMatrix;\nin vec4 POSITION;\n\n#ifdef HAS_UV\n  in vec2 TEXCOORD_0;\n#endif\n\n#ifdef MODULE_PBR\n  #ifdef HAS_NORMALS\n    in vec4 NORMAL;\n  #endif\n#endif\nout vec4 vColor;\n#ifndef MODULE_PBR\n  #ifdef HAS_UV\n    out vec2 vTEXCOORD_0;\n  #endif\n#endif\nvoid main(void) {\n  #if defined(HAS_UV) && !defined(MODULE_PBR)\n    vTEXCOORD_0 = TEXCOORD_0;\n    geometry.uv = vTEXCOORD_0;\n  #endif\n\n  geometry.worldPosition = instancePositions;\n  geometry.pickingColor = instancePickingColors;\n\n  #ifdef MODULE_PBR\n    #ifdef HAS_NORMALS\n      pbr_vNormal = project_normal(instanceModelMatrix * (sceneModelMatrix * vec4(NORMAL.xyz, 0.0)).xyz);\n      geometry.normal = pbr_vNormal;\n    #endif\n\n    #ifdef HAS_UV\n      pbr_vUV = TEXCOORD_0;\n    #else\n      pbr_vUV = vec2(0., 0.);\n    #endif\n    geometry.uv = pbr_vUV;\n  #endif\n\n  float originalSize = project_size_to_pixel(sizeScale);\n  float clampedSize = clamp(originalSize, sizeMinPixels, sizeMaxPixels);\n\n  vec3 pos = (instanceModelMatrix * (sceneModelMatrix * POSITION).xyz) * sizeScale * (clampedSize / originalSize) + instanceTranslation;\n  if(composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, geometry.position);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  #ifdef MODULE_PBR\n    pbr_vPosition = geometry.position.xyz;\n  #endif\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\nuniform float opacity;\nin vec4 vColor;\n\nout vec4 fragmentColor;\n#ifndef MODULE_PBR\n  #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n    in vec2 vTEXCOORD_0;\n    uniform sampler2D u_BaseColorSampler;\n  #endif\n#endif\n\nvoid main(void) {\n  #ifdef MODULE_PBR\n    fragmentColor = vColor * pbr_filterColor(vec4(0));\n    geometry.uv = pbr_vUV;\n  #else\n    #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n      fragmentColor = vColor * texture2D(u_BaseColorSampler, vTEXCOORD_0);\n      geometry.uv = vTEXCOORD_0;\n    #else\n      fragmentColor = vColor;\n    #endif\n  #endif\n\n  fragmentColor.a *= opacity;\n  DECKGL_FILTER_COLOR(fragmentColor, geometry);\n}\n",modules:t,isInstanced:!0,transpileToGLSL100:!Object(T.f)(this.context.gl)},useTangents:!1}}},{key:"updateAttributes",value:function(t){var e=this;this.setState({attributesAvailable:!0}),this.state.scenegraph&&this.state.scenegraph.traverse((function(n){e._setModelAttributes(n.model,t)}))}},{key:"draw",value:function(t){var e=t.moduleParameters,n=void 0===e?null:e,r=t.parameters,i=void 0===r?{}:r,a=t.context;if(this.state.scenegraph){this.props._animations&&this.state.animator&&this.state.animator.animate(a.animationProps.time);var o=this.context.viewport,s=this.props,c=s.sizeScale,u=s.sizeMinPixels,l=s.sizeMaxPixels,h=s.opacity,f=s.coordinateSystem,p=this.getNumInstances();this.state.scenegraph.traverse((function(t,e){var r=e.worldMatrix;t.model.setInstanceCount(p),t.updateModuleSettings(n),t.draw({parameters:i,uniforms:{sizeScale:c,opacity:h,sizeMinPixels:u,sizeMaxPixels:l,composeModelMatrix:U(o,f),sceneModelMatrix:r,u_Camera:t.model.getUniforms().project_uCameraPosition}})}))}}}]),e}(y.a);F.layerName="ScenegraphLayer",F.defaultProps=B;var q=n("91Zk"),G=n("f5Sf"),H=n("ykdB"),Z=n("d3kR"),W=n("tMmZ");function Y(t){j.a.assert(t.positions||t.POSITION,'SimpleMeshLayer requires "postions" or "POSITION" attribute in mesh property.')}function K(t){if(t.attributes)return Y(t.attributes),t instanceof p.a?t:new p.a(t);if(t.positions||t.POSITION)return Y(t),new p.a({attributes:t});throw Error("Invalid mesh")}var Q={mesh:{value:null,type:"object",async:!0},texture:{type:"object",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},parameters:{depthTest:!0,depthFunc:515},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:function(t){return t.position}},getColor:{type:"accessor",value:[0,0,0,255]},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]}},J=function(t){function e(){return Object(s.a)(this,e),Object(u.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(h.a)(e,t),Object(c.a)(e,[{key:"getShaders",value:function(){var t=!Object(T.f)(this.context.gl),n={};return Object(Z.b)(this.context.gl,W.a.GLSL_DERIVATIVES)&&(n.DERIVATIVES_AVAILABLE=1),Object(v.a)(Object(l.a)(e.prototype),"getShaders",this).call(this,{vs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-vs\nuniform float sizeScale;\nuniform bool composeModelMatrix;\nin vec3 positions;\nin vec3 normals;\nin vec2 texCoords;\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\nout vec2 vTexCoord;\nout vec3 cameraPosition;\nout vec3 normals_commonspace;\nout vec4 position_commonspace;\nout vec4 vColor;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = texCoords;\n  geometry.pickingColor = instancePickingColors;\n\n  vTexCoord = texCoords;\n  cameraPosition = project_uCameraPosition;\n  normals_commonspace = project_normal(instanceModelMatrix * normals);\n  vColor = instanceColors;\n  geometry.normal = normals_commonspace;\n\n  vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;\n\n  if (composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);\n  }\n\n  geometry.position = position_commonspace;\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-fs\n\nprecision highp float;\n\nuniform bool hasTexture;\nuniform sampler2D sampler;\nuniform bool flatShading;\nuniform float opacity;\n\nin vec2 vTexCoord;\nin vec3 cameraPosition;\nin vec3 normals_commonspace;\nin vec4 position_commonspace;\nin vec4 vColor;\n\nout vec4 fragColor;\n\nvoid main(void) {\n  geometry.uv = vTexCoord;\n\n  vec3 normal;\n  if (flatShading) {\n#ifdef DERIVATIVES_AVAILABLE\n    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));\n#else\n    normal = vec3(0.0, 0.0, 1.0);\n#endif\n  } else {\n    normal = normals_commonspace;\n  }\n\n  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;\n  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);\n  fragColor = vec4(lightColor, color.a * opacity);\n\n  DECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",modules:[w.a,q.b,S.a],transpileToGLSL100:t,defines:n})}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:5130,fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:5121,transition:!0,size:this.props.colorFormat.length,normalized:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:z}),this.setState({emptyTexture:new G.a(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}},{key:"updateState",value:function(t){var n=t.props,r=t.oldProps,i=t.changeFlags;if(Object(v.a)(Object(l.a)(e.prototype),"updateState",this).call(this,{props:n,oldProps:r,changeFlags:i}),n.mesh!==r.mesh||i.extensionsChanged){if(this.state.model&&this.state.model.delete(),n.mesh){this.setState({model:this.getModel(n.mesh)});var a=n.mesh.attributes||n.mesh;this.setState({hasNormals:Boolean(a.NORMAL||a.normals)})}this.getAttributeManager().invalidateAll()}n.texture!==r.texture&&this.setTexture(n.texture),this.state.model&&this.state.model.setDrawMode(this.props.wireframe?3:4)}},{key:"finalizeState",value:function(){Object(v.a)(Object(l.a)(e.prototype),"finalizeState",this).call(this),this.state.emptyTexture.delete(),this.state.texture&&this.state.texture.delete()}},{key:"draw",value:function(t){var e=t.uniforms;if(this.state.model){var n=this.context.viewport,r=this.props,i=r.sizeScale,a=r.coordinateSystem,o=r._instanced;this.state.model.draw({uniforms:Object.assign({},e,{sizeScale:i,composeModelMatrix:!o||U(n,a),flatShading:!this.state.hasNormals})})}}},{key:"getModel",value:function(t){var e=new H.a(this.context.gl,Object.assign({},this.getShaders(),{id:this.props.id,geometry:K(t),isInstanced:!0})),n=this.state,r=n.texture,i=n.emptyTexture;return e.setUniforms({sampler:r||i,hasTexture:Boolean(r)}),e}},{key:"setTexture",value:function(t){var e=this.context.gl,n=this.state,r=n.emptyTexture,i=n.model;this.state.texture&&this.state.texture.delete();var a=t?function(t,e,n){return e instanceof G.a?e:new G.a(t,Object.assign({data:e},n))}(e,t):null;this.setState({texture:a}),i&&i.setUniforms({sampler:a||r,hasTexture:Boolean(a)})}}]),e}(y.a);J.layerName="SimpleMeshLayer",J.defaultProps=Q;var X=n("24Wh"),$=(n("wcNg"),n("kh/P")),tt=n("SDD5"),et=n("Ns70"),nt=n("G+eI"),rt=n("P+ME"),it=n("9h7C"),at=n("Vmat"),ot=function(t,e,n){this.item=t,this.previous=e,this.next=n},st=function(){function t(){this.head=null,this.tail=null,this._length=0}var e=t.prototype;return e.add=function(t){var e=new ot(t,this.tail,null);return this.tail?(this.tail.next=e,this.tail=e):(this.head=e,this.tail=e),++this._length,e},e.remove=function(t){t&&(t.previous&&t.next?(t.previous.next=t.next,t.next.previous=t.previous):t.previous?(t.previous.next=null,this.tail=t.previous):t.next?(t.next.previous=null,this.head=t.next):(this.head=null,this.tail=null),t.next=null,t.previous=null,--this._length)},e.splice=function(t,e){t!==e&&(this.remove(e),this._insert(t,e))},e._insert=function(t,e){var n=t.next;t.next=e,this.tail===t?this.tail=e:n.previous=e,e.next=n,e.previous=t,++this._length},Object(c.a)(t,[{key:"length",get:function(){return this._length}}]),t}();function ct(t){return null!=t}var ut=function(){function t(){this._list=new st,this._sentinel=this._list.add("sentinel"),this._trimTiles=!1}var e=t.prototype;return e.reset=function(){this._list.splice(this._list.tail,this._sentinel)},e.touch=function(t){var e=t._cacheNode;ct(e)&&this._list.splice(this._sentinel,e)},e.add=function(t,e,n){ct(e._cacheNode)||(e._cacheNode=this._list.add(e),n&&n(t,e))},e.unloadTile=function(t,e,n){var r=e._cacheNode;ct(r)&&(this._list.remove(r),e._cacheNode=void 0,n&&n(t,e))},e.unloadTiles=function(t,e){var n=this._trimTiles;this._trimTiles=!1;for(var r=this._list,i=1024*t.maximumMemoryUsage*1024,a=this._sentinel,o=r.head;o!==a&&(t.gpuMemoryUsageInBytes>i||n);){var s=o.item;o=o.next,this.unloadTile(t,s,e)}},e.trim=function(){this._trimTiles=!0},t}();var lt=Object.freeze({OUTSIDE:-1,INTERSECTING:0,INSIDE:1}),ht=n("zXfU"),ft=new ht.a,pt=new ht.a,dt=(function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Object(s.a)(this,t),r=r||ft.copy(e).add(n).scale(.5),this.center=new ht.a(r),this.halfDiagonal=new ht.a(n).subtract(this.center),this.minimum=new ht.a(e),this.maximum=new ht.a(n)}Object(c.a)(t,[{key:"clone",value:function(){return new t(this.minimum,this.maximum,this.center)}},{key:"equals",value:function(t){return this===t||Boolean(t)&&this.minimum.equals(t.minimum)&&this.maximum.equals(t.maximum)}},{key:"intersectPlane",value:function(t){var e=this.halfDiagonal,n=pt.from(t.normal),r=e.x*Math.abs(n.x)+e.y*Math.abs(n.y)+e.z*Math.abs(n.z),i=this.center.dot(n)+t.distance;return i-r>0?lt.INSIDE:i+r<0?lt.OUTSIDE:lt.INTERSECTING}},{key:"distanceTo",value:function(t){return Math.sqrt(this.distanceSquaredTo(t))}},{key:"distanceSquaredTo",value:function(t){var e,n=ft.from(t).subtract(this.center),r=this.halfDiagonal,i=0;return(e=Math.abs(n.x)-r.x)>0&&(i+=e*e),(e=Math.abs(n.y)-r.y)>0&&(i+=e*e),(e=Math.abs(n.z)-r.z)>0&&(i+=e*e),i}}])}(),n("ZaHm")),vt=new ht.a,yt=new ht.a,mt=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(s.a)(this,t),this.radius=-0,this.center=new ht.a,this.fromCenterRadius(e,n)}return Object(c.a)(t,[{key:"fromCenterRadius",value:function(t,e){return this.center.from(t),this.radius=e,this}},{key:"fromCornerPoints",value:function(t,e){return e=vt.from(e),this.center=(new ht.a).from(t).add(e).scale(.5),this.radius=this.center.distance(e),this}},{key:"equals",value:function(t){return this===t||Boolean(t)&&this.center.equals(t.center)&&this.radius===t.radius}},{key:"clone",value:function(){return new t(this.center,this.radius)}},{key:"union",value:function(t){var e=this.center,n=this.radius,r=t.center,i=t.radius,a=vt.copy(r).subtract(e),o=a.magnitude();if(n>=o+i)return this.clone();if(i>=o+n)return t.clone();var s=.5*(n+o+i);return yt.copy(a).scale((-n+s)/o).add(e),this.center.copy(yt),this.radius=s,this}},{key:"expand",value:function(t){var e=(t=vt.from(t)).subtract(this.center).magnitude();return e>this.radius&&(this.radius=e),this}},{key:"intersectPlane",value:function(t){var e=this.center,n=this.radius,r=t.normal.dot(e)+t.distance;return r<-n?lt.OUTSIDE:r<n?lt.INTERSECTING:lt.INSIDE}},{key:"transform",value:function(t){this.center.transform(t);var e=dt.e(vt,t);return this.radius=Math.max(e[0],Math.max(e[1],e[2]))*this.radius,this}},{key:"distanceSquaredTo",value:function(t){return(t=vt.from(t)).subtract(this.center).lengthSquared()-this.radius*this.radius}},{key:"distanceTo",value:function(t){return Math.sqrt(this.distanceSquaredTo(t))}}]),t}(),gt=n("GA6j"),bt=new ht.a,Ot=new ht.a,_t=new ht.a,jt=new ht.a,wt=new ht.a,St=new ht.a,Tt=new ht.a,kt=new ht.a,Et=new ht.a,Pt=new ht.a,Mt=0,xt=1,Ct=2,Rt=3,Lt=4,Nt=5,It=6,At=7,Dt=8,zt=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0,0,0,0,0,0,0];Object(s.a)(this,t),this.center=(new ht.a).from(e),this.halfAxes=new gt.a(n)}return Object(c.a)(t,[{key:"clone",value:function(){return new t(this.center,this.halfAxes)}},{key:"equals",value:function(t){return this===t||Boolean(t)&&this.center.equals(t.center)&&this.halfAxes.equals(t.halfAxes)}},{key:"getBoundingSphere",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new mt,e=this.halfAxes,n=e.getColumn(0,kt),r=e.getColumn(1,Et),i=e.getColumn(2,Pt),a=bt.copy(n).add(r).add(i);return t.center.copy(this.center),t.radius=a.magnitude(),t}},{key:"intersectPlane",value:function(t){var e=this.center,n=t.normal,r=this.halfAxes,i=n.x,a=n.y,o=n.z,s=Math.abs(i*r[Mt]+a*r[xt]+o*r[Ct])+Math.abs(i*r[Rt]+a*r[Lt]+o*r[Nt])+Math.abs(i*r[It]+a*r[At]+o*r[Dt]),c=n.dot(e)+t.distance;return c<=-s?lt.OUTSIDE:c>=s?lt.INSIDE:lt.INTERSECTING}},{key:"distanceTo",value:function(t){return Math.sqrt(this.distanceSquaredTo(t))}},{key:"distanceSquaredTo",value:function(t){var e=Ot.from(t).subtract(this.center),n=this.halfAxes,r=n.getColumn(0,_t),i=n.getColumn(1,jt),a=n.getColumn(2,wt),o=r.magnitude(),s=i.magnitude(),c=a.magnitude();r.normalize(),i.normalize(),a.normalize();var u,l=0;return(u=Math.abs(e.dot(r))-o)>0&&(l+=u*u),(u=Math.abs(e.dot(i))-s)>0&&(l+=u*u),(u=Math.abs(e.dot(a))-c)>0&&(l+=u*u),l}},{key:"computePlaneDistances",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[-0,-0],r=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,a=this.center,o=this.halfAxes,s=o.getColumn(0,_t),c=o.getColumn(1,jt),u=o.getColumn(2,wt),l=St.copy(s).add(c).add(u).add(a),h=Tt.copy(l).subtract(t),f=e.dot(h);return r=Math.min(f,r),i=Math.max(f,i),l.copy(a).add(s).add(c).subtract(u),h.copy(l).subtract(t),f=e.dot(h),r=Math.min(f,r),i=Math.max(f,i),l.copy(a).add(s).subtract(c).add(u),h.copy(l).subtract(t),f=e.dot(h),r=Math.min(f,r),i=Math.max(f,i),l.copy(a).add(s).subtract(c).subtract(u),h.copy(l).subtract(t),f=e.dot(h),r=Math.min(f,r),i=Math.max(f,i),a.copy(l).subtract(s).add(c).add(u),h.copy(l).subtract(t),f=e.dot(h),r=Math.min(f,r),i=Math.max(f,i),a.copy(l).subtract(s).add(c).subtract(u),h.copy(l).subtract(t),f=e.dot(h),r=Math.min(f,r),i=Math.max(f,i),a.copy(l).subtract(s).subtract(c).add(u),h.copy(l).subtract(t),f=e.dot(h),r=Math.min(f,r),i=Math.max(f,i),a.copy(l).subtract(s).subtract(c).subtract(u),h.copy(l).subtract(t),f=e.dot(h),r=Math.min(f,r),i=Math.max(f,i),n[0]=r,n[1]=i,n}},{key:"getTransform",value:function(){}}]),t}(),Ut=n("tS8E"),Vt=n("a3TU"),Bt=new ht.a,Ft=new ht.a,qt=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,1],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(s.a)(this,t),this.normal=new ht.a,this.distance=-0,this.fromNormalDistance(e,n)}return Object(c.a)(t,[{key:"fromNormalDistance",value:function(t,e){return Object(Ut.a)(Number.isFinite(e)),this.normal.from(t).normalize(),this.distance=e,this}},{key:"fromPointNormal",value:function(t,e){t=Bt.from(t),this.normal.from(e).normalize();var n=-this.normal.dot(t);return this.distance=n,this}},{key:"fromCoefficients",value:function(t,e,n,r){return this.normal.set(t,e,n),Object(Ut.a)(Object(Vt.c)(this.normal.len(),1)),this.distance=r,this}},{key:"clone",value:function(e){return new t(this.normal,this.distance)}},{key:"equals",value:function(t){return Object(Vt.c)(this.distance,t.distance)&&Object(Vt.c)(this.normal,t.normal)}},{key:"getPointDistance",value:function(t){return this.normal.dot(t)+this.distance}},{key:"transform",value:function(t){var e=Ft.copy(this.normal).transformAsVector(t).normalize(),n=this.normal.scale(-this.distance).transform(t);return this.fromPointNormal(n,e)}},{key:"projectPointOntoPlane",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];t=Bt.from(t);var n=this.getPointDistance(t),r=Ft.copy(this.normal).scale(n);return t.subtract(r).to(e)}}]),t}(),Gt=[new ht.a([1,0,0]),new ht.a([0,1,0]),new ht.a([0,0,1])],Ht=new ht.a,Zt=new ht.a,Wt=(new qt(new ht.a(1,0,0),0),function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Object(s.a)(this,t),this.planes=e,Object(Ut.a)(this.planes.every((function(t){return t instanceof qt})))}return Object(c.a)(t,null,[{key:"MASK_OUTSIDE",get:function(){return 4294967295}},{key:"MASK_INSIDE",get:function(){return 0}},{key:"MASK_INDETERMINATE",get:function(){return 2147483647}}]),Object(c.a)(t,[{key:"fromBoundingSphere",value:function(t){this.planes.length=2*Gt.length;var e=t.center,n=t.radius,r=0,i=!0,a=!1,o=void 0;try{for(var s,c=Gt[Symbol.iterator]();!(i=(s=c.next()).done);i=!0){var u=s.value,l=this.planes[r],h=this.planes[r+1];l||(l=this.planes[r]=new qt),h||(h=this.planes[r+1]=new qt);var f=Ht.copy(u).scale(-n).add(e);u.dot(f);l.fromPointNormal(f,u);var p=Ht.copy(u).scale(n).add(e),d=Zt.copy(u).negate();d.dot(p);h.fromPointNormal(p,d),r+=2}}catch(v){a=!0,o=v}finally{try{i||null==c.return||c.return()}finally{if(a)throw o}}return this}},{key:"computeVisibility",value:function(t){Object(Ut.a)(t);var e=lt.INSIDE,n=!0,r=!1,i=void 0;try{for(var a,o=this.planes[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;switch(t.intersectPlane(s)){case lt.OUTSIDE:return lt.OUTSIDE;case lt.INTERSECTING:e=lt.INTERSECTING}}}catch(c){r=!0,i=c}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return e}},{key:"computeVisibilityWithPlaneMask",value:function(e,n){if(Object(Ut.a)(e,"boundingVolume is required."),Object(Ut.a)(Number.isFinite(n),"parentPlaneMask is required."),n===t.MASK_OUTSIDE||n===t.MASK_INSIDE)return n;for(var r=t.MASK_INSIDE,i=this.planes,a=0;a<this.planes.length;++a){var o=a<31?1<<a:0;if(!(a<31&&0==(n&o))){var s=i[a],c=e.intersectPlane(s);if(c===lt.OUTSIDE)return t.MASK_OUTSIDE;c===lt.INTERSECTING&&(r|=o)}}return r}}]),t}()),Yt=n("Nw31");function Kt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Qt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Kt(n,!0).forEach((function(e){Object(a.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Kt(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Jt=new ht.a,Xt=new ht.a,$t=new ht.a,te=new ht.a,ee=new ht.a,ne=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(s.a)(this,t),e=Qt({near:1,far:5e8},e),this.left=e.left,this._left=void 0,this.right=e.right,this._right=void 0,this.top=e.top,this._top=void 0,this.bottom=e.bottom,this._bottom=void 0,this.near=e.near,this._near=this.near,this.far=e.far,this._far=this.far,this._cullingVolume=new Wt([new qt,new qt,new qt,new qt,new qt,new qt]),this._perspectiveMatrix=new Yt.a,this._infinitePerspective=new Yt.a}return Object(c.a)(t,[{key:"clone",value:function(){return new t({right:this.right,left:this.left,top:this.top,bottom:this.bottom,near:this.near,far:this.far})}},{key:"equals",value:function(e){return e&&e instanceof t&&this.right===e.right&&this.left===e.left&&this.top===e.top&&this.bottom===e.bottom&&this.near===e.near&&this.far===e.far}},{key:"computeCullingVolume",value:function(t,e,n){Object(Ut.a)(t,"position is required."),Object(Ut.a)(e,"direction is required."),Object(Ut.a)(n,"up is required.");var r=this._cullingVolume.planes;n=Jt.copy(n).normalize();var i=Xt.copy(e).cross(n).normalize(),a=$t.copy(e).multiplyByScalar(this.near).add(t),o=te.copy(e).multiplyByScalar(this.far).add(t),s=ee;return s.copy(i).multiplyByScalar(this.left).add(a).subtract(t).cross(n),r[0].fromPointNormal(t,s),s.copy(i).multiplyByScalar(this.right).add(a).subtract(t).cross(n).negate(),r[1].fromPointNormal(t,s),s.copy(n).multiplyByScalar(this.bottom).add(a).subtract(t).cross(i).negate(),r[2].fromPointNormal(t,s),s.copy(n).multiplyByScalar(this.top).add(a).subtract(t).cross(i),r[3].fromPointNormal(t,s),s=(new ht.a).copy(e),r[4].fromPointNormal(a,s),s.negate(),r[5].fromPointNormal(o,s),this._cullingVolume}},{key:"getPixelDimensions",value:function(t,e,n,r){re(this),Object(Ut.a)(Number.isFinite(t)&&Number.isFinite(e)),Object(Ut.a)(t>0),Object(Ut.a)(e>0),Object(Ut.a)(n>0),Object(Ut.a)(r);var i=1/this.near,a=this.top*i,o=2*n*a/e,s=2*n*(a=this.right*i)/t;return r.x=s,r.y=o,r}},{key:"projectionMatrix",get:function(){return re(this),this._perspectiveMatrix}},{key:"infiniteProjectionMatrix",get:function(){return re(this),this._infinitePerspective}}]),t}();function re(t){Object(Ut.a)(Number.isFinite(t.right)&&Number.isFinite(t.left)&&Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.near)&&Number.isFinite(t.far));var e=t.top,n=t.bottom,r=t.right,i=t.left,a=t.near,o=t.far;e===t._top&&n===t._bottom&&i===t._left&&r===t._right&&a===t._near&&o===t._far||(Object(Ut.a)(t.near>0&&t.near<t.far,"near must be greater than zero and less than far."),t._left=i,t._right=r,t._top=e,t._bottom=n,t._near=a,t._far=o,t._perspectiveMatrix=(new Yt.a).frustum({left:i,right:r,bottom:n,top:e,near:a,far:o}),t._infinitePerspective=(new Yt.a).frustum({left:i,right:r,bottom:n,top:e,near:a,far:1/0}))}function ie(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ae(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ie(n,!0).forEach((function(e){Object(a.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ie(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}!function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(s.a)(this,t),e=ae({near:1,far:5e8,xOffset:0,yOffset:0},e),this._offCenterFrustum=new ne,this.fov=e.fov,this._fov=void 0,this._fovy=void 0,this._sseDenominator=void 0,this.aspectRatio=e.aspectRatio,this._aspectRatio=void 0,this.near=e.near,this._near=this.near,this.far=e.far,this._far=this.far,this.xOffset=e.xOffset,this._xOffset=this.xOffset,this.yOffset=e.yOffset,this._yOffset=this.yOffset}Object(c.a)(t,[{key:"clone",value:function(){return new t({aspectRatio:this.aspectRatio,fov:this.fov,near:this.near,far:this.far})}},{key:"equals",value:function(e){return null!=e&&e instanceof t&&(oe(this),oe(e),this.fov===e.fov&&this.aspectRatio===e.aspectRatio&&this.near===e.near&&this.far===e.far&&this._offCenterFrustum.equals(e._offCenterFrustum))}},{key:"computeCullingVolume",value:function(t,e,n){return oe(this),this._offCenterFrustum.computeCullingVolume(t,e,n)}},{key:"getPixelDimensions",value:function(t,e,n,r){return oe(this),this._offCenterFrustum.getPixelDimensions(t,e,n,r)}},{key:"projectionMatrix",get:function(){return oe(this),this._offCenterFrustum.projectionMatrix}},{key:"infiniteProjectionMatrix",get:function(){return oe(this),this._offCenterFrustum.infiniteProjectionMatrix}},{key:"fovy",get:function(){return oe(this),this._fovy}},{key:"sseDenominator",get:function(){return oe(this),this._sseDenominator}}])}();function oe(t){Object(Ut.a)(Number.isFinite(t.fov)&&Number.isFinite(t.aspectRatio)&&Number.isFinite(t.near)&&Number.isFinite(t.far));var e=t._offCenterFrustum;t.fov===t._fov&&t.aspectRatio===t._aspectRatio&&t.near===t._near&&t.far===t._far&&t.xOffset===t._xOffset&&t.yOffset===t._yOffset||(Object(Ut.a)(t.fov>=0&&t.fov<Math.PI),Object(Ut.a)(t.aspectRatio>0),Object(Ut.a)(t.near>=0&&t.near<t.far),t._aspectRatio=t.aspectRatio,t._fov=t.fov,t._fovy=t.aspectRatio<=1?t.fov:2*Math.atan(Math.tan(.5*t.fov)/t.aspectRatio),t._near=t.near,t._far=t.far,t._sseDenominator=2*Math.tan(.5*t._fovy),t._xOffset=t.xOffset,t._yOffset=t.yOffset,e.top=t.near*Math.tan(.5*t._fovy),e.bottom=-e.top,e.right=t.aspectRatio*e.top,e.left=-e.right,e.near=t.near,e.far=t.far,e.right+=t.xOffset,e.left+=t.xOffset,e.top+=t.yOffset,e.bottom+=t.yOffset)}new ht.a,new ht.a,new ht.a,new ht.a,new ht.a,new ht.a,new ht.a,new ht.a,new ht.a,new ht.a,new ht.a,new ht.a,Math.PI;n("gOKY"),new gt.a,new gt.a,new gt.a,new gt.a,new gt.a;new ht.a,new ht.a,new ht.a,new ht.a,new ht.a,new gt.a,new gt.a,new gt.a;var se=new tt.a,ce=new tt.a,ue=new Wt([new qt,new qt,new qt,new qt,new qt,new qt]);function le(t,e){var n=t.cameraDirection,r=t.cameraUp,i=t.height,a=t.distanceScales.metersPerUnit,o=[t.longitude,t.latitude,0],s=et.a.WGS84.cartographicToCartesian(o,new tt.a),c=et.a.WGS84.eastNorthUpToFixedFrame(s),u=t.unprojectPosition(t.cameraPosition),l=et.a.WGS84.cartographicToCartesian(u,new tt.a),h=new tt.a(c.transformAsVector(new tt.a(n).scale(a))).normalize(),f=new tt.a(c.transformAsVector(new tt.a(r).scale(a))).normalize();return function(t,e){var n=t.getFrustumPlanes(),r=0;for(var i in n){var a=n[i],o=a.normal.dot(t.center);ce.copy(a.normal).scale(a.distance-o).add(t.center);var s=t.unprojectPosition(ce),c=et.a.WGS84.cartographicToCartesian(s,new tt.a);ue.planes[r++].fromPointNormal(c,se.copy(e).subtract(c))}}(t,s),{camera:{position:l,direction:h,up:f},viewport:t,height:i,cullingVolume:ue,frameNumber:e,sseDenominator:1.15}}var he=new tt.a;var fe=n("O6hP"),pe=n("yeNo"),de=n("T27a");function ve(t){return null!=t}var ye=new tt.a,me=new tt.a,ge=new tt.a;new $.a;function be(t,e,n){if(Object(rt.a)(t,"3D Tile: boundingVolume must be defined"),t.box)return function(t,e,n){var r=new tt.a(t[0],t[1],t[2]);e.transform(r,r);var i=e.transformAsVector(t.slice(3,6)),a=e.transformAsVector(t.slice(6,9)),o=e.transformAsVector(t.slice(9,12)),s=new de.a([i[0],i[1],i[2],a[0],a[1],a[2],o[0],o[1],o[2]]);if(ve(n))return n.center=r,n.halfAxes=s,n;return new zt(r,s)}(t.box,e,n);if(t.region){var r=t.region,i=r[0],a=r[1],o=r[2],s=r[3],c=r[4],u=r[5],l=et.a.WGS84.cartographicToCartesian([Object(pe.c)(i),Object(pe.c)(s),c],me),h=et.a.WGS84.cartographicToCartesian([Object(pe.c)(o),Object(pe.c)(a),u],ge),f=(new tt.a).addVectors(l,h).multiplyScalar(.5),p=(new tt.a).subVectors(l,h).len()/2;return Oe([f[0],f[1],f[2],p],new $.a)}if(t.sphere)return Oe(t.sphere,e,n);throw new Error("3D Tile: boundingVolume must contain a sphere, region, or box")}function Oe(t,e,n){var r=new tt.a(t[0],t[1],t[2]);e.transform(r,r);var i=e.getScale(ye),a=Math.max(Math.max(i[0],i[1]),i[2]),o=t[3]*a;return ve(n)?(n.center=r,n.radius=o,n):new mt(r,o)}new tt.a,new tt.a,new $.a,new tt.a,new tt.a,new tt.a;function _e(t,e){if(t.dynamicScreenSpaceError&&t._dynamicScreenSpaceErrorComputedDensity){var n=t._dynamicScreenSpaceErrorComputedDensity,r=t.dynamicScreenSpaceErrorFactor;return function(t,e){var n=t*e;return 1-Math.exp(-n*n)}(e,n)*r}return 0}var je=Math.PI/2;function we(t){var e=t[0],n=t[1],r=t[2],i=Object(pe.g)(e),a=Object(pe.g)(n),o=1+r/6378137,s=o*Math.cos(a);return[e=s*Math.cos(i),n=s*Math.sin(i),r=o*Math.sin(a)]}function Se(t,e){var n=t[0],r=t[1],i=t[2],a=void 0===i?0:i,o=e[0],s=e[1],c=e[2],u=we([o,s,void 0===c?0:c]),l=we([n,r,a]),h=l[0]-u[0],f=l[1]-u[1],p=l[2]-u[2];return h*h+f*f+p*p}function Te(t,e){var n=e.viewport,r=t.header.mbs[1],i=[t.header.mbs[0],r,t.header.mbs[2]],a=t.header.mbs[3]/6378137,o=Se(n.unprojectPosition(n.cameraPosition),i)-a*a;if(o<=0)return 170141175e30;var s=function(t,e){var n=e.viewport,r=n.width,i=n.height,a=n.pixelProjectionMatrix,o=Math.tan(Math.atan(Math.sqrt(1/(a[0]*a[0])+1/(a[5]*a[5]))));return Math.sqrt(i*i+r*r)/o}(0,e);return s*=a/Math.sqrt(o)/n.scale}function ke(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ee(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ke(Object(n),!0).forEach((function(e){Object(a.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ke(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Pe=new tt.a;var Me=function(){function t(t,e,n){Object(rt.a)("object"==typeof e),this.header=e,this.tileset=t,this.id=e.id,this.url=e.url,this.parent=n,this.refine=this._getRefine(e.refine),this.type=e.type,this.contentUrl=e.contentUrl,this.lodMetricType=null,this.lodMetricValue=null,this.boundingVolume=null,this.content=null,this.contentState=fe.d.UNLOADED,this.gpuMemoryUsageInBytes=0,this.children=[],this.depth=0,this._cacheNode=null,this._frameNumber=null,this._cacheNode=null,this._initializeLodMetric(e),this._initializeTransforms(e),this._initializeBoundingVolumes(e),this._initializeContent(e),this._initializeRenderingState(e),this._lodJudge=null,this._expireDate=null,this._expiredContent=null,this._getPriority=this._getPriority.bind(this),Object.seal(this)}var e=t.prototype;return e.destroy=function(){this.header=null},e.isDestroyed=function(){return null===this.header},e.getScreenSpaceError=function(t,e){switch(this.tileset.type){case fe.c.I3S:return Te(this,t);case fe.c.TILES3D:return function(t,e,n){var r=t.tileset,i=t.parent&&t.parent.lodMetricValue||t.lodMetricValue,a=n?i:t.lodMetricValue;if(0===a)return 0;var o=Math.max(t._distanceToCamera,1e-7),s=a*e.height/(o*e.sseDenominator);return s-=_e(r,o)}(this,t,e);default:return console.error("Unsupported tileset type"),null}},e._getPriority=function(){return this.isVisible?this.contentState===fe.d.UNLOADED?-1:Math.max(1e7-this._priority,0)||0:-1},e.loadContent=function(){var t=Object(o.a)(i.a.mark((function t(){var e,n,r,a,o,s;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.hasEmptyContent){t.next=2;break}return t.abrupt("return",!1);case 2:if(!this.content){t.next=4;break}return t.abrupt("return",!0);case 4:return this.contentExpired&&(this._expireDate=null),this.contentState=fe.d.LOADING,t.next=9,this.tileset._requestScheduler.scheduleRequest(this.id,this._getPriority);case 9:if(e=t.sent){t.next=13;break}return this.contentState=fe.d.UNLOADED,t.abrupt("return",!1);case 13:return t.prev=13,r=this.tileset.getTileUrl(this.contentUrl),a=this.tileset.fetchOptions,o=this.tileset.loader,s=Ee(Ee({},a),{},((n={})[o.id]={tile:this.header,tileset:this.tileset.tileset,isTileset:!1,isTileHeader:!1},n)),t.next=20,Object(X.a)(r,o,s);case 20:return this.content=t.sent,this._isTileset()&&this.tileset._initializeTileHeaders(this.content,this,it.a.dirname(this.contentUrl)),this.contentState=fe.d.READY,this._onContentLoaded(),t.abrupt("return",!0);case 27:throw t.prev=27,t.t0=t.catch(13),this.contentState=fe.d.FAILED,t.t0;case 31:return t.prev=31,e.done(),t.finish(31);case 34:case"end":return t.stop()}}),t,this,[[13,27,31,34]])})));return function(){return t.apply(this,arguments)}}(),e.unloadContent=function(){return this.content&&this.content.destroy&&this.content.destroy(),this.content=null,this.contentState=fe.d.UNLOADED,!0},e.updateVisibility=function(t){if(this._frameNumber!==t.frameNumber){var e=this.parent,n=e?e.computedTransform:this.tileset.modelMatrix,r=e?e._visibilityPlaneMask:Wt.MASK_INDETERMINATE;this._updateTransform(n),this._distanceToCamera=this.distanceToTile(t),this._screenSpaceError=this.getScreenSpaceError(t,!1),this._visibilityPlaneMask=this.visibility(t,r),this._visible=this._visibilityPlaneMask!==Wt.MASK_OUTSIDE,this._inRequestVolume=this.insideViewerRequestVolume(t),this._priority=this.lodMetricValue,this._frameNumber=t.frameNumber}},e.visibility=function(t,e){var n=t.cullingVolume,r=this.boundingVolume;return n.computeVisibilityWithPlaneMask(r,e)},e.contentVisibility=function(t){return!0},e.distanceToTile=function(t){var e=this.boundingVolume;return Math.sqrt(Math.max(e.distanceSquaredTo(t.camera.position),0))},e.cameraSpaceZDepth=function(t){var e=t.camera,n=this.boundingVolume;return Pe.subVectors(n.center,e.position),e.direction.dot(Pe)},e.insideViewerRequestVolume=function(t){var e=this._viewerRequestVolume;return!e||0===e.distanceToCamera(t)},e._initializeLodMetric=function(t){"lodMetricType"in t?this.lodMetricType=t.lodMetricType:(this.lodMetricType=this.parent&&this.parent.lodMetricType||this.tileset.lodMetricType,console.warn("3D Tile: Required prop lodMetricType is undefined. Using parent lodMetricType")),"lodMetricValue"in t?this.lodMetricValue=t.lodMetricValue:(this.lodMetricValue=this.parent&&this.parent.lodMetricValue||this.tileset.lodMetricValue,console.warn("3D Tile: Required prop lodMetricValue is undefined. Using parent lodMetricValue"))},e._initializeTransforms=function(t){this.transform=t.transform?new $.a(t.transform):new $.a;var e=this.parent,n=this.tileset,r=e&&e.computedTransform?e.computedTransform.clone():n.modelMatrix.clone();this.computedTransform=new $.a(r).multiplyRight(this.transform);var i=e&&e._initialTransform?e._initialTransform.clone():new $.a;this._initialTransform=new $.a(i).multiplyRight(this.transform)},e._initializeBoundingVolumes=function(t){this._contentBoundingVolume=null,this._viewerRequestVolume=null,this._updateBoundingVolume(t)},e._initializeContent=function(t){this.content={_tileset:this.tileset,_tile:this},this.hasEmptyContent=!0,this.contentState=fe.d.UNLOADED,this.hasTilesetContent=!1,t.contentUrl&&(this.content=null,this.hasEmptyContent=!1)},e._initializeRenderingState=function(t){this.depth=t.level,this._shouldRefine=!1,this._distanceToCamera=0,this._centerZDepth=0,this._screenSpaceError=0,this._visibilityPlaneMask=Wt.MASK_INDETERMINATE,this._visible=!1,this._inRequestVolume=!1,this._stackLength=0,this._selectionDepth=0,this._frameNumber=0,this._touchedFrame=0,this._visitedFrame=0,this._selectedFrame=0,this._requestedFrame=0,this._priority=0},e._getRefine=function(t){return t||this.parent&&this.parent.refine||fe.e.REPLACE},e._isTileset=function(){return-1!==this.contentUrl.indexOf(".json")},e._onContentLoaded=function(){switch(this.content&&this.content.type){case"vctr":case"geom":this.tileset.traverser.disableSkipLevelOfDetail=!0}this._isTileset()&&(this.hasTilesetContent=!0)},e._updateBoundingVolume=function(t){this.boundingVolume=be(t.boundingVolume,this.computedTransform,this.boundingVolume);var e=t.content;e&&(e.boundingVolume&&(this._contentBoundingVolume=be(e.boundingVolume,this.computedTransform,this._contentBoundingVolume)),t.viewerRequestVolume&&(this._viewerRequestVolume=be(t.viewerRequestVolume,this.computedTransform,this._viewerRequestVolume)))},e._updateTransform=function(t){void 0===t&&(t=new $.a);var e=t.clone().multiplyRight(this.transform);!e.equals(this.computedTransform)&&(this.computedTransform=e,this._updateBoundingVolume(this.header))},e.updateExpiration=function(){if(null!=this._expireDate&&this.contentReady&&!this.hasEmptyContent){var t=Date.now();Date.lessThan(this._expireDate,t)&&(this.contentState=fe.d.EXPIRED,this._expiredContent=this.content)}},Object(c.a)(t,[{key:"selected",get:function(){return this._selectedFrame===this.tileset._frameNumber}},{key:"isVisible",get:function(){return this._visible}},{key:"isVisibleAndInRequestVolume",get:function(){return this._visible&&this._inRequestVolume}},{key:"hasRenderContent",get:function(){return!this.hasEmptyContent&&!this.hasTilesetContent}},{key:"hasChildren",get:function(){return this.children.length>0||this.header.children&&this.header.children.length>0}},{key:"contentReady",get:function(){return this.contentState===fe.d.READY||this.hasEmptyContent}},{key:"contentAvailable",get:function(){return Boolean(this.contentReady&&this.hasRenderContent||this._expiredContent&&!this.contentFailed)}},{key:"hasUnloadedContent",get:function(){return this.hasRenderContent&&this.contentUnloaded}},{key:"contentUnloaded",get:function(){return this.contentState===fe.d.UNLOADED}},{key:"contentExpired",get:function(){return this.contentState===fe.d.EXPIRED}},{key:"contentFailed",get:function(){return this.contentState===fe.d.FAILED}},{key:"extras",get:function(){return this.header.extras}}]),t}(),xe=n("dI71"),Ce=function(){function t(t){void 0===t&&(t=0),this._array=new Array(t),this._map=new Map,this._length=t}var e=t.prototype;return e.get=function(t){return Object(rt.a)(t<this._array.length),this._array[t]},e.set=function(t,e){Object(rt.a)(t>=0),t>=this.length&&(this.length=t+1),this._map.has(this._array[t])&&this._map.delete(this._array[t]),this._array[t]=e,this._map.set(e,t)},e.delete=function(t){var e=this._map.get(t);e>=0&&(this._array.splice(e,1),this._map.delete(t),this.length--)},e.peek=function(){return this._array[this._length-1]},e.push=function(t){if(!this._map.has(t)){var e=this.length++;this._array[e]=t,this._map.set(t,e)}},e.pop=function(){var t=this._array[--this.length];return this._map.delete(t),t},e.reserve=function(t){Object(rt.a)(t>=0),t>this._array.length&&(this._array.length=t)},e.resize=function(t){Object(rt.a)(t>=0),this.length=t},e.trim=function(t){null==t&&(t=this.length),this._array.length=t},e.reset=function(){this._array=[],this._map=new Map,this._length=0},e.find=function(t){return this._map.has(t)},Object(c.a)(t,[{key:"length",get:function(){return this._length},set:function(t){this._length=t,t>this._array.length&&(this._array.length=t)}},{key:"values",get:function(){return this._array}}]),t}();function Re(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Le(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Le(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=t[Symbol.iterator]()).next.bind(n)}function Le(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Ne(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ie(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ne(Object(n),!0).forEach((function(e){Object(a.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ne(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Ae={loadSiblings:!1,skipLevelOfDetail:!1,maximumScreenSpaceError:2},De=function(){function t(t){this.options=Ie(Ie({},Ae),t),this._traversalStack=new Ce,this._emptyTraversalStack=new Ce,this._frameNumber=null,this.root=null,this.selectedTiles={},this.requestedTiles={},this.emptyTiles={}}var e=t.prototype;return e.traverse=function(t,e,n){this.root=t,this.options=Ie(Ie({},this.options),n),this.reset(),this.updateTile(t,e),this._frameNumber=e.frameNumber,this.executeTraversal(t,e)},e.reset=function(){this.requestedTiles={},this.selectedTiles={},this.emptyTiles={},this._traversalStack.reset(),this._emptyTraversalStack.reset()},e.executeTraversal=function(t,e){var n=this._traversalStack;for(n.push(t);n.length>0;){var r=n.pop(),i=!1;this.canTraverse(r,e)&&(this.updateChildTiles(r,e),i=this.updateAndPushChildren(r,e,n));var a=r.parent,o=Boolean(!a||a._shouldRefine),s=!i;r.hasRenderContent?r.refine===fe.e.ADD?(this.loadTile(r,e),this.selectTile(r,e)):r.refine===fe.e.REPLACE&&(this.loadTile(r,e),s&&this.selectTile(r,e)):(this.emptyTiles[r.id]=r,this.loadTile(r,e),s&&this.selectTile(r,e)),this.touchTile(r,e),r._shouldRefine=i&&o}this.options.onTraversalEnd&&this.options.onTraversalEnd(e)},e.updateChildTiles=function(t,e){for(var n,r=Re(t.children);!(n=r()).done;){var i=n.value;this.updateTile(i,e)}return!0},e.updateAndPushChildren=function(t,e,n){var r=this.options,i=r.loadSiblings,a=r.skipLevelOfDetail,o=t.children;o.sort(this.compareDistanceToCamera);for(var s,c=!a&&t.refine===fe.e.REPLACE&&t.hasRenderContent,u=!1,l=Re(o);!(s=l()).done;){var h=s.value;if(h.isVisibleAndInRequestVolume?(n.find(h)&&n.delete(h),n.push(h),u=!0):(c||i)&&(this.loadTile(h,e),this.touchTile(h,e)),c){var f=void 0;if(!(f=!!h._inRequestVolume&&(h.hasRenderContent?h.contentAvailable:this.executeEmptyTraversal(h,e))))return f}}return u},e.updateTile=function(t,e){this.updateTileVisibility(t,e)},e.selectTile=function(t,e){this.shouldSelectTile(t,e)&&(t._selectedFrame=e.frameNumber,this.selectedTiles[t.id]=t)},e.loadTile=function(t,e){this.shouldLoadTile(t,e)&&(t._requestedFrame=e.frameNumber,t._priority=this.getPriority(t),this.requestedTiles[t.id]=t)},e.touchTile=function(t,e){t.tileset._cache.touch(t),t._touchedFrame=e.frameNumber},e.canTraverse=function(t,e,n,r){return void 0===n&&(n=!1),void 0===r&&(r=!1),!(!r&&!t.isVisibleAndInRequestVolume)&&(!!t.hasChildren&&(t.hasTilesetContent?!t.contentExpired:this.shouldRefine(t,e,n)))},e.shouldLoadTile=function(t,e){return t.hasUnloadedContent||t.contentExpired},e.shouldSelectTile=function(t,e){return t.contentAvailable&&!this.options.skipLevelOfDetail},e.shouldRefine=function(t,e,n){var r=t._screenSpaceError;return n&&(r=t.getScreenSpaceError(e,!0)),r>this.options.maximumScreenSpaceError},e.updateTileVisibility=function(t,e){t.updateVisibility(e)},e.compareDistanceToCamera=function(t,e){return t._distanceToCamera-e._distanceToCamera},e.getPriority=function(t){var e=this.options;switch(t.refine){case fe.e.ADD:return t._distanceToCamera;case fe.e.REPLACE:var n=t.parent,r=n&&(!e.skipLevelOfDetail||0===t._screenSpaceError||n.hasTilesetContent)?n._screenSpaceError:t._screenSpaceError;return this.root._screenSpaceError-r;default:return Object(rt.a)(!1)}},e.anyChildrenVisible=function(t,e){for(var n,r=!1,i=Re(t.children);!(n=i()).done;){var a=n.value;a.updateVisibility(e),r=r||a.isVisibleAndInRequestVolume}return r},e.executeEmptyTraversal=function(t,e){for(var n=!0,r=this._emptyTraversalStack;r.length>0;){var i=r.pop();this.updateTile(i,e),i.isVisibleAndInRequestVolume||(this.loadTile(i,e),this.touchTile(i,e));var a=!i.hasRenderContent&&this.canTraverse(i,e,!1,!0);if(a||i.contentAvailable||(n=!1),a)for(var o,s=Re(i.children.filter((function(t){return t})));!(o=s()).done;){var c=o.value;r.find(c)&&r.delete(c),r.push(c)}}return n},t}(),ze=function(t){function e(){return t.apply(this,arguments)||this}Object(xe.a)(e,t);var n=e.prototype;return n.compareDistanceToCamera=function(t,e){return 0===e._distanceToCamera&&0===t._distanceToCamera?e._centerZDepth-t._centerZDepth:e._distanceToCamera-t._distanceToCamera},n.updateTileVisibility=function(t,e){if(t.updateVisibility(e),t.isVisibleAndInRequestVolume){var n=t.children.length>0;if(t.hasTilesetContent&&n){var r=t.children[0];return this.updateTileVisibility(r,e),void(t._visible=r._visible)}if(this.meetsScreenSpaceErrorEarly(t,e))t._visible=!1;else{var i=t.refine===fe.e.REPLACE,a=t._optimChildrenWithinParent===fe.b.USE_OPTIMIZATION;i&&a&&n&&!this.anyChildrenVisible(t,e)&&(t._visible=!1)}}},n.meetsScreenSpaceErrorEarly=function(t,e){var n=t.parent;return!(!n||n.hasTilesetContent||n.refine!==fe.e.ADD)&&!this.shouldRefine(t,e,!0)},e}(De),Ue="REQUESTED",Ve="COMPLETED",Be="ERROR",Fe=function(){function t(){this._statusMap={}}var e=t.prototype;return e.add=function(t,e,n,r){var i=this;this._statusMap[e]||(this._statusMap[e]={request:t,callback:n,key:e,frameState:r,status:Ue},t().then((function(t){i._statusMap[e].status=Ve,i._statusMap[e].callback(t,r)})).catch((function(t){i._statusMap[e].status=Be,n(t)})))},e.update=function(t,e){this._statusMap[t]&&(this._statusMap[t].frameState=e)},e.find=function(t){return this._statusMap[t]},t}();function qe(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ge(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?qe(Object(n),!0).forEach((function(e){Object(a.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):qe(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function He(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Ze(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ze(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=t[Symbol.iterator]()).next.bind(n)}function Ze(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var We=function(t){function e(e){var n;return(n=t.call(this,e)||this)._tileManager=new Fe,n}Object(xe.a)(e,t);var n=e.prototype;return n.shouldRefine=function(t,e){return t._lodJudge=function(t,e){var n=e.viewport,r=n.metersPerPixel,i=t.header.mbs[1],a=t.header.mbs[0],o=t.header.mbs[2],s=t.header.mbs[3],c=n.height,u=n.width,l=n.latitude,h=n.longitude,f=[h,l],p=[a,i,o],d=[h,i],v=[a,l],y=Math.sqrt(c*c+u*u)*r[0],m=.5*c+s/6378137,g=.5*u+s/6378137;if(Se(f,p)>y+s/6378137)return"OUT";if(Se(f,d)>m)return"OUT";if(Se(f,v)>g)return"OUT";if(0===t.lodMetricValue)return"DIG";var b=Te(t,e);return(b*=je)<.5?"OUT":!t.header.children||b<=t.lodMetricValue?"DRAW":t.header.children?"DIG":"OUT"}(t,e),"DIG"===t._lodJudge},n.updateChildTiles=function(t,e){for(var n,r=this,i=t.header.children||[],a=t.children,o=t.tileset,s=function(){var i=n.value,s=a&&a.find((function(t){return t.id===i.id}));if(s)s&&r.updateTile(s,e);else{r._tileManager.find(i.id)?r._tileManager.update(i.id,e):r._tileManager.add((function(){return r._loadTile(i.id,o)}),i.id,(function(e){return r._onTileLoad(e,t)}),e)}},c=He(i);!(n=c()).done;)s()},n._loadTile=function(){var t=Object(o.a)(i.a.mark((function t(e,n){var r,a,o;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.loader,a=n.getTileUrl(n.url+"/nodes/"+e),o={i3s:Ge(Ge({},n.fetchOptions),{},{isTileHeader:!0,loadContent:!1})},t.next=5,Object(X.a)(a,r,o);case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),n._onTileLoad=function(t,e){var n=this.options.basePath,r=new Me(e.tileset,t,e,n);e.children.push(r);var i=this._tileManager.find(r.id).frameState;this.updateTile(r,i),this._frameNumber===i.frameNumber&&this.executeTraversal(r,i)},e}(De);function Ye(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Ke(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ke(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=t[Symbol.iterator]()).next.bind(n)}function Ke(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Qe(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Je(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Qe(Object(n),!0).forEach((function(e){Object(a.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Qe(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var Xe={ellipsoid:et.a.WGS84,modelMatrix:new $.a,throttleRequests:!1,maximumMemoryUsage:32,onTileLoad:function(){},onTileUnload:function(){},onTileError:function(t,e,n){},maximumScreenSpaceError:8},$e=function(){function t(t,e){void 0===e&&(e={}),Object(rt.a)(t),this.options=Je(Je({},Xe),e),this.tileset=t,this.loader=t.loader,this.type=t.type,this.url=t.url,this.basePath=t.basePath||it.a.dirname(this.url),this.modelMatrix=this.options.modelMatrix,this.ellipsoid=this.options.ellipsoid,this.lodMetricType=t.lodMetricType,this.lodMetricValue=t.lodMetricValue,this.refine=t.root.refine,this.fetchOptions=this.options.fetchOptions||{},this.options.headers&&(this.fetchOptions.headers=this.options.headers),this.options.token&&(this.fetchOptions.token=this.options.token),this.root=null,this.cartographicCenter=null,this.cartesianCenter=null,this.zoom=1,this.boundingVolume=null,this._traverser=this._initializeTraverser(),this._cache=new ut,this._requestScheduler=new at.a({throttleRequests:this.options.throttleRequests}),this._frameNumber=0,this._updateFrameNumber=0,this._pendingCount=0,this._tiles={},this.selectedTiles=[],this._emptyTiles=[],this._requestedTiles=[],this._selectedTilesToStyle=[],this._queryParams={},this._queryParamsString=null,this.maximumMemoryUsage=this.options.maximumMemoryUsage,this.gpuMemoryUsageInBytes=0,this.stats=new nt.a({id:this.url}),this._initializeStats(),this._hasMixedContent=!1,this._maximumScreenSpaceError=this.options.maximumScreenSpaceError,this._properties=void 0,this._extensionsUsed=void 0,this._gltfUpAxis=void 0,this._dynamicScreenSpaceErrorComputedDensity=0,this.extras=null,this.asset={},this.credits={},this.description=this.options.description,this._defaultGeometrySchema=[],this._initializeTileSet(t,this.options)}var e=t.prototype;return e.isLoaded=function(){return 0===this._pendingCount},e.destroy=function(){this._destroy()},e.getTileUrl=function(t){return t.startsWith("data:")?t:""+t+this.queryParams},e.update=function(t){this._cache.reset(),this._frameNumber++,this._frameState=le(t,this._frameNumber),this._traverser.traverse(this.root,this._frameState,this.options)},e._onTraversalEnd=function(){var t=Object.values(this._traverser.selectedTiles);this._tilesChanged(this.selectedTiles,t)&&this._updateFrameNumber++,this.selectedTiles=t;for(var e,n=Ye(this.selectedTiles);!(e=n()).done;){var r=e.value;this._tiles[r.id]=r}return this._requestedTiles=Object.values(this._traverser.requestedTiles),this._emptyTiles=Object.values(this._traverser.emptyTiles),this._loadTiles(this._frameState),this._unloadTiles(),this._updateStats(),this._updateFrameNumber},e._tilesChanged=function(t,e){if(t.length!==e.length)return!0;var n=new Set(t.map((function(t){return t.id}))),r=new Set(e.map((function(t){return t.id}))),i=t.filter((function(t){return!r.has(t.id)})).length>0;return i=i||e.filter((function(t){return!n.has(t.id)})).length>0},e._loadTiles=function(t){for(var e,n=Ye(this._requestedTiles);!(e=n()).done;){var r=e.value;r.contentUnloaded&&this._loadTile(r,t)}},e._unloadTiles=function(){this._cache.unloadTiles(this,(function(t,e){return t._unloadTile(e)}))},e._updateStats=function(){for(var t,e=0,n=0,r=Ye(this.selectedTiles);!(t=r()).done;){var i=t.value;i.contentAvailable&&(e++,i.content.pointCount&&(n+=i.content.pointCount))}this.stats.get("Tiles In View").count=this.selectedTiles.length,this.stats.get("Tiles To Render").count=e,this.stats.get("Points").count=n},e._initializeTileSet=function(t){this.root=this._initializeTileHeaders(t,null,this.basePath),this.type===fe.c.TILES3D&&this._initializeCesiumTileset(t),this.type===fe.c.I3S&&this._initializeI3STileset(t),this._calculateViewProps()},e._calculateViewProps=function(){var t=this.root,e=t.boundingVolume.center;if(!e)return console.warn("center was not pre-calculated for the root tile"),this.cartographicCenter=new tt.a,void(this.zoom=1);this.cartographicCenter=et.a.WGS84.cartesianToCartographic(e,new tt.a),this.cartesianCenter=e,this.zoom=function(t){var e=t.halfAxes,n=t.radius,r=t.width,i=t.height;if(e){e.getColumn(0,he);var a=he.len();e.getColumn(1,he);var o=he.len();e.getColumn(2,he);var s=a/2,c=o/2,u=he.len()/2;return(Math.log2(6378137/s)+Math.log2(6378137/c)+Math.log2(6356752.314245179/u))/3}return n?Math.log2(6356752.314245179/n):i&&r?(Math.log2(6378137/r)+Math.log2(6378137/i))/2:1}(t.boundingVolume)},e._initializeStats=function(){this.stats.get("Tiles In Tileset(s)"),this.stats.get("Tiles Loading"),this.stats.get("Tiles In Memory"),this.stats.get("Tiles In View"),this.stats.get("Tiles To Render"),this.stats.get("Tiles Loaded"),this.stats.get("Tiles Unloaded"),this.stats.get("Failed Tile Loads"),this.stats.get("Points","memory"),this.stats.get("Tile Memory Use","memory")},e._initializeTileHeaders=function(t,e,n){var r=new Me(this,t.root,e,n);if(e&&(e.children.push(r),r.depth=e.depth+1),this.type===fe.c.TILES3D){var i=[];for(i.push(r);i.length>0;){var a=i.pop();this.stats.get("Tiles In Tileset(s)").incrementCount();for(var o,s=Ye(a.header.children||[]);!(o=s()).done;){var c=o.value,u=new Me(this,c,a,n);a.children.push(u),u.depth=a.depth+1,i.push(u)}}}return r},e._initializeTraverser=function(){var t;switch(this.type){case fe.c.TILES3D:t=ze;break;case fe.c.I3S:t=We;break;default:t=De}return new t({basePath:this.basePath,onTraversalEnd:this._onTraversalEnd.bind(this)})},e._destroyTileHeaders=function(t){this._destroySubtree(t)},e._loadTile=function(){var t=Object(o.a)(i.a.mark((function t(e,n){var r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this._onStartTileLoading(),t.next=4,e.loadContent(n);case 4:r=t.sent,t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),this._onTileLoadError(e,t.t0);case 10:return t.prev=10,this._onEndTileLoading(),this._onTileLoad(e,r),t.finish(10);case 14:case"end":return t.stop()}}),t,this,[[0,7,10,14]])})));return function(e,n){return t.apply(this,arguments)}}(),e._onTileLoadError=function(t,e){this.stats.get("Failed Tile Loads").incrementCount();var n=e.message||e.toString(),r=t.url;console.error("A 3D tile failed to load: "+t.url+" "+n),this.options.onTileError(t,n,r)},e._onTileLoad=function(t,e){e&&(t&&t.content&&function(t,e){Object(rt.a)(t),Object(rt.a)(e);var n=e.rtcCenter,r=e.rotateYtoZ,i=t.computedTransform,a=t.boundingVolume.center,o=new $.a(i);if(n&&o.translate(n),r){var s=(new $.a).rotateX(Math.PI/2);o=o.multiplyRight(s)}e.isQuantized&&o.translate(e.quantizedVolumeOffset).scale(e.quantizedVolumeScale);var c=new tt.a(a);e.cartesianModelMatrix=o,e.cartesianOrigin=c;var u=et.a.WGS84.cartesianToCartographic(c,new tt.a),l=et.a.WGS84.eastNorthUpToFixedFrame(c).invert();e.cartographicModelMatrix=l.multiplyRight(o),e.cartographicOrigin=u,e.modelMatrix=e.cartographicModelMatrix}(t,t.content),this._addTileToCache(t),this.options.onTileLoad(t))},e._onStartTileLoading=function(){this._pendingCount++,this.stats.get("Tiles Loading").incrementCount()},e._onEndTileLoading=function(){this._pendingCount--,this.stats.get("Tiles Loading").decrementCount()},e._addTileToCache=function(t){this._cache.add(this,t,(function(e){return e._updateCacheStats(t)}))},e._updateCacheStats=function(t){this.stats.get("Tiles Loaded").incrementCount(),this.stats.get("Tiles In Memory").incrementCount(),this.gpuMemoryUsageInBytes+=t.content.byteLength||0,this.stats.get("Tile Memory Use").count=this.gpuMemoryUsageInBytes},e._unloadTile=function(t){this.gpuMemoryUsageInBytes-=t.content.byteLength||0,this.stats.get("Tiles In Memory").decrementCount(),this.stats.get("Tiles Unloaded").incrementCount(),this.stats.get("Tile Memory Use").count=this.gpuMemoryUsageInBytes,this.options.onTileUnload(t),t.unloadContent()},e._destroy=function(){var t=[];for(this.root&&t.push(this.root);t.length>0;){for(var e,n=t.pop(),r=Ye(n.children);!(e=r()).done;){var i=e.value;t.push(i)}this._destroyTile(n)}this.root=null},e._destroySubtree=function(t){var e=t,n=[];for(n.push(e);n.length>0;){for(var r,i=Ye((t=n.pop()).children);!(r=i()).done;){var a=r.value;n.push(a)}t!==e&&this._destroyTile(t)}e.children=[]},e._destroyTile=function(t){this._cache.unloadTile(this,t),this._unloadTile(t),t.destroy()},e._initializeCesiumTileset=function(t){if(this.asset=t.asset,!this.asset)throw new Error("Tileset must have an asset property.");if("0.0"!==this.asset.version&&"1.0"!==this.asset.version)throw new Error("The tileset must be 3D Tiles version 0.0 or 1.0.");"tilesetVersion"in this.asset&&(this._queryParams.v=this.asset.tilesetVersion),this.credits={attributions:this.options.attributions||[]},this.description=this.options.description,this.properties=t.properties,this.geometricError=t.geometricError,this._extensionsUsed=t.extensionsUsed,this.extras=t.extras},e._initializeI3STileset=function(t){"token"in this.options&&(this._queryParams.token=this.options.token),this._defaultGeometrySchema=t.store.defaultGeometrySchema},e.hasExtension=function(t){return Boolean(this._extensionsUsed&&this._extensionsUsed.indexOf(t)>-1)},Object(c.a)(t,[{key:"tiles",get:function(){return Object.values(this._tiles)}},{key:"queryParams",get:function(){return this._queryParamsString||(this._queryParamsString=function(t){for(var e=[],n=0,r=Object.keys(t);n<r.length;n++){var i=r[n];e.push(i+"="+t[i])}switch(e.length){case 0:return"";case 1:return"?"+e[0];default:return"?"+e.join("&")}}(this._queryParams)),this._queryParamsString}}]),t}(),tn=n("Ed8q");function en(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function nn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?en(Object(n),!0).forEach((function(e){Object(a.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):en(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var rn=new f.d,an={getPointColor:[0,0,0],pointSize:1,data:null,loadOptions:{},loader:tn.a,onTilesetLoad:function(t){},onTileLoad:function(t){},onTileUnload:function(t){},onTileError:function(t,e,n){}},on=function(t){function e(){return Object(s.a)(this,e),Object(u.a)(this,Object(l.a)(e).apply(this,arguments))}var n;return Object(h.a)(e,t),Object(c.a)(e,[{key:"initializeState",value:function(){"onTileLoadFail"in this.props&&j.a.removed("onTileLoadFail","onTileError")(),this.state={layerMap:{},tileset3d:null}}},{key:"shouldUpdateState",value:function(t){return t.changeFlags.somethingChanged}},{key:"updateState",value:function(t){var e=t.props,n=t.oldProps,r=t.changeFlags;if(e.data&&e.data!==n.data&&this._loadTileset(e.data),r.viewportChanged){var i=this.state.tileset3d;this._updateTileset(i)}}},{key:"getPickingInfo",value:function(t){var e=t.info,n=t.sourceLayer,r=this.state.layerMap,i=n&&n.id;if(i){var a=i.substring(this.id.length+1),o=a.substring(a.indexOf("-")+1);e.object=r[o]&&r[o].tile}return e}},{key:"_loadTileset",value:(n=Object(o.a)(i.a.mark((function t(e){var n,r,a,o,s,c,u;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.props,r=n.loader,a=n.loadOptions,o=nn({},a),!r.preload){t.next=7;break}return t.next=5,r.preload(e,a);case 5:s=t.sent,Object.assign(o,s);case 7:return t.next=9,Object(X.a)(e,r,o);case 9:c=t.sent,u=new $e(c,nn({onTileLoad:this._onTileLoad.bind(this),onTileUnload:this._onTileUnload.bind(this),onTileLoadFail:this.props.onTileError},o)),this.setState({tileset3d:u,layerMap:{}}),this._updateTileset(u),this.props.onTilesetLoad(u);case 14:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"_onTileLoad",value:function(t){this.props.onTileLoad(t),this._updateTileset(this.state.tileset3d),this.setNeedsUpdate()}},{key:"_onTileUnload",value:function(t){delete this.state.layerMap[t.id],this.props.onTileUnload(t)}},{key:"_updateTileset",value:function(t){var e=this.context,n=e.timeline,r=e.viewport;if(n&&r&&t){var i=t.update(r);this.state.frameNumber!==i&&this.setState({frameNumber:i})}}},{key:"_create3DTileLayer",value:function(t){if(!t.content)return null;switch(t.type){case fe.f.POINTCLOUD:return this._createPointCloudTileLayer(t);case fe.f.SCENEGRAPH:return this._create3DModelTileLayer(t);case fe.f.MESH:return this._createSimpleMeshLayer(t);default:throw new Error("Tile3DLayer: Failed to render layer of type ".concat(t.content.type))}}},{key:"_createPointCloudTileLayer",value:function(t){var e=t.content,n=e.attributes,r=e.pointCount,i=e.constantRGBA,a=e.cartographicOrigin,o=e.modelMatrix,s=n.positions,c=n.normals,u=n.colors;if(!s)return null;var l=this.props,h=l.pointSize,f=l.getPointColor;return new(this.getSubLayerClass("pointcloud",O.a))({pointSize:h},this.getSubLayerProps({id:"pointcloud"}),{id:"".concat(this.id,"-pointcloud-").concat(t.id),data:{header:{vertexCount:r},attributes:{POSITION:s,NORMAL:c,COLOR_0:u}},coordinateSystem:d.a.METER_OFFSETS,coordinateOrigin:a,modelMatrix:o,getColor:i||f})}},{key:"_create3DModelTileLayer",value:function(t){var e=t.content,n=e.gltf,r=e.instances,i=e.cartographicOrigin,a=e.modelMatrix;return new(this.getSubLayerClass("scenegraph",F))({_lighting:"pbr"},this.getSubLayerProps({id:"scenegraph"}),{id:"".concat(this.id,"-scenegraph-").concat(t.id),data:r||[{}],scenegraph:n,coordinateSystem:d.a.METER_OFFSETS,coordinateOrigin:i,modelMatrix:a,getTransformMatrix:function(t){return t.modelMatrix},getPosition:function(t){return[0,0,0]}})}},{key:"_createSimpleMeshLayer",value:function(t){for(var e=t.content,n=e.attributes,r=e.modelMatrix,i=e.cartographicOrigin,a=e.texture,o=n.normals,s=n.texCoords,c=new Float32Array(n.positions.value.length),u=0;u<c.length;u+=3)rn.copy(n.positions.value.subarray(u,u+3)),c.set(rn,u);var l=new p.a({drawMode:4,attributes:{positions:c,normals:o,texCoords:s}});return new(this.getSubLayerClass("mesh",J))(this.getSubLayerProps({id:"mesh"}),{id:"".concat(this.id,"-mesh-").concat(t.id),mesh:l,data:[{}],getPosition:[0,0,0],getColor:[255,255,255],texture:a,modelMatrix:r,coordinateOrigin:i,coordinateSystem:d.a.METER_OFFSETS})}},{key:"renderLayers",value:function(){var t=this,e=this.state,n=e.tileset3d,r=e.layerMap;return n?n.tiles.map((function(e){var n=r[e.id]&&r[e.id].layer;return e.selected?(n||(n=t._create3DTileLayer(e),r[e.id]={layer:n,tile:e}),n&&n.props&&!n.props.visible&&(n=n.clone({visible:!0}),r[e.id].layer=n),n):(n&&n.props&&n.props.visible&&(n=n.clone({visible:!1}),r[e.id].layer=n),n)})).filter(Boolean):null}}]),e}(b);on.layerName="Tile3DLayer",on.defaultProps=an},GA6j:function(t,e,n){"use strict";n.d(e,"a",(function(){return g}));var r=n("1OyB"),i=n("md7G"),a=n("foSv"),o=n("vuIU"),s=n("Ji7U"),c=n("fxzv"),u=n("+H0l"),l=n("sSh/"),h=n("HwUG"),f=n("ZxFD"),p=n("n+fv"),d=Object.freeze([1,0,0,0,1,0,0,0,1]),v=Object.freeze([0,0,0,0,0,0,0,0,0]),y=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL1ROW0:3,COL1ROW1:4,COL1ROW2:5,COL2ROW0:6,COL2ROW1:7,COL2ROW2:8}),m={},g=function(t){function e(t){var n;return Object(r.a)(this,e),n=Object(i.a)(this,Object(a.a)(e).call(this,-0,-0,-0,-0,-0,-0,-0,-0,-0)),1===arguments.length&&Array.isArray(t)?n.copy(t):n.identity(),n}return Object(s.a)(e,t),Object(o.a)(e,[{key:"ELEMENTS",get:function(){return 9}},{key:"RANK",get:function(){return 3}},{key:"INDICES",get:function(){return y}}],[{key:"IDENTITY",get:function(){return m.IDENTITY=m.IDENTITY||Object.freeze(new e(d)),m.IDENTITY}},{key:"ZERO",get:function(){return m.ZERO=m.ZERO||Object.freeze(new e(v)),m.ZERO}}]),Object(o.a)(e,[{key:"copy",value:function(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this.check()}},{key:"set",value:function(t,e,n,r,i,a,o,s,c){return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this[4]=i,this[5]=a,this[6]=o,this[7]=s,this[8]=c,this.check()}},{key:"setRowMajor",value:function(t,e,n,r,i,a,o,s,c){return this[0]=t,this[1]=r,this[2]=o,this[3]=e,this[4]=i,this[5]=s,this[6]=n,this[7]=a,this[8]=c,this.check()}},{key:"determinant",value:function(){return h.b(this)}},{key:"identity",value:function(){return this.copy(d)}},{key:"fromQuaternion",value:function(t){return h.c(this,t),this.check()}},{key:"transpose",value:function(){return h.i(this,this),this.check()}},{key:"invert",value:function(){return h.d(this,this),this.check()}},{key:"multiplyLeft",value:function(t){return h.e(this,t,this),this.check()}},{key:"multiplyRight",value:function(t){return h.e(this,this,t),this.check()}},{key:"rotate",value:function(t){return h.f(this,this,t),this.check()}},{key:"scale",value:function(t){return Array.isArray(t)?h.g(this,this,t):h.g(this,this,[t,t,t]),this.check()}},{key:"translate",value:function(t){return h.h(this,this,t),this.check()}},{key:"transform",value:function(t,e){switch(t.length){case 2:e=f.i(e||[-0,-0],t,this);break;case 3:e=p.n(e||[-0,-0,-0],t,this);break;case 4:e=Object(l.d)(e||[-0,-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Object(u.b)(e,t.length),e}},{key:"transformVector",value:function(t,e){return Object(u.c)("Matrix3.transformVector"),this.transform(t,e)}},{key:"transformVector2",value:function(t,e){return Object(u.c)("Matrix3.transformVector"),this.transform(t,e)}},{key:"transformVector3",value:function(t,e){return Object(u.c)("Matrix3.transformVector"),this.transform(t,e)}}]),e}(c.a)},GSm6:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"i",(function(){return a})),n.d(e,"d",(function(){return o})),n.d(e,"b",(function(){return s})),n.d(e,"e",(function(){return c})),n.d(e,"h",(function(){return u})),n.d(e,"f",(function(){return l})),n.d(e,"g",(function(){return h})),n.d(e,"c",(function(){return f}));n("QFcT");var r=n("yOd+");function i(){var t=new r.a(9);return r.a!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function a(t,e){if(t===e){var n=e[1],r=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function o(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],c=e[6],u=e[7],l=e[8],h=l*o-s*u,f=-l*a+s*c,p=u*a-o*c,d=n*h+r*f+i*p;return d?(d=1/d,t[0]=h*d,t[1]=(-l*r+i*u)*d,t[2]=(s*r-i*o)*d,t[3]=f*d,t[4]=(l*n-i*c)*d,t[5]=(-s*n+i*a)*d,t[6]=p*d,t[7]=(-u*n+r*c)*d,t[8]=(o*n-r*a)*d,t):null}function s(t){var e=t[0],n=t[1],r=t[2],i=t[3],a=t[4],o=t[5],s=t[6],c=t[7],u=t[8];return e*(u*a-o*c)+n*(-u*i+o*s)+r*(c*i-a*s)}function c(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],c=e[5],u=e[6],l=e[7],h=e[8],f=n[0],p=n[1],d=n[2],v=n[3],y=n[4],m=n[5],g=n[6],b=n[7],O=n[8];return t[0]=f*r+p*o+d*u,t[1]=f*i+p*s+d*l,t[2]=f*a+p*c+d*h,t[3]=v*r+y*o+m*u,t[4]=v*i+y*s+m*l,t[5]=v*a+y*c+m*h,t[6]=g*r+b*o+O*u,t[7]=g*i+b*s+O*l,t[8]=g*a+b*c+O*h,t}function u(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],c=e[5],u=e[6],l=e[7],h=e[8],f=n[0],p=n[1];return t[0]=r,t[1]=i,t[2]=a,t[3]=o,t[4]=s,t[5]=c,t[6]=f*r+p*o+u,t[7]=f*i+p*s+l,t[8]=f*a+p*c+h,t}function l(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],c=e[5],u=e[6],l=e[7],h=e[8],f=Math.sin(n),p=Math.cos(n);return t[0]=p*r+f*o,t[1]=p*i+f*s,t[2]=p*a+f*c,t[3]=p*o-f*r,t[4]=p*s-f*i,t[5]=p*c-f*a,t[6]=u,t[7]=l,t[8]=h,t}function h(t,e,n){var r=n[0],i=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function f(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=n+n,s=r+r,c=i+i,u=n*o,l=r*o,h=r*s,f=i*o,p=i*s,d=i*c,v=a*o,y=a*s,m=a*c;return t[0]=1-h-d,t[3]=l-m,t[6]=f+y,t[1]=l+m,t[4]=1-u-d,t[7]=p-v,t[2]=f-y,t[5]=p+v,t[8]=1-u-h,t}},HHP4:function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));var r=n("1OyB"),i=n("vuIU"),a=n("md7G"),o=n("foSv"),s=n("Ji7U"),c=n("bE5S"),u=n("fOPP"),l=n("2plT"),h=function(t){function e(){return Object(r.a)(this,e),Object(a.a)(this,Object(o.a)(e).apply(this,arguments))}return Object(s.a)(e,t),Object(i.a)(e,[{key:"copy",value:function(t){return Object(l.a)(!1),this}},{key:"len",value:function(){return Math.sqrt(this.lengthSquared())}},{key:"magnitude",value:function(){return this.len()}},{key:"lengthSquared",value:function(){for(var t=0,e=0;e<this.ELEMENTS;++e)t+=this[e]*this[e];return t}},{key:"magnitudeSquared",value:function(){return this.lengthSquared()}},{key:"distance",value:function(t){return Math.sqrt(this.distanceSquared(t))}},{key:"distanceSquared",value:function(t){for(var e=0,n=0;n<this.ELEMENTS;++n){var r=this[n]-t[n];e+=r*r}return Object(u.a)(e)}},{key:"dot",value:function(t){for(var e=0,n=0;n<this.ELEMENTS;++n)e+=this[n]*t[n];return Object(u.a)(e)}},{key:"normalize",value:function(){var t=this.magnitude();if(0!==t)for(var e=0;e<this.ELEMENTS;++e)this[e]/=t;return this.check()}},{key:"multiply",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0,i=e;r<i.length;r++)for(var a=i[r],o=0;o<this.ELEMENTS;++o)this[o]*=a[o];return this.check()}},{key:"divide",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0,i=e;r<i.length;r++)for(var a=i[r],o=0;o<this.ELEMENTS;++o)this[o]/=a[o];return this.check()}},{key:"lengthSq",value:function(){return this.lengthSquared()}},{key:"distanceTo",value:function(t){return this.distance(t)}},{key:"distanceToSquared",value:function(t){return this.distanceSquared(t)}},{key:"getComponent",value:function(t){return Object(l.a)(t>=0&&t<this.ELEMENTS,"index is out of range"),Object(u.a)(this[t])}},{key:"setComponent",value:function(t,e){return Object(l.a)(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=e,this.check()}},{key:"addVectors",value:function(t,e){return this.copy(t).add(e)}},{key:"subVectors",value:function(t,e){return this.copy(t).subtract(e)}},{key:"multiplyVectors",value:function(t,e){return this.copy(t).multiply(e)}},{key:"addScaledVector",value:function(t,e){return this.add(new this.constructor(t).multiplyScalar(e))}},{key:"x",get:function(){return this[0]},set:function(t){this[0]=Object(u.a)(t)}},{key:"y",get:function(){return this[1]},set:function(t){this[1]=Object(u.a)(t)}}]),e}(c.a)},MTwu:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"e",(function(){return a})),n.d(e,"g",(function(){return o})),n.d(e,"d",(function(){return s})),n.d(e,"c",(function(){return c})),n.d(e,"l",(function(){return u})),n.d(e,"k",(function(){return l})),n.d(e,"m",(function(){return h})),n.d(e,"h",(function(){return f})),n.d(e,"i",(function(){return p})),n.d(e,"j",(function(){return d})),n.d(e,"a",(function(){return v})),n.d(e,"f",(function(){return m}));n("QFcT");var r=n("yOd+");function i(){var t=new r.a(3);return r.a!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function a(t,e,n){var i=new r.a(3);return i[0]=t,i[1]=e,i[2]=n,i}function o(t,e){var n=e[0],r=e[1],i=e[2],a=n*n+r*r+i*i;return a>0&&(a=1/Math.sqrt(a)),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t}function s(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function c(t,e,n){var r=e[0],i=e[1],a=e[2],o=n[0],s=n[1],c=n[2];return t[0]=i*c-a*s,t[1]=a*o-r*c,t[2]=r*s-i*o,t}function u(t,e,n){var r=e[0],i=e[1],a=e[2],o=n[3]*r+n[7]*i+n[11]*a+n[15];return o=o||1,t[0]=(n[0]*r+n[4]*i+n[8]*a+n[12])/o,t[1]=(n[1]*r+n[5]*i+n[9]*a+n[13])/o,t[2]=(n[2]*r+n[6]*i+n[10]*a+n[14])/o,t}function l(t,e,n){var r=e[0],i=e[1],a=e[2];return t[0]=r*n[0]+i*n[3]+a*n[6],t[1]=r*n[1]+i*n[4]+a*n[7],t[2]=r*n[2]+i*n[5]+a*n[8],t}function h(t,e,n){var r=n[0],i=n[1],a=n[2],o=n[3],s=e[0],c=e[1],u=e[2],l=i*u-a*c,h=a*s-r*u,f=r*c-i*s,p=i*f-a*h,d=a*l-r*f,v=r*h-i*l,y=2*o;return l*=y,h*=y,f*=y,p*=2,d*=2,v*=2,t[0]=s+l+p,t[1]=c+h+d,t[2]=u+f+v,t}function f(t,e,n,r){var i=[],a=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],a[0]=i[0],a[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),a[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function p(t,e,n,r){var i=[],a=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],a[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),a[1]=i[1],a[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function d(t,e,n,r){var i=[],a=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],a[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),a[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),a[2]=i[2],t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function v(t,e){var n=t[0],r=t[1],i=t[2],a=e[0],o=e[1],c=e[2],u=Math.sqrt(n*n+r*r+i*i)*Math.sqrt(a*a+o*o+c*c),l=u&&s(t,e)/u;return Math.acos(Math.min(Math.max(l,-1),1))}var y,m=function(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)};y=i()},Ns70:function(t,e,n){"use strict";n.d(e,"a",(function(){return A}));var r=n("ODXe"),i=n("1OyB"),a=n("vuIU"),o=n("zXfU"),s=n("tS8E"),c=n("gOKY"),u=n("Nw31"),l=n("a3TU"),h=n("n+fv"),f=(Math.max(6378137,6378137,6356752.314245179),function(t){return t}),p=new o.a;function d(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:f;return Object(l.e)(t)?(e[0]=n(t[0]),e[1]=n(t[1]),e[2]=t[2]):"longitude"in t?(e[0]=n(t.longitude),e[1]=n(t.latitude),e[2]=t.height):(e[0]=n(t.x),e[1]=n(t.y),e[2]=t.z),e}function v(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p;return d(t,e,l.b._cartographicRadians?f:l.i)}function y(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:f;return Object(l.e)(e)?(e[0]=n(t[0]),e[1]=n(t[1]),e[2]=t[2]):"longitude"in e?(e.longitude=n(t[0]),e.latitude=n(t[1]),e.height=t[2]):(e.x=n(t[0]),e.y=n(t[1]),e.z=t[2]),e}function m(t,e){return y(t,e,l.b._cartographicRadians?f:l.h)}var g=new o.a,b=new o.a,O=new o.a;var _=new o.a,j={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}},w={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]},S={east:new o.a,north:new o.a,up:new o.a,west:new o.a,south:new o.a,down:new o.a},T=new o.a,k=new o.a,E=new o.a;function P(t,e,n,r,i,a){var o,c,u,h=j[e]&&j[e][n];Object(s.a)(h&&(!r||r===h));var f=_.copy(i);if(Object(l.c)(f.x,0,1e-14)&&Object(l.c)(f.y,0,1e-14)){var p=Math.sign(f.z);o=T.fromArray(w[e]),"east"!==e&&"west"!==e&&o.scale(p),c=k.fromArray(w[n]),"east"!==n&&"west"!==n&&c.scale(p),u=E.fromArray(w[r]),"east"!==r&&"west"!==r&&u.scale(p)}else{var d=S.up,v=S.east,y=S.north;v.set(-f.y,f.x,0).normalize(),t.geodeticSurfaceNormal(f,d),y.copy(d).cross(v);var m=S.west,g=S.south;S.down.copy(d).scale(-1),m.copy(v).scale(-1),g.copy(y).scale(-1),o=S[e],c=S[n],u=S[r]}return a[0]=o.x,a[1]=o.y,a[2]=o.z,a[3]=0,a[4]=c.x,a[5]=c.y,a[6]=c.z,a[7]=0,a[8]=u.x,a[9]=u.y,a[10]=u.z,a[11]=0,a[12]=f.x,a[13]=f.y,a[14]=f.z,a[15]=1,a}var M,x=new o.a,C=new o.a,R=new o.a,L=new o.a,N=new o.a,I=new o.a,A=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;Object(i.a)(this,t),Object(s.a)(e>=0),Object(s.a)(n>=0),Object(s.a)(r>=0),this.radii=new o.a(e,n,r),this.radiiSquared=new o.a(e*e,n*n,r*r),this.radiiToTheFourth=new o.a(e*e*e*e,n*n*n*n,r*r*r*r),this.oneOverRadii=new o.a(0===e?0:1/e,0===n?0:1/n,0===r?0:1/r),this.oneOverRadiiSquared=new o.a(0===e?0:1/(e*e),0===n?0:1/(n*n),0===r?0:1/(r*r)),this.minimumRadius=Math.min(e,n,r),this.maximumRadius=Math.max(e,n,r),this.centerToleranceSquared=c.a.EPSILON1,0!==this.radiiSquared.z&&(this.squaredXOverSquaredZ=this.radiiSquared.x/this.radiiSquared.z),Object.freeze(this)}return Object(a.a)(t,null,[{key:"WGS84",get:function(){return M=M||new t(6378137,6378137,6356752.314245179)}}]),Object(a.a)(t,[{key:"equals",value:function(t){return this===t||Boolean(t&&this.radii.equals(t.radii))}},{key:"toString",value:function(){return this.radii.toString()}},{key:"cartographicToCartesian",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],n=C,i=R,a=Object(r.a)(t,3),o=a[2];this.geodeticSurfaceNormalCartographic(t,n),i.copy(this.radiiSquared).scale(n);var s=Math.sqrt(n.dot(i));return i.scale(1/s),n.scale(o),i.add(n),i.to(e)}},{key:"cartesianToCartographic",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];I.from(t);var n=this.scaleToGeodeticSurface(I,L);if(n){var r=this.geodeticSurfaceNormal(n,C),i=N;i.copy(I).subtract(n);var a=Math.atan2(r.y,r.x),o=Math.asin(r.z),s=Math.sign(h.d(i,I))*h.g(i);return m([a,o,s],e)}}},{key:"eastNorthUpToFixedFrame",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new u.a;return P(this,"east","north","up",t,e)}},{key:"localFrameToFixedFrame",value:function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new u.a;return P(this,t,e,n,r,i)}},{key:"geocentricSurfaceNormal",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return x.from(t).normalize().to(e)}},{key:"geodeticSurfaceNormalCartographic",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],n=v(t),r=n[0],i=n[1],a=Math.cos(i);return x.set(a*Math.cos(r),a*Math.sin(r),Math.sin(i)).normalize(),x.to(e)}},{key:"geodeticSurfaceNormal",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return x.from(t).scale(this.oneOverRadiiSquared).normalize().to(e)}},{key:"scaleToGeodeticSurface",value:function(t,e){return function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new o.a,r=e.oneOverRadii,i=e.oneOverRadiiSquared,a=e.centerToleranceSquared;g.from(t);var s=t.x,u=t.y,l=t.z,h=r.x,f=r.y,p=r.z,d=s*s*h*h,v=u*u*f*f,y=l*l*p*p,m=d+v+y,_=Math.sqrt(1/m);if(Number.isFinite(_)){var j=b;if(j.copy(t).scale(_),m<a)return j.to(n);var w=i.x,S=i.y,T=i.z,k=O;k.set(j.x*w*2,j.y*S*2,j.z*T*2);var E,P,M,x,C=(1-_)*t.len()/(.5*k.len()),R=0;do{var L=(E=1/(1+(C-=R)*w))*E,N=(P=1/(1+C*S))*P,I=(M=1/(1+C*T))*M,A=L*E,D=N*P,z=I*M,U=d*A*w+v*D*S+y*z*T,V=-2*U;R=(x=d*L+v*N+y*I-1)/V}while(Math.abs(x)>c.a.EPSILON12);return g.scale([E,P,M]).to(n)}}(t,this,e)}},{key:"scaleToGeocentricSurface",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];L.from(t);var n=L.x,r=L.y,i=L.z,a=this.oneOverRadiiSquared,o=1/Math.sqrt(n*n*a.x+r*r*a.y+i*i*a.z);return L.multiplyScalar(o).to(e)}},{key:"transformPositionToScaledSpace",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return L.from(t).scale(this.oneOverRadii).to(e)}},{key:"transformPositionFromScaledSpace",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return L.from(t).scale(this.radii).to(e)}},{key:"getSurfaceNormalIntersectionWithZAxis",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0,0];Object(s.a)(Object(l.c)(this.radii.x,this.radii.y,c.a.EPSILON15)),Object(s.a)(this.radii.z>0),L.from(t);var r=L.z*(1-this.squaredXOverSquaredZ);if(!(Math.abs(r)>=this.radii.z-e))return L.set(0,0,r).to(n)}}]),t}()},O6hP:function(t,e,n){"use strict";n.d(e,"d",(function(){return r})),n.d(e,"e",(function(){return i})),n.d(e,"f",(function(){return a})),n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return c}));var r={UNLOADED:0,LOADING:1,PROCESSING:2,READY:3,EXPIRED:4,FAILED:5},i={ADD:1,REPLACE:2},a={EMPTY:"empty",SCENEGRAPH:"scenegraph",POINTCLOUD:"pointcloud",MESH:"mesh"},o={I3S:"I3S",TILES3D:"TILES3D"},s={GEOMETRIC_ERROR:"geometricError",MAX_SCREEN_THRESHOLD:"maxScreenThreshold"},c={NOT_COMPUTED:-1,USE_OPTIMIZATION:1,SKIP_OPTIMIZATION:0}},OyGM:function(t,e,n){"use strict";(function(t){function r(){var e;if("undefined"!=typeof window&&window.performance)e=window.performance.now();else if(void 0!==t&&t.hrtime){var n=t.hrtime();e=1e3*n[0]+n[1]/1e6}else e=Date.now();return e}n.d(e,"a",(function(){return r}))}).call(this,n("8oxB"))},SDD5:function(t,e,n){"use strict";n.d(e,"a",(function(){return v}));var r=n("1OyB"),i=n("md7G"),a=n("foSv"),o=n("vuIU"),s=n("Ji7U"),c=n("HHP4"),u=n("yeNo"),l=n("fOPP"),h=n("MTwu"),f=n("vtVt"),p=[0,0,0],d={},v=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Object(r.a)(this,e),t=Object(i.a)(this,Object(a.a)(e).call(this,-0,-0,-0)),1===arguments.length&&Object(u.f)(n)?t.copy(n):(u.b.debug&&(Object(l.a)(n),Object(l.a)(o),Object(l.a)(s)),t[0]=n,t[1]=o,t[2]=s),t}return Object(s.a)(e,t),Object(o.a)(e,null,[{key:"ZERO",get:function(){return d.ZERO=d.ZERO||Object.freeze(new e(0,0,0,0))}}]),Object(o.a)(e,[{key:"set",value:function(t,e,n){return this[0]=t,this[1]=e,this[2]=n,this.check()}},{key:"copy",value:function(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}},{key:"fromObject",value:function(t){return u.b.debug&&(Object(l.a)(t.x),Object(l.a)(t.y),Object(l.a)(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}},{key:"toObject",value:function(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}},{key:"angle",value:function(t){return h.a(this,t)}},{key:"cross",value:function(t){return h.c(this,this,t),this.check()}},{key:"rotateX",value:function(t){var e=t.radians,n=t.origin,r=void 0===n?p:n;return h.h(this,this,r,e),this.check()}},{key:"rotateY",value:function(t){var e=t.radians,n=t.origin,r=void 0===n?p:n;return h.i(this,this,r,e),this.check()}},{key:"rotateZ",value:function(t){var e=t.radians,n=t.origin,r=void 0===n?p:n;return h.j(this,this,r,e),this.check()}},{key:"transform",value:function(t){return this.transformAsPoint(t)}},{key:"transformAsPoint",value:function(t){return h.l(this,this,t),this.check()}},{key:"transformAsVector",value:function(t){return Object(f.c)(this,this,t),this.check()}},{key:"transformByMatrix3",value:function(t){return h.k(this,this,t),this.check()}},{key:"transformByMatrix2",value:function(t){return Object(f.b)(this,this,t),this.check()}},{key:"transformByQuaternion",value:function(t){return h.m(this,this,t),this.check()}},{key:"ELEMENTS",get:function(){return 3}},{key:"z",get:function(){return this[2]},set:function(t){this[2]=Object(l.a)(t)}}]),e}(c.a)},T27a:function(t,e,n){"use strict";n.d(e,"a",(function(){return g}));var r=n("1OyB"),i=n("md7G"),a=n("foSv"),o=n("vuIU"),s=n("Ji7U"),c=n("8CAv"),u=n("fOPP"),l=n("vtVt"),h=n("GSm6"),f=n("umh7"),p=n("MTwu"),d=Object.freeze([1,0,0,0,1,0,0,0,1]),v=Object.freeze([0,0,0,0,0,0,0,0,0]),y=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL1ROW0:3,COL1ROW1:4,COL1ROW2:5,COL2ROW0:6,COL2ROW1:7,COL2ROW2:8}),m={},g=function(t){function e(t){var n;return Object(r.a)(this,e),n=Object(i.a)(this,Object(a.a)(e).call(this,-0,-0,-0,-0,-0,-0,-0,-0,-0)),1===arguments.length&&Array.isArray(t)?n.copy(t):n.identity(),n}return Object(s.a)(e,t),Object(o.a)(e,[{key:"ELEMENTS",get:function(){return 9}},{key:"RANK",get:function(){return 3}},{key:"INDICES",get:function(){return y}}],[{key:"IDENTITY",get:function(){return m.IDENTITY=m.IDENTITY||Object.freeze(new e(d)),m.IDENTITY}},{key:"ZERO",get:function(){return m.ZERO=m.ZERO||Object.freeze(new e(v)),m.ZERO}}]),Object(o.a)(e,[{key:"copy",value:function(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this.check()}},{key:"set",value:function(t,e,n,r,i,a,o,s,c){return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this[4]=i,this[5]=a,this[6]=o,this[7]=s,this[8]=c,this.check()}},{key:"setRowMajor",value:function(t,e,n,r,i,a,o,s,c){return this[0]=t,this[1]=r,this[2]=o,this[3]=e,this[4]=i,this[5]=s,this[6]=n,this[7]=a,this[8]=c,this.check()}},{key:"determinant",value:function(){return h.b(this)}},{key:"identity",value:function(){return this.copy(d)}},{key:"fromQuaternion",value:function(t){return h.c(this,t),this.check()}},{key:"transpose",value:function(){return h.i(this,this),this.check()}},{key:"invert",value:function(){return h.d(this,this),this.check()}},{key:"multiplyLeft",value:function(t){return h.e(this,t,this),this.check()}},{key:"multiplyRight",value:function(t){return h.e(this,this,t),this.check()}},{key:"rotate",value:function(t){return h.f(this,this,t),this.check()}},{key:"scale",value:function(t){return Array.isArray(t)?h.g(this,this,t):h.g(this,this,[t,t,t]),this.check()}},{key:"translate",value:function(t){return h.h(this,this,t),this.check()}},{key:"transform",value:function(t,e){switch(t.length){case 2:e=f.c(e||[-0,-0],t,this);break;case 3:e=p.k(e||[-0,-0,-0],t,this);break;case 4:e=Object(l.d)(e||[-0,-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Object(u.b)(e,t.length),e}},{key:"transformVector",value:function(t,e){return Object(u.c)("Matrix3.transformVector"),this.transform(t,e)}},{key:"transformVector2",value:function(t,e){return Object(u.c)("Matrix3.transformVector"),this.transform(t,e)}},{key:"transformVector3",value:function(t,e){return Object(u.c)("Matrix3.transformVector"),this.transform(t,e)}}]),e}(c.a)},UP1k:function(t,e,n){"use strict";function r(){return(r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}n.d(e,"a",(function(){return ut}));var i=n("1OyB"),a=n("JX7q"),o=n("vuIU"),s=n("Ji7U"),c=n("md7G"),u=n("foSv"),l=n("rePB"),h=n("q1tI"),f=n("17x9"),p=n.n(f);function d(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?d(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function y(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(!t)return;if("string"==typeof t)return m(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(t,e)}(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,a=!0,o=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return a=t.done,t},e:function(t){o=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(o)throw i}}}}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var g=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function b(t){if(!t)return null;if("string"==typeof t)return t;t.toJS&&(t=t.toJS());var e,n={},r=y(t.layers);try{for(r.s();!(e=r.n()).done;){var i=e.value;n[i.id]=i}}catch(o){r.e(o)}finally{r.f()}var a=t.layers.map((function(t){var e=n[t.ref],r=null;if("interactive"in t&&delete(r=v({},t)).interactive,e){delete(r=r||v({},t)).ref;var i,a=y(g);try{for(a.s();!(i=a.n()).done;){var s=i.value;s in e&&(r[s]=e[s])}}catch(o){a.e(o)}finally{a.f()}}return r||t}));return v(v({},t),{},{layers:a})}var O=n("v88f"),_=n("jYz7"),j=n("6pOq"),w=n("4ZJM"),S=n.n(w),T=n("ODXe");function k(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function E(t,e){if(t===e)return!0;if(k(t)&&k(e)){if(t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!E(t[n],e[n]))return!1;return!0}return Math.abs(t-e)<=1e-7}function P(t,e,n){return Math.max(e,Math.min(n,t))}function M(t,e,n){return k(t)?t.map((function(t,r){return M(t,e[r],n)})):n*e+(1-n)*t}function x(t,e){if(!t)throw new Error(e||"react-map-gl: assertion failed.")}function C(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(!t)return;if("string"==typeof t)return R(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return R(t,e)}(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,a=!0,o=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return a=t.done,t},e:function(t){o=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(o)throw i}}}}function R(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var L=function(){function t(){Object(i.a)(this,t),Object(l.a)(this,"propNames",[])}return Object(o.a)(t,[{key:"arePropsEqual",value:function(t,e){var n,r=C(this.propNames||[]);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!E(t[i],e[i]))return!1}}catch(a){r.e(a)}finally{r.f()}return!0}},{key:"initializeProps",value:function(t,e){return{start:t,end:e}}},{key:"interpolateProps",value:function(t,e,n){x(!1,"interpolateProps is not implemented")}},{key:"getDuration",value:function(t,e){return e.transitionDuration}}]),t}(),N={longitude:1,bearing:1};function I(t){return Number.isFinite(t)||Array.isArray(t)}function A(t,e,n){return function(t){return t in N}(t)&&Math.abs(n-e)>180&&(n=n<0?n+360:n-360),n}function D(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(!t)return;if("string"==typeof t)return z(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return z(t,e)}(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,a=!0,o=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return a=t.done,t},e:function(t){o=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(o)throw i}}}}function z(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function U(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Object(u.a)(t);if(e){var i=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var V=["longitude","latitude","zoom","bearing","pitch"],B=["latitude","longitude","zoom","width","height"],F=["bearing","pitch"],q={speed:1.2,curve:1.414};!function(t){Object(s.a)(n,t);var e=U(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i.a)(this,n),t=e.call(this),Object(l.a)(Object(a.a)(t),"speed",void 0),Object(l.a)(Object(a.a)(t),"propNames",V),Object(l.a)(Object(a.a)(t),"props",void 0),t.props=Object.assign({},q,r),t}Object(o.a)(n,[{key:"initializeProps",value:function(t,e){var n,r={},i={},a=D(B);try{for(a.s();!(n=a.n()).done;){var o=n.value,s=t[o],c=e[o];x(I(s)&&I(c),"".concat(o," must be supplied for transition")),r[o]=s,i[o]=A(o,s,c)}}catch(d){a.e(d)}finally{a.f()}var u,l=D(F);try{for(l.s();!(u=l.n()).done;){var h=u.value,f=t[h]||0,p=e[h]||0;r[h]=f,i[h]=A(h,f,p)}}catch(d){l.e(d)}finally{l.f()}return{start:r,end:i}}},{key:"interpolateProps",value:function(t,e,n){var r,i=Object(O.d)(t,e,n,this.props),a=D(F);try{for(a.s();!(r=a.n()).done;){var o=r.value;i[o]=M(t[o],e[o],n)}}catch(s){a.e(s)}finally{a.f()}return i}},{key:"getDuration",value:function(t,e){var n=e.transitionDuration;return"auto"===n&&(n=Object(O.g)(t,e,this.props)),n}}])}(L);function G(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(!t)return;if("string"==typeof t)return H(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return H(t,e)}(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,a=!0,o=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return a=t.done,t},e:function(t){o=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(o)throw i}}}}function H(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Z(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Object(u.a)(t);if(e){var i=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var W=["longitude","latitude","zoom","bearing","pitch"],Y=function(t){Object(s.a)(n,t);var e=Z(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i.a)(this,n),t=e.call(this),Object(l.a)(Object(a.a)(t),"around",void 0),Array.isArray(r)&&(r={transitionProps:r}),t.propNames=r.transitionProps||W,r.around&&(t.around=r.around),t}return Object(o.a)(n,[{key:"initializeProps",value:function(t,e){var n={},r={};if(this.around){n.around=this.around;var i=new O.a(t).unproject(this.around);Object.assign(r,e,{around:new O.a(e).project(i),aroundLngLat:i})}var a,o=G(this.propNames);try{for(o.s();!(a=o.n()).done;){var s=a.value,c=t[s],u=e[s];x(I(c)&&I(u),"".concat(s," must be supplied for transition")),n[s]=c,r[s]=A(s,c,u)}}catch(l){o.e(l)}finally{o.f()}return{start:n,end:r}}},{key:"interpolateProps",value:function(t,e,n){var r,i={},a=G(this.propNames);try{for(a.s();!(r=a.n()).done;){var o=r.value;i[o]=M(t[o],e[o],n)}}catch(h){a.e(h)}finally{a.f()}if(e.around){var s=new O.a(Object.assign({},e,i)).getMapCenterByLngLatPosition({lngLat:e.aroundLngLat,pos:M(t.around,e.around,n)}),c=Object(T.a)(s,2),u=c[0],l=c[1];i.longitude=u,i.latitude=l}return i}}]),n}(L),K={minZoom:0,maxZoom:24,minPitch:0,maxPitch:60},Q=0,J=0,X=1.5,$=function(){function t(e){var n=e.width,r=e.height,a=e.latitude,o=e.longitude,s=e.zoom,c=e.bearing,u=void 0===c?J:c,h=e.pitch,f=void 0===h?Q:h,p=e.altitude,d=void 0===p?X:p,v=e.maxZoom,y=void 0===v?K.maxZoom:v,m=e.minZoom,g=void 0===m?K.minZoom:m,b=e.maxPitch,O=void 0===b?K.maxPitch:b,_=e.minPitch,j=void 0===_?K.minPitch:_,w=e.transitionDuration,S=e.transitionEasing,T=e.transitionInterpolator,k=e.transitionInterruption,E=e.startPanLngLat,P=e.startZoomLngLat,M=e.startBearing,C=e.startPitch,R=e.startZoom;Object(i.a)(this,t),Object(l.a)(this,"_viewportProps",void 0),Object(l.a)(this,"_interactiveState",void 0),x(Number.isFinite(n),"`width` must be supplied"),x(Number.isFinite(r),"`height` must be supplied"),x(Number.isFinite(o),"`longitude` must be supplied"),x(Number.isFinite(a),"`latitude` must be supplied"),x(Number.isFinite(s),"`zoom` must be supplied"),this._viewportProps=this._applyConstraints({width:n,height:r,latitude:a,longitude:o,zoom:s,bearing:u,pitch:f,altitude:d,maxZoom:y,minZoom:g,maxPitch:O,minPitch:j,transitionDuration:w,transitionEasing:S,transitionInterpolator:T,transitionInterruption:k}),this._interactiveState={startPanLngLat:E,startZoomLngLat:P,startBearing:M,startPitch:C,startZoom:R}}return Object(o.a)(t,[{key:"getViewportProps",value:function(){return this._viewportProps}},{key:"getInteractiveState",value:function(){return this._interactiveState}},{key:"panStart",value:function(t){var e=t.pos;return this._getUpdatedMapState({startPanLngLat:this._unproject(e)})}},{key:"pan",value:function(t){var e=t.pos,n=t.startPos,r=this._interactiveState.startPanLngLat||this._unproject(n);if(!r)return this;var i=this._calculateNewLngLat({startPanLngLat:r,pos:e}),a=Object(T.a)(i,2),o=a[0],s=a[1];return this._getUpdatedMapState({longitude:o,latitude:s})}},{key:"panEnd",value:function(){return this._getUpdatedMapState({startPanLngLat:null})}},{key:"rotateStart",value:function(t){t.pos;return this._getUpdatedMapState({startBearing:this._viewportProps.bearing,startPitch:this._viewportProps.pitch})}},{key:"rotate",value:function(t){var e=t.deltaScaleX,n=void 0===e?0:e,r=t.deltaScaleY,i=void 0===r?0:r,a=this._interactiveState,o=a.startBearing,s=a.startPitch;if(!Number.isFinite(o)||!Number.isFinite(s))return this;var c=this._calculateNewPitchAndBearing({deltaScaleX:n,deltaScaleY:i,startBearing:o||0,startPitch:s||0}),u=c.pitch,l=c.bearing;return this._getUpdatedMapState({bearing:l,pitch:u})}},{key:"rotateEnd",value:function(){return this._getUpdatedMapState({startBearing:null,startPitch:null})}},{key:"zoomStart",value:function(t){var e=t.pos;return this._getUpdatedMapState({startZoomLngLat:this._unproject(e),startZoom:this._viewportProps.zoom})}},{key:"zoom",value:function(t){var e=t.pos,n=t.startPos,r=t.scale;x(r>0,"`scale` must be a positive number");var i=this._interactiveState,a=i.startZoom,o=i.startZoomLngLat;Number.isFinite(a)||(a=this._viewportProps.zoom,o=this._unproject(n)||this._unproject(e)),x(o,"`startZoomLngLat` prop is required for zoom behavior to calculate where to position the map.");var s=this._calculateNewZoom({scale:r,startZoom:a||0}),c=new O.a(Object.assign({},this._viewportProps,{zoom:s})).getMapCenterByLngLatPosition({lngLat:o,pos:e}),u=Object(T.a)(c,2),l=u[0],h=u[1];return this._getUpdatedMapState({zoom:s,longitude:l,latitude:h})}},{key:"zoomEnd",value:function(){return this._getUpdatedMapState({startZoomLngLat:null,startZoom:null})}},{key:"_getUpdatedMapState",value:function(e){return new t(Object.assign({},this._viewportProps,this._interactiveState,e))}},{key:"_applyConstraints",value:function(t){var e=t.maxZoom,n=t.minZoom,r=t.zoom;t.zoom=P(r,n,e);var i=t.maxPitch,a=t.minPitch,o=t.pitch;return t.pitch=P(o,a,i),Object.assign(t,Object(O.l)(t)),t}},{key:"_unproject",value:function(t){var e=new O.a(this._viewportProps);return t&&e.unproject(t)}},{key:"_calculateNewLngLat",value:function(t){var e=t.startPanLngLat,n=t.pos;return new O.a(this._viewportProps).getMapCenterByLngLatPosition({lngLat:e,pos:n})}},{key:"_calculateNewZoom",value:function(t){var e=t.scale,n=t.startZoom,r=this._viewportProps,i=r.maxZoom,a=r.minZoom;return P(n+Math.log2(e),a,i)}},{key:"_calculateNewPitchAndBearing",value:function(t){var e=t.deltaScaleX,n=t.deltaScaleY,r=t.startBearing,i=t.startPitch;n=P(n,-1,1);var a=this._viewportProps,o=a.minPitch,s=a.maxPitch,c=i;return n>0?c=i+n*(s-i):n<0&&(c=i-n*(o-i)),{pitch:c,bearing:r+180*e}}}]),t}();function tt(t){return t[0].toLowerCase()+t.slice(1)}var et=Object(h.createContext)({viewport:null,map:null,mapContainer:null,onViewportChange:null,onViewStateChange:null,eventManager:null,isDragging:!1});function nt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function rt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?nt(Object(n),!0).forEach((function(e){Object(l.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):nt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function it(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Object(u.a)(t);if(e){var i=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var at="A valid API access token is required to use Mapbox data";var ot={position:"absolute",width:"100%",height:"100%",overflow:"hidden"},st=Object.assign({},j.a.propTypes,{width:p.a.oneOfType([p.a.number,p.a.string]),height:p.a.oneOfType([p.a.number,p.a.string]),onResize:p.a.func,preventStyleDiffing:p.a.bool,disableTokenWarning:p.a.bool,visible:p.a.bool,className:p.a.string,style:p.a.object,visibilityConstraints:p.a.object}),ct=Object.assign({},j.a.defaultProps,{preventStyleDiffing:!1,disableTokenWarning:!1,visible:!0,onResize:function(){},className:"",style:null,visibilityConstraints:K}),ut=function(t){Object(s.a)(n,t);var e=it(n);function n(){var t;Object(i.a)(this,n);for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return t=e.call.apply(e,[this].concat(o)),Object(l.a)(Object(a.a)(t),"state",{accessTokenInvalid:!1}),Object(l.a)(Object(a.a)(t),"_mapbox",null),Object(l.a)(Object(a.a)(t),"_map",null),Object(l.a)(Object(a.a)(t),"_mapboxMapRef",Object(h.createRef)()),Object(l.a)(Object(a.a)(t),"_mapContainerRef",Object(h.createRef)()),Object(l.a)(Object(a.a)(t),"_queryParams",{}),Object(l.a)(Object(a.a)(t),"_width",0),Object(l.a)(Object(a.a)(t),"_height",0),Object(l.a)(Object(a.a)(t),"getMap",(function(){return t._map})),Object(l.a)(Object(a.a)(t),"queryRenderedFeatures",(function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t._map.queryRenderedFeatures(e,n)})),Object(l.a)(Object(a.a)(t),"_mapboxMapError",(function(e){401!==(e.error&&e.error.status||e.status)||t.state.accessTokenInvalid||(console.error(at),t.setState({accessTokenInvalid:!0})),t.props.onError(e)})),t}return Object(o.a)(n,[{key:"componentDidMount",value:function(){if(n.supported()){var t=this.props.mapStyle;this._mapbox=new j.a(Object.assign({},this.props,{mapboxgl:S.a,width:this._width,height:this._height,container:this._mapboxMapRef.current,onError:this._mapboxMapError,mapStyle:b(t)})),this._map=this._mapbox.getMap()}}},{key:"componentDidUpdate",value:function(t){this._mapbox&&(this._updateMapStyle(t,this.props),this._updateMapProps(this.props))}},{key:"componentWillUnmount",value:function(){this._mapbox&&(this._mapbox.finalize(),this._mapbox=null,this._map=null)}},{key:"_updateMapSize",value:function(t,e){this._width===t&&this._height===e||(this._width=t,this._height=e,this._updateMapProps(this.props))}},{key:"_updateMapStyle",value:function(t,e){var n=e.mapStyle;n!==t.mapStyle&&n&&this._map.setStyle(b(n),{diff:!this.props.preventStyleDiffing})}},{key:"_updateMapProps",value:function(t){this._mapbox&&this._mapbox.setProps(Object.assign({},t,{width:this._width,height:this._height}))}},{key:"_renderNoTokenWarning",value:function(){if(this.state.accessTokenInvalid&&!this.props.disableTokenWarning){return h.createElement("div",{key:"warning",id:"no-token-warning",style:{position:"absolute",left:0,top:0}},h.createElement("h3",{key:"header"},"NO_TOKEN_WARNING"),h.createElement("div",{key:"text"},"For information on setting up your basemap, read"),h.createElement("a",{key:"link",href:"https://visgl.github.io/react-map-gl/docs/get-started/mapbox-tokens"},"Note on Map Tokens"))}return null}},{key:"_renderOverlays",value:function(t){var e=this,n=t.width,r=void 0===n?Number(this.props.width):n,i=t.height,a=void 0===i?Number(this.props.height):i;return this._updateMapSize(r,a),h.createElement(et.Consumer,null,(function(t){var n=rt(rt({},t),{},{viewport:new O.a(rt(rt(rt({},e.props),e.props.viewState),{},{width:r,height:a})),map:e._map,mapContainer:t.mapContainer||e._mapContainerRef.current});return h.createElement(et.Provider,{value:n},h.createElement("div",{key:"map-overlays",className:"overlays",style:ot},e.props.children))}))}},{key:"render",value:function(){var t=this.props,e=t.className,n=t.width,r=t.height,i=t.style,a=t.visibilityConstraints,o=Object.assign({position:"relative"},i,{width:n,height:r}),s=this.props.visible&&function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:K;for(var n in e){var r=n.slice(0,3),i=tt(n.slice(3));if("min"===r&&t[i]<e[n])return!1;if("max"===r&&t[i]>e[n])return!1}return!0}(this.props.viewState||this.props,a),c=Object.assign({},ot,{visibility:s?"inherit":"hidden"});return h.createElement("div",{key:"map-container",style:o,ref:this._mapContainerRef},h.createElement("div",{key:"map-mapbox",ref:this._mapboxMapRef,style:c,className:e}),h.createElement(_.a,{key:"autosizer",disableWidth:Number.isFinite(n),disableHeight:Number.isFinite(r),onResize:this.props.onResize},this._renderOverlays.bind(this)),this._renderNoTokenWarning())}}],[{key:"supported",value:function(){return S.a&&S.a.supported()}}]),n}(h.PureComponent);Object(l.a)(ut,"propTypes",st),Object(l.a)(ut,"defaultProps",ct);var lt=function(){};var ht=1,ft=2,pt=3,dt=4,vt={transitionDuration:0,transitionEasing:function(t){return t},transitionInterpolator:new Y,transitionInterruption:ht,onTransitionStart:lt,onTransitionInterrupt:lt,onTransitionEnd:lt,onViewportChange:lt,onStateChange:lt},yt=function(){function t(e,n){var r=this;Object(i.a)(this,t),Object(l.a)(this,"props",void 0),Object(l.a)(this,"state",void 0),Object(l.a)(this,"time",void 0),Object(l.a)(this,"_animationFrame",null),Object(l.a)(this,"_onTransitionFrame",(function(){r._animationFrame=requestAnimationFrame(r._onTransitionFrame),r._updateViewport()})),e&&(this.props=e),this.time=n||Date.now}return Object(o.a)(t,[{key:"getViewportInTransition",value:function(){return this._animationFrame?this.state.propsInTransition:null}},{key:"processViewportChange",value:function(t){var e=this.props;if(this.props=t,this._shouldIgnoreViewportChange(e,t))return!1;if(this._isTransitionEnabled(t)){var n=Object.assign({},e),r=Object.assign({},t);if(this._isTransitionInProgress()&&(e.onTransitionInterrupt(),this.state.interruption===ft?Object.assign(n,this.state.endProps):Object.assign(n,this.state.propsInTransition),this.state.interruption===dt)){var i=this.time(),a=(i-this.state.startTime)/this.state.duration;r.transitionDuration=this.state.duration-(i-this.state.startTime),r.transitionEasing=function(t,e){var n=t(e);return function(r){return 1/(1-n)*(t(r*(1-e)+e)-n)}}(this.state.easing,a),r.transitionInterpolator=n.transitionInterpolator}return r.onTransitionStart(),this._triggerTransition(n,r),!0}return this._isTransitionInProgress()&&(e.onTransitionInterrupt(),this._endTransition()),!1}},{key:"_isTransitionInProgress",value:function(){return Boolean(this._animationFrame)}},{key:"_isTransitionEnabled",value:function(t){var e=t.transitionDuration,n=t.transitionInterpolator;return(e>0||"auto"===e)&&Boolean(n)}},{key:"_isUpdateDueToCurrentTransition",value:function(t){return!!this.state.propsInTransition&&this.state.interpolator.arePropsEqual(t,this.state.propsInTransition)}},{key:"_shouldIgnoreViewportChange",value:function(t,e){return!t||(this._isTransitionInProgress()?this.state.interruption===pt||this._isUpdateDueToCurrentTransition(e):!this._isTransitionEnabled(e)||e.transitionInterpolator.arePropsEqual(t,e))}},{key:"_triggerTransition",value:function(t,e){x(this._isTransitionEnabled(e)),this._animationFrame&&cancelAnimationFrame(this._animationFrame);var n=e.transitionInterpolator,r=n.getDuration?n.getDuration(t,e):e.transitionDuration;if(0!==r){var i=e.transitionInterpolator.initializeProps(t,e),a={inTransition:!0,isZooming:t.zoom!==e.zoom,isPanning:t.longitude!==e.longitude||t.latitude!==e.latitude,isRotating:t.bearing!==e.bearing||t.pitch!==e.pitch};this.state={duration:r,easing:e.transitionEasing,interpolator:e.transitionInterpolator,interruption:e.transitionInterruption,startTime:this.time(),startProps:i.start,endProps:i.end,animation:null,propsInTransition:{},interactionState:a},this._onTransitionFrame(),this.props.onStateChange(a)}}},{key:"_endTransition",value:function(){this._animationFrame&&(cancelAnimationFrame(this._animationFrame),this._animationFrame=null),this.props.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1})}},{key:"_updateViewport",value:function(){var t=this.time(),e=this.state,n=e.startTime,r=e.duration,i=e.easing,a=e.interpolator,o=e.startProps,s=e.endProps,c=!1,u=(t-n)/r;u>=1&&(u=1,c=!0),u=i(u);var l=a.interpolateProps(o,s,u),h=new $(Object.assign({},this.props,l));this.state.propsInTransition=h.getViewportProps(),this.props.onViewportChange(this.state.propsInTransition,this.state.interactionState,this.props),c&&(this._endTransition(),this.props.onTransitionEnd())}}]),t}();Object(l.a)(yt,"defaultProps",vt);var mt=n("ei+1");var gt={transitionDuration:0},bt={transitionDuration:300,transitionEasing:function(t){return t},transitionInterpolator:new Y,transitionInterruption:ht},Ot=["wheel"],_t=["panstart","panmove","panend"],jt=["pinchstart","pinchmove","pinchend","pinchcancel"],wt=["doubletap"],St=["keydown"],Tt=function(){function t(){var e=this;Object(i.a)(this,t),Object(l.a)(this,"events",[]),Object(l.a)(this,"mapState",void 0),Object(l.a)(this,"onViewportChange",void 0),Object(l.a)(this,"onStateChange",void 0),Object(l.a)(this,"mapStateProps",void 0),Object(l.a)(this,"eventManager",void 0),Object(l.a)(this,"scrollZoom",!0),Object(l.a)(this,"dragPan",!0),Object(l.a)(this,"dragRotate",!0),Object(l.a)(this,"doubleClickZoom",!0),Object(l.a)(this,"touchZoom",!0),Object(l.a)(this,"touchRotate",!1),Object(l.a)(this,"keyboard",!0),Object(l.a)(this,"_state",{isDragging:!1}),Object(l.a)(this,"_events",{}),Object(l.a)(this,"_transitionManager",new yt),Object(l.a)(this,"setState",(function(t){Object.assign(e._state,t),e.onStateChange&&e.onStateChange(e._state)})),this.handleEvent=this.handleEvent.bind(this),this._onWheelEnd=function(t,e){var n,r,i,a=function(){return i=null,t.apply(n,r)};return function(){n=this,r=arguments,i&&clearTimeout(i),i=setTimeout(a,e)}}(this._onWheelEnd,100)}return Object(o.a)(t,[{key:"handleEvent",value:function(t){switch(this.mapState=this.getMapState(),t.type){case"panstart":return this._onPanStart(t);case"panmove":return this._onPan(t);case"panend":return this._onPanEnd(t);case"pinchstart":return this._onPinchStart(t);case"pinchmove":return this._onPinch(t);case"pinchcancel":case"pinchend":return this._onPinchEnd(t);case"doubletap":return this._onDoubleTap(t);case"wheel":return this._onWheel(t);case"keydown":return this._onKeyDown(t);default:return!1}}},{key:"getCenter",value:function(t){var e=t.offsetCenter;return[e.x,e.y]}},{key:"isFunctionKeyPressed",value:function(t){var e=t.srcEvent;return Boolean(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}},{key:"updateViewport",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=this.mapState?this.mapState.getViewportProps():{},i=Object.assign({},t.getViewportProps(),e),a=Object.keys(i).some((function(t){return r[t]!==i[t]}));a&&this.onViewportChange(i,n,r),this.setState(Object.assign({},t.getInteractiveState(),n))}},{key:"getMapState",value:function(t){return new $(Object.assign({},this.mapStateProps,this._state,t))}},{key:"setOptions",value:function(t){var e=t.onViewportChange,n=t.onStateChange,r=t.eventManager,i=void 0===r?this.eventManager:r,a=t.isInteractive,o=void 0===a||a,s=t.scrollZoom,c=void 0===s?this.scrollZoom:s,u=t.dragPan,l=void 0===u?this.dragPan:u,h=t.dragRotate,f=void 0===h?this.dragRotate:h,p=t.doubleClickZoom,d=void 0===p?this.doubleClickZoom:p,v=t.touchZoom,y=void 0===v?this.touchZoom:v,m=t.touchRotate,g=void 0===m?this.touchRotate:m,b=t.keyboard,O=void 0===b?this.keyboard:b;this.onViewportChange=e,this.onStateChange=n;var _=!this.mapStateProps||this.mapStateProps.height!==t.height;this.mapStateProps=t,_&&this.updateViewport(new $(t)),this._transitionManager.processViewportChange(Object.assign({},t,{onStateChange:this.setState})),this.eventManager!==i&&(this.eventManager=i,this._events={},this.toggleEvents(this.events,!0)),this.toggleEvents(Ot,o&&c),this.toggleEvents(_t,o&&(l||f)),this.toggleEvents(jt,o&&(y||g)),this.toggleEvents(wt,o&&d),this.toggleEvents(St,o&&O),this.scrollZoom=c,this.dragPan=l,this.dragRotate=f,this.doubleClickZoom=d,this.touchZoom=y,this.touchRotate=g,this.keyboard=O}},{key:"toggleEvents",value:function(t,e){var n=this;this.eventManager&&t.forEach((function(t){n._events[t]!==e&&(n._events[t]=e,e?n.eventManager.on(t,n.handleEvent):n.eventManager.off(t,n.handleEvent))}))}},{key:"_onPanStart",value:function(t){var e=this.getCenter(t),n=this.mapState.panStart({pos:e}).rotateStart({pos:e});return this.updateViewport(n,gt,{isDragging:!0}),!0}},{key:"_onPan",value:function(t){return this.isFunctionKeyPressed(t)||t.rightButton?this._onPanRotate(t):this._onPanMove(t)}},{key:"_onPanEnd",value:function(t){var e=this.mapState.panEnd().rotateEnd();return this.updateViewport(e,null,{isDragging:!1,isPanning:!1,isRotating:!1}),!0}},{key:"_onPanMove",value:function(t){if(!this.dragPan)return!1;var e=this.getCenter(t),n=this.mapState.pan({pos:e});return this.updateViewport(n,gt,{isPanning:!0}),!0}},{key:"_onPanRotate",value:function(t){if(!this.dragRotate)return!1;var e=t.deltaX,n=t.deltaY,r=this.getCenter(t),i=Object(T.a)(r,2)[1],a=i-n,o=this.mapState.getViewportProps(),s=o.width,c=o.height,u=e/s,l=0;n>0?Math.abs(c-a)>5&&(l=n/(a-c)*1.2):n<0&&a>5&&(l=1-i/a),l=Math.min(1,Math.max(-1,l));var h=this.mapState.rotate({deltaScaleX:u,deltaScaleY:l});return this.updateViewport(h,gt,{isRotating:!0}),!0}},{key:"_onWheel",value:function(t){if(!this.scrollZoom)return!1;t.preventDefault();var e=this.getCenter(t),n=t.delta,r=2/(1+Math.exp(-Math.abs(.01*n)));n<0&&0!==r&&(r=1/r);var i=this.mapState.zoom({pos:e,scale:r});return this.updateViewport(i,gt,{isZooming:!0}),this._onWheelEnd(),!0}},{key:"_onWheelEnd",value:function(){this.setState({isZooming:!1})}},{key:"_onPinchStart",value:function(t){var e=this.getCenter(t),n=this.mapState.zoomStart({pos:e}).rotateStart({pos:e});return this._state.startPinchRotation=t.rotation,this.updateViewport(n,gt,{isDragging:!0}),!0}},{key:"_onPinch",value:function(t){if(!this.touchZoom&&!this.touchRotate)return!1;var e=this.mapState;if(this.touchZoom){var n=t.scale,r=this.getCenter(t);e=e.zoom({pos:r,scale:n})}if(this.touchRotate){var i=t.rotation,a=this._state.startPinchRotation;e=e.rotate({deltaScaleX:-(i-a)/180})}return this.updateViewport(e,gt,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),!0}},{key:"_onPinchEnd",value:function(t){var e=this.mapState.zoomEnd().rotateEnd();return this._state.startPinchRotation=0,this.updateViewport(e,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1}),!0}},{key:"_onDoubleTap",value:function(t){if(!this.doubleClickZoom)return!1;var e=this.getCenter(t),n=this.isFunctionKeyPressed(t),r=this.mapState.zoom({pos:e,scale:n?.5:2});return this.updateViewport(r,Object.assign({},bt,{transitionInterpolator:new Y({around:e})}),{isZooming:!0}),!0}},{key:"_onKeyDown",value:function(t){if(!this.keyboard)return!1;var e,n=this.isFunctionKeyPressed(t),r=this.mapStateProps;switch(t.srcEvent.keyCode){case 189:e=n?this.getMapState({zoom:r.zoom-2}):this.getMapState({zoom:r.zoom-1});break;case 187:e=n?this.getMapState({zoom:r.zoom+2}):this.getMapState({zoom:r.zoom+1});break;case 37:e=n?this.getMapState({bearing:r.bearing-15}):this.mapState.pan({pos:[100,0],startPos:[0,0]});break;case 39:e=n?this.getMapState({bearing:r.bearing+15}):this.mapState.pan({pos:[-100,0],startPos:[0,0]});break;case 38:e=n?this.getMapState({pitch:r.pitch+10}):this.mapState.pan({pos:[0,100],startPos:[0,0]});break;case 40:e=n?this.getMapState({pitch:r.pitch-10}):this.mapState.pan({pos:[0,-100],startPos:[0,0]});break;default:return!1}return this.updateViewport(e,bt)}}]),t}(),kt=[{old:"onChangeViewport",new:"onViewportChange"},{old:"perspectiveEnabled",new:"dragRotate"},{old:"onHoverFeatures",new:"onHover"},{old:"onClickFeatures",new:"onClick"},{old:"touchZoomRotate",new:"touchZoom, touchRotate"},{old:"mapControls",new:"controller"}];function Et(t){return"react-map-gl: `".concat(t,"` is removed.")}function Pt(t){return"Use `".concat(t,"` instead.")}function Mt(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};kt.forEach((function(e){if(t.hasOwnProperty(e.old)){var n=Et(e.old);e.new&&(n="".concat(n," ").concat(Pt(e.new))),console.warn(n)}}))}function xt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Object(u.a)(t);if(e){var i=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var Ct=Object.assign({},ut.propTypes,{maxZoom:p.a.number,minZoom:p.a.number,maxPitch:p.a.number,minPitch:p.a.number,onViewStateChange:p.a.func,onViewportChange:p.a.func,onInteractionStateChange:p.a.func,transitionDuration:p.a.oneOfType([p.a.number,p.a.string]),transitionInterpolator:p.a.object,transitionInterruption:p.a.number,transitionEasing:p.a.func,onTransitionStart:p.a.func,onTransitionInterrupt:p.a.func,onTransitionEnd:p.a.func,scrollZoom:p.a.bool,dragPan:p.a.bool,dragRotate:p.a.bool,doubleClickZoom:p.a.bool,touchZoom:p.a.bool,touchRotate:p.a.bool,keyboard:p.a.bool,onHover:p.a.func,onClick:p.a.func,onDblClick:p.a.func,onContextMenu:p.a.func,onMouseDown:p.a.func,onMouseMove:p.a.func,onMouseUp:p.a.func,onTouchStart:p.a.func,onTouchMove:p.a.func,onTouchEnd:p.a.func,onMouseEnter:p.a.func,onMouseLeave:p.a.func,onMouseOut:p.a.func,onWheel:p.a.func,touchAction:p.a.string,clickRadius:p.a.number,interactiveLayerIds:p.a.array,getCursor:p.a.func,controller:p.a.instanceOf(Tt)}),Rt=Object.assign({},ut.defaultProps,K,yt.defaultProps,{onViewStateChange:null,onViewportChange:null,onClick:null,onNativeClick:null,onHover:null,onContextMenu:function(t){return t.preventDefault()},scrollZoom:!0,dragPan:!0,dragRotate:!0,doubleClickZoom:!0,touchZoom:!0,touchRotate:!1,keyboard:!0,touchAction:"none",clickRadius:0,getCursor:function(t){var e=t.isDragging,n=t.isHovering;return e?"grabbing":n?"pointer":"grab"}}),Lt=function(t){Object(s.a)(n,t);var e=xt(n);function n(t){var r;return Object(i.a)(this,n),r=e.call(this,t),Object(l.a)(Object(a.a)(r),"state",{isLoaded:!1,isDragging:!1,isHovering:!1}),Object(l.a)(Object(a.a)(r),"_controller",void 0),Object(l.a)(Object(a.a)(r),"_eventManager",void 0),Object(l.a)(Object(a.a)(r),"_interactiveContext",void 0),Object(l.a)(Object(a.a)(r),"_width",0),Object(l.a)(Object(a.a)(r),"_height",0),Object(l.a)(Object(a.a)(r),"_eventCanvasRef",Object(h.createRef)()),Object(l.a)(Object(a.a)(r),"_staticMapRef",Object(h.createRef)()),Object(l.a)(Object(a.a)(r),"getMap",(function(){return r._staticMapRef.current?r._staticMapRef.current.getMap():null})),Object(l.a)(Object(a.a)(r),"queryRenderedFeatures",(function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.getMap();return n&&n.queryRenderedFeatures(t,e)})),Object(l.a)(Object(a.a)(r),"_onInteractionStateChange",(function(t){var e=t.isDragging,n=void 0!==e&&e;n!==r.state.isDragging&&(r._updateInteractiveContext({isDragging:n}),r.setState({isDragging:n}));var i=r.props.onInteractionStateChange;i&&i(t)})),Object(l.a)(Object(a.a)(r),"_onResize",(function(t){var e=t.width,n=t.height;r._width=e,r._height=n,r._setControllerProps(r.props),r.props.onResize({width:e,height:n})})),Object(l.a)(Object(a.a)(r),"_onViewportChange",(function(t,e,n){var i=r.props,a=i.onViewStateChange,o=i.onViewportChange;a&&a({viewState:t,interactionState:e,oldViewState:n}),o&&o(t,e,n)})),Object(l.a)(Object(a.a)(r),"_onLoad",(function(t){r.setState({isLoaded:!0}),r.props.onLoad(t)})),Object(l.a)(Object(a.a)(r),"_onEvent",(function(t,e){var n=r.props[t];n&&n(r._normalizeEvent(e))})),Object(l.a)(Object(a.a)(r),"_onPointerDown",(function(t){switch(t.pointerType){case"touch":r._onEvent("onTouchStart",t);break;default:r._onEvent("onMouseDown",t)}})),Object(l.a)(Object(a.a)(r),"_onPointerUp",(function(t){switch(t.pointerType){case"touch":r._onEvent("onTouchEnd",t);break;default:r._onEvent("onMouseUp",t)}})),Object(l.a)(Object(a.a)(r),"_onPointerMove",(function(t){switch(t.pointerType){case"touch":r._onEvent("onTouchMove",t);break;default:r._onEvent("onMouseMove",t)}if(!r.state.isDragging){var e,n=r.props,i=n.onHover,a=n.interactiveLayerIds;t=r._normalizeEvent(t),r.state.isLoaded&&(a||i)&&(e=r._getFeatures({pos:t.point,radius:r.props.clickRadius})),i&&(t.features=e,i(t));var o=Boolean(a&&e&&e.length>0),s=o&&!r.state.isHovering,c=!o&&r.state.isHovering;s&&r._onEvent("onMouseEnter",t),c&&r._onEvent("onMouseLeave",t),(s||c)&&r.setState({isHovering:o})}})),Object(l.a)(Object(a.a)(r),"_onClick",(function(t){var e=r.props,n=e.onClick,i=e.onNativeClick,a=e.onDblClick,o=e.doubleClickZoom,s=[],c=a||o;switch(t.type){case"anyclick":s.push(i),c||s.push(n);break;case"click":c&&s.push(n)}(s=s.filter(Boolean)).length&&((t=r._normalizeEvent(t)).features=r._getFeatures({pos:t.point,radius:r.props.clickRadius}),s.forEach((function(e){return e(t)})))})),Mt(t),r._controller=t.controller||new Tt,r._eventManager=new mt.a(null,{touchAction:t.touchAction}),r._updateInteractiveContext({isDragging:!1,eventManager:r._eventManager}),r}return Object(o.a)(n,null,[{key:"supported",value:function(){return ut.supported()}}]),Object(o.a)(n,[{key:"componentDidMount",value:function(){var t=this._eventManager,e=this._eventCanvasRef.current;t.setElement(e),t.on({pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerup:this._onPointerUp,pointerleave:this._onEvent.bind(this,"onMouseOut"),click:this._onClick,anyclick:this._onClick,dblclick:this._onEvent.bind(this,"onDblClick"),wheel:this._onEvent.bind(this,"onWheel"),contextmenu:this._onEvent.bind(this,"onContextMenu")}),this._setControllerProps(this.props),this._updateInteractiveContext({mapContainer:e})}},{key:"componentDidUpdate",value:function(){this._setControllerProps(this.props)}},{key:"componentWillUnmount",value:function(){this._eventManager.destroy()}},{key:"_setControllerProps",value:function(t){t=Object.assign({},t,t.viewState,{isInteractive:Boolean(t.onViewStateChange||t.onViewportChange),onViewportChange:this._onViewportChange,onStateChange:this._onInteractionStateChange,eventManager:this._eventManager,width:this._width,height:this._height}),this._controller.setOptions(t);var e=this._interactiveContext;e.onViewportChange=t.onViewportChange,e.onViewStateChange=t.onViewStateChange}},{key:"_getFeatures",value:function(t){var e,n=t.pos,r=t.radius,i={},a=this.getMap();if(this.props.interactiveLayerIds&&(i.layers=this.props.interactiveLayerIds),r){var o=r,s=[[n[0]-o,n[1]+o],[n[0]+o,n[1]-o]];e=a&&a.queryRenderedFeatures(s,i)}else e=a&&a.queryRenderedFeatures(n,i);return e}},{key:"_updateInteractiveContext",value:function(t){this._interactiveContext=Object.assign({},this._interactiveContext,t)}},{key:"_normalizeEvent",value:function(t){if(t.lngLat)return t;var e=t.offsetCenter,n=[e.x,e.y],r=new O.a(Object.assign({},this.props,{width:this._width,height:this._height}));return t.point=n,t.lngLat=r.unproject(n),t}},{key:"render",value:function(){var t=this.props,e=t.width,n=t.height,i=t.style,a=t.getCursor,o=Object.assign({position:"relative"},i,{width:e,height:n,cursor:a(this.state)});return h.createElement(et.Provider,{value:this._interactiveContext},h.createElement("div",{key:"event-canvas",ref:this._eventCanvasRef,style:o},h.createElement(ut,r({},this.props,{width:"100%",height:"100%",style:null,onResize:this._onResize,onLoad:this._onLoad,ref:this._staticMapRef}),this.props.children)))}}]),n}(h.PureComponent);Object(l.a)(Lt,"propTypes",Ct),Object(l.a)(Lt,"defaultProps",Rt);var Nt=n("U8pU");function It(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!It(t[n],e[n]))return!1;return!0}if(Array.isArray(e))return!1;if("object"===Object(Nt.a)(t)&&"object"===Object(Nt.a)(e)){var r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;for(var a=0,o=r;a<o.length;a++){var s=o[a];if(!e.hasOwnProperty(s))return!1;if(!It(t[s],e[s]))return!1}return!0}return!1}function At(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Object(u.a)(t);if(e){var i=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var Dt={type:p.a.string.isRequired,id:p.a.string},zt=0,Ut=function(t){Object(s.a)(n,t);var e=At(n);function n(t){var r;return Object(i.a)(this,n),r=e.call(this,t),Object(l.a)(Object(a.a)(r),"id",void 0),Object(l.a)(Object(a.a)(r),"type",void 0),Object(l.a)(Object(a.a)(r),"_map",null),Object(l.a)(Object(a.a)(r),"_sourceOptions",{}),Object(l.a)(Object(a.a)(r),"_updateSource",(function(){var t=Object(a.a)(r),e=t.type;if(t._map){var n=Object(a.a)(r),i=n._sourceOptions,o=n.props;x(!o.id||o.id===r.id,"source id changed"),x(o.type===e,"source type changed");var s="",c=0;for(var u in o)"children"===u||"id"===u||It(i[u],o[u])||(i[u]=o[u],s=u,c++);var l=r.getSource();l?c&&("geojson"===e?l.setData(i.data):"image"===e?l.updateImage({url:i.url,coordinates:i.coordinates}):"canvas"!==e&&"video"!==e||1!==c||"coordinates"!==s?console.warn("Unable to update <Source> prop: ".concat(s)):l.setCoordinates(i.coordinates)):r._createSource(i)}})),r.id=t.id||"jsx-source-".concat(zt++),r.type=t.type,r}return Object(o.a)(n,[{key:"componentWillUnmount",value:function(){var t=this,e=this._map;e&&(e.off("styledata",this._updateSource),requestAnimationFrame((function(){e.style&&e.style._loaded&&e.removeSource(t.id)})))}},{key:"getSource",value:function(){var t=this._map;return t&&t.style&&t.getSource(this.id)}},{key:"_createSource",value:function(t){var e=this._map;e.style&&e.style._loaded&&e.addSource(this.id,t)}},{key:"_render",value:function(t){var e=this;return!this._map&&t.map&&(this._map=t.map,this._map.on("styledata",this._updateSource)),this._updateSource(),h.Children.map(this.props.children,(function(t){return Object(h.cloneElement)(t,{source:e.id})}))}},{key:"render",value:function(){return h.createElement(et.Consumer,null,this._render.bind(this))}}]),n}(h.PureComponent);Object(l.a)(Ut,"propTypes",Dt);var Vt=n("zLVn");function Bt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Object(u.a)(t);if(e){var i=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var Ft={type:p.a.string.isRequired,id:p.a.string,source:p.a.string,beforeId:p.a.string};function qt(t,e,n,r){var i=n.layout,a=void 0===i?{}:i,o=n.paint,s=void 0===o?{}:o,c=n.filter,u=n.minzoom,l=n.maxzoom,h=n.beforeId,f=function(t,e){if(null==t)return{};var n,r,i=Object(Vt.a)(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(r=0;r<a.length;r++)n=a[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}(n,["layout","paint","filter","minzoom","maxzoom","beforeId"]);if(h!==r.beforeId&&t.moveLayer(e,h),a!==r.layout)for(var p in a)It(a[p],r.layout[p])||t.setLayoutProperty(e,p,a[p]);if(s!==r.paint)for(var d in s)It(s[d],r.paint[d])||t.setPaintProperty(e,d,s[d]);for(var v in It(c,r.filter)||t.setFilter(e,c),u===r.minzoom&&l===r.maxzoom||t.setLayerZoomRange(e,u,l),f)It(f[v],r[v])||t.setLayerProperty(e,v,f[v])}var Gt=0,Ht=function(t){Object(s.a)(n,t);var e=Bt(n);function n(t){var r;return Object(i.a)(this,n),r=e.call(this,t),Object(l.a)(Object(a.a)(r),"id",void 0),Object(l.a)(Object(a.a)(r),"type",void 0),Object(l.a)(Object(a.a)(r),"_map",null),Object(l.a)(Object(a.a)(r),"_layerOptions",{}),Object(l.a)(Object(a.a)(r),"_updateLayer",(function(){var t=r._map;if(t){var e=Object(a.a)(r),n=e.props,i=e._layerOptions;if(x(!n.id||n.id===r.id,"layer id changed"),x(n.type===r.type,"layer type changed"),r.getLayer())try{qt(t,r.id,n,i),Object.assign(i,n)}catch(o){console.warn(o)}else r._createLayer()}})),r.id=t.id||"jsx-layer-".concat(Gt++),r.type=t.type,r}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this._updateLayer()}},{key:"componentDidUpdate",value:function(){this._updateLayer()}},{key:"componentWillUnmount",value:function(){var t=this._map;t&&(t.off("styledata",this._updateLayer),t.style&&t.style._loaded&&t.removeLayer(this.id))}},{key:"getLayer",value:function(){var t=this._map;return t&&t.style&&t.getLayer(this.id)}},{key:"_createLayer",value:function(){var t=this._map;if(t.style&&t.style._loaded){var e=Object.assign({},this.props);e.id=this.id,delete e.beforeId,t.addLayer(e,this.props.beforeId),this._layerOptions=e}}},{key:"_render",value:function(t){return!this._map&&t.map&&(this._map=t.map,this._map.on("styledata",this._updateLayer)),null}},{key:"render",value:function(){return h.createElement(et.Consumer,null,this._render.bind(this))}}]),n}(h.PureComponent);function Zt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Object(u.a)(t);if(e){var i=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}Object(l.a)(Ht,"propTypes",Ft);var Wt={captureScroll:p.a.bool,captureDrag:p.a.bool,captureClick:p.a.bool,captureDoubleClick:p.a.bool},Yt=function(t){Object(s.a)(n,t);var e=Zt(n);function n(){var t;Object(i.a)(this,n);for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return t=e.call.apply(e,[this].concat(o)),Object(l.a)(Object(a.a)(t),"_context",{}),Object(l.a)(Object(a.a)(t),"_events",null),Object(l.a)(Object(a.a)(t),"_containerRef",Object(h.createRef)()),Object(l.a)(Object(a.a)(t),"_onScroll",(function(e){t.props.captureScroll&&e.stopPropagation()})),Object(l.a)(Object(a.a)(t),"_onDragStart",(function(e){t.props.captureDrag&&e.stopPropagation()})),Object(l.a)(Object(a.a)(t),"_onDblClick",(function(e){t.props.captureDoubleClick&&e.stopPropagation()})),Object(l.a)(Object(a.a)(t),"_onClick",(function(e){t.props.captureClick&&e.stopPropagation()})),t}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var t=this._containerRef.current;if(t){var e=this._context.eventManager;e&&(this._events={wheel:this._onScroll,panstart:this._onDragStart,anyclick:this._onClick,click:this._onClick,dblclick:this._onDblClick},e.watch(this._events,t))}}},{key:"componentWillUnmount",value:function(){var t=this._context.eventManager;t&&this._events&&t.off(this._events)}},{key:"_render",value:function(){throw new Error("_render() not implemented")}},{key:"render",value:function(){var t=this;return h.createElement(et.Consumer,null,(function(e){return t._context=e,t._render()}))}}]),n}(h.PureComponent);Object(l.a)(Yt,"propTypes",Wt),Object(l.a)(Yt,"defaultProps",{captureScroll:!1,captureDrag:!0,captureClick:!0,captureDoubleClick:!0});var Kt=n("ReuC");function Qt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Object(u.a)(t);if(e){var i=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var Jt=Object.assign({},Yt.propTypes,{draggable:p.a.bool,onDrag:p.a.func,onDragEnd:p.a.func,onDragStart:p.a.func,offsetLeft:p.a.number,offsetTop:p.a.number}),Xt=Object.assign({},Yt.defaultProps,{draggable:!1,offsetLeft:0,offsetTop:0}),$t=function(t){Object(s.a)(n,t);var e=Qt(n);function n(){var t;Object(i.a)(this,n);for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return t=e.call.apply(e,[this].concat(o)),Object(l.a)(Object(a.a)(t),"state",{dragPos:null,dragOffset:null}),Object(l.a)(Object(a.a)(t),"_dragEvents",null),Object(l.a)(Object(a.a)(t),"_onDragStart",(function(e){var n=t.props,r=n.draggable,i=n.captureDrag;if((r||i)&&e.stopPropagation(),r){var a=t._getDragEventPosition(e),o=t._getDragEventOffset(e);t.setState({dragPos:a,dragOffset:o}),t._setupDragEvents();var s=t.props.onDragStart;if(s&&o){var c=Object.assign({},e);c.lngLat=t._getDragLngLat(a,o),s(c)}}})),Object(l.a)(Object(a.a)(t),"_onDrag",(function(e){e.stopPropagation();var n=t._getDragEventPosition(e);t.setState({dragPos:n});var r=t.props.onDrag,i=t.state.dragOffset;if(r&&i){var a=Object.assign({},e);a.lngLat=t._getDragLngLat(n,i),r(a)}})),Object(l.a)(Object(a.a)(t),"_onDragEnd",(function(e){var n=t.state,r=n.dragPos,i=n.dragOffset;e.stopPropagation(),t.setState({dragPos:null,dragOffset:null}),t._removeDragEvents();var a=t.props.onDragEnd;if(a&&r&&i){var o=Object.assign({},e);o.lngLat=t._getDragLngLat(r,i),a(o)}})),Object(l.a)(Object(a.a)(t),"_onDragCancel",(function(e){e.stopPropagation(),t.setState({dragPos:null,dragOffset:null}),t._removeDragEvents()})),t}return Object(o.a)(n,[{key:"componentWillUnmount",value:function(){Object(Kt.a)(Object(u.a)(n.prototype),"componentWillUnmount",this).call(this),this._removeDragEvents()}},{key:"_setupDragEvents",value:function(){var t=this._context.eventManager;t&&(this._dragEvents={panmove:this._onDrag,panend:this._onDragEnd,pancancel:this._onDragCancel},t.on(this._dragEvents))}},{key:"_removeDragEvents",value:function(){var t=this._context.eventManager;t&&this._dragEvents&&(t.off(this._dragEvents),this._dragEvents=null)}},{key:"_getDragEventPosition",value:function(t){var e=t.offsetCenter;return[e.x,e.y]}},{key:"_getDragEventOffset",value:function(t){var e=t.center,n=e.x,r=e.y,i=this._containerRef.current;if(i){var a=i.getBoundingClientRect();return[a.left-n,a.top-r]}return null}},{key:"_getDraggedPosition",value:function(t,e){return[t[0]+e[0],t[1]+e[1]]}},{key:"_getDragLngLat",value:function(t,e){var n=this.props,r=n.offsetLeft,i=n.offsetTop,a=this._getDraggedPosition(t,e),o=Object(T.a)(a,2),s=o[0],c=o[1];return this._context.viewport.unproject([s-r,c-i])}}]),n}(Yt);Object(l.a)($t,"propTypes",Jt),Object(l.a)($t,"defaultProps",Xt);var te="undefined"!=typeof window&&window.devicePixelRatio||1,ee=function(t){return Math.round(t*te)/te},ne=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"x";if(null===t)return e;var r="x"===n?t.offsetWidth:t.offsetHeight;return ee(e/100*r)/r*100};function re(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Object(u.a)(t);if(e){var i=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var ie=Object.assign({},$t.propTypes,{className:p.a.string,longitude:p.a.number.isRequired,latitude:p.a.number.isRequired}),ae=Object.assign({},$t.defaultProps,{className:""}),oe=function(t){Object(s.a)(n,t);var e=re(n);function n(){var t;Object(i.a)(this,n);for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return t=e.call.apply(e,[this].concat(o)),Object(l.a)(Object(a.a)(t),"_control",null),t}return Object(o.a)(n,[{key:"_getPosition",value:function(){var t=this.props,e=t.longitude,n=t.latitude,r=t.offsetLeft,i=t.offsetTop,a=this.state,o=a.dragPos,s=a.dragOffset;if(o&&s)return this._getDraggedPosition(o,s);var c=this._context.viewport.project([e,n]),u=Object(T.a)(c,2),l=u[0],h=u[1];return[l+=r,h+=i]}},{key:"_render",value:function(){var t=this._getPosition(),e=Object(T.a)(t,2),n=e[0],r=e[1],i="translate(".concat(ee(n),"px, ").concat(ee(r),"px)"),a=this._containerRef.current;if(this._control&&a)a.style.transform=i;else{var o=this.props,s=o.className,c=o.draggable,u=this.state.dragPos,l={position:"absolute",left:0,top:0,transform:i,cursor:c?u?"grabbing":"grab":"auto"};this._control=h.createElement("div",{className:"mapboxgl-marker ".concat(s),ref:this._containerRef,style:l},this.props.children)}return this._control}},{key:"render",value:function(){return this._control=null,Object(Kt.a)(Object(u.a)(n.prototype),"render",this).call(this)}}]),n}($t);Object(l.a)(oe,"propTypes",ie),Object(l.a)(oe,"defaultProps",ae);var se={top:{x:.5,y:0},"top-left":{x:0,y:0},"top-right":{x:1,y:0},bottom:{x:.5,y:1},"bottom-left":{x:0,y:1},"bottom-right":{x:1,y:1},left:{x:0,y:.5},right:{x:1,y:.5}},ce=Object.keys(se);function ue(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Object(u.a)(t);if(e){var i=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var le=Object.assign({},Yt.propTypes,{className:p.a.string,longitude:p.a.number.isRequired,latitude:p.a.number.isRequired,altitude:p.a.number,offsetLeft:p.a.number,offsetTop:p.a.number,tipSize:p.a.number,closeButton:p.a.bool,closeOnClick:p.a.bool,anchor:p.a.oneOf(Object.keys(se)),dynamicPosition:p.a.bool,sortByDepth:p.a.bool,onClose:p.a.func}),he=Object.assign({},Yt.defaultProps,{className:"",altitude:0,offsetLeft:0,offsetTop:0,tipSize:10,anchor:"bottom",dynamicPosition:!0,sortByDepth:!1,closeButton:!0,closeOnClick:!0,onClose:function(){}}),fe=function(t){Object(s.a)(n,t);var e=ue(n);function n(){var t;Object(i.a)(this,n);for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return t=e.call.apply(e,[this].concat(o)),Object(l.a)(Object(a.a)(t),"_closeOnClick",!1),Object(l.a)(Object(a.a)(t),"_contentRef",Object(h.createRef)()),Object(l.a)(Object(a.a)(t),"_onClick",(function(e){if(t.props.captureClick&&e.stopPropagation(),t.props.closeOnClick||"mapboxgl-popup-close-button"===e.target.className){t.props.onClose();var n=t._context.eventManager;n&&n.once("click",(function(t){return t.stopPropagation()}),e.target)}})),t}return Object(o.a)(n,[{key:"componentDidMount",value:function(){Object(Kt.a)(Object(u.a)(n.prototype),"componentDidMount",this).call(this),this.forceUpdate()}},{key:"_getPosition",value:function(t,e){var n=this._context.viewport,r=this.props,i=r.anchor,a=r.dynamicPosition,o=r.tipSize,s=this._contentRef.current;return s&&a?function(t){var e=t.x,n=t.y,r=t.width,i=t.height,a=t.selfWidth,o=t.selfHeight,s=t.anchor,c=t.padding,u=void 0===c?0:c,l=se[s],h=l.x,f=l.y,p=n-f*o,d=p+o;if(p<u)for(;p<u&&f>=.5;)f-=.5,p+=.5*o;else if(d>i-u)for(;d>i-u&&f<=.5;)f+=.5,d-=.5*o;var v=e-h*a,y=v+a,m=.5;if(.5===f&&(h=Math.floor(h),m=1),v<u)for(;v<u&&h>=m;)h-=m,v+=m*a;else if(y>r-u)for(;y>r-u&&h<=1-m;)h+=m,y-=m*a;return ce.find((function(t){var e=se[t];return e.x===h&&e.y===f}))||s}({x:t,y:e,anchor:i,padding:o,width:n.width,height:n.height,selfWidth:s.clientWidth,selfHeight:s.clientHeight}):i}},{key:"_getContainerStyle",value:function(t,e,n,r){var i=this._context.viewport,a=this.props,o=a.offsetLeft,s=a.offsetTop,c=a.sortByDepth,u=se[r],l=t+o,h=e+s,f=this._containerRef.current,p=ne(f,100*-u.x),d=ne(f,100*-u.y,"y"),v={position:"absolute",transform:"\n        translate(".concat(p,"%, ").concat(d,"%)\n        translate(").concat(ee(l),"px, ").concat(ee(h),"px)\n      "),display:void 0,zIndex:void 0};return c?(n>1||n<-1||t<0||t>i.width||e<0||e>i.height?v.display="none":v.zIndex=Math.floor((1-n)/2*1e5),v):v}},{key:"_renderTip",value:function(t){var e=this.props.tipSize;return h.createElement("div",{key:"tip",className:"mapboxgl-popup-tip",style:{borderWidth:e}})}},{key:"_renderContent",value:function(){var t=this.props,e=t.closeButton,n=t.children,r=this._context.eventManager?null:this._onClick;return h.createElement("div",{key:"content",ref:this._contentRef,className:"mapboxgl-popup-content",onClick:r},e&&h.createElement("button",{key:"close-button",className:"mapboxgl-popup-close-button",type:"button"},""),n)}},{key:"_render",value:function(){var t=this.props,e=t.className,n=t.longitude,r=t.latitude,i=t.altitude,a=this._context.viewport.project([n,r,i]),o=Object(T.a)(a,3),s=o[0],c=o[1],u=o[2],l=this._getPosition(s,c),f=this._getContainerStyle(s,c,u,l);return h.createElement("div",{className:"mapboxgl-popup mapboxgl-popup-anchor-".concat(l," ").concat(e),style:f,ref:this._containerRef},this._renderTip(l),this._renderContent())}}]),n}(Yt);Object(l.a)(fe,"propTypes",le),Object(l.a)(fe,"defaultProps",he);var pe=n("2lZV");function de(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Object(u.a)(t);if(e){var i=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}var ve,ye=Object.assign({},Yt.propTypes,{className:p.a.string,container:p.a.object}),me=Object.assign({},Yt.defaultProps,{className:"",container:null}),ge=function(t){Object(s.a)(n,t);var e=de(n);function n(){var t;Object(i.a)(this,n);for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return t=e.call.apply(e,[this].concat(o)),Object(l.a)(Object(a.a)(t),"state",{isFullscreen:!1,showButton:!1}),Object(l.a)(Object(a.a)(t),"_mapboxFullscreenControl",null),Object(l.a)(Object(a.a)(t),"_onFullscreenChange",(function(){var e=!t._mapboxFullscreenControl._fullscreen;t._mapboxFullscreenControl._fullscreen=e,t.setState({isFullscreen:e})})),Object(l.a)(Object(a.a)(t),"_onClickFullscreen",(function(){t._mapboxFullscreenControl._onClickFullscreen()})),t}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var t=this.props.container||this._context.mapContainer;this._mapboxFullscreenControl=new S.a.FullscreenControl({container:t}),this.setState({showButton:this._mapboxFullscreenControl._checkFullscreenSupport()}),pe.a.addEventListener(this._mapboxFullscreenControl._fullscreenchange,this._onFullscreenChange)}},{key:"componentWillUnmount",value:function(){pe.a.removeEventListener(this._mapboxFullscreenControl._fullscreenchange,this._onFullscreenChange)}},{key:"_renderButton",value:function(t,e,n){return h.createElement("button",{key:t,className:"mapboxgl-ctrl-icon mapboxgl-ctrl-".concat(t),type:"button",title:e,onClick:n},h.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true"}))}},{key:"_render",value:function(){if(!this.state.showButton)return null;var t=this.props.className,e=this.state.isFullscreen?"shrink":"fullscreen";return h.createElement("div",{className:"mapboxgl-ctrl mapboxgl-ctrl-group ".concat(t),ref:this._containerRef},this._renderButton(e,"Toggle fullscreen",this._onClickFullscreen))}}]),n}(Yt);function be(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Object(u.a)(t);if(e){var i=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}Object(l.a)(ge,"propTypes",ye),Object(l.a)(ge,"defaultProps",me);var Oe=Object.assign({},yt.defaultProps,{transitionDuration:500}),_e=function(){},je=Object.assign({},Yt.propTypes,{className:p.a.string,style:p.a.object,label:p.a.string,auto:p.a.bool,positionOptions:p.a.object,fitBoundsOptions:p.a.object,trackUserLocation:p.a.bool,showUserLocation:p.a.bool,onViewStateChange:p.a.func,onViewportChange:p.a.func,onGeolocate:p.a.func}),we=Object.assign({},Yt.defaultProps,{className:"",style:{},label:"Geolocate",auto:!1,positionOptions:null,fitBoundsOptions:null,trackUserLocation:!1,showUserLocation:!0,onGeolocate:function(){}}),Se=function(t){Object(s.a)(n,t);var e=be(n);function n(){var t;Object(i.a)(this,n);for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return t=e.call.apply(e,[this].concat(o)),Object(l.a)(Object(a.a)(t),"state",{supportsGeolocation:!1,markerPosition:null}),Object(l.a)(Object(a.a)(t),"_mapboxGeolocateControl",null),Object(l.a)(Object(a.a)(t),"_geolocateButtonRef",Object(h.createRef)()),Object(l.a)(Object(a.a)(t),"_setupMapboxGeolocateControl",(function(e){if(e){var n={showUserLocation:!1};["positionOptions","fitBoundsOptions","trackUserLocation"].forEach((function(e){e in t.props&&null!==t.props[e]&&(n[e]=t.props[e])}));var r=new S.a.GeolocateControl(n);t._mapboxGeolocateControl=r,r._watchState="OFF",r._geolocateButton=t._geolocateButtonRef.current,r.options.trackUserLocation&&r._geolocateButton&&r._geolocateButton.setAttribute("aria-pressed","false"),r._updateMarker=t._updateMarker,r._updateCamera=t._updateCamera,r._setup=!0;var i=t._context.eventManager;r.options.trackUserLocation&&i&&i.on("panstart",(function(){"ACTIVE_LOCK"===r._watchState&&(r._watchState="BACKGROUND",r._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),r._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"))})),r.on("geolocate",t.props.onGeolocate)}else console.warn("Geolocation support is not available, the GeolocateControl will not be visible.")})),Object(l.a)(Object(a.a)(t),"_triggerGeolocate",(function(){var e=t._mapboxGeolocateControl;return e._map=t._context.map,t.props.showUserLocation&&(e.on("geolocate",t._updateMarker),e.on("trackuserlocationend",t._updateMarker)),t._mapboxGeolocateControl.trigger()})),Object(l.a)(Object(a.a)(t),"_updateMarker",(function(e){e&&t.setState({markerPosition:e.coords})})),Object(l.a)(Object(a.a)(t),"_getBounds",(function(t){var e=new S.a.LngLat(t.coords.longitude,t.coords.latitude),n=t.coords.accuracy,r=e.toBounds(n);return[[r._ne.lng,r._ne.lat],[r._sw.lng,r._sw.lat]]})),Object(l.a)(Object(a.a)(t),"_updateCamera",(function(e){var n=t._context.viewport,r=t._getBounds(e),i=new O.a(n).fitBounds(r),a=i.longitude,o=i.latitude,s=i.zoom,c=Object.assign({},n,{longitude:a,latitude:o,zoom:s}),u=new $(c),l=Object.assign({},u.getViewportProps(),Oe),h=t.props.onViewportChange||t._context.onViewportChange||_e;(t.props.onViewStateChange||t._context.onViewStateChange||_e)({viewState:l}),h(l)})),Object(l.a)(Object(a.a)(t),"_renderButton",(function(e,n,r){return h.createElement("button",{key:e,className:"mapboxgl-ctrl-icon mapboxgl-ctrl-".concat(e),ref:t._geolocateButtonRef,type:"button",title:n,onClick:r},h.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true"}))})),Object(l.a)(Object(a.a)(t),"_renderMarker",(function(){var e=t.state.markerPosition,n=t.props.showUserLocation;return e&&n?h.createElement(oe,{key:"location-maker",className:"mapboxgl-user-location-dot",longitude:e.longitude,latitude:e.latitude,onContextMenu:function(t){return t.preventDefault()},captureDrag:!1,captureDoubleClick:!1}):null})),t}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var t=this;(void 0!==ve?Promise.resolve(ve):void 0!==window.navigator.permissions?window.navigator.permissions.query({name:"geolocation"}).then((function(t){return ve="denied"!==t.state})):(ve=Boolean(window.navigator.geolocation),Promise.resolve(ve))).then((function(e){t.setState({supportsGeolocation:e}),t._setupMapboxGeolocateControl(e),e&&t.props.auto&&t._triggerGeolocate()}))}},{key:"componentDidUpdate",value:function(t){this.state.supportsGeolocation&&!t.auto&&this.props.auto&&this._triggerGeolocate()}},{key:"componentWillUnmount",value:function(){if(this._mapboxGeolocateControl){var t=this._mapboxGeolocateControl._geolocationWatchID;void 0!==t&&(window.navigator.geolocation.clearWatch(t),this._mapboxGeolocateControl._geolocationWatchID=void 0)}}},{key:"_render",value:function(){if(!this.state.supportsGeolocation)return null;var t=this.props,e=t.className,n=t.style,r=t.label;return h.createElement("div",null,this._renderMarker(),h.createElement("div",{key:"geolocate-control",className:"mapboxgl-ctrl mapboxgl-ctrl-group ".concat(e),ref:this._containerRef,style:n,onContextMenu:function(t){return t.preventDefault()}},this._renderButton("geolocate",r,this._triggerGeolocate)))}}]),n}(Yt);function Te(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Object(u.a)(t);if(e){var i=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}Object(l.a)(Se,"propTypes",je),Object(l.a)(Se,"defaultProps",we);var ke=function(){},Ee=Object.assign({},Yt.propTypes,{className:p.a.string,onViewStateChange:p.a.func,onViewportChange:p.a.func,showCompass:p.a.bool,showZoom:p.a.bool,zoomInLabel:p.a.string,zoomOutLabel:p.a.string,compassLabel:p.a.string}),Pe=Object.assign({},Yt.defaultProps,{className:"",showCompass:!0,showZoom:!0,zoomInLabel:"Zoom In",zoomOutLabel:"Zoom Out",compassLabel:"Reset North"});function Me(t){return function(t,e){for(var n=(t||"").split(".").map(Number),r=(e||"").split(".").map(Number),i=0;i<3;i++){var a=n[i]||0,o=r[i]||0;if(a<o)return-1;if(a>o)return 1}return 0}(t,"1.6.0")>=0?2:1}var xe=function(t){Object(s.a)(n,t);var e=Te(n);function n(t){var r;return Object(i.a)(this,n),r=e.call(this,t),Object(l.a)(Object(a.a)(r),"_uiVersion",void 0),Object(l.a)(Object(a.a)(r),"_onZoomIn",(function(){r._updateViewport({zoom:r._context.viewport.zoom+1})})),Object(l.a)(Object(a.a)(r),"_onZoomOut",(function(){r._updateViewport({zoom:r._context.viewport.zoom-1})})),Object(l.a)(Object(a.a)(r),"_onResetNorth",(function(){r._updateViewport({bearing:0,pitch:0})})),Mt(t),r}return Object(o.a)(n,[{key:"_updateViewport",value:function(t){var e=this._context.viewport,n=new $(Object.assign({},e,t)),r=Object.assign({},n.getViewportProps(),bt),i=this.props.onViewportChange||this._context.onViewportChange||ke;(this.props.onViewStateChange||this._context.onViewStateChange||ke)({viewState:r}),i(r)}},{key:"_renderCompass",value:function(){var t=this._context.viewport.bearing,e={transform:"rotate(".concat(-t,"deg)")};return 2===this._uiVersion?h.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true",style:e}):h.createElement("span",{className:"mapboxgl-ctrl-compass-arrow",style:e})}},{key:"_renderButton",value:function(t,e,n,r){return h.createElement("button",{key:t,className:"mapboxgl-ctrl-icon mapboxgl-ctrl-".concat(t),type:"button",title:e,onClick:n},r||h.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true"}))}},{key:"_render",value:function(){var t=this.props,e=t.className,n=t.showCompass,r=t.showZoom,i=t.zoomInLabel,a=t.zoomOutLabel,o=t.compassLabel;if(!this._uiVersion){var s=this._context.map;this._uiVersion=s?Me(s.version):2}return h.createElement("div",{className:"mapboxgl-ctrl mapboxgl-ctrl-group ".concat(e),ref:this._containerRef},r&&this._renderButton("zoom-in",i,this._onZoomIn),r&&this._renderButton("zoom-out",a,this._onZoomOut),n&&this._renderButton("compass",o,this._onResetNorth,this._renderCompass()))}}]),n}(Yt);function Ce(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Object(u.a)(t);if(e){var i=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}Object(l.a)(xe,"propTypes",Ee),Object(l.a)(xe,"defaultProps",Pe);var Re=Object.assign({},Yt.propTypes,{maxWidth:p.a.number,unit:p.a.oneOf(["imperial","metric","nautical"])}),Le=Object.assign({},Yt.defaultProps,{maxWidth:100,unit:"metric"}),Ne=function(t){Object(s.a)(n,t);var e=Ce(n);function n(){var t;Object(i.a)(this,n);for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return t=e.call.apply(e,[this].concat(o)),Object(l.a)(Object(a.a)(t),"_control",null),Object(l.a)(Object(a.a)(t),"_mapboxScaleControl",null),t}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var t=new S.a.ScaleControl;t._map=this._context.map,t._container=this._containerRef.current,this._mapboxScaleControl=t,this._update()}},{key:"_update",value:function(){var t=this._mapboxScaleControl;t&&(t.options=this.props,t._onMove())}},{key:"_render",value:function(){return this._control=this._control||h.createElement("div",{ref:this._containerRef,className:"mapboxgl-ctrl mapboxgl-ctrl-scale"}),this._update(),this._control}}]),n}(Yt);function Ie(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Object(u.a)(t);if(e){var i=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}Object(l.a)(Ne,"propTypes",Re),Object(l.a)(Ne,"defaultProps",Le);var Ae=Object.assign({},Yt.propTypes,{redraw:p.a.func.isRequired}),De=function(t){Object(s.a)(n,t);var e=Ie(n);function n(){var t;Object(i.a)(this,n);for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return t=e.call.apply(e,[this].concat(o)),Object(l.a)(Object(a.a)(t),"_canvas",void 0),Object(l.a)(Object(a.a)(t),"_ctx",void 0),Object(l.a)(Object(a.a)(t),"_redraw",(function(){var e=t._ctx;if(e){var n=pe.b.devicePixelRatio||1;e.save(),e.scale(n,n);var r=t._context,i=r.viewport,a=r.isDragging;t.props.redraw({width:i.width,height:i.height,ctx:e,isDragging:a,project:i.project.bind(i),unproject:i.unproject.bind(i)}),e.restore()}})),t}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var t=this._containerRef.current;t&&(this._canvas=t,this._ctx=t.getContext("2d")),this._redraw()}},{key:"_render",value:function(){var t=pe.b.devicePixelRatio||1,e=this._context.viewport,n=e.width,r=e.height;return this._redraw(),h.createElement("canvas",{ref:this._containerRef,width:n*t,height:r*t,style:{width:"".concat(n,"px"),height:"".concat(r,"px"),position:"absolute",left:0,top:0}})}}]),n}(Yt);function ze(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Object(u.a)(t);if(e){var i=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}Object(l.a)(De,"propTypes",Ae),Object(l.a)(De,"defaultProps",{captureScroll:!1,captureDrag:!1,captureClick:!1,captureDoubleClick:!1});var Ue=Object.assign({},Yt.propTypes,{redraw:p.a.func.isRequired,style:p.a.object}),Ve=function(t){Object(s.a)(n,t);var e=ze(n);function n(){return Object(i.a)(this,n),e.apply(this,arguments)}return Object(o.a)(n,[{key:"_render",value:function(){var t=this._context,e=t.viewport,n=t.isDragging,r=Object.assign({position:"absolute",left:0,top:0,width:e.width,height:e.height},this.props.style);return h.createElement("div",{ref:this._containerRef,style:r},this.props.redraw({width:e.width,height:e.height,isDragging:n,project:e.project.bind(e),unproject:e.unproject.bind(e)}))}}]),n}(Yt);function Be(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Object(u.a)(t);if(e){var i=Object(u.a)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Object(c.a)(this,n)}}Object(l.a)(Ve,"propTypes",Ue),Object(l.a)(Ve,"defaultProps",{captureScroll:!1,captureDrag:!1,captureClick:!1,captureDoubleClick:!1});var Fe=Object.assign({},Yt.propTypes,{redraw:p.a.func.isRequired,style:p.a.object}),qe=function(t){Object(s.a)(n,t);var e=Be(n);function n(){return Object(i.a)(this,n),e.apply(this,arguments)}return Object(o.a)(n,[{key:"_render",value:function(){var t=this._context,e=t.viewport,n=t.isDragging,r=Object.assign({position:"absolute",left:0,top:0},this.props.style);return h.createElement("svg",{width:e.width,height:e.height,ref:this._containerRef,style:r},this.props.redraw({width:e.width,height:e.height,isDragging:n,project:e.project.bind(e),unproject:e.unproject.bind(e)}))}}]),n}(Yt);Object(l.a)(qe,"propTypes",Fe),Object(l.a)(qe,"defaultProps",{captureScroll:!1,captureDrag:!1,captureClick:!1,captureDoubleClick:!1});S.a&&S.a.setRTLTextPlugin},Vmat:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n("rePB"),i=n("G+eI");function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function o(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){Object(r.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var s={id:"request-scheduler",throttleRequests:!0,maxRequests:6},c=function(){function t(t){void 0===t&&(t={}),this.props=o(o({},s),t),this.requestQueue=[],this.activeRequestCount=0,this.requestMap=new Map,this.stats=new i.a({id:t.id}),this.stats.get("Queued Requests"),this.stats.get("Active Requests"),this.stats.get("Cancelled Requests"),this.stats.get("Queued Requests Ever"),this.stats.get("Active Requests Ever"),this._deferredUpdate=null}var e=t.prototype;return e.scheduleRequest=function(t,e){if(void 0===e&&(e=function(){return 0}),!this.props.throttleRequests)return Promise.resolve({done:function(){}});if(this.requestMap.has(t))return this.requestMap.get(t);var n={handle:t,getPriority:e},r=new Promise((function(t){return n.resolve=t,n}));return this.requestQueue.push(n),this.requestMap.set(t,r),this._issueNewRequests(),r},e._issueRequest=function(t){var e=this,n=t.handle,r=t.resolve,i=!1,a=function(){i||(i=!0,e.requestMap.delete(n),e.activeRequestCount--,e._issueNewRequests())};return this.activeRequestCount++,r?r({done:a}):Promise.resolve({done:a})},e._issueNewRequests=function(){var t=this;this._deferredUpdate||(this._deferredUpdate=setTimeout((function(){return t._issueNewRequestsAsync()}),0))},e._issueNewRequestsAsync=function(){this._deferredUpdate=null;var t=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(0!==t){this._updateAllRequests();for(var e=0;e<t;++e)if(this.requestQueue.length>0){var n=this.requestQueue.shift();this._issueRequest(n)}}},e._updateAllRequests=function(){for(var t=this.requestQueue,e=0;e<t.length;++e){var n=t[e];this._updateRequest(n)||(t.splice(e,1),this.requestMap.delete(n.handle),e--)}t.sort((function(t,e){return t.priority-e.priority}))},e._updateRequest=function(t){return t.priority=t.getPriority(t.handle),!(t.priority<0)||(t.resolve(null),!1)},t}()},Wium:function(t,e,n){"use strict";n.d(e,"a",(function(){return p}));var r=n("1OyB"),i=n("vuIU"),a=n("md7G"),o=n("foSv"),s=n("Ji7U"),c=n("wldP"),u=n("c9N0"),l=n("v88f"),h=["bearing","pitch"],f={speed:1.2,curve:1.414},p=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r.a)(this,e),(t=Object(a.a)(this,Object(o.a)(e).call(this,{compare:["longitude","latitude","zoom","bearing","pitch"],extract:["width","height","longitude","latitude","zoom","bearing","pitch"],required:["width","height","latitude","longitude","zoom"]}))).props=Object.assign({},f,n),t}return Object(s.a)(e,t),Object(i.a)(e,[{key:"interpolateProps",value:function(t,e,n){var r=Object(l.d)(t,e,n,this.props),i=!0,a=!1,o=void 0;try{for(var s,c=h[Symbol.iterator]();!(i=(s=c.next()).done);i=!0){var f=s.value;r[f]=Object(u.g)(t[f]||0,e[f]||0,n)}}catch(p){a=!0,o=p}finally{try{i||null==c.return||c.return()}finally{if(a)throw o}}return r}},{key:"getDuration",value:function(t,e){var n=e.transitionDuration;return"auto"===n&&(n=Object(l.g)(t,e,this.props)),n}}]),e}(c.a)},bE5S:function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));var r=n("1OyB"),i=n("vuIU"),a=n("md7G"),o=n("foSv"),s=n("Ji7U"),c=n("kHIg"),u=n("yeNo"),l=n("2plT"),h=function(t){function e(){return Object(r.a)(this,e),Object(a.a)(this,Object(o.a)(e).apply(this,arguments))}return Object(s.a)(e,t),Object(i.a)(e,[{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"from",value:function(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}},{key:"fromArray",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<this.ELEMENTS;++n)this[n]=t[n+e];return this.check()}},{key:"to",value:function(t){return t===this?this:Object(u.f)(t)?this.toArray(t):this.toObject(t)}},{key:"toTarget",value:function(t){return t?this.to(t):this}},{key:"toArray",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<this.ELEMENTS;++n)t[e+n]=this[n];return t}},{key:"toFloat32Array",value:function(){return new Float32Array(this)}},{key:"toString",value:function(){return this.formatString(u.b)}},{key:"formatString",value:function(t){for(var e="",n=0;n<this.ELEMENTS;++n)e+=(n>0?", ":"")+Object(u.e)(this[n],t);return"".concat(t.printTypes?this.constructor.name:"","[").concat(e,"]")}},{key:"equals",value:function(t){if(!t||this.length!==t.length)return!1;for(var e=0;e<this.ELEMENTS;++e)if(!Object(u.d)(this[e],t[e]))return!1;return!0}},{key:"exactEquals",value:function(t){if(!t||this.length!==t.length)return!1;for(var e=0;e<this.ELEMENTS;++e)if(this[e]!==t[e])return!1;return!0}},{key:"negate",value:function(){for(var t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}},{key:"lerp",value:function(t,e,n){void 0===n&&(n=e,e=t,t=this);for(var r=0;r<this.ELEMENTS;++r){var i=t[r];this[r]=i+n*(e[r]-i)}return this.check()}},{key:"min",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=Math.min(t[e],this[e]);return this.check()}},{key:"max",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=Math.max(t[e],this[e]);return this.check()}},{key:"clamp",value:function(t,e){for(var n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t[n]),e[n]);return this.check()}},{key:"add",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0,i=e;r<i.length;r++)for(var a=i[r],o=0;o<this.ELEMENTS;++o)this[o]+=a[o];return this.check()}},{key:"subtract",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0,i=e;r<i.length;r++)for(var a=i[r],o=0;o<this.ELEMENTS;++o)this[o]-=a[o];return this.check()}},{key:"scale",value:function(t){if(Array.isArray(t))return this.multiply(t);for(var e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}},{key:"sub",value:function(t){return this.subtract(t)}},{key:"setScalar",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=t;return this.check()}},{key:"addScalar",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]+=t;return this.check()}},{key:"subScalar",value:function(t){return this.addScalar(-t)}},{key:"multiplyScalar",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}},{key:"divideScalar",value:function(t){return this.scale(1/t)}},{key:"clampScalar",value:function(t,e){for(var n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t),e);return this.check()}},{key:"multiplyByScalar",value:function(t){return this.scale(t)}},{key:"check",value:function(){if(u.b.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}},{key:"validate",value:function(){for(var t=this.length===this.ELEMENTS,e=0;e<this.ELEMENTS;++e)t=t&&Number.isFinite(this[e]);return t}},{key:"ELEMENTS",get:function(){return Object(l.a)(!1),0}},{key:"RANK",get:function(){return Object(l.a)(!1),0}},{key:"elements",get:function(){return this}}]),e}(Object(c.a)(Array))},fOPP:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return c}));var r=n("yeNo");function i(t,e){if(t.length!==e)return!1;for(var n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function a(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function o(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(r.b.debug&&!i(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}var s={};function c(t,e){s[t]||(s[t]=!0,console.warn("".concat(t," has been removed in version ").concat(e,", see upgrade guide for more information")))}},gOKY:function(t,e,n){"use strict";e.a={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,PI_OVER_TWO:Math.PI/2,PI_OVER_FOUR:Math.PI/4,PI_OVER_SIX:Math.PI/6,TWO_PI:2*Math.PI}},jYz7:function(t,e,n){"use strict";(function(t){var r=n("q1tI");function i(e){var n;n="undefined"!=typeof window?window:"undefined"!=typeof self?self:t;var r,i,a="undefined"!=typeof document&&document.attachEvent;if(!a){var o=(i=n.requestAnimationFrame||n.mozRequestAnimationFrame||n.webkitRequestAnimationFrame||function(t){return n.setTimeout(t,20)},function(t){return i(t)}),s=(r=n.cancelAnimationFrame||n.mozCancelAnimationFrame||n.webkitCancelAnimationFrame||n.clearTimeout,function(t){return r(t)}),c=function(t){var e=t.__resizeTriggers__,n=e.firstElementChild,r=e.lastElementChild,i=n.firstElementChild;r.scrollLeft=r.scrollWidth,r.scrollTop=r.scrollHeight,i.style.width=n.offsetWidth+1+"px",i.style.height=n.offsetHeight+1+"px",n.scrollLeft=n.scrollWidth,n.scrollTop=n.scrollHeight},u=function(t){if(!(t.target.className.indexOf("contract-trigger")<0&&t.target.className.indexOf("expand-trigger")<0)){var e=this;c(this),this.__resizeRAF__&&s(this.__resizeRAF__),this.__resizeRAF__=o((function(){(function(t){return t.offsetWidth!=t.__resizeLast__.width||t.offsetHeight!=t.__resizeLast__.height})(e)&&(e.__resizeLast__.width=e.offsetWidth,e.__resizeLast__.height=e.offsetHeight,e.__resizeListeners__.forEach((function(n){n.call(e,t)})))}))}},l=!1,h="",f="animationstart",p="Webkit Moz O ms".split(" "),d="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),v=document.createElement("fakeelement");if(void 0!==v.style.animationName&&(l=!0),!1===l)for(var y=0;y<p.length;y++)if(void 0!==v.style[p[y]+"AnimationName"]){h="-"+p[y].toLowerCase()+"-",f=d[y],l=!0;break}var m="resizeanim",g="@"+h+"keyframes "+m+" { from { opacity: 0; } to { opacity: 0; } } ",b=h+"animation: 1ms "+m+"; "}return{addResizeListener:function(t,r){if(a)t.attachEvent("onresize",r);else{if(!t.__resizeTriggers__){var i=t.ownerDocument,o=n.getComputedStyle(t);o&&"static"==o.position&&(t.style.position="relative"),function(t){if(!t.getElementById("detectElementResize")){var n=(g||"")+".resize-triggers { "+(b||"")+'visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; z-index: -1; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',r=t.head||t.getElementsByTagName("head")[0],i=t.createElement("style");i.id="detectElementResize",i.type="text/css",null!=e&&i.setAttribute("nonce",e),i.styleSheet?i.styleSheet.cssText=n:i.appendChild(t.createTextNode(n)),r.appendChild(i)}}(i),t.__resizeLast__={},t.__resizeListeners__=[],(t.__resizeTriggers__=i.createElement("div")).className="resize-triggers",t.__resizeTriggers__.innerHTML='<div class="expand-trigger"><div></div></div><div class="contract-trigger"></div>',t.appendChild(t.__resizeTriggers__),c(t),t.addEventListener("scroll",u,!0),f&&(t.__resizeTriggers__.__animationListener__=function(e){e.animationName==m&&c(t)},t.__resizeTriggers__.addEventListener(f,t.__resizeTriggers__.__animationListener__))}t.__resizeListeners__.push(r)}},removeResizeListener:function(t,e){if(a)t.detachEvent("onresize",e);else if(t.__resizeListeners__.splice(t.__resizeListeners__.indexOf(e),1),!t.__resizeListeners__.length){t.removeEventListener("scroll",u,!0),t.__resizeTriggers__.__animationListener__&&(t.__resizeTriggers__.removeEventListener(f,t.__resizeTriggers__.__animationListener__),t.__resizeTriggers__.__animationListener__=null);try{t.__resizeTriggers__=!t.removeChild(t.__resizeTriggers__)}catch(n){}}}}}var a=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},c=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},u=function(t){function e(){var t,n,r;a(this,e);for(var i=arguments.length,o=Array(i),s=0;s<i;s++)o[s]=arguments[s];return n=r=c(this,(t=e.__proto__||Object.getPrototypeOf(e)).call.apply(t,[this].concat(o))),r.state={height:r.props.defaultHeight||0,width:r.props.defaultWidth||0},r._onResize=function(){var t=r.props,e=t.disableHeight,n=t.disableWidth,i=t.onResize;if(r._parentNode){var a=r._parentNode.offsetHeight||0,o=r._parentNode.offsetWidth||0,s=window.getComputedStyle(r._parentNode)||{},c=parseInt(s.paddingLeft,10)||0,u=parseInt(s.paddingRight,10)||0,l=parseInt(s.paddingTop,10)||0,h=parseInt(s.paddingBottom,10)||0,f=a-l-h,p=o-c-u;(!e&&r.state.height!==f||!n&&r.state.width!==p)&&(r.setState({height:a-l-h,width:o-c-u}),i({height:a,width:o}))}},r._setRef=function(t){r._autoSizer=t},c(r,n)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),o(e,[{key:"componentDidMount",value:function(){var t=this.props.nonce;this._autoSizer&&this._autoSizer.parentNode&&this._autoSizer.parentNode.ownerDocument&&this._autoSizer.parentNode.ownerDocument.defaultView&&this._autoSizer.parentNode instanceof this._autoSizer.parentNode.ownerDocument.defaultView.HTMLElement&&(this._parentNode=this._autoSizer.parentNode,this._detectElementResize=i(t),this._detectElementResize.addResizeListener(this._parentNode,this._onResize),this._onResize())}},{key:"componentWillUnmount",value:function(){this._detectElementResize&&this._parentNode&&this._detectElementResize.removeResizeListener(this._parentNode,this._onResize)}},{key:"render",value:function(){var t=this.props,e=t.children,n=t.className,i=t.disableHeight,a=t.disableWidth,o=t.style,c=this.state,u=c.height,l=c.width,h={overflow:"visible"},f={},p=!1;return i||(0===u&&(p=!0),h.height=0,f.height=u),a||(0===l&&(p=!0),h.width=0,f.width=l),Object(r.createElement)("div",{className:n,ref:this._setRef,style:s({},h,o)},!p&&e(f))}}]),e}(r.PureComponent);u.defaultProps={onResize:function(){},disableHeight:!1,disableWidth:!1,style:{}},e.a=u}).call(this,n("yLpj"))},"kh/P":function(t,e,n){"use strict";n.d(e,"a",(function(){return S}));var r=n("ODXe"),i=n("1OyB"),a=n("md7G"),o=n("foSv"),s=n("vuIU"),c=n("Ji7U"),u=n("fOPP"),l=n("8CAv"),h=n("vtVt"),f=(n("QFcT"),n("yOd+"));function p(t,e,n){var r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],c=e[5],u=e[6],l=e[7],h=e[8],f=e[9],p=e[10],d=e[11],v=e[12],y=e[13],m=e[14],g=e[15],b=n[0],O=n[1],_=n[2],j=n[3];return t[0]=b*r+O*s+_*h+j*v,t[1]=b*i+O*c+_*f+j*y,t[2]=b*a+O*u+_*p+j*m,t[3]=b*o+O*l+_*d+j*g,b=n[4],O=n[5],_=n[6],j=n[7],t[4]=b*r+O*s+_*h+j*v,t[5]=b*i+O*c+_*f+j*y,t[6]=b*a+O*u+_*p+j*m,t[7]=b*o+O*l+_*d+j*g,b=n[8],O=n[9],_=n[10],j=n[11],t[8]=b*r+O*s+_*h+j*v,t[9]=b*i+O*c+_*f+j*y,t[10]=b*a+O*u+_*p+j*m,t[11]=b*o+O*l+_*d+j*g,b=n[12],O=n[13],_=n[14],j=n[15],t[12]=b*r+O*s+_*h+j*v,t[13]=b*i+O*c+_*f+j*y,t[14]=b*a+O*u+_*p+j*m,t[15]=b*o+O*l+_*d+j*g,t}function d(t,e,n){var r=n[0],i=n[1],a=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function v(t,e,n,r,i){var a,o=1/Math.tan(e/2);return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(a=1/(r-i),t[10]=(i+r)*a,t[14]=2*i*r*a):(t[10]=-1,t[14]=-2*r),t}function y(t,e,n,r){var i,a,o,s,c,u,l,h,p,d,v=e[0],y=e[1],m=e[2],g=r[0],b=r[1],O=r[2],_=n[0],j=n[1],w=n[2];return Math.abs(v-_)<f.b&&Math.abs(y-j)<f.b&&Math.abs(m-w)<f.b?function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}(t):(l=v-_,h=y-j,p=m-w,i=b*(p*=d=1/Math.hypot(l,h,p))-O*(h*=d),a=O*(l*=d)-g*p,o=g*h-b*l,(d=Math.hypot(i,a,o))?(i*=d=1/d,a*=d,o*=d):(i=0,a=0,o=0),s=h*o-p*a,c=p*i-l*o,u=l*a-h*i,(d=Math.hypot(s,c,u))?(s*=d=1/d,c*=d,u*=d):(s=0,c=0,u=0),t[0]=i,t[1]=s,t[2]=l,t[3]=0,t[4]=a,t[5]=c,t[6]=h,t[7]=0,t[8]=o,t[9]=u,t[10]=p,t[11]=0,t[12]=-(i*v+a*y+o*m),t[13]=-(s*v+c*y+u*m),t[14]=-(l*v+h*y+p*m),t[15]=1,t)}var m=n("umh7"),g=n("MTwu"),b=n("ARt4"),O=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),_=Object.freeze([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),j=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL0ROW3:3,COL1ROW0:4,COL1ROW1:5,COL1ROW2:6,COL1ROW3:7,COL2ROW0:8,COL2ROW1:9,COL2ROW2:10,COL2ROW3:11,COL3ROW0:12,COL3ROW1:13,COL3ROW2:14,COL3ROW3:15}),w={},S=function(t){function e(t){var n;return Object(i.a)(this,e),n=Object(a.a)(this,Object(o.a)(e).call(this,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0)),1===arguments.length&&Array.isArray(t)?n.copy(t):n.identity(),n}return Object(c.a)(e,t),Object(s.a)(e,[{key:"INDICES",get:function(){return j}},{key:"ELEMENTS",get:function(){return 16}},{key:"RANK",get:function(){return 4}}],[{key:"IDENTITY",get:function(){return w.IDENTITY=w.IDENTITY||Object.freeze(new e(O)),w.IDENTITY}},{key:"ZERO",get:function(){return w.ZERO=w.ZERO||Object.freeze(new e(_)),w.ZERO}}]),Object(s.a)(e,[{key:"copy",value:function(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this[9]=t[9],this[10]=t[10],this[11]=t[11],this[12]=t[12],this[13]=t[13],this[14]=t[14],this[15]=t[15],this.check()}},{key:"set",value:function(t,e,n,r,i,a,o,s,c,u,l,h,f,p,d,v){return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this[4]=i,this[5]=a,this[6]=o,this[7]=s,this[8]=c,this[9]=u,this[10]=l,this[11]=h,this[12]=f,this[13]=p,this[14]=d,this[15]=v,this.check()}},{key:"setRowMajor",value:function(t,e,n,r,i,a,o,s,c,u,l,h,f,p,d,v){return this[0]=t,this[1]=i,this[2]=c,this[3]=f,this[4]=e,this[5]=a,this[6]=u,this[7]=p,this[8]=n,this[9]=o,this[10]=l,this[11]=d,this[12]=r,this[13]=s,this[14]=h,this[15]=v,this.check()}},{key:"toRowMajor",value:function(t){return t[0]=this[0],t[1]=this[4],t[2]=this[8],t[3]=this[12],t[4]=this[1],t[5]=this[5],t[6]=this[9],t[7]=this[13],t[8]=this[2],t[9]=this[6],t[10]=this[10],t[11]=this[14],t[12]=this[3],t[13]=this[7],t[14]=this[11],t[15]=this[15],t}},{key:"identity",value:function(){return this.copy(O)}},{key:"fromQuaternion",value:function(t){return function(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],o=n+n,s=r+r,c=i+i,u=n*o,l=r*o,h=r*s,f=i*o,p=i*s,d=i*c,v=a*o,y=a*s,m=a*c;t[0]=1-h-d,t[1]=l+m,t[2]=f-y,t[3]=0,t[4]=l-m,t[5]=1-u-d,t[6]=p+v,t[7]=0,t[8]=f+y,t[9]=p-v,t[10]=1-u-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1}(this,t),this.check()}},{key:"frustum",value:function(t){var n=t.left,r=t.right,i=t.bottom,a=t.top,o=t.near,s=t.far;return s===1/0?e._computeInfinitePerspectiveOffCenter(this,n,r,i,a,o):function(t,e,n,r,i,a,o){var s=1/(n-e),c=1/(i-r),u=1/(a-o);t[0]=2*a*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*a*c,t[6]=0,t[7]=0,t[8]=(n+e)*s,t[9]=(i+r)*c,t[10]=(o+a)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*a*2*u,t[15]=0}(this,n,r,i,a,o,s),this.check()}},{key:"lookAt",value:function(t,e,n){if(1===arguments.length){var r=t;t=r.eye,e=r.center,n=r.up}return y(this,t,e=e||[0,0,0],n=n||[0,1,0]),this.check()}},{key:"ortho",value:function(t){var e=t.left,n=t.right,r=t.bottom,i=t.top,a=t.near,o=void 0===a?.1:a,s=t.far;return function(t,e,n,r,i,a,o){var s=1/(e-n),c=1/(r-i),u=1/(a-o);t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+n)*s,t[13]=(i+r)*c,t[14]=(o+a)*u,t[15]=1}(this,e,n,r,i,o,void 0===s?500:s),this.check()}},{key:"orthographic",value:function(t){var n=t.fovy,r=void 0===n?45*Math.PI/180:n,i=t.aspect,a=void 0===i?1:i,o=t.focalDistance,s=void 0===o?1:o,c=t.near,u=void 0===c?.1:c,l=t.far,h=void 0===l?500:l;if(r>2*Math.PI)throw Error("radians");var f=r/2,p=s*Math.tan(f),d=p*a;return(new e).ortho({left:-d,right:d,bottom:-p,top:p,near:u,far:h})}},{key:"perspective",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.fovy,n=void 0===e?void 0:e,r=t.fov,i=void 0===r?45*Math.PI/180:r,a=t.aspect,o=void 0===a?1:a,s=t.near,c=void 0===s?.1:s,u=t.far,l=void 0===u?500:u;if((n=n||i)>2*Math.PI)throw Error("radians");return v(this,n,o,c,l),this.check()}},{key:"determinant",value:function(){return e=(t=this)[0],n=t[1],r=t[2],i=t[3],a=t[4],o=t[5],s=t[6],c=t[7],u=t[8],l=t[9],h=t[10],f=t[11],p=t[12],d=t[13],v=t[14],y=t[15],(e*o-n*a)*(h*y-f*v)-(e*s-r*a)*(l*y-f*d)+(e*c-i*a)*(l*v-h*d)+(n*s-r*o)*(u*y-f*p)-(n*c-i*o)*(u*v-h*p)+(r*c-i*s)*(u*d-l*p);var t,e,n,r,i,a,o,s,c,u,l,h,f,p,d,v,y}},{key:"getScale",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0];return t[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),t[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),t[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),t}},{key:"getTranslation",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0];return t[0]=this[12],t[1]=this[13],t[2]=this[14],t}},{key:"getRotation",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.getScale(e||[-0,-0,-0]),r=1/n[0],i=1/n[1],a=1/n[2];return t[0]=this[0]*r,t[1]=this[1]*i,t[2]=this[2]*a,t[3]=0,t[4]=this[4]*r,t[5]=this[5]*i,t[6]=this[6]*a,t[7]=0,t[8]=this[8]*r,t[9]=this[9]*i,t[10]=this[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},{key:"getRotationMatrix3",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0,-0,-0,-0,-0,-0,-0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.getScale(e||[-0,-0,-0]),r=1/n[0],i=1/n[1],a=1/n[2];return t[0]=this[0]*r,t[1]=this[1]*i,t[2]=this[2]*a,t[3]=this[4]*r,t[4]=this[5]*i,t[5]=this[6]*a,t[6]=this[8]*r,t[7]=this[9]*i,t[8]=this[10]*a,t}},{key:"transpose",value:function(){return function(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],a=e[6],o=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=a,t[11]=e[14],t[12]=i,t[13]=o,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15]}(this,this),this.check()}},{key:"invert",value:function(){var t,e,n,r,i,a,o,s,c,u,l,h,f,p,d,v,y,m,g,b,O,_,j,w,S,T,k,E,P,M,x;return t=this,n=(e=this)[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],c=e[6],u=e[7],l=e[8],h=e[9],f=e[10],p=e[11],d=e[12],v=e[13],y=e[14],m=e[15],(x=(g=n*s-r*o)*(M=f*m-p*y)-(b=n*c-i*o)*(P=h*m-p*v)+(O=n*u-a*o)*(E=h*y-f*v)+(_=r*c-i*s)*(k=l*m-p*d)-(j=r*u-a*s)*(T=l*y-f*d)+(w=i*u-a*c)*(S=l*v-h*d))&&(x=1/x,t[0]=(s*M-c*P+u*E)*x,t[1]=(i*P-r*M-a*E)*x,t[2]=(v*w-y*j+m*_)*x,t[3]=(f*j-h*w-p*_)*x,t[4]=(c*k-o*M-u*T)*x,t[5]=(n*M-i*k+a*T)*x,t[6]=(y*O-d*w-m*b)*x,t[7]=(l*w-f*O+p*b)*x,t[8]=(o*P-s*k+u*S)*x,t[9]=(r*k-n*P-a*S)*x,t[10]=(d*j-v*O+m*g)*x,t[11]=(h*O-l*j-p*g)*x,t[12]=(s*T-o*E-c*S)*x,t[13]=(n*E-r*T+i*S)*x,t[14]=(v*b-d*_-y*g)*x,t[15]=(l*_-h*b+f*g)*x),this.check()}},{key:"multiplyLeft",value:function(t){return p(this,t,this),this.check()}},{key:"multiplyRight",value:function(t){return p(this,this,t),this.check()}},{key:"rotateX",value:function(t){var e,n,r,i,a,o,s,c,u,l,h,f,p;return e=this,n=this,r=t,i=Math.sin(r),a=Math.cos(r),o=n[4],s=n[5],c=n[6],u=n[7],l=n[8],h=n[9],f=n[10],p=n[11],n!==e&&(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e[4]=o*a+l*i,e[5]=s*a+h*i,e[6]=c*a+f*i,e[7]=u*a+p*i,e[8]=l*a-o*i,e[9]=h*a-s*i,e[10]=f*a-c*i,e[11]=p*a-u*i,this.check()}},{key:"rotateY",value:function(t){var e,n,r,i,a,o,s,c,u,l,h,f,p;return e=this,n=this,r=t,i=Math.sin(r),a=Math.cos(r),o=n[0],s=n[1],c=n[2],u=n[3],l=n[8],h=n[9],f=n[10],p=n[11],n!==e&&(e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e[0]=o*a-l*i,e[1]=s*a-h*i,e[2]=c*a-f*i,e[3]=u*a-p*i,e[8]=o*i+l*a,e[9]=s*i+h*a,e[10]=c*i+f*a,e[11]=u*i+p*a,this.check()}},{key:"rotateZ",value:function(t){var e,n,r,i,a,o,s,c,u,l,h,f,p;return e=this,n=this,r=t,i=Math.sin(r),a=Math.cos(r),o=n[0],s=n[1],c=n[2],u=n[3],l=n[4],h=n[5],f=n[6],p=n[7],n!==e&&(e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e[0]=o*a+l*i,e[1]=s*a+h*i,e[2]=c*a+f*i,e[3]=u*a+p*i,e[4]=l*a-o*i,e[5]=h*a-s*i,e[6]=f*a-c*i,e[7]=p*a-u*i,this.check()}},{key:"rotateXYZ",value:function(t){var e=Object(r.a)(t,3),n=e[0],i=e[1],a=e[2];return this.rotateX(n).rotateY(i).rotateZ(a)}},{key:"rotateAxis",value:function(t,e){return function(t,e,n,r){var i,a,o,s,c,u,l,h,p,d,v,y,m,g,b,O,_,j,w,S,T,k,E,P,M=r[0],x=r[1],C=r[2],R=Math.hypot(M,x,C);R<f.b||(M*=R=1/R,x*=R,C*=R,i=Math.sin(n),o=1-(a=Math.cos(n)),s=e[0],c=e[1],u=e[2],l=e[3],h=e[4],p=e[5],d=e[6],v=e[7],y=e[8],m=e[9],g=e[10],b=e[11],O=M*M*o+a,_=x*M*o+C*i,j=C*M*o-x*i,w=M*x*o-C*i,S=x*x*o+a,T=C*x*o+M*i,k=M*C*o+x*i,E=x*C*o-M*i,P=C*C*o+a,t[0]=s*O+h*_+y*j,t[1]=c*O+p*_+m*j,t[2]=u*O+d*_+g*j,t[3]=l*O+v*_+b*j,t[4]=s*w+h*S+y*T,t[5]=c*w+p*S+m*T,t[6]=u*w+d*S+g*T,t[7]=l*w+v*S+b*T,t[8]=s*k+h*E+y*P,t[9]=c*k+p*E+m*P,t[10]=u*k+d*E+g*P,t[11]=l*k+v*E+b*P,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]))}(this,this,t,e),this.check()}},{key:"scale",value:function(t){return Array.isArray(t)?d(this,this,t):d(this,this,[t,t,t]),this.check()}},{key:"translate",value:function(t){var e,n,r,i,a,o,s,c,u,l,h,f,p,d,v,y,m,g;return e=this,n=this,y=(r=t)[0],m=r[1],g=r[2],n===e?(e[12]=n[0]*y+n[4]*m+n[8]*g+n[12],e[13]=n[1]*y+n[5]*m+n[9]*g+n[13],e[14]=n[2]*y+n[6]*m+n[10]*g+n[14],e[15]=n[3]*y+n[7]*m+n[11]*g+n[15]):(i=n[0],a=n[1],o=n[2],s=n[3],c=n[4],u=n[5],l=n[6],h=n[7],f=n[8],p=n[9],d=n[10],v=n[11],e[0]=i,e[1]=a,e[2]=o,e[3]=s,e[4]=c,e[5]=u,e[6]=l,e[7]=h,e[8]=f,e[9]=p,e[10]=d,e[11]=v,e[12]=i*y+c*m+f*g+n[12],e[13]=a*y+u*m+p*g+n[13],e[14]=o*y+l*m+d*g+n[14],e[15]=s*y+h*m+v*g+n[15]),this.check()}},{key:"transform",value:function(t,e){return 4===t.length?(e=b.n(e||[-0,-0,-0,-0],t,this),Object(u.b)(e,4),e):this.transformAsPoint(t,e)}},{key:"transformAsPoint",value:function(t,e){switch(t.length){case 2:e=m.d(e||[-0,-0],t,this);break;case 3:e=g.l(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Object(u.b)(e,t.length),e}},{key:"transformAsVector",value:function(t,e){switch(t.length){case 2:e=Object(h.a)(e||[-0,-0],t,this);break;case 3:e=Object(h.c)(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Object(u.b)(e,t.length),e}},{key:"makeRotationX",value:function(t){return this.identity().rotateX(t)}},{key:"makeTranslation",value:function(t,e,n){return this.identity().translate([t,e,n])}},{key:"transformPoint",value:function(t,e){return Object(u.c)("Matrix4.transformPoint","3.0"),this.transformAsPoint(t,e)}},{key:"transformVector",value:function(t,e){return Object(u.c)("Matrix4.transformVector","3.0"),this.transformAsPoint(t,e)}},{key:"transformDirection",value:function(t,e){return Object(u.c)("Matrix4.transformDirection","3.0"),this.transformAsVector(t,e)}}],[{key:"_computeInfinitePerspectiveOffCenter",value:function(t,e,n,r,i,a){var o=2*a/(n-e),s=2*a/(i-r),c=(n+e)/(n-e),u=(i+r)/(i-r),l=-2*a;return t[0]=o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=c,t[9]=u,t[10]=-1,t[11]=-1,t[12]=0,t[13]=0,t[14]=l,t[15]=0,t}}]),e}(l.a)},umh7:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return o})),n.d(e,"d",(function(){return s}));n("QFcT");var r=n("yOd+");function i(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t}function a(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i+n[4],t[1]=n[1]*r+n[3]*i+n[5],t}function o(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[3]*i+n[6],t[1]=n[1]*r+n[4]*i+n[7],t}function s(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}var c,u;c=new r.a(2),r.a!=Float32Array&&(c[0]=0,c[1]=0),u=c},vtVt:function(t,e,n){"use strict";function r(t,e,n){var r=e[0],i=e[1],a=n[3]*r+n[7]*i||1;return t[0]=(n[0]*r+n[4]*i)/a,t[1]=(n[1]*r+n[5]*i)/a,t}function i(t,e,n){var r=e[0],i=e[1],a=e[2],o=n[3]*r+n[7]*i+n[11]*a||1;return t[0]=(n[0]*r+n[4]*i+n[8]*a)/o,t[1]=(n[1]*r+n[5]*i+n[9]*a)/o,t[2]=(n[2]*r+n[6]*i+n[10]*a)/o,t}function a(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t}function o(t,e,n){var r=e[0],i=e[1],a=e[2];return t[0]=n[0]*r+n[3]*i+n[6]*a,t[1]=n[1]*r+n[4]*i+n[7]*a,t[2]=n[2]*r+n[5]*i+n[8]*a,t[3]=e[3],t}n.d(e,"a",(function(){return r})),n.d(e,"c",(function(){return i})),n.d(e,"b",(function(){return a})),n.d(e,"d",(function(){return o}))},"yOd+":function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return i})),n.d(e,"c",(function(){return a}));n("QFcT");var r=1e-6,i="undefined"!=typeof Float32Array?Float32Array:Array,a=Math.random;Math.PI;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)})},yeNo:function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"e",(function(){return s})),n.d(e,"f",(function(){return c})),n.d(e,"g",(function(){return l})),n.d(e,"c",(function(){return h})),n.d(e,"a",(function(){return f})),n.d(e,"d",(function(){return p}));n("U8pU"),n("RHh3"),n("KQm4"),n("2plT");var r=1/Math.PI*180,i=1/180*Math.PI,a={};function o(t){return Math.round(t/a.EPSILON)*a.EPSILON}function s(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.precision,r=void 0===n?a.precision||4:n;return t=o(t),"".concat(parseFloat(t.toPrecision(r)))}function c(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function u(t,e,n){if(c(t)){n=n||((i=t).clone?i.clone():new Array(i.length));for(var r=0;r<n.length&&r<t.length;++r)n[r]=e(t[r],r,n);return n}var i;return e(t)}function l(t){return function(t,e){return u(t,(function(t){return t*i}),e)}(t)}function h(t,e){return u(t,(function(t){return t*r}),e)}function f(t,e,n){return u(t,(function(t){return Math.max(e,Math.min(n,t))}))}function p(t,e,n){var r=a.EPSILON;n&&(a.EPSILON=n);try{if(t===e)return!0;if(c(t)&&c(e)){if(t.length!==e.length)return!1;for(var i=0;i<t.length;++i)if(!p(t[i],e[i]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):!(!Number.isFinite(t)||!Number.isFinite(e))&&Math.abs(t-e)<=a.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))}finally{a.EPSILON=r}}a.EPSILON=1e-12,a.debug=!1,a.precision=4,a.printTypes=!1,a.printDegrees=!1,a.printRowMajor=!0}}]);